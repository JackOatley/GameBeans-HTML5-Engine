!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("GameBeans",[],e):"object"==typeof exports?exports.GameBeans=e():t.GameBeans=e()}("undefined"!=typeof self?self:this,function(){return function(t){function e(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=25)}([function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function i(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function r(t,e,n,o,i,r,a,s,l){if(r)for(var u=~~t,c=n.length,f=0;f<c;f++){var d=o[n[f]],h=~~d.left,p=~~d.top,g=Math.ceil(d.bottom)-p,y=Math.ceil(d.right)-h;i.drawImage(a,h,p,y,g,u,e,y*s,g*s),u+=(y+1)*s}else i[l](n,t,e)}Object.defineProperty(e,"__esModule",{value:!0});var a=n(5),s=o(a),l=n(2),u=o(l),c=n(3),f=o(c),d=n(15),h=o(d),p=n(10),g=o(p),y=n(26),v=o(y),m={color:"#FFFFFF",font:"Arial",fontSize:30,textAlign:"start",textBaseline:"alphabetic",target:null,context:null,defaultTransform:[1,0,0,1,0,0],targetStack:[],imageSmoothing:!1,offsetX:0,offsetY:0,setTarget:function(t){m.targetStack.push(m.target),m.target=t,m.context=t.domElement.getContext("2d")},resetTarget:function(){var t=m.targetStack.pop();m.target=t,m.context=t.domElement.getContext("2d")},getTarget:function(){return m.target},clear:function(t){f.default.fill(m.target,t)},save:function(){m.context.save()},restore:function(){m.context.restore()},reset:function(){var t;m.context.imageSmoothingEnabled=m.imageSmoothing,(t=m.context).setTransform.apply(t,i(m.defaultTransform)),m.context.globalAlpha=1},setImageSmoothing:function(t){m.imageSmoothing=t},transform:{scale:function(t,e){m.context.scale(t,e)},rotate:function(t){m.context.rotate(t*s.default.DEGTORAD)},translate:function(t,e){m.offsetX=t,m.offsetY=e,m.context.translate(t,e)},setDefault:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=m.defaultTransform;t.scaleX&&(e[0]=t.scaleX),t.skewX&&(e[1]=t.skewX),t.skewY&&(e[2]=t.skewY),t.scaleY&&(e[3]=t.scaleY),t.moveX&&(e[4]=t.moveX),t.moveY&&(e[5]=t.moveY)}},setColor:function(t){"string"==typeof t?m.color=t:"r"in t&&"g"in t&&"b"in t?m.color="a"in t?"rgba("+t.r+","+t.g+","+t.b+","+t.a+")":"rgb("+t.r+","+t.g+","+t.b+")":"h"in t&&"s"in t&&"l"in t&&(m.color="a"in t?"hsla("+t.h+","+t.s+"%,"+t.l+"%,"+t.a+")":"hsl("+t.h+","+t.s+"%,"+t.l+"%)")},sprite:function(t,e,n,o,i,r,a){var l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{};t=u.default.get(t);var c=m.context,f=t.originX,d=t.originY;void 0!==l.originX&&(f=l.originX),void 0!==l.originY&&(d=l.originY),c.save(),c.translate(n,o),c.rotate(a*s.default.DEGTORAD),c.scale(i,r),e=Math.floor(e||0)%t.images.length;var h=t.images[e],p=h.img;c.drawImage(p,h.clip.x,h.clip.y,h.clip.w,h.clip.h,-f,-d,t.width,t.height),c.restore()},spriteTiled:function(t,e,n,o,i,r){t=u.default.get(t);var a=void 0,s=void 0,l=void 0,c=void 0;for(l=0,a=n;l<i;l++,a+=t.width)for(c=0,s=o;c<r;c++,s+=t.height)drawSprite(t,e,a,s,1,1,0)},canvas:function(t,e,n){m.context.drawImage(t.domElement,e,n)},setFont:function(t,e,n,o){t="string"==typeof t?t:t.name,m.font=t,m.fontSize=e||16,m.textAlign=n||"left",m.textBaseline=o||"alphabetic";var i=m.context;i.font=m.fontSize+"px "+t,i.textAlign=m.textAlign,i.textBaseline=m.textBaseline},text:function(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e=Number(e),n=Number(n);var i=void 0,a=void 0,s=void 0,l=void 0,u=!1,c=h.default.get(m.font);if(c&&"bitmap"===c.method){i=c.forceSize||m.fontSize;var f=g.default.hexToArray(m.color),d=""+i+f[0]+f[1]+f[2]+f[3];c.bitmapFont[d]||c.convertToBitmapFont({size:i,color:f}),u=!0,s=c.bitmapFont[d].lookup,a=c.bitmapFont[d].image,l=m.fontSize/c.bitmapFont[d].size}var p=m.context,y="fillText";o.stroke?(p.strokeStyle=o.strokeColor||m.color,p.lineWidth=o.lineWidth||2,y="strokeText"):p.fillStyle=m.color;var v=void 0,b=e,w=0,x=t.toString().length;o.pattern&&(w=o.pattern.start,x=o.pattern.end);for(var _=1.2*p.measureText("Mp").width,S=t.toString().split("#"),M=0;M<S.length;M++){if(o.maxWidth){for(var E=S[M].split(" "),O="",j=0;j<E.length;j++){var T=O+E[j]+" ";if(p.measureText(T).width>o.maxWidth&&j>0){var C=O.slice(0,w),D=O.slice(w,x);b+=p.measureText(C).width,0<x&&r(b,n,D,s,p,u,a,l,y),v=T.length,w-=v,x-=v,O=E[j]+" ",n+=_,b=e}else O=T}var A=O.slice(0,w),k=O.slice(w,x);b+=p.measureText(A).width,r(b,n,k,s,p,u,a,l,y),v=O.length}else{var P=S[M].slice(0,w),Y=S[M].slice(w,x);b+=p.measureText(P).width,r(~~b,n,Y,s,p,u,a,l,y),v=S[M].length}b=e,n+=_,w-=v,x-=v}},shape:v.default};e.default=m},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){o(this,t)}return t.classStaticMatch=function(e){e.create=t.functionFromConstructor(e);var n=e.get;for(var o in e.prototype)e[o]=t.functionFromMethod(e.prototype[o],n)},t.functionFromConstructor=function(t){return function(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];return new(Function.prototype.bind.apply(t,[null].concat(n)))}},t.functionFromMethod=function(t,e){return e?function(n){for(var o=arguments.length,i=Array(o>1?o-1:0),r=1;r<o;r++)i[r-1]=arguments[r];return t.call.apply(t,[e(n)].concat(i))}:function(){return t.call.apply(t,arguments)}},t.arrayExecute=function(t,e){return function(){for(var n=arguments.length,o=Array(n),i=0;i<n;i++)o[i]=arguments[i];return t.forEach(function(t){return e.call.apply(e,[t].concat(o))})}},t}();e.default=i},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(){return"Sprite_"+h.array.length}function a(t,e){for(var n=e.r/255,o=e.g/255,i=e.b/255,r=t.length;r-=4;)t[r]*=n,t[r+1]*=o,t[r+2]*=i}Object.defineProperty(e,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},u=n(1),c=o(u),f=n(10),d=o(f),h=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var o=void 0;n.atlas&&(o=n.atlasIndex||0,n.atlas.images[o]),this.assetType="sprite",this.name=n.name||r(),this.originX=n.originX||0,this.originY=n.originY||0,this.width=0,this.height=0,this.images=[],n.frames&&n.frames.forEach(function(t){e.addFrame({source:t.src})});var a=t.array.length;t.names[a]=this.name,t.array[a++]=this}return t.prototype.addFrame=function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=void 0;n.atlas&&(o=t.get(n.atlas).images[0].img);var i={img:o||new Image,clip:null,ready:!1};n.source&&(i.img.onload=function(){i.ready=!0,i.clip={x:0,y:0,w:i.img.width,h:i.img.height},e.width*e.height==0&&(e.width=i.clip.w,e.height=i.clip.h)},i.img.src=n.source||""),o&&n.clip&&(i.ready=!0,i.clip=n.clip,this.width*this.height==0&&(this.width=i.clip.w,this.height=i.clip.h)),this.images.push(i)},t.prototype.cache=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.images.forEach(function(e){var n=document.createElement("CANVAS");n.width=t.width||e.img.width,n.height=t.height||e.img.height,n.getContext("2d").drawImage(e.img,0,0,n.width+1,n.height+1),e.__orig=l({},e),e.clip.x=0,e.clip.y=0,e.clip.w=n.width,e.clip.h=n.height,e.img=n})},t.prototype.restore=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.images.forEach(function(t){t.__orig&&(t=t._orig),t.__origSrc&&(t.img.src=t.__origSrc)})},t.prototype.setOrigin=function(t,e){this.originX=Number(t),this.originY=Number(e)},t.prototype.tint=function(t){var e=this;this.images.forEach(function(n){var o=document.createElement("CANVAS"),i=o.getContext("2d");o.width=e.width,o.height=e.height,n.img=n.__orig||n.img,i.drawImage(n.img,0,0);var r=i.getImageData(0,0,o.width,o.height),l="object"===(void 0===t?"undefined":s(t))?t:d.default.hexToRgb(t);a(r.data,l),i.putImageData(r,0,0),n.__orig=n.img,n.__origSrc=n.img.src,n.img=o})},t.readyAll=function(){for(var e=t.array,n=e.length;n--;)for(var o=e[n].images,i=o.length;i--;)if(!o[i].ready)return!1;return!0},t.get=function(e){if("object"===(void 0===e?"undefined":s(e)))return e;for(var n=t.array.length;n--;)if(t.array[n].name===e)return t.array[n];return null},t}();c.default.classStaticMatch(h),h.names=[],h.array=[],e.default=h},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),a=n(0),s=o(a),l=n(1),u=o(l),c=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var n=document.createElement("CANVAS"),o=n.getContext("2d");this.domElement=n,this.context=o,this.width=e.width||300,this.height=e.height||150,n.scale=e.scale||1,n.application=e.application||!1,e.crisp2D&&(o.imageSmoothingEnabled=!1),n.application&&(s.default.setTarget(this),t.setMain(this)),n.oncontextmenu=function(t){return t.preventDefault()},t.array.push(this)}return t.prototype.setMain=function(){var e=this.domElement;if(t.main=this,null===t.dom){t.dom=e;(document.getElementById("gbgamebox")||document.body).appendChild(e)}},t.getMain=function(){return t.main},t.prototype.fill=function(t){var e=this.domElement,n=this.context;n.fillStyle=t||"#000000",n.fillRect(0,0,e.width/e.scale,e.height/e.scale)},t.prototype.clear=function(){var t=this.domElement;this.context.clearRect(0,0,t.width/t.scale,t.height/t.scale)},t.prototype.getPixel=function(t,e){return this.context.getImageData(t,e,1,1).data},r(t,[{key:"width",get:function(){return this._width},set:function(t){this._width=t,this.domElement.width=t}},{key:"height",get:function(){return this._height},set:function(t){this._height=t,this.domElement.height=t}}]),t}();u.default.classStaticMatch(c),c.array=[],c.main=null,c.dom=null,e.default=c},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=n(5),a=o(r),s=n(9),l=o(s),u=n(12),c=o(u),f=n(2),d=o(f),h=n(0),p=o(h),g=n(20),y=o(g);window.global=y.default;var v=function(){function t(t,e,n){var o=c.default.get(t);return null===o?(window.addConsoleText("#F00","No such object as "+t),window._GB_stop(),null):new o(e,n)}function e(t,e,o,i){t.id=X++,t.exists=!0,t.speed=0,t.object=e,t.objectName=e.objectName,t.assetType="instance",t.x=Number(o),t.y=Number(i),t.startX=t.x,t.startY=t.y,t.previousX=t.x,t.previousY=t.y,t.boxCollision={};var r=d.default.get(t.sprite);r&&(t.boxCollision.x=r.originX,t.boxCollision.y=r.originY,t.boxCollision.width=r.width,t.boxCollision.height=r.height),n(t),m(t),b(t),j(t,"create")}function n(t){for(var e=R.length;e--;)if(t.depth<=R[e].depth)return void R.splice(e,0,t);R.push(t)}function o(e,n,o,i,r){if(R.length>=N)return void console.warn("instance number hard limit reached:",N);var a=t(e,n,o);return a.speed=i,a.direction=r,a}function r(t,e){"function"==typeof t&&(t=t.objectName);var n=void 0,o=0,i=void 0;for(n=0;n<R.length;n++)if(i=R[n],i.objectName===t&&o++===e)return i;return null}function s(t){var e=0;return R.forEach(function(n){e+=n.objectName===t}),e}function u(t,e){this.rotation=e?this.rotation+t:t}function f(t,e){this.direction=e?this.direction+t:t}function h(t){return!(t.boxTop>l.default.mouse.y-p.default.offsetY||t.boxBottom<l.default.mouse.y-p.default.offsetY||t.boxLeft>l.default.mouse.x-p.default.offsetX||t.boxRight<l.default.mouse.x-p.default.offsetX)}function g(t){j(t,"step"),y(t),v(t),m(t),b(t),M(t),l.default.triggerEvents.forEach(function(e){j(t,e)})}function y(t){t.index+=t.imageSpeed;var e=d.default.get(t.sprite);if(e){var n=e.images.length;if(t.index>=n){var o=t.animationBehavior,r=void 0===o?"undefined":i(o);"string"===r?"loop"===o?t.index-=n:"stop"===o&&(t.index=n-1,t.imageSpeed=0):"function"===r&&o.call(t)}}}function v(t){var e={x:a.default.lengthDirX(t.terminal,t.gravityDirection),y:a.default.lengthDirY(t.terminal,t.gravityDirection)};(e.x>0&&t.speedX<=e.x||e.x<0&&t.speedX>=e.x)&&(t.speedX+=a.default.lengthDirX(t.gravity,t.gravityDirection)),(e.y>0&&t.speedY<=e.y||e.y<0&&t.speedY>=e.y)&&(t.speedY+=a.default.lengthDirY(t.gravity,t.gravityDirection)),t.x+=t.speedX,t.y+=t.speedY}function m(t){var e=d.default.get(t.sprite);null!==e&&(t.boxTop=t.y-e.originY*t.scaleY,t.boxLeft=t.x-e.originX*t.scaleX,t.boxBottom=t.boxTop+e.height*t.scaleY,t.boxRight=t.boxLeft+e.width*t.scaleX)}function b(t){var e=t.boxCollision;e.top=t.y-e.y*t.scaleY,e.left=t.x-e.x*t.scaleX,e.bottom=e.top+e.height*t.scaleY,e.right=e.left+e.width*t.scaleX}function w(t){j(t,"destroy"),t.exists=!1;var e=t.object.instances,n=e.indexOf(t);n>=0&&(e[n]=e[e.length-1],e.length-=1)}function x(t){t.visible&&(t.events.draw?j(t,"draw"):_(t))}function _(t,e){null!==t.sprite&&p.default.sprite(t.sprite,t.index,t.x,t.y,t.scaleX,t.scaleY,t.rotation,e)}function S(t){this.sprite=t}function M(t){t.listeners.forEach(function(e){switch(e.type){case"collision":E(t,e.target)}})}function E(t,e){var n=void 0;n="solid"===e?F():c.default.getAllInstances(e);var o=t.boxCollision;n.forEach(function(n){if(t!==n){var i=n.boxCollision;o.left>i.right||o.right<i.left||o.top>i.bottom||o.bottom<i.top||j(t,"collision_"+e,n)}})}function O(t,e){for(var n=R.length;n--;)j(R[n],t,e)}function j(t,e,n){B.push(window.other),window.other=n,G=e;try{if(t.exists){var o=t.events[e];o&&T(t,o,n)}}catch(n){return console.error(n),window.addConsoleText("#F00","Failed to execute event ["+e+"] of object ["+t.objectName+"] with error: "+n),window._GB_stop(),!1}window.other=B.pop()}function T(t,e,n){for(var o=[],i=!0,r=0,a=0;a<e.length;a++){var s=e[a];switch(s.flow){case"":i&&(i=s.cache.call(t),void 0===i?i=!0:o[r]=0);break;case"blockBegin":r++;break;case"blockEnd":r--;break;case"exitEvent":if(i)return!1}1==o[r]++&&(i=!0)}}function C(){for(var t=R.slice(),e=void 0,n=t.length;n--;)e=t[n],e.previousX=e.x,e.previousY=e.y}function D(){C();var t=R.slice();t.forEach(function(t){j(t,"stepBegin")}),t.forEach(g),t.forEach(function(t){j(t,"stepEnd")}),Y()}function A(){I&&R.sort(P),R.forEach(x)}function k(){for(var t=R.length;t--;)j(R[t],"drawGUI")}function P(t,e){return t.depth===e.depth?t.id-e.id:t.depth-e.depth}function Y(){for(var t,e=R.length,n=e;t=R[--n];)t.exists||(t.object.pool.release(t),R[n]=R[--e]);R.length=e}function F(){for(var t,e=[],n=R.length;t=R[--n];)t.solid&&e.push(t);return e}var X=1,R=[],N=1e3,I=!1,B=[],G="";return{get instanceArray(){return R},set doDepthSort(t){I=t},create:t,setup:e,stepAll:D,drawAll:A,drawGuiAll:k,executeEventAll:O,changeSprite:S,createMoving:o,destroy:w,drawSelf:_,setDirection:f,setRotation:u,count:s,mouseOn:h,find:r}}();e.default=v},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o={PI:Math.PI,RADTODEG:180/Math.PI,DEGTORAD:Math.PI/180,cos:Math.cos,sin:Math.sin,sign:Math.sign,randomInt:function(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t},choose:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return e[Math.floor(Math.random()*e.length)]},lengthDir:function(t,e){return e*=o.DEGTORAD,[Math.cos(e)*t,Math.sin(e)*t]},lengthDirX:function(t,e){return Math.cos(e*o.DEGTORAD)*t},lengthDirY:function(t,e){return Math.sin(e*o.DEGTORAD)*t},pointDistance:function(t,e,n,o){var i=t-n,r=e-o;return Math.sqrt(i*i+r*r)},pointDirection:function(t,e,n,i){return(Math.atan2(i-e,n-t)*o.RADTODEG+360)%360},angleDifference:function(t,e){var n=(e-t)%360;return n<=-180?n+=360:n>180&&(n-=360),n}};e.default=o},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=n(16),a=o(r),s=n(1),l=o(s),u=function(){function t(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};i(this,t);var r=t.pool.get(this);return r.size=e*n,r.data=r===this?[]:r.data,r.data.length=r.size,r.width=e,r.height=n,r.clear(o.value||0),r}return t.prototype.get=function(t,e){return this.data[t+e*this.width]},t.prototype.set=function(t,e,n){this.data[t+e*this.width]=n},t.prototype.add=function(t,e,n){this.data[t+e*this.width]+=n},t.prototype.multiply=function(t,e,n){this.data[t+e*this.width]*=n},t.prototype.clear=function(t){this.data.fill(t)},t.prototype.destroy=function(){t.pool.release(this)},t}();e.default=u,u.pool=new a.default(u),l.default.classStaticMatch(u)},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=n(1),s=o(a),l=n(8),u=o(l),c=n(4),f=o(c),d=n(2),h=o(d),p=n(0),g=o(p),y=function(){function t(e,n,o){i(this,t),this.name=e,this.width=Number(n),this.height=Number(o),this.background=null,this.backgroundMethod="no-repeat",this.backgroundColor="#FF0000",this.instances=[],t.names.push(e),t.array.push(this),null===t.current&&(t.current=this)}return t.prototype.setBackground=function(t){this.background=t},t.prototype.addInstance=function(t,e,n){"object"===(void 0===t?"undefined":r(t))&&(t=t.objectName),this.instances.push({name:t,x:e,y:n})},t.prototype.enter=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.transition)return void new u.default({prefab:e.transition,callback:t.enter.bind(null,this)});f.default.executeEventAll("roomleave"),f.default.instanceArray.forEach(function(t){f.default.destroy(t,!1)}),t.current=this,this.instances.forEach(function(t){f.default.create(t.name,t.x,t.y)}),f.default.executeEventAll("roomenter")},t.prototype.draw=function(){var t=g.default.target.domElement,e=g.default.context;g.default.clear(this.backgroundColor);var n=h.default.get(this.background);if(null!==n){var o=n.images[0].img;if("stretch"===this.backgroundMethod)e.drawImage(o,0,0,t.width,t.height);else{var i=e.createPattern(o,this.backgroundMethod);e.fillStyle=i,e.fillRect(0,0,t.width,t.height)}}},t.next=function(){var e=t.array.indexOf(t.current);t.enter(t.array[e+1])},t.previous=function(){var e=t.array.indexOf(t.current);t.enter(t.array[e-1])},t.get=function(e){if("object"===(void 0===e?"undefined":r(e)))return e;for(var n=0;n<t.array.length;n++)if(t.array[n].name===e)return t.array[n];return null},t}();y.prototype.assetType="room",y.names=[],y.array=[],y.current=null,s.default.classStaticMatch(y),e.default=y},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},a=n(0),s=o(a),l=n(11),u=o(l),c=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t),this.type=e.type||"fade",this.time=e.time||60,this.color=e.color||"#000000",this.callback=e.callback||u.default,e.prefab&&r(this,e.prefab),this.direction=1,this.alpha=0,this.delta=1/this.time,t.allInstances.push(this),t.prefabs.hasOwnProperty(this.type)||(window.addConsoleText("#F00","Unknown transition type: "+this.type),this.type="fade")}return t.prototype.update=function(){t.prefabs.hasOwnProperty(this.type)&&t.prefabs[this.type].update.call(this)},t.prototype.draw=function(){t.prefabs.hasOwnProperty(this.type)&&t.prefabs[this.type].draw.call(this)},t.prototype.destroy=function(){var e=t.allInstances.indexOf(this);t.allInstances.splice(e,1)},t.create=function(e){return new t(e)},t.updateAll=function(){t.allInstances.forEach(function(t){t.update()})},t.drawAll=function(){t.allInstances.forEach(function(t){t.draw()})},t}();c.allInstances=[],c.prefabs={fade:{update:function(){this.alpha+=this.direction?this.delta:-this.delta,this.alpha>=1?(this.callback(),this.direction=0):this.alpha<=0&&this.destroy()},draw:function(){var t=s.default.context;t.globalAlpha=this.alpha,t.fillStyle=this.color,t.fillRect(0,0,9999999,9999999)}}},e.default=c},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),a=o(r),s=n(18),l=o(s),u=["Left","Middle","Right"],c={press:[!1,!1,!1],down:[!1,!1,!1],release:[!1,!1,!1],wheelUp:!1,wheelDown:!1,rawX:0,rawY:0,x:0,y:0},f={press:{},down:{},release:{}},d={start:[],held:[],move:[],end:[],cancel:[],x:[],y:[]},h=function(){function t(){i(this,t)}return t.initMouse=function(){function e(t){t.preventDefault(),c.press[t.button]||window.focus(),c.press[t.button]=!0,c.down[t.button]=!0}function n(t){t.preventDefault(),c.press[t.button]=!1,c.release[t.button]=!0,c.down[t.button]=!1}function o(t){var e=a.default.main.domElement,n=e.getBoundingClientRect(),o=e.width/n.width,i=e.height/n.height;c.rawX=~~(t.clientX-n.left),c.rawY=~~(t.clientY-n.top),c.x=~~(c.rawX*o),c.y=~~(c.rawY*i)}function i(t){t.preventDefault();var e=Math.sign(t.wheelDelta);c.wheelUp=e>0,c.wheelDown=e<0}t.element.addEventListener("mousedown",e),t.element.addEventListener("mouseup",n),t.element.addEventListener("mousemove",o),t.element.addEventListener("mousewheel",i)},t.initKeyboard=function(){function e(t){t.preventDefault();var e=t.code||t.key;f.down[e]||(f.press[e]=!0,f.down[e]=!0)}function n(t){t.preventDefault();var e=t.code||t.key;f.release[e]=!0,f.down[e]=!1}l.default.forEach(function(t){f.press[t]=!1,f.down[t]=!1,f.release[t]=!1}),t.element.addEventListener("keydown",e),t.element.addEventListener("keyup",n)},t.initTouch=function(){function e(t){t.preventDefault(),!d.start[0]&&window.focus(),d.start[0]=!0,d.held[0]=!0}function n(t){t.preventDefault(),d.start[0]=!1,d.end[0]=!0,d.held[0]=!1}function o(t){t.preventDefault();var e=t.changedTouches;d.x[0]=e[0].pageX,d.y[0]=e[0].pageY}t.element.addEventListener("touchstart",e),t.element.addEventListener("touchend",n),t.element.addEventListener("touchcancel",n),t.element.addEventListener("touchmove",o)},t.getTriggerEvents=function(){var e=t.triggerEvents;e.length=0,Object.keys(f.down).forEach(function(t){l.default.includes(t)?(f.down[t]&&e.push(t),f.press[t]&&e.push(t+"Press"),f.release[t]&&e.push(t+"Release")):(console.warn("input key not supported: ",t),delete f.down[t])});for(var n=0;n<3;n++)c.down[n]&&e.push(u[n]+"Down"),c.press[n]&&e.push(u[n]+"Press"),c.release[n]&&e.push(u[n]+"Release");c.wheelUp&&e.push("WheelUp"),c.wheelDown&&e.push("WheelDown")},t.update=function(){Object.keys(f.down).forEach(function(t){f.press[t]=!1,f.release[t]=!1}),Object.keys(c.down).forEach(function(t){c.press[t]=!1,c.release[t]=!1}),Object.keys(d.held).forEach(function(t){d.start[t]=!1,d.end[t]=!1,d.held[t]=!1}),c.wheelUp=!1,c.wheelDown=!1},t}();h.element=document,h.triggerEvents=[],h.mouse=c,h.keyboard=f,h.touch=d,e.default=h},function(t,e,n){"use strict";function o(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16),a:255}:{r:0,g:0,b:0,a:255}}function i(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16),255]:[0,0,0,255]}function r(t){var e=t.toString(16);return 1==e.length?"0"+e:e}function a(t,e,n){return"#"+r(t)+r(e)+r(n)}Object.defineProperty(e,"__esModule",{value:!0}),e.default={hexToRgb:o,componentToHex:r,rgbToHex:a,hexToArray:i}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){}},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},a=n(19),s=(o(a),n(4)),l=o(s),u=n(27),c=o(u),f=n(16),d=o(f),h=n(1),p=o(h),g=function(){function t(e,n){i(this,t);var o=function t(e,n){var o=t.pool.get(this);return l.default.setup(o,t,e,n),t.instances.push(o),o};return r(o,t.prototype),c.default.set(o.prototype),o.objectName=e||"object_"+o.id,o.prototype.sprite=n||null,o.pool=new d.default(o),o.instances=[],t.names.push(o.objectName),t.array.push(o),o}return t.prototype.eventAddAction=function(e,n){void 0===n&&console.warn("tried to add an undefined action to an event!");var o="";if("string"==typeof n&&(o=n),this.prototype.events[e]||(this.prototype.events[e]=[]),e.includes("collision_")){var i=e.indexOf("_")+1,r=e.slice(i,200);t.addCollisionListener(this,r)}this.prototype.events[e].push({flow:o,cache:n})},t.prototype.addCollisionListener=function(t){this.prototype.listeners.push({type:"collision",target:t})},t.prototype.getAllInstances=function(){var t=this,e=[];return l.default.instanceArray.forEach(function(n){n.constructor.objectName===t.objectName&&e.push(n)}),e},t.get=function(e){if("string"!=typeof e)return e;for(var n=t.array,o=n.length;o--;)if(n[o].objectName===e)return n[o];return null},t}();p.default.classStaticMatch(g),g.prototype.assetType="object",g.names=[],g.array=[],e.default=g},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},a=n(7),s=o(a),l=n(0),u=o(l),c=n(1),f=o(c),d=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t),this.x=0,this.y=0,this.angle=0,this.width=s.default.current.width,this.height=s.default.current.height,this.follow=null,this.gridLocked=!1,this.left=0,this.right=0,this.top=0,this.bottom=0,r(this,e),t.array.push(this)}return t.prototype.update=function(){if(this.follow){Array.isArray(this.follow)||(this.follow=[this.follow]);var t=0,e=0,n=0,o=1;this.follow.forEach(function(i){Array.isArray(i)?(o=i[1]||1,i=i[0]):o=1,t+=i.x*o,e+=i.y*o,n+=o}),this.x=t/n,this.y=e/n}this.left=this.x-.5*this.width,this.right=this.x+.5*this.width,this.top=this.y-.5*this.height,this.bottom=this.y+.5*this.height,u.default.transform.translate(-this.left,-this.top)},t}();d.array=[],d.create=f.default.functionFromConstructor(d),d.updateAll=f.default.arrayExecute(d.array,d.prototype.update),e.default=d},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=n(3),r=function(t){return t&&t.__esModule?t:{default:t}}(i),a=function(){function t(){o(this,t)}return t.setCursor=function(t){r.default.main.style.cursor=t},t}();e.default=a},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=n(1),s=o(a),l=n(6),u=o(l),c=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t),this.name=e.name||"_UNNAMEDFONT",this.source=e.src||"",this.hasFontFace=!1,this.forceSize=0,this.bitmapFont=[],this.hasBitmapFont=null!==this.bitmap,this.method=e.method||"normal",e.apply&&this.applyCss(),t.names.push(this.name),t.array.push(this)}return t.prototype.getCss=function(){return"@font-face {font-family: "+this.name+";src: url('"+this.source+"') format('truetype');}"},t.prototype.applyCss=function(){var t=document.createElement("STYLE");t.textContent=this.getCss(),document.head.appendChild(t)},t.prototype.convertToBitmapFont=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=3*(t.size||8),n=t.map||"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789/\\,.<>{}[]!\"£$%^&*():;@'~#|`=+-_",o=.5*e,i=o,r=t.alphaThreshold||150,a=t.color||[0,0,0,255],s=document.createElement("CANVAS");s.width=e/3*n.length,s.height=e/3;var l=s.getContext("2d"),c=l.createImageData(1,1);c.data.set(a,0);var f=document.createElement("CANVAS");f.width=f.height=e;var d=f.getContext("2d");d.font=e+"px "+this.name,d.textAlign="center",d.textBaseline="middle";for(var h=new u.default(e/3,e/3),p={},g=0;g<n.length;g++){d.clearRect(0,0,e,e),h.clear(-1);var y=n[g];d.fillStyle="#000",d.fillText(y,o,i);var v,m=d.getImageData(0,0,f.width,f.height),b=m.data;for(v=0;v<b.length;v+=12){var w=~~(v/4%e/3),x=~~(~~(v/4/e)/3);-1===h.get(w,x)&&h.set(w,x,b[v+3])}var _={left:100,top:100,right:0,bottom:0},S=100,M=0,E=void 0,O=void 0;for(O=0;O<e/3;O++)for(E=0;E<e/3;E++)h.get(E,O)>r&&(_.left=Math.min(_.left,E),_.top=Math.min(_.top,O),_.right=Math.max(_.right,E+1),_.bottom=Math.max(_.bottom,O+1),S=Math.min(S,_.top),M=Math.max(M,_.bottom));for(O=0;O<e/3;O++)for(E=0;E<e/3;E++)h.get(E,O)>r&&l.putImageData(c,g*(e/3)+E,O);_.left+=g*(e/3),_.right+=g*(e/3),_.top=0,_.bottom=e/3,p[y]=_}p[" "]={left:-3,top:0,right:0,bottom:e/3};var j=""+t.size+a[0]+a[1]+a[2]+a[3];this.bitmapFont[j]={size:e/3,lookup:p,image:s},this.method="bitmap"},t.get=function(e){if("object"===(void 0===e?"undefined":r(e))||"function"==typeof e)return e;for(var n=t.array,o=n.length;o--;)if(n[o].name===e)return n[o];return null},t}();s.default.classStaticMatch(c),c.prototype.assetType="font",c.names=[],c.array=[],e.default=c},function(t,e,n){"use strict";function o(t){this.stack=[],this.length=0,this.newConstructor=t}Object.defineProperty(e,"__esModule",{value:!0}),e.default=o,o.prototype.get=function(t){return this.length&&(t=this.stack[--this.length],this.stack[this.length]=void 0),t||new this.newConstructor},o.prototype.release=function(t){this.stack[this.length++]=t}},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function i(t){try{window._GB_stop&&p.default.triggerEvents.includes("EscapePressed")&&window._GB_stop(),window.requestAnimationFrame(i);var e=j+T,n=0;if(m.default.fps=1e3/(t-C),m.default.dt=t-C,C=t,t>e){var o=t-j,a=Math.floor(o/T);j+=T*a,n=Math.min(a,60)}p.default.getTriggerEvents(),r(n),s(),n&&p.default.update()}catch(t){console.error(t),window.addConsoleText("#F00","Error: "+t),window._GB_stop()}}function r(t){for(;t--;)a()}function a(){y.default.stepAll(),M.default.updateAll()}function s(){w.default.reset(),c.default.main.fill("#000"),d.default.draw(d.default.current),_.default.updateAll(),y.default.drawAll(),w.default.reset(),y.default.drawGuiAll(),M.default.drawAll()}function l(){y.default.executeEventAll("resize")}Object.defineProperty(e,"__esModule",{value:!0});var u=n(3),c=o(u),f=n(7),d=o(f),h=n(9),p=o(h),g=n(4),y=o(g),v=n(20),m=o(v),b=n(0),w=o(b),x=n(13),_=o(x),S=n(8),M=o(S),E=n(11),O=o(E),j=performance.now(),T=1e3/60,C=0;window.addConsoleText=window.addConsoleText||console.log,window._GB_stop=window._GB_stop||O.default;var D={start:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(void 0!==t.host&&""!==t.host){var e=window.parent?window.parent.location:window.location,n=e.hostname;t.host.split(" ").join("").split(",");if(!t.host.includes(n))return}var o=new c.default({width:d.default.current.width,height:d.default.current.height,crisp2D:!0,application:!0});t.enableMouse&&p.default.initMouse(),t.enableKeyboard&&p.default.initKeyboard(),t.enableTouch&&p.default.initTouch(),t.hideCursor&&(o.domElement.style.cursor="none"),d.default.enter(d.default.current),i(performance.now())},setGameSpeed:function(t){T=1e3/t}};window.addEventListener("resize",l),e.default=D},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Enter","Space","Backspace","Escape","ShiftLeft","ShiftRight","ControlLeft","ControlRight","AltLeft","AltRight","KeyA","KeyB","KeyC","KeyD","KeyE","KeyF","KeyG","KeyH","KeyI","KeyJ","KeyK","KeyL","KeyM","KeyN","KeyO","KeyP","KeyQ","KeyR","KeyS","KeyT","KeyU","KeyV","KeyW","KeyX","KeyY","KeyZ","Digit0","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9"];e.default=o},function(t,e,n){"use strict";function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n={};return t.forEach(function(t){n[t]=t+e}),n}Object.defineProperty(e,"__esModule",{value:!0});var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},r=n(18),a=function(t){return t&&t.__esModule?t:{default:t}}(r),s={create:"create",roomEnter:"roomEnter",roomLeave:"roomLeave",step:"step",draw:"draw",collision:"collision_",resize:"resize",keyboard:i({},o(a.default),{pressed:o(a.default,"Press"),released:o(a.default,"Release")})};e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o={fps:0};e.default=o},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),a=n(1),s=function(t){return t&&t.__esModule?t:{default:t}}(a),l=function(){function t(e,n){o(this,t),this.name=e,this.instances=[new Audio(n)],this.ready=!1,this.volume=1,t.names.push(e),t.array.push(this),this.__test()}return t.prototype.preload=function(t){for(var e=this.instances,n=t-e.length;n-- >0;)e.push(e[0].cloneNode())},t.prototype.play=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t.isEnabled){for(var n,o=this.instances.length;o--;){var i=this.instances[o];if(i.paused){n=i;break}}n||(n=this.instances[0].cloneNode(),this.instances.push(n)),n.onError=function(t){console.error(soundName,t)},n.volume=this.volume;var r=n.play();return void 0!==r&&r.then(function(){n.onended=function(){this.currentTime=0,Number(e.loop||!1)?this.play():this.pause(),e.onEnd&&e.onEnd()}}).catch(function(t){console.warn(t)}),n}return null},t.prototype.stop=function(){for(var t=this.instances,e=t.length;e--;){var n=t[e];n.paused||n._end()}},t.prototype.__test=function(){var t=this,e=this.instances[0];e.oncanplaythrough=function(){t.ready=!0,e.oncanplaythrough=null}},t.readyAll=function(){for(var e=t.array,n=e.length;n--;)if(!e[n].ready)return!1;return!0},t.enable=function(e){t.isEnabled=e},t.get=function(e){if("object"===(void 0===e?"undefined":i(e)))return e;for(var n=t.array,o=n.length;o--;)if(n[o].name===e)return n[o];return window.addConsoleText("#F00","Unknown sound: "+e),null},r(t,[{key:"assetType",get:function(){return"sound"}}]),t}();s.default.classStaticMatch(l),l.isEnabled=!0,l.names=[],l.array=[],e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o={blend:function(t,e,n){return t+(e-t)*n},cubicBezier:function(t,e,n,i,r){var a=o.blend(0,t,r),s=o.blend(0,e,r),l=o.blend(t,n,r),u=o.blend(e,i,r),c=o.blend(n,1,r),f=o.blend(i,1,r),d=o.blend(a,l,r),h=o.blend(s,u,r),p=o.blend(l,c,r),g=o.blend(u,f,r);o.blend(d,p,r);return o.blend(h,g,r)}};e.default=o},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.texture,n=p.default.get(e);if(null===n)return void console.warn("No such texture: "+e);var o=d.default.context,i=n.images[0],r=i.img,a=n.width,u=n.height,c=l(t),f=t.points;t.modifier&&(f=s(t.points,t.modifier)),f.forEach(function(e){e.x+=t.x,e.y+=t.y});for(var h=c.length;h--;){var g=c[h],y=f[g[0]].x,v=f[g[1]].x,m=f[g[2]].x,b=f[g[0]].y,w=f[g[1]].y,x=f[g[2]].y,_=f[g[0]].u*a,S=f[g[1]].u*a,M=f[g[2]].u*a,E=f[g[0]].v*u,O=f[g[1]].v*u,j=f[g[2]].v*u;o.save(),o.beginPath(),o.moveTo(y,b),o.lineTo(v,w),o.lineTo(m,x),o.closePath(),o.clip();var T=_*O+E*M+S*j-O*M-E*S-_*j,C=y*O+E*m+v*j-O*m-E*v-y*j,D=_*v+y*M+S*m-v*M-y*S-_*m,A=_*O*m+E*v*M+y*S*j-y*O*M-E*S*m-_*v*j,k=b*O+E*x+w*j-O*x-E*w-b*j,P=_*w+b*M+S*x-w*M-b*S-_*x,Y=_*O*x+E*w*M+b*S*j-b*O*M-E*S*x-_*w*j;o.transform(C/T,k/T,D/T,P/T,A/T,Y/T),o.drawImage(r,0,0),o.restore()}}function a(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.points;if(t.modifier&&(e=s(t.points,t.modifier)),e.length>0){var n=u(t),o=void 0,i=d.default.context;for(i.fillStyle=t.color||d.default.color,o=0;o<n.length;o++){var r=n[o],a=void 0,l=e[r[0]];for(i.beginPath(),i.moveTo(t.x+l.x,t.y+l.y),a=1;a<r.length;a++)l=e[r[a]],i.lineTo(t.x+l.x,t.y+l.y);i.closePath(),i.fill()}}}function s(t,e){for(var n=[],o=t.length;o--;){var i=c({},t[o]);e(i),n.push(i)}return n}function l(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=[];if("quads"===t.format)for(var n=Math.floor(t.points.length/4),o=0;n--;)e.push([o+0,o+1,o+2],[o+2,o+3,o+0]),o+=4;return e}function u(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=[],n=Math.floor(t.points.length/4),o=0;n--;)e.push([o++,o++,o++,o++]);return e}Object.defineProperty(e,"__esModule",{value:!0});var c=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},f=n(0),d=o(f),h=n(2),p=o(h),g=n(1),y=o(g),v=n(11),m=o(v),b=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t),this.points=e.points||[],this.texture=e.texture||null,this.color=e.color||"#000000",this.format=e.format||"quads",this.modifier=e.modifier||m.default,this.x=e.x||0,this.y=e.y||0}return t.prototype.draw=function(t){var e=t||this;e.texture?r(e):a(e)},t}();y.default.classStaticMatch(b),e.default=b},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=function(t){return t&&t.__esModule?t:{default:t}}(i),a=function(){function t(e,n){o(this,t),this.set(e,n)}return t.prototype.set=function(t,e){this.x=t,this.y=e},t.prototype.copy=function(t){this.x=t.x,this.y=t.y},t.prototype.add=function(t){this.x+=t.x,this.y+=t.y},t.prototype.mul=function(t){this.x*=t.x,this.y*=t.y},t.prototype.div=function(t){this.x/=t.x,this.y/=t.y},t}();r.default.classStaticMatch(a),e.default=a},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.Vector2=e.Grid=e.Font=e.Transition=e.tween=e.math=e.draw=e.instance=e.action=e.event=e.object=e.Script=e.Sound=e.sprite=e.input=e.Room=e.Camera=e.canvas=e.main=e.App=void 0;var i=n(14),r=o(i),a=n(17),s=o(a),l=n(3),u=o(l),c=n(13),f=o(c),d=n(7),h=o(d),p=n(9),g=o(p),y=n(28),v=o(y),m=n(2),b=o(m),w=n(21),x=o(w),_=n(12),S=o(_),M=n(19),E=o(M),O=n(29),j=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(O),T=n(4),C=o(T),D=n(0),A=o(D),k=n(5),P=o(k),Y=n(22),F=o(Y),X=n(8),R=o(X),N=n(23),I=(o(N),n(15)),B=o(I),G=n(6),L=o(G),K=n(24),W=o(K);e.App=r.default,e.main=s.default,e.canvas=u.default,e.Camera=f.default,e.Room=h.default,e.input=g.default,e.sprite=b.default,e.Sound=x.default,e.Script=v.default,e.object=S.default,e.event=E.default,e.action=j,e.instance=C.default,e.draw=A.default,e.math=P.default,e.tween=F.default,e.Transition=R.default,e.Font=B.default,e.Grid=L.default,e.Vector2=W.default},function(t,e,n){"use strict";function o(t,e,n,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},r=s.default.context;r.strokeStyle=i.color||s.default.color,r.beginPath(),r.moveTo(t,e),r.lineTo(n,o),r.stroke()}function i(t,e,n,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},r=s.default.context;r.save(),r.beginPath(),r.translate(t-n,e-o),r.scale(n,o),r.arc(1,1,1,0,2*Math.PI,!1),r.restore();var a=void 0;if(i.healthbar){var l=i.healthbar.amount||1,u=i.healthbar.color||"#0F0",c=i.healthbar.background||"#F00";a=r.createLinearGradient(t-n,0,t+n,0),a.addColorStop(0,u),a.addColorStop(l,u),a.addColorStop(l,c),a.addColorStop(1,c)}else a=i.color||s.default.color;(i.fill||!i.fill&&!i.stroke)&&(r.fillStyle=a,r.fill()),i.stroke&&(r.strokeStyle=a,r.lineWidth=i.lineWidth||1,r.stroke())}function r(t,e,n,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},r=s.default.context;r.beginPath(),r.rect(t,e,n,o);var a=void 0;if(i.healthbar){var l=i.healthbar.amount||1,u=i.healthbar.color||"#0F0",c=i.healthbar.background||"#F00";a=r.createLinearGradient(t,0,t+n,0),a.addColorStop(0,u),a.addColorStop(l,u),a.addColorStop(l,c),a.addColorStop(1,c)}else a=i.color||s.default.color;(i.fill||!i.fill&&!i.stroke)&&(r.fillStyle=a,r.fill()),i.stroke&&(r.strokeStyle=a,r.lineWidth=i.lineWidth||1,r.stroke())}Object.defineProperty(e,"__esModule",{value:!0});var a=n(0),s=function(t){return t&&t.__esModule?t:{default:t}}(a);e.default={line:o,ellipse:i,rectangle:r}},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},r=n(5),a=o(r),s=n(4),l=o(s),u=JSON.stringify({sprite:null,index:0,imageSpeed:1,animationBehavior:"loop",visible:!0,solid:!1,exists:!0,scaleX:1,scaleY:1,rotation:0,terminal:100,gravity:0,gravityDirection:0,speedX:0,speedY:0,boxTop:0,boxBottom:0,boxLeft:0,boxRight:0,behaviours:[],listeners:[],events:{},boxCollision:{x:0,y:0,width:0,height:0,top:0,bottom:0,left:0,right:0},_depth:0}),c={set:function(t){i(t,JSON.parse(u)),t.destroy=function(){l.default.destroy(this)},t.mouseOn=function(){return l.default.mouseOn(this)},Object.defineProperty(t,"depth",{set:function(t){this._depth!==t&&(this._depth=t,l.default.doDepthSort=!0)},get:function(){return this._depth}}),Object.defineProperty(t,"speed",{set:function(t){var e=this.direction*a.default.DEGTORAD;this.speedX=Math.cos(e)*t,this.speedY=Math.sin(e)*t},get:function(t){return a.default.pointDistance(0,0,this.speedX,this.speedY)}}),Object.defineProperty(t,"direction",{set:function(t){var e=this.speed;this.speedX=Math.cos(t*a.default.DEGTORAD)*e,this.speedY=Math.sin(t*a.default.DEGTORAD)*e},get:function(t){return a.default.pointDirection(0,0,this.speedX,this.speedY)}})}};e.default=c},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function t(){o(this,t)};e.default=i,i.names=[]},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function i(t,e,n,o){var i=o?window.global:this;n?i[t]+=e:i[t]=e}function r(t,e,n,o){var i=o?window.global:this;switch(e){case"!==":return i[t]!==n;case"===":return i[t]===n;case"!=":return i[t]!=n;case"==":return i[t]==n;case"<":return i[t]<n;case">":return i[t]>n;case"<=":return i[t]<=n;case">=":return i[t]>=n;default:return!1}}function a(t){this.gravity=t}function s(t,e,n){n?(this.x+=Number(t),this.y+=Number(e)):(this.x=Number(t),this.y=Number(e))}function l(){this.x=Math.floor(641*Math.random())+0,this.y=Math.floor(481*Math.random())+0}function u(t,e){this.speed=t,this.direction=e}function c(t,e){this.x+=t*B.default.dt,this.y+=e*B.default.dt}function f(t){this.speedX=Number(t)}function d(t){this.speedY=Number(t)}function h(){this.speedX=-this.speedX}function p(){this.speedY=-this.speedY}function g(){var t=this.boxRight-this.boxLeft,e=this.boxBottom-this.boxTop,n=_.default.current,o=n.width,i=n.height;this.boxRight<0&&(this.x+=o+t),this.boxBottom<0&&(this.y+=i+e),this.boxLeft>o&&(this.x-=o+t),this.boxTop>i&&(this.y-=i+e)}function y(){var t=this.boxRight-this.boxLeft,e=this.boxBottom-this.boxTop,n=_.default.current,o=n.width,i=n.height;this.boxLeft<0&&(this.x=0),this.boxTop<0&&(this.y=0),this.boxRight>o&&(this.x=o-t),this.boxBottom>i&&(this.y=i-e)}function v(t){for(var e=arguments.length,n=Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];t.apply(this,n)}function m(t,e){window[t].apply(this,e)}function b(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];console.log(this[e].toFixed(2))}Object.defineProperty(e,"__esModule",{value:!0}),e.GAME=e.confirm=e.alert=e.message=e.script=e.func=e.confine=e.wrap=e.actionConfine=e.actionWrap=e.moveReverseY=e.moveReverseX=e.moveSpeedY=e.moveSpeedX=e.moveDirect=e.moveFree=e.jumpRandom=e.jump=e.setGravity=e.test=e.get=e.set=e.exitEvent=e.blockEnd=e.blockBegin=e.roomPrevious=e.roomNext=e.roomEnter=e.drawSprite=e.instanceDrawSelf=e.drawSelf=e.drawText=e.drawSetFontSize=e.drawSetFont=e.drawSetColor=e.soundStop=e.soundPlay=e.instanceChangeSprite=e.changeSprite=e.instanceSetDirection=e.instanceSetRotation=e.instanceDestroy=e.instanceCreateMoving=e.instanceCreate=void 0;var w=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},x=n(7),_=o(x),S=n(21),M=o(S),E=n(0),O=o(E),j=n(4),T=o(j),C=n(9),D=o(C),A=n(5),k=o(A),P=n(2),Y=o(P),F=n(3),X=o(F),R=n(10),N=o(R),I=n(17),B=o(I),G=n(13),L=o(G),K=n(14),W=o(K),z=n(6),U=o(z),H=n(30),V=o(H),q=n(22),J=o(q),$=n(8),Q=o($),Z=n(12),tt=o(Z),et=n(23),nt=o(et),ot=n(24),it=o(ot),rt={main:{setGameSpeed:B.default.setGameSpeed},instance:{create:T.default.create,createMoving:T.default.createMoving,destroy:T.default.destroy,find:T.default.find,findRandom:T.default.findRandom,count:T.default.count,mouseOn:T.default.mouseOn},draw:w(O.default,{self:T.default.drawSelf,debug:T.default.drawDebug}),Canvas:X.default,Color:N.default,sprite:Y.default,Sound:M.default,Room:_.default,input:{keyboard:D.default.keyboard,mouse:D.default.mouse,touch:D.default.touch},math:k.default,Camera:L.default,App:W.default,Grid:U.default,Tilemap:V.default,tween:J.default,Transition:Q.default,Object:tt.default,Primitive:nt.default,Vector2:it.default},at=_.default.enter,st=_.default.next,lt=_.default.previous,ut=T.default.create,ct=T.default.createMoving,ft=T.default.destroy,dt=T.default.changeSprite,ht=T.default.setRotation,pt=T.default.setDirection,gt=function(t){return console.log(t)},yt=function(t){window.alert(t)},vt=function(t){return window.confirm(t)},mt=O.default.setColor,bt=O.default.setFont,wt=O.default.setFontSize,xt=O.default.text,_t=T.default.drawSelf,St=O.default.sprite,Mt=function(t,e){M.default.play(t,{loop:e})},Et=M.default.stop;e.instanceCreate=ut,e.instanceCreateMoving=ct,e.instanceDestroy=ft,e.instanceSetRotation=ht,e.instanceSetDirection=pt,e.changeSprite=dt,e.instanceChangeSprite=dt,e.soundPlay=Mt,e.soundStop=Et,e.drawSetColor=mt,e.drawSetFont=bt,e.drawSetFontSize=wt,e.drawText=xt,e.drawSelf=_t,e.instanceDrawSelf=_t,e.drawSprite=St,e.roomEnter=at,e.roomNext=st,e.roomPrevious=lt,e.blockBegin="blockBegin",e.blockEnd="blockEnd",e.exitEvent="exitEvent",e.set=i,e.get=b,e.test=r,e.setGravity=a,e.jump=s,e.jumpRandom=l,e.moveFree=u,e.moveDirect=c,e.moveSpeedX=f,e.moveSpeedY=d,e.moveReverseX=h,e.moveReverseY=p,e.actionWrap=g,e.actionConfine=y,e.wrap=g,e.confine=y,e.func=v,e.script=m,e.message=gt,e.alert=yt,e.confirm=vt,e.GAME=rt},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),a=o(r),s=n(6),l=o(s),u=n(0),c=o(u),f=n(2),d=o(f),h=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t),this.textureAtlas=e.atlas||null,this.tileWidth=e.tileWidth||16,this.tileHeight=e.tileHeight||16,this.tileSpacing=e.tileSpacing||0,this.tileOverlay=e.tileOverlay||0,this.tilesWide=e.tilesWide||16,this.mapWidth=e.mapWidth||16,this.mapHeight=e.mapHeight||16,this.layers={},this.__gap=this.tileSpacing+this.tileOverlay,this.textureAtlas&&(this.__atlas=d.default.get(this.textureAtlas).images[0].img)}return t.prototype.set=function(t,e,n,o){this.layers[t]||(this.layers[t]=new l.default(this.mapWidth,this.mapHeight)),this.layers[t].set(e,n,o)},t.prototype.draw=function(t){var e=this.__atlas,n=this.tileWidth,o=this.tileHeight,i=this.tilesWide,r=this.__gap,a=this.tileOverlay,s=n+2*a,l=o+2*a,u=t.order||Object.keys(this.layers),f=~~Math.max(0,(t.left||0)/n),d=~~Math.max(0,(t.top||0)/o),h=Math.ceil(Math.min(this.mapWidth,(t.right||0)/n)),p=Math.ceil(Math.min(this.mapHeight,(t.bottom||0)/o)),g=void 0,y=void 0,v=void 0,m=void 0,b=void 0,w=void 0,x=void 0;for(v=0;v<u.length;v++)for(m=this.layers[u[v]],g=f;g<h;g++)for(y=d;y<p;y++)(b=m.get(g,y)-1)>=0&&(w=b%i*(n+2*r)+r,x=~~(b/i)*(o+2*r)+r,c.default.context.drawImage(e,w-a,x-a,s,l,g*n-a,y*o-a,s,l))},t}();a.default.classStaticMatch(h),h.prototype.assetType="tilemap",e.default=h}])});
//# sourceMappingURL=GameBeans.js.map