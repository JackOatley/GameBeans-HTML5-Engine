{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///GameBeans.js","webpack:///webpack/bootstrap 7742389b5a415bc76a5b","webpack:///./core/js/draw.js","webpack:///./core/js/generator.js","webpack:///./core/js/Canvas.js","webpack:///./core/js/sprite.js","webpack:///./core/js/instance.js","webpack:///./core/js/math.js","webpack:///./core/js/data/grid.js","webpack:///./core/js/room.js","webpack:///./core/js/transition.js","webpack:///./core/js/input.js","webpack:///./core/js/Color.js","webpack:///./core/js/font.js","webpack:///./core/js/utils/noop.js","webpack:///./core/js/object.js","webpack:///./core/js/camera.js","webpack:///./core/js/App.js","webpack:///./core/js/utils/pool.js","webpack:///./core/js/main.js","webpack:///./core/js/keyvalues.js","webpack:///./core/js/event.js","webpack:///./core/js/global.js","webpack:///./core/js/Sound.js","webpack:///./core/js/tween.js","webpack:///./core/js/drawing/primitive.js","webpack:///./core/js/Vector2.js","webpack:///./core/js/core.js","webpack:///./core/js/drawing/DrawShapes.js","webpack:///./core/js/objectVars.js","webpack:///./core/js/Script.js","webpack:///./core/js/action.js","webpack:///./core/js/tilemap.js"],"names":["root","factory","exports","module","define","amd","self","this","modules","__webpack_require__","moduleId","installedModules","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","_interopRequireDefault","obj","default","_classCallCheck","instance","Constructor","TypeError","_drawWord","drawX","drawY","word","lookup","ctx","useBitmap","bitmap","scale","drawMethod","dx","len","length","cn","metrics","sx","left","sy","top","sh","Math","ceil","bottom","sw","right","drawImage","value","_math","_math2","_sprite2","_sprite3","_Canvas","_Canvas2","_font","_font2","_Color","_Color2","_DrawShapes","_DrawShapes2","Draw","setTarget","target","targetStack","push","context","resetTarget","pop","getTarget","clear","col","canvas","fill","save","restore","reset","imageSmoothingEnabled","imageSmoothing","globalAlpha","CanvasRenderingContext2D","setTransform","apply","defaultTransform","setImageSmoothing","enable","setColor","color","a","r","g","b","sprite","spr","index","x","y","scaleX","scaleY","rotation","opts","arguments","undefined","window","addConsoleText","_GB_stop","ox","originX","oy","originY","translate","rotate","math","DEGTORAD","floor","images","frame","img","clip","w","h","width","height","spriteTiled","dy","rx","ry","drawSprite","canv","domElement","setFont","font","size","align","baseline","fontSize","textAlign","textBaseline","text","Number","drawSize","Font","method","forceSize","Color","hexToArray","key","bitmapFont","convertToBitmapFont","image","stroke","strokeStyle","strokeColor","lineWidth","fillStyle","lineLength","startN","endN","toString","lineHeight","measureText","lines","split","maxWidth","words","line","testLine","slice","t","offsetX","offsetY","shape","DrawShapes","transform","rot","Generator","classStaticMatch","create","functionFromConstructor","functionFromMethod","_len","Array","_key","Function","bind","concat","_len2","_key2","arrayExecute","_len3","_key3","forEach","_createClass","defineProperties","props","descriptor","writable","protoProps","staticProps","_draw","_draw2","_generator","_generator2","Canvas","defaultContext","document","createElement","getContext","_width","_height","application","crisp2D","draw","setMain","oncontextmenu","e","preventDefault","array","main","dom","getElementById","body","appendChild","fillRect","clearRect","setPixel","data","imageData","getImageData","set","putImageData","getPixel","setImageData","getMain","pixelDataTint","rgb","pixelDataFade","rgba","_typeof","Symbol","iterator","constructor","_extends","assign","source","Sprite","_this","atlasIndex","atlas","assetType","newName","frames","addFrame","src","names","_this2","Image","ready","onload","cache","__orig","_orig","__origSrc","setOrigin","tint","hexToRgb","fade","toCanvas","readyAll","sa","ia","_toConsumableArray","arr","isArray","arr2","from","newStep","instanceArray","previousX","previousY","updatePosition","inst","gravVector","lengthDirX","terminal","gravityDirection","lengthDirY","speedX","gravity","speedY","updateBoundingBox","boxTop","boxLeft","boxBottom","boxRight","updateCollisionBox","box","boxCollision","updateAnimation","imageSpeed","behavior","animationBehavior","type","addToArray","depth","splice","getAllSolid","solid","clearDestroyed","exists","uninstantiate","pool","release","sortFunction","id","instanceExecuteListeners","listeners","listener","instanceCollisionInstance","executeEvent","event","otherInst","otherStack","other","currentEvent","actions","events","executeActions","err","console","error","objectName","getAllInstances","box1","targ","box2","steps","condition","executeIfElse","scope","action","flow","_input","_input2","_object","_object2","_sprite","_global","_global2","global","uniqueId","doDepthSort","createMoving","speed","direction","newInst","setup","startX","startY","find","findRandom","randomInt","count","nearest","all","nrst","dist","newDist","pointDistance","furthest","frst","setRotation","relative","setDirection","moveTowardsPoint","spd","pointDirection","stepTowardsPoint","dir","vec","lengthDir","distanceToPoint","position","pointOn","mouseOn","input","mouse","step","triggerEvents","destroy","instances","indexOf","visible","drawSelf","drawDebug","rectangle","changeSprite","executeEventAll","stepAll","drawAll","sort","drawGuiAll","PI","RADTODEG","cos","sin","sign","min","max","random","choose","x1","y1","x2","y2","sqrt","atan2","angleDifference","angle1","angle2","diff","_pool","_pool2","Grid","myGrid","add","multiply","Pool","_transition","_transition2","_instance","_instance2","_draw3","Room","background","backgroundFrame","backgroundAnimate","backgroundAnimateSpeed","backgroundMethod","backgroundColor","current","setBackground","addInstance","enter","transition","Transition","prefab","callback","persistent","animate","pattern","replace","createPattern","next","previous","_noop","_noop2","time","noop","alpha","delta","allInstances","prefabs","update","updateAll","_keyvalues","_keyvalues2","__mouseMap","__mouse","press","down","wheelUp","wheelDown","rawX","rawY","__keyboard","__touch","start","held","move","end","cancel","Input","initMouse","handleMouseDown","button","focus","handleMouseUp","handleMouseMove","rect","getBoundingClientRect","hs","vs","clientX","clientY","handleMouseWheel","wheelDelta","element","addEventListener","initKeyboard","handleKeyDown","code","handleKeyUp","keyValues","initTouch","handleTouchStart","handleTouchEnd","handleTouchMove","touches","changedTouches","pageX","pageY","getTriggerEvents","triggers","keys","includes","warn","keyboard","touch","hex","result","exec","parseInt","componentToHex","rgbToHex","_grid","_grid2","hasFontFace","hasBitmapFont","applyCss","getCss","style","textContent","head","psize","map","cx","cy","alphaThreshold","atlasCtx","pointImageData","createImageData","charMap","lookupTable","fillText","minY","maxY","hits","log","_event","_objectVars","_objectVars2","GameObject","objectVars","eventAddAction","addCollisionListener","_room","_room2","Camera","angle","room","follow","gridLocked","weight","App","setCursor","cursor","newConstructor","stack","def","tick","timestamp","requestAnimationFrame","nextTick","lastTick","tickLength","numTicks","fpsNow","last","dt","fpsFrames","fpsTime","fps","timeSinceTick","maxTicks","queueUpdates","gameDraw","ticks","gameUpdate","Instance","handleResizeEvent","_camera","_camera2","performance","now","NOOP","host","loc","parent","location","hostname","join","enableMouse","enableKeyboard","enableTouch","hideCursor","setGameSpeed","values","postfix","roomEnter","roomLeave","collision","resize","pressed","released","Sound","Audio","volume","__test","preload","number","cloneNode","play","isEnabled","playSound","paused","onError","soundName","promise","then","onended","currentTime","loop","pause","onEnd","catch","stop","oncanplaythrough","tween","blend","n1","n2","perc","cubicBezier","x3","y3","xa","ya","xb","yb","xc","yc","xm","ym","xn","yn","drawTextured","texture","tris","orderTriangleList","pts","points","modifier","applyModifier","pp","x0","y0","u0","u","u1","u2","v0","v","v1","v2","beginPath","moveTo","lineTo","closePath","delta_a","delta_b","delta_c","delta_d","delta_e","delta_f","drawBasic","orderQuadList","tri","newPoints","newP","format","Primitive","Vector2","copy","mul","div","Script","_App","_App2","_main","_main2","_Script","_Script2","_Sound","_Sound2","_event2","_action","newObj","_tween","_tween2","_primitive","_Vector","_Vector2","ellipse","xr","yr","arc","healthbar","amount","createLinearGradient","addColorStop","basic","JSON","stringify","behaviours","_depth","ObjectVars","proto","parse","varName","test","op","setGravity","jump","jumpRandom","moveFree","moveDirect","moveSpeedX","moveSpeedY","moveReverseX","moveReverseY","actionWrap","thisRoom","roomW","roomH","actionConfine","actionFunc","func","args","script","toFixed","GAME","confirm","alert","message","confine","wrap","exitEvent","ifElse","blockEnd","blockBegin","roomPrevious","roomNext","instanceDrawSelf","drawRectangle","drawText","drawSetFontSize","drawSetFont","drawSetColor","soundStop","soundPlay","instanceChangeSprite","instanceSetDirection","instanceSetRotation","instanceDestroy","instanceCreateMoving","instanceCreate","_tilemap","_tilemap2","_primitive2","debug","Tilemap","setFontSize","snd","textureAtlas","tileWidth","tileHeight","tileSpacing","tileOverlay","tilesWide","mapWidth","mapHeight","layers","__gap","__atlas","layer","tile","iX","iY","tw","th","tsw","gap","overlay","renderWidth","renderHeight","order","endX","endY"],"mappings":"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+BnwJa4wB,iBAAZlX,G/BowJD1Z,E+BnwJCgJ,c/BowJDhJ,E+BnwJCknB,a/BowJDlnB,E+BpwJY2wB,Y/BqwJZ3wB,E+BrwJsB0wB,gB/BswJtB1wB,E+BrwJCywB,WA7CgB,a/BmzJjBzwB,E+BtwJawwB,SA5CD,W/BmzJZxwB,E+BvwJuBuwB,OA1Cb,S/BkzJVvwB,E+BvwJCswB,UA5CY,Y/BozJbtwB,E+BvwJCsP,M/BwwJDtP,E+BvwJCuB,M/BwwJDvB,E+BvwJC2uB,O/BwwJD3uB,E+BvwJC6uB,a/BwwJD7uB,E+BvwJC8uB,O/BwwJD9uB,E+BvwJC+uB,a/BwwJD/uB,E+BvwJCgvB,W/BwwJDhvB,E+BvwJCivB,a/BwwJDjvB,E+BvwJCkvB,a/BwwJDlvB,E+BvwJCmvB,a/BwwJDnvB,E+BvwJCovB,e/BwwJDpvB,E+BvwJCqvB,e/BwwJDrvB,E+BvwJCsvB,a/BwwJDtvB,E+BvwJC0vB,gB/BwwJD1vB,E+BvwJqBqwB,KAApBf,E/BwwJDtvB,E+BvwJqBowB,QAApBV,E/BwwJD1vB,E+BvwJqB4vB,KAApBD,E/BwwJD3vB,E+BvwJC8vB,S/BwwJD9vB,E+BvwJCmwB,W/BwwJDnwB,E+BvwJCkwB,S/BwwJDlwB,E+BvwJCiwB,W/BwwJDjwB,E+BvwJCgwB,S/B2wJK,SAAU/vB,EAAQD,EAASO,GAEjC,YAuBA,SAASyB,GAAuBC,GAAO,MAAOA,IAAOA,EAAIR,WAAaQ,GAAQC,QAASD,GAEvF,QAASE,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAtBhHnB,OAAOC,eAAepB,EAAS,cAC9BiE,OAAO,GgC9kKR,IAAAyJ,GAAAnN,EAAA,GhCmlKIoN,EAAc3L,EAAuB0L,GgCllKzCoU,EAAAvhB,EAAA,GhCslKIwhB,EAAS/f,EAAuB8f,GgCrlKpCtU,EAAAjN,EAAA,GhCylKIkN,EAASzL,EAAuBwL,GgCxlKpCmJ,EAAApW,EAAA,GhC4lKI6D,EAAWpC,EAAuB2U,GgCvlKhCmb,EhCgmKQ,WgCnlKb,QAAAA,KAAuB,GAAXzqB,GAAWC,UAAAnE,OAAA,OAAAoE,KAAAD,UAAA,GAAAA,UAAA,KAAAnF,GAAA9B,KAAAyxB,GACtBzxB,KAAK4xB,aAAe5qB,EAAKoJ,OAAS,KAClCpQ,KAAK6xB,UAAY7qB,EAAK6qB,WAAa,GACnC7xB,KAAK8xB,WAAa9qB,EAAK8qB,YAAc,GACrC9xB,KAAK+xB,YAAc/qB,EAAK+qB,aAAe,EACvC/xB,KAAKgyB,YAAchrB,EAAKgrB,aAAe,EACvChyB,KAAKiyB,UAAYjrB,EAAKirB,WAAa,GACnCjyB,KAAKkyB,SAAWlrB,EAAKkrB,UAAY,GACjClyB,KAAKmyB,UAAYnrB,EAAKmrB,WAAa,GACnCnyB,KAAKoyB,UAELpyB,KAAKqyB,MAAQryB,KAAK+xB,YAAc/xB,KAAKgyB,YACjChyB,KAAK4xB,eACR5xB,KAAKsyB,QAAUriB,UAAO/O,IAAIlB,KAAK4xB,cAAc7pB,OAAO,GAAGE,KhCiqKzD,MAlDAwpB,GAAQlwB,UgCrmKR0N,IhCqmKwB,SgCrmKpBsjB,EAAO5rB,EAAGC,EAAGF,GACX1G,KAAKoyB,OAAOG,KAChBvyB,KAAKoyB,OAAOG,GAAS,GAAIpX,WAAKnb,KAAKkyB,SAAUlyB,KAAKmyB,YAEnDnyB,KAAKoyB,OAAOG,GAAOtjB,IAAItI,EAAGC,EAAGF,IhCmnK9B+qB,EAAQlwB,UgCvmKRyM,KhCumKyB,SgCvmKpBhH,GACJ,GAaIL,GAAGC,EAAGzF,EAAGoxB,EAAOC,EAAMC,EAAIC,EAbxBtiB,EAAQpQ,KAAKsyB,QACbK,EAAK3yB,KAAK6xB,UACVe,EAAK5yB,KAAK8xB,WACVe,EAAM7yB,KAAKiyB,UACXa,EAAM9yB,KAAKqyB,MACXU,EAAU/yB,KAAKgyB,YACfgB,EAAcL,EAAe,EAAVI,EACnBE,EAAeL,EAAe,EAAVG,EACpBG,EAAQlsB,EAAKksB,OAASpyB,OAAOggB,KAAK9gB,KAAKoyB,QACvCnb,IAAY3T,KAAK8W,IAAI,GAAIpT,EAAK9D,MAAQ,GAAKyvB,GAC3Czb,IAAY5T,KAAK8W,IAAI,GAAIpT,EAAK5D,KAAO,GAAKwvB,GAC1CO,EAAO7vB,KAAKC,KAAKD,KAAK6W,IAAIna,KAAKkyB,UAAWlrB,EAAKtD,OAAS,GAAKivB,IAC7DS,EAAO9vB,KAAKC,KAAKD,KAAK6W,IAAIna,KAAKmyB,WAAYnrB,EAAKxD,QAAU,GAAKovB,GAErE,KAAKzxB,EAAE,EAAGA,EAAE+xB,EAAMpwB,OAAQ3B,IAEzB,IADAoxB,EAAQvyB,KAAKoyB,OAAOc,EAAM/xB,IACrBwF,EAAEsQ,EAAQtQ,EAAEwsB,EAAMxsB,IACvB,IAAKC,EAAEsQ,EAAQtQ,EAAEwsB,EAAMxsB,KACtB4rB,EAAOD,EAAMrxB,IAAIyF,EAAGC,GAAK,IACb,IACX6rB,EAAMD,EAAOK,GAAQF,EAAS,EAAJG,GAASA,EACnCJ,KAAQF,EAAOK,IAAQD,EAAS,EAAJE,GAASA,EACrCruB,UAAKK,QAAQnB,UACZyM,EACAqiB,EAAKM,EAASL,EAAKK,EACnBC,EAAaC,EACbtsB,EAAIgsB,EAAKI,EACTnsB,EAAIgsB,EAAKG,EACTC,EAAaC,KhC0mKXxB,IgChmKR9lB,WAAUC,iBAAiB6lB,GAC3BA,EAAQlwB,UAAU8O,UAAY,UhCwmK9B1Q,EAAQkC,QgCtmKO4vB","file":"GameBeans.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"GameBeans\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"GameBeans\"] = factory();\n\telse\n\t\troot[\"GameBeans\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"GameBeans\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"GameBeans\"] = factory();\n\telse\n\t\troot[\"GameBeans\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 25);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _math = __webpack_require__(5);\n\nvar _math2 = _interopRequireDefault(_math);\n\nvar _sprite2 = __webpack_require__(3);\n\nvar _sprite3 = _interopRequireDefault(_sprite2);\n\nvar _Canvas = __webpack_require__(2);\n\nvar _Canvas2 = _interopRequireDefault(_Canvas);\n\nvar _font = __webpack_require__(11);\n\nvar _font2 = _interopRequireDefault(_font);\n\nvar _Color = __webpack_require__(10);\n\nvar _Color2 = _interopRequireDefault(_Color);\n\nvar _DrawShapes = __webpack_require__(26);\n\nvar _DrawShapes2 = _interopRequireDefault(_DrawShapes);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n//\nvar Draw = function () {\n\tfunction Draw() {\n\t\t_classCallCheck(this, Draw);\n\t}\n\n\t/** */\n\tDraw.setTarget = function setTarget(target) {\n\t\tDraw.targetStack.push(Draw.target);\n\t\tDraw.target = target;\n\t\tDraw.context = target.context;\n\t};\n\n\t/** */\n\n\n\tDraw.resetTarget = function resetTarget() {\n\t\tvar target = Draw.targetStack.pop();\n\t\tDraw.target = target;\n\t\tDraw.context = target.context;\n\t};\n\n\t/** */\n\n\n\tDraw.getTarget = function getTarget() {\n\t\treturn Draw.target;\n\t};\n\n\t/** */\n\n\n\tDraw.clear = function clear(col) {\n\t\t_Canvas2.default.fill(Draw.target, col);\n\t};\n\n\t/** */\n\n\n\tDraw.save = function save() {\n\t\tDraw.context.save();\n\t};\n\n\t/** */\n\n\n\tDraw.restore = function restore() {\n\t\tDraw.context.restore();\n\t};\n\n\t/** */\n\n\n\tDraw.reset = function reset() {\n\t\tDraw.context.imageSmoothingEnabled = Draw.imageSmoothing;\n\t\tDraw.context.globalAlpha = 1;\n\t\tif (Draw.context instanceof CanvasRenderingContext2D) {\n\t\t\tDraw.context.setTransform.apply(Draw.context, Draw.defaultTransform);\n\t\t}\n\t};\n\n\t/** */\n\n\n\tDraw.setImageSmoothing = function setImageSmoothing(enable) {\n\t\tDraw.imageSmoothing = enable;\n\t};\n\n\t/**\r\n  * @param {*} c Can be a number, a hex-value or an object containing R,\r\n  * G, B and optionally A properties or H, S, L and optionally A properties.\r\n  * @return {void}\r\n  */\n\n\n\tDraw.setColor = function setColor(c) {\n\n\t\t// quick exit if c is already a CSS color value\n\t\tif (typeof c === \"string\") {\n\t\t\tDraw.color = c;\n\t\t\treturn;\n\t\t}\n\n\t\t// RGB / RGBA\n\t\tif (\"r\" in c && \"g\" in c && \"b\" in c) {\n\t\t\tvar a = \"a\" in c ? c.a : 1;\n\t\t\tDraw.color = \"rgba(\" + c.r + \",\" + c.g + \",\" + c.b + \",\" + a + \")\";\n\t\t}\n\n\t\t// HSL / HSLA\n\t\telse if (\"h\" in c && \"s\" in c && \"l\" in c) {\n\t\t\t\tvar a = \"a\" in c ? c.a : 1;\n\t\t\t\tDraw.color = \"hsla(\" + c.r + \",\" + c.g + \",\" + c.b + \",\" + a + \")\";\n\t\t\t}\n\t};\n\n\t/**\r\n  * Draws the sprite at the given x, y position.\r\n  * @param {Object} sprite\r\n  * @param {number} index\r\n  * @param {number} x\r\n  * @param {number} y\r\n  * @param {number} scaleX\r\n  * @param {number} scaleY\r\n  * @param {number} rotation\r\n  * @param {Object} [opts={}]\r\n  * @param {number} [originX] Overrides sprite's originX property.\r\n  * @param {number} [originY] Overrides sprite's originY property.\r\n  * @return {void}\r\n  */\n\n\n\tDraw.sprite = function sprite(spr, index, x, y, scaleX, scaleY, rotation) {\n\t\tvar opts = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : {};\n\n\n\t\tif (!spr) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar ctx = Draw.context;\n\t\tif (!(ctx instanceof CanvasRenderingContext2D)) {\n\t\t\twindow.addConsoleText(\"#F00\", \"Sprites are currently only supported in Canvas 2D!\");\n\t\t\twindow._GB_stop();\n\t\t\treturn;\n\t\t}\n\n\t\tspr = _sprite3.default.get(spr);\n\n\t\t//\n\t\tvar ox = opts.originX !== undefined ? opts.originX : spr.originX;\n\t\tvar oy = opts.originY !== undefined ? opts.originY : spr.originY;\n\n\t\t//\n\t\tctx.save();\n\t\tctx.translate(x, y);\n\t\tctx.rotate(rotation * _math2.default.DEGTORAD);\n\t\tctx.scale(scaleX, scaleY);\n\n\t\t//\n\t\tindex = Math.floor(index || 0) % spr.images.length;\n\n\t\t//\n\t\tvar frame = spr.images[index];\n\t\tvar img = frame.img;\n\t\tctx.drawImage(img, frame.clip.x, frame.clip.y, frame.clip.w, frame.clip.h, -ox, -oy, spr.width, spr.height);\n\n\t\t//\n\t\tctx.restore();\n\t};\n\n\t/**\r\n  * Draws the sprite at the given x, y position.\r\n  * @param {sprite} sprite\r\n  * @param {number} x\r\n  * @param {number} y\r\n  * @param {number} w\r\n  * @param {number} h\r\n  */\n\n\n\tDraw.spriteTiled = function spriteTiled(spr, index, x, y, w, h) {\n\t\tspr = _sprite3.default.get(spr);\n\t\tvar dx = void 0,\n\t\t    dy = void 0,\n\t\t    rx = void 0,\n\t\t    ry = void 0;\n\t\tfor (rx = 0, dx = x; rx < w; rx++, dx += spr.width) {\n\t\t\tfor (ry = 0, dy = y; ry < h; ry++, dy += spr.height) {\n\t\t\t\tdrawSprite(spr, index, dx, dy, 1, 1, 0);\n\t\t\t}\n\t\t}\n\t};\n\n\t/**\r\n  * Draws a canvas at the given position.\r\n  * @param {canvas} canvas The canvas to draw.\r\n  * @param {number} x The X position to draw at.\r\n  * @param {number} y The Y position to draw at.\r\n  */\n\n\n\tDraw.canvas = function canvas(canv, x, y) {\n\t\tDraw.context.drawImage(canv.domElement, x, y);\n\t};\n\n\t/**\r\n  * @param {string} font\r\n  * @param {number} size\r\n  * @param {string} align Horizontal alignment.\r\n  * @param {string} baseline Vertical alignment.\r\n  * @return {void}\r\n  */\n\n\n\tDraw.setFont = function setFont(font, size, align, baseline) {\n\t\tvar ctx = Draw.context;\n\t\tfont = typeof font === \"string\" ? font : font.name;\n\t\tDraw.font = font;\n\t\tDraw.fontSize = size || 16;\n\t\tctx.font = Draw.fontSize + \"px \" + font;\n\t\tctx.textAlign = Draw.textAlign = align || \"left\";\n\t\tctx.textBaseline = Draw.textBaseline = baseline || \"alphabetic\";\n\t};\n\n\t/**\r\n  * @param {string} text\r\n  * @param {number} x\r\n  * @param {number} y\r\n  * @param {Object=} opts\r\n  * @return {void}\r\n  */\n\n\n\tDraw.text = function text(_text, x, y) {\n\t\tvar opts = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n\n\n\t\tx = Number(x);\n\t\ty = Number(y);\n\n\t\tvar drawSize = void 0,\n\t\t    bitmap = void 0,\n\t\t    lookup = void 0,\n\t\t    scale = void 0,\n\t\t    useBitmap = false;\n\t\tvar font = _font2.default.get(Draw.font);\n\t\tif (font && font.method === \"bitmap\") {\n\n\t\t\tdrawSize = font.forceSize || Draw.fontSize;\n\t\t\tvar c = _Color2.default.hexToArray(Draw.color);\n\t\t\tvar key = \"\" + drawSize + c[0] + c[1] + c[2] + c[3];\n\n\t\t\tif (!font.bitmapFont[key]) {\n\t\t\t\tfont.convertToBitmapFont({\n\t\t\t\t\tsize: drawSize,\n\t\t\t\t\tcolor: c\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tuseBitmap = true;\n\t\t\tlookup = font.bitmapFont[key].lookup;\n\t\t\tbitmap = font.bitmapFont[key].image;\n\t\t\tscale = Draw.fontSize / font.bitmapFont[key].size;\n\t\t}\n\n\t\t//\n\t\tvar ctx = Draw.context;\n\t\tvar drawMethod = \"fillText\";\n\t\tif (opts.stroke) {\n\t\t\tctx.strokeStyle = opts.strokeColor || Draw.color;\n\t\t\tctx.lineWidth = opts.lineWidth || 2;\n\t\t\tdrawMethod = \"strokeText\";\n\t\t} else {\n\t\t\tctx.fillStyle = Draw.color;\n\t\t}\n\n\t\t//\n\t\tvar lineLength = void 0;\n\t\tvar drawX = x;\n\t\tvar startN = 0;\n\t\tvar endN = _text.toString().length;\n\t\t//if (opts.pattern) {\n\t\t//startN = opts.pattern.start;\n\t\t//endN = opts.pattern.end;\n\t\t//}\n\n\t\t//\n\t\tvar lineHeight = Draw.lineHeight || ctx.measureText(\"Mp\").width * 1.2;\n\t\tvar lines = _text.toString().split(\"#\");\n\t\tfor (var i = 0; i < lines.length; i++) {\n\n\t\t\tif (opts.maxWidth) {\n\t\t\t\tvar words = lines[i].split(' ');\n\t\t\t\tvar line = '';\n\n\t\t\t\tfor (var n = 0; n < words.length; n++) {\n\n\t\t\t\t\tvar testLine = line + words[n] + ' ';\n\t\t\t\t\tvar metrics = ctx.measureText(testLine);\n\t\t\t\t\tvar testWidth = metrics.width;\n\t\t\t\t\tif (testWidth > opts.maxWidth && n > 0) {\n\n\t\t\t\t\t\tvar _a = line.slice(0, startN);\n\t\t\t\t\t\tvar _b = line.slice(startN, endN);\n\t\t\t\t\t\t//drawX += Draw.measureText(a).width;\n\t\t\t\t\t\tdrawX += ctx.measureText(_a).width;\n\t\t\t\t\t\tif (0 < endN) {\n\t\t\t\t\t\t\t_drawWord(drawX, y, _b, lookup, ctx, useBitmap, bitmap, scale, drawMethod);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlineLength = testLine.length;\n\t\t\t\t\t\tstartN -= lineLength;\n\t\t\t\t\t\tendN -= lineLength;\n\n\t\t\t\t\t\tline = words[n] + ' ';\n\t\t\t\t\t\ty += lineHeight;\n\t\t\t\t\t\tdrawX = x;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tline = testLine;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar a = line.slice(0, startN);\n\t\t\t\tvar b = line.slice(startN, endN);\n\t\t\t\tdrawX += ctx.measureText(a).width;\n\t\t\t\t_drawWord(drawX, y, b, lookup, ctx, useBitmap, bitmap, scale, drawMethod);\n\t\t\t\tlineLength = line.length;\n\t\t\t} else {\n\n\t\t\t\tvar t = lines[i];\n\t\t\t\tif (useBitmap && ctx.textAlign === \"center\") {\n\t\t\t\t\tdrawX -= ctx.measureText(t).width / 2;\n\t\t\t\t}\n\t\t\t\t_drawWord(~~drawX, y, t, lookup, ctx, useBitmap, bitmap, scale, drawMethod);\n\t\t\t}\n\n\t\t\tdrawX = x;\n\t\t\ty += lineHeight;\n\t\t}\n\t};\n\n\treturn Draw;\n}();\n\nDraw.color = \"#FFFFFF\";\nDraw.font = \"Arial\";\nDraw.fontSize = 30;\nDraw.lineHeight = 0;\nDraw.textAlign = \"start\";\nDraw.textBaseline = \"alphabetic\";\nDraw.target = null;\nDraw.context = null;\nDraw.defaultTransform = [1, 0, 0, 1, 0, 0];\nDraw.targetStack = [];\nDraw.imageSmoothing = false;\nDraw.offsetX = 0;\nDraw.offsetY = 0;\nDraw.shape = _DrawShapes2.default;\n\nDraw.transform = {\n\n\tscale: function scale(x, y) {\n\t\tDraw.context.scale(x, y);\n\t},\n\n\trotate: function rotate(rot) {\n\t\tDraw.context.rotate(rot * _math2.default.DEGTORAD);\n\t},\n\n\ttranslate: function translate(x, y) {\n\t\tDraw.offsetX = x;\n\t\tDraw.offsetY = y;\n\t\tDraw.context.translate(x, y);\n\t}\n\n\t/**\r\n  *\r\n  */\n};function _drawWord(drawX, drawY, word, lookup, ctx, useBitmap, bitmap, scale, drawMethod) {\n\tif (useBitmap) {\n\t\tvar dx = ~~drawX;\n\t\tvar len = word.length;\n\t\tfor (var cn = 0; cn < len; cn++) {\n\t\t\tvar metrics = lookup[word[cn]];\n\t\t\tif (!metrics) continue;\n\t\t\tvar sx = ~~metrics.left;\n\t\t\tvar sy = ~~metrics.top;\n\t\t\tvar sh = Math.ceil(metrics.bottom) - sy;\n\t\t\tvar sw = Math.ceil(metrics.right) - sx;\n\t\t\tctx.drawImage(bitmap, sx, sy, sw, sh, dx, drawY, sw * scale, sh * scale);\n\t\t\tdx += (sw + 1) * scale;\n\t\t}\n\t} else {\n\t\tctx[drawMethod](word, drawX, drawY);\n\t}\n}\n\n//\nexports.default = Draw;\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n * @author Jack Oatley\r\n */\nvar Generator = function () {\n\tfunction Generator() {\n\t\t_classCallCheck(this, Generator);\n\t}\n\n\t/**\r\n  * If class has a static \"get\" method it is used in functions created from\r\n  * prototype methods. If there is a \"get\" method on the prototype it is not\r\n  * used in the created functions, however it will overide the static \"get\"\r\n  * method. If there is both a static \"get\" method and a \"get\" method on the\r\n  * prototype, the static one is used in created functions and remains so,\r\n  * but the static method on the class is still overwritten.\r\n  * @param {function} c Constructor function.\r\n  */\n\tGenerator.classStaticMatch = function classStaticMatch(c) {\n\t\tc.create = Generator.functionFromConstructor(c);\n\t\tvar get = c.get;\n\t\tfor (var m in c.prototype) {\n\t\t\tc[m] = Generator.functionFromMethod(c.prototype[m], get);\n\t\t}\n\t};\n\n\t/**\r\n  * @param {function} c Constructor function.\r\n  */\n\n\n\tGenerator.functionFromConstructor = function functionFromConstructor(c) {\n\t\treturn function () {\n\t\t\tfor (var _len = arguments.length, a = Array(_len), _key = 0; _key < _len; _key++) {\n\t\t\t\ta[_key] = arguments[_key];\n\t\t\t}\n\n\t\t\treturn new (Function.prototype.bind.apply(c, [null].concat(a)))();\n\t\t};\n\t};\n\n\t/**\r\n  * @param {function} m Prototype method.\r\n  * @param {function} [get] Optional get function (static on the constructor.)\r\n  */\n\n\n\tGenerator.functionFromMethod = function functionFromMethod(m, get) {\n\t\tif (get) return function (s) {\n\t\t\tfor (var _len2 = arguments.length, a = Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n\t\t\t\ta[_key2 - 1] = arguments[_key2];\n\t\t\t}\n\n\t\t\treturn m.call.apply(m, [get(s)].concat(a));\n\t\t};else return function () {\n\t\t\treturn m.call.apply(m, arguments);\n\t\t};\n\t};\n\n\t/**\r\n  * @param {array} a An array of instances of constructor with the following method.\r\n  * @param {function} m The method to execute for each instance in the array.\r\n  */\n\n\n\tGenerator.arrayExecute = function arrayExecute(a, m) {\n\t\treturn function () {\n\t\t\tfor (var _len3 = arguments.length, p = Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n\t\t\t\tp[_key3] = arguments[_key3];\n\t\t\t}\n\n\t\t\treturn a.forEach(function (i) {\n\t\t\t\treturn m.call.apply(m, [i].concat(p));\n\t\t\t});\n\t\t};\n\t};\n\n\treturn Generator;\n}();\n\nexports.default = Generator;\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _draw = __webpack_require__(0);\n\nvar _draw2 = _interopRequireDefault(_draw);\n\nvar _generator = __webpack_require__(1);\n\nvar _generator2 = _interopRequireDefault(_generator);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n *\r\n */\nvar Canvas = function () {\n\n\t/**\r\n  * @param {Object} [opts={}]\r\n  * @param {bumber} [opts.width=300]\r\n  * @param {bumber} [opts.height=150]\r\n  * @param {bumber} [opts.scale=1]\r\n  * @param {boolean} [opts.application=false]\r\n  * @param {boolean} [opts.crisp2D=false]\r\n  * @param {string} [opts.context=\"2d\"]\r\n  */\n\tfunction Canvas() {\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\t\t_classCallCheck(this, Canvas);\n\n\t\tvar defaultContext = opts.context || \"2d\";\n\t\tvar c = document.createElement(\"CANVAS\");\n\t\tvar ctx = c.getContext(defaultContext);\n\t\tthis.domElement = c;\n\t\tthis.context = ctx;\n\t\tthis.width = this._width = opts.width || 300;\n\t\tthis.height = this._height = opts.height || 150;\n\n\t\t//\n\t\tc.scale = opts.scale || 1;\n\t\tc.application = opts.application || false;\n\n\t\t//\n\t\tif (opts.crisp2D) {\n\t\t\tctx.imageSmoothingEnabled = false;\n\t\t}\n\n\t\t//\n\t\tif (c.application) {\n\t\t\t_draw2.default.setTarget(this);\n\t\t\tCanvas.setMain(this);\n\t\t}\n\n\t\t//\n\t\tc.oncontextmenu = function (e) {\n\t\t\te.preventDefault();\n\t\t};\n\n\t\t//\n\t\tCanvas.array.push(this);\n\t}\n\n\t/**\r\n  * Sets the canvas as the main canvas for the game.\r\n  * @return {void}\r\n  */\n\tCanvas.prototype.setMain = function setMain() {\n\t\tvar c = this.domElement;\n\t\tCanvas.main = this;\n\t\tif (Canvas.dom === null) {\n\t\t\tCanvas.dom = c;\n\t\t\tvar el = document.getElementById(\"gbgamebox\") || document.body;\n\t\t\tel.appendChild(c);\n\t\t}\n\t};\n\n\t/**\r\n  * @param {string} [color=\"#000\"] CSS value as a string.\r\n  * @return {void}\r\n  */\n\n\n\tCanvas.prototype.fill = function fill(color) {\n\t\tvar c = this.domElement;\n\t\tvar ctx = this.context;\n\t\tif (ctx instanceof CanvasRenderingContext2D) {\n\t\t\tctx.fillStyle = color || \"#000\";\n\t\t\tctx.fillRect(0, 0, c.width / c.scale, c.height / c.scale);\n\t\t}\n\t};\n\n\t/**\r\n  * Clears the canvas.\r\n  * @return {void}\r\n  */\n\n\n\tCanvas.prototype.clear = function clear() {\n\t\tvar c = this.domElement;\n\t\tvar ctx = this.context;\n\t\tif (ctx instanceof CanvasRenderingContext2D) {\n\t\t\tctx.clearRect(0, 0, c.width / c.scale, c.height / c.scale);\n\t\t}\n\t};\n\n\t/**\r\n  * Set the RGBA components of a pixel on the canvas as an ArrayBuffer.\r\n  * @param {number} x X position of the pixel, must be an integer.\r\n  * @param {number} y Y position of the pixel, must be an integer.\r\n  * @returns {void}\r\n  */\n\n\n\tCanvas.prototype.setPixel = function setPixel(x, y, data) {\n\t\tvar imageData = this.context.getImageData(x, y, 1, 1);\n\t\timageData.data.set(data);\n\t\tthis.context.putImageData(imageData, x, y);\n\t};\n\n\t/**\r\n  * Returns the RGBA components of a pixel on the canvas as an ArrayBuffer.\r\n  * @param {number} x X position of the pixel, must be an integer.\r\n  * @param {number} y Y position of the pixel, must be an integer.\r\n  * @returns {ArrayBuffer} An ArrayBuffer with 4 values (for R, G, B, A).\r\n  */\n\n\n\tCanvas.prototype.getPixel = function getPixel(x, y) {\n\t\treturn this.context.getImageData(x, y, 1, 1).data;\n\t};\n\n\t/**\r\n  * @param {ImageData} data\r\n  * @return {void}\r\n  */\n\n\n\tCanvas.prototype.setImageData = function setImageData(data) {\n\t\tthis.context.putImageData(data, 0, 0);\n\t};\n\n\t/**\r\n  * Returns the entire pixel buffer of the canvas.\r\n  * @return {ArrayBuffer}\r\n  */\n\n\n\tCanvas.prototype.getImageData = function getImageData() {\n\t\treturn this.context.getImageData(0, 0, this.width, this.height).data;\n\t};\n\n\t/**\r\n  * Gets the Canvas that is currently set as the main game canvas.\r\n  * @return {Object}\r\n  */\n\n\n\tCanvas.getMain = function getMain() {\n\t\treturn Canvas.main;\n\t};\n\n\t_createClass(Canvas, [{\n\t\tkey: \"width\",\n\t\tget: function get() {\n\t\t\treturn this._width;\n\t\t},\n\t\tset: function set(x) {\n\t\t\tthis._width = x;\n\t\t\tthis.domElement.width = x;\n\t\t}\n\t}, {\n\t\tkey: \"height\",\n\t\tget: function get() {\n\t\t\treturn this._height;\n\t\t},\n\t\tset: function set(x) {\n\t\t\tthis._height = x;\n\t\t\tthis.domElement.height = x;\n\t\t}\n\t}]);\n\n\treturn Canvas;\n}();\n\n_generator2.default.classStaticMatch(Canvas);\nCanvas.array = [];\nCanvas.main = null;\nCanvas.dom = null;\n\nexports.default = Canvas;\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _Canvas = __webpack_require__(2);\n\nvar _Canvas2 = _interopRequireDefault(_Canvas);\n\nvar _Color = __webpack_require__(10);\n\nvar _Color2 = _interopRequireDefault(_Color);\n\nvar _generator = __webpack_require__(1);\n\nvar _generator2 = _interopRequireDefault(_generator);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n *\r\n */\nvar Sprite = function () {\n\n\t/**\r\n  *\r\n  */\n\tfunction Sprite() {\n\t\tvar _this = this;\n\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\t\t_classCallCheck(this, Sprite);\n\n\t\t//\n\t\tvar atlas = void 0,\n\t\t    atlasIndex = void 0;\n\t\tif (opts.atlas) {\n\t\t\tatlasIndex = opts.atlasIndex || 0;\n\t\t\tatlas = opts.atlas.images[atlasIndex];\n\t\t}\n\n\t\t//\n\t\tthis.assetType = \"sprite\";\n\t\tthis.name = opts.name || Sprite.newName();\n\t\tthis.originX = opts.originX || 0;\n\t\tthis.originY = opts.originY || 0;\n\t\tthis.width = 0;\n\t\tthis.height = 0;\n\t\tthis.images = [];\n\n\t\t//\n\t\tif (opts.frames) {\n\t\t\topts.frames.forEach(function (frame) {\n\t\t\t\t_this.addFrame({\n\t\t\t\t\tsource: frame.src\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\t//\n\t\tvar length = Sprite.array.length;\n\t\tSprite.names[length] = this.name;\n\t\tSprite.array[length++] = this;\n\t}\n\n\t/**\r\n  * @return {void}\r\n  */\n\n\n\tSprite.prototype.addFrame = function addFrame() {\n\t\tvar _this2 = this;\n\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\n\t\t//\n\t\tvar atlas = void 0;\n\t\tif (opts.atlas) {\n\t\t\tatlas = Sprite.get(opts.atlas).images[0].img;\n\t\t}\n\n\t\tvar image = {\n\t\t\timg: atlas || new Image(),\n\t\t\tclip: null,\n\t\t\tready: false\n\n\t\t\t//\n\t\t};if (opts.source) {\n\n\t\t\timage.img.onload = function () {\n\n\t\t\t\timage.ready = true;\n\t\t\t\timage.clip = {\n\t\t\t\t\tx: 0,\n\t\t\t\t\ty: 0,\n\t\t\t\t\tw: image.img.width,\n\t\t\t\t\th: image.img.height\n\n\t\t\t\t\t//\n\t\t\t\t};if (_this2.width * _this2.height === 0) {\n\t\t\t\t\t_this2.width = image.clip.w;\n\t\t\t\t\t_this2.height = image.clip.h;\n\t\t\t\t}\n\t\t\t};\n\t\t\timage.img.src = opts.source || \"\";\n\t\t}\n\n\t\t//\n\t\tif (atlas && opts.clip) {\n\t\t\timage.ready = true;\n\t\t\timage.clip = opts.clip;\n\t\t\tif (this.width * this.height === 0) {\n\t\t\t\tthis.width = image.clip.w;\n\t\t\t\tthis.height = image.clip.h;\n\t\t\t}\n\t\t}\n\n\t\t//\n\t\tthis.images.push(image);\n\t};\n\n\t/**\r\n  * @return {void}\r\n  */\n\n\n\tSprite.prototype.cache = function cache() {\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\t\tthis.images.forEach(function (frame) {\n\t\t\tvar canvas = document.createElement(\"CANVAS\");\n\t\t\tcanvas.width = opts.width || frame.img.width;\n\t\t\tcanvas.height = opts.height || frame.img.height;\n\t\t\tvar ctx = canvas.getContext(\"2d\");\n\t\t\tctx.drawImage(frame.img, 0, 0, canvas.width + 1, canvas.height + 1);\n\t\t\tframe.__orig = _extends({}, frame);\n\t\t\tframe.clip.x = 0;\n\t\t\tframe.clip.y = 0;\n\t\t\tframe.clip.w = canvas.width;\n\t\t\tframe.clip.h = canvas.height;\n\t\t\tframe.img = canvas;\n\t\t});\n\t};\n\n\t/**\r\n  * @return {void}\r\n  */\n\n\n\tSprite.prototype.restore = function restore() {\n\t\tthis.images.forEach(function (frame) {\n\t\t\tif (frame.__orig) frame = frame._orig;\n\t\t\tif (frame.__origSrc) frame.img.src = frame.__origSrc;\n\t\t});\n\t};\n\n\t/**\r\n  * @param {number} x\r\n  * @param {number} y\r\n  * @return {void}\r\n  */\n\n\n\tSprite.prototype.setOrigin = function setOrigin(x, y) {\n\t\tthis.originX = Number(x);\n\t\tthis.originY = Number(y);\n\t};\n\n\t/**\r\n  * Tints (multiplies) the sprite to the given color. Effects all frames.\r\n  * @param {string} col A CSS color value.\r\n  * @return {void}\r\n  */\n\n\n\tSprite.prototype.tint = function tint(col) {\n\n\t\tvar n = this.images.length;\n\t\twhile (n--) {\n\t\t\tvar frame = this.images[n];\n\n\t\t\t// Create canvas, draw image.\n\t\t\tvar canvas = document.createElement(\"CANVAS\");\n\t\t\tvar ctx = canvas.getContext(\"2d\");\n\t\t\tcanvas.width = this.width;\n\t\t\tcanvas.height = this.height;\n\t\t\tframe.img = frame.__orig || frame.img;\n\t\t\tctx.drawImage(frame.img, 0, 0);\n\n\t\t\t// Get data, do thing, put data back.\n\t\t\tvar imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n\t\t\tvar color = (typeof col === \"undefined\" ? \"undefined\" : _typeof(col)) === \"object\" ? col : _Color2.default.hexToRgb(col);\n\t\t\tpixelDataTint(imageData.data, color);\n\t\t\tctx.putImageData(imageData, 0, 0);\n\n\t\t\t// Cache old image, then set new one.\n\t\t\tframe.__orig = frame.img;\n\t\t\tframe.__origSrc = frame.img.src;\n\t\t\tframe.img = canvas;\n\t\t}\n\t};\n\n\t/**\r\n  * Tints (multiplies) the sprite to the given color. Effects all frames.\r\n  * @param {string} col A CSS color value.\r\n  * @return {void}\r\n  */\n\n\n\tSprite.prototype.fade = function fade(col) {\n\n\t\tvar n = this.images.length;\n\t\twhile (n--) {\n\t\t\tvar frame = this.images[n];\n\n\t\t\t// Create canvas, draw image.\n\t\t\tvar canvas = document.createElement(\"CANVAS\");\n\t\t\tvar ctx = canvas.getContext(\"2d\");\n\t\t\tcanvas.width = this.width;\n\t\t\tcanvas.height = this.height;\n\t\t\tframe.img = frame.__orig || frame.img;\n\t\t\tctx.drawImage(frame.img, 0, 0);\n\n\t\t\t// Get data, do thing, put data back.\n\t\t\tvar imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n\t\t\tvar color = (typeof col === \"undefined\" ? \"undefined\" : _typeof(col)) === \"object\" ? col : _Color2.default.hexToRgb(col);\n\t\t\tpixelDataFade(imageData.data, color);\n\t\t\tctx.putImageData(imageData, 0, 0);\n\n\t\t\t// Cache old image, then set new one.\n\t\t\tframe.__orig = frame.img;\n\t\t\tframe.__origSrc = frame.img.src;\n\t\t\tframe.img = canvas;\n\t\t}\n\t};\n\n\t/**\r\n  * @param {number} index The index of the frame to draw onto the canvas.\r\n  * @return {Object}\r\n  */\n\n\n\tSprite.prototype.toCanvas = function toCanvas(index) {\n\t\tvar c = new _Canvas2.default({\n\t\t\twidth: this.width,\n\t\t\theight: this.height\n\t\t});\n\t\tvar img = this.images[index].img;\n\t\tc.context.drawImage(img, 0, 0);\n\t\treturn c;\n\t};\n\n\t/**\r\n  * Returns the RGBA components of a pixel on the Sprite as an ArrayBuffer.\r\n  * @param {number} x X position of the pixel, must be an integer.\r\n  * @param {number} y Y position of the pixel, must be an integer.\r\n  * @returns {ArrayBuffer} An ArrayBuffer with 4 values (for R, G, B, A).\r\n  */\n\n\n\tSprite.prototype.getPixel = function getPixel(index, x, y) {\n\t\tvar c = this.toCanvas(index);\n\t\treturn c.context.getImageData(x, y, 1, 1).data;\n\t};\n\n\t/**\r\n  * @return {boolean}\r\n  */\n\n\n\tSprite.readyAll = function readyAll() {\n\n\t\tvar sa = Sprite.array;\n\t\tvar n = sa.length;\n\t\twhile (n--) {\n\t\t\tvar ia = sa[n].images;\n\t\t\tvar i = ia.length;\n\t\t\twhile (i--) {\n\t\t\t\tif (!ia[i].ready) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t};\n\n\t/**\r\n  * Generates a new, unused, sprite name.\r\n  * @return {string}\r\n  */\n\n\n\tSprite.newName = function newName() {\n\t\treturn \"sprNewSprite\" + Sprite.array.length;\n\t};\n\n\t/**\r\n  * @param {*} name String or Object.\r\n  * @return {Object}\r\n  */\n\n\n\tSprite.get = function get(name) {\n\n\t\tif ((typeof name === \"undefined\" ? \"undefined\" : _typeof(name)) === \"object\") {\n\t\t\treturn name;\n\t\t}\n\n\t\tvar n = Sprite.array.length;\n\t\twhile (n--) {\n\t\t\tif (Sprite.array[n].name === name) {\n\t\t\t\treturn Sprite.array[n];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t};\n\n\treturn Sprite;\n}();\n\n/**\r\n * Iterates pixel data and tints (multiplies) it with the given color.\r\n * @param {Uint8ClampedArray} data\r\n * @param {Object} rgb\r\n * @return {void}\r\n */\n\n\nfunction pixelDataTint(data, rgb) {\n\tvar r = rgb.r / 255;\n\tvar g = rgb.g / 255;\n\tvar b = rgb.b / 255;\n\tvar i = data.length;\n\twhile (i -= 4) {\n\t\tdata[i] *= r;\n\t\tdata[i + 1] *= g;\n\t\tdata[i + 2] *= b;\n\t}\n}\n\n/**\r\n * Iterates pixel data and tints (multiplies) it with the given color.\r\n * @param {Uint8ClampedArray} data\r\n * @param {Object} rgba\r\n * @return {void}\r\n */\nfunction pixelDataFade(data, rgba) {\n\tvar a = rgba.a / 255;\n\tvar r = rgba.r * a;\n\tvar g = rgba.g * a;\n\tvar b = rgba.b * a;\n\tvar o = 1 - a;\n\tvar i = data.length;\n\twhile (i -= 4) {\n\t\tdata[i] = r + data[i] * o;\n\t\tdata[i + 1] = g + data[i + 1] * o;\n\t\tdata[i + 2] = b + data[i + 2] * o;\n\t}\n}\n\n//\n_generator2.default.classStaticMatch(Sprite);\nSprite.names = [];\nSprite.array = [];\n\n//\nexports.default = Sprite;\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _math = __webpack_require__(5);\n\nvar _math2 = _interopRequireDefault(_math);\n\nvar _input = __webpack_require__(9);\n\nvar _input2 = _interopRequireDefault(_input);\n\nvar _object = __webpack_require__(13);\n\nvar _object2 = _interopRequireDefault(_object);\n\nvar _sprite = __webpack_require__(3);\n\nvar _sprite2 = _interopRequireDefault(_sprite);\n\nvar _draw = __webpack_require__(0);\n\nvar _draw2 = _interopRequireDefault(_draw);\n\nvar _global = __webpack_require__(20);\n\nvar _global2 = _interopRequireDefault(_global);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar INSTANCE_HARD_LIMIT = 10000;\n\n//\nwindow.global = _global2.default;\n\n//\nvar instanceArray = [];\nvar otherStack = [];\nvar uniqueId = 1;\nvar doDepthSort = false;\nvar currentEvent = \"\";\n\n//\n\nvar instance = function () {\n\tfunction instance() {\n\t\t_classCallCheck(this, instance);\n\t}\n\n\t/**\r\n  * Create a new instance of an object.\r\n  * @param {string|Object} obj\r\n  * @param {number} x\r\n  * @param {number} y\r\n  * @return {?Object}\r\n  */\n\tinstance.create = function create(obj, x, y) {\n\n\t\tvar o = _object2.default.get(obj);\n\n\t\tif (o === null) {\n\t\t\twindow.addConsoleText(\"#F00\", \"Instance creation failed! No such object as \" + obj + \".\");\n\t\t\treturn null;\n\t\t}\n\n\t\tif (instanceArray.length >= INSTANCE_HARD_LIMIT) {\n\t\t\twindow.addConsoleText(\"#F00\", \"instance number hard limit reached:\", INSTANCE_HARD_LIMIT);\n\t\t\treturn null;\n\t\t}\n\n\t\treturn new o(x, y);\n\t};\n\n\t/**\r\n  * @param {object} obj\r\n  * @param {number} x\r\n  * @param {number} y\r\n  * @param {number} speed\r\n  * @param {number} direction\r\n  */\n\n\n\tinstance.createMoving = function createMoving(obj, x, y, speed, direction) {\n\t\tvar newInst = instance.create(obj, x, y);\n\t\tnewInst.speed = speed;\n\t\tnewInst.direction = direction;\n\t\treturn newInst;\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tinstance.setup = function setup(inst, o, x, y) {\n\n\t\tinst.id = uniqueId++;\n\t\tinst.exists = true;\n\t\tinst.speed = 0;\n\t\tinst.object = o;\n\t\tinst.objectName = o.objectName;\n\t\tinst.assetType = \"instance\";\n\t\tinst.x = Number(x);\n\t\tinst.y = Number(y);\n\t\tinst.startX = inst.x;\n\t\tinst.startY = inst.y;\n\t\tinst.previousX = inst.x;\n\t\tinst.previousY = inst.y;\n\t\tinst.boxCollision = {};\n\n\t\t//\n\t\tvar spr = _sprite2.default.get(inst.sprite);\n\t\tif (spr) {\n\t\t\tinst.boxCollision.x = spr.originX;\n\t\t\tinst.boxCollision.y = spr.originY;\n\t\t\tinst.boxCollision.width = spr.width;\n\t\t\tinst.boxCollision.height = spr.height;\n\t\t}\n\n\t\t//\n\t\taddToArray(inst);\n\t\tupdateBoundingBox(inst);\n\t\tupdateCollisionBox(inst);\n\t\texecuteEvent(inst, \"create\");\n\t};\n\n\t/**\r\n  * Finds instance n of the given object.\r\n  * @param {Object} obj\r\n  * @param {number} n\r\n  * @return {?Object}\r\n  */\n\n\n\tinstance.find = function find(obj, n) {\n\t\tif (typeof obj === \"function\") obj = obj.objectName;\n\t\tvar i = void 0,\n\t\t    c = 0,\n\t\t    inst = void 0;\n\t\tfor (i = 0; i < instanceArray.length; i++) {\n\t\t\tinst = instanceArray[i];\n\t\t\tif (inst.objectName === obj) {\n\t\t\t\tif (c++ === n) return inst;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t};\n\n\t/** */\n\n\n\tinstance.findRandom = function findRandom(obj) {\n\t\tif (typeof obj === \"function\") obj = obj.objectName;\n\t\tvar n = _math2.default.randomInt(0, count(obj) - 1);\n\t\treturn find(obj, n);\n\t};\n\n\t/**\r\n  * Find the nearest instance of an object to a point.\r\n  * @param {number} x\r\n  * @param {number} y\r\n  * @param {string|Object} obj\r\n  * @param {?Object}\r\n  */\n\n\n\tinstance.nearest = function nearest(x, y, obj) {\n\n\t\tvar all = [];\n\t\tif (!Array.isArray(obj)) {\n\t\t\tall.push.apply(all, _toConsumableArray(_object2.default.get(obj).getAllInstances()));\n\t\t} else {\n\t\t\tobj.forEach(function (o) {\n\t\t\t\tall.push.apply(all, _toConsumableArray(_object2.default.get(o).getAllInstances()));\n\t\t\t});\n\t\t}\n\n\t\tif (all.length === 0) {\n\t\t\treturn null;\n\t\t}\n\t\tif (all.length === 1) {\n\t\t\treturn all[0];\n\t\t}\n\t\tvar nrst = void 0,\n\t\t    dist = 1e9,\n\t\t    newDist = void 0;\n\t\tall.forEach(function (inst) {\n\t\t\tnewDist = _math2.default.pointDistance(x, y, inst.x, inst.y);\n\t\t\tif (newDist < dist) {\n\t\t\t\tnrst = inst;\n\t\t\t\tdist = newDist;\n\t\t\t}\n\t\t});\n\t\treturn nrst;\n\t};\n\n\t/**\r\n  * Find the furthest instance of an object from a point.\r\n  * @param {number} x\r\n  * @param {number} y\r\n  * @param {string|Object} obj\r\n  * @param {?Object}\r\n  */\n\n\n\tinstance.furthest = function furthest(x, y, obj) {\n\t\tvar all = _object2.default.get(obj).getAllInstances();\n\t\tif (all.length === 0) {\n\t\t\treturn null;\n\t\t}\n\t\tif (all.length === 1) {\n\t\t\treturn all[0];\n\t\t}\n\t\tvar frst = void 0,\n\t\t    dist = 0,\n\t\t    newDist = void 0;\n\t\tall.forEach(function (inst) {\n\t\t\tnewDist = _math2.default.pointDistance(x, y, inst.x, inst.y);\n\t\t\tif (newDist > dist) {\n\t\t\t\tfrst = inst;\n\t\t\t\tdist = newDist;\n\t\t\t}\n\t\t});\n\t\treturn frst;\n\t};\n\n\t/**\r\n  * Returns the number of instances of a given object.\r\n  * @param {string|Object} obj\r\n  * @return {number}\r\n  */\n\n\n\tinstance.count = function count(obj) {\n\t\tvar name = _object2.default.get(obj).objectName;\n\t\tvar c = 0;\n\t\tfor (var n = instanceArray.length - 1; n > 0; n--) {\n\t\t\tc += instanceArray[n].objectName === name;\n\t\t}\n\t\treturn c;\n\t};\n\n\t/**\r\n  * @param {number} rotation\r\n  * @param {boolean} relative\r\n  * @return {void}\r\n  */\n\n\n\tinstance.setRotation = function setRotation(rotation, relative) {\n\t\tthis.rotation = relative ? this.rotation + rotation : rotation;\n\t};\n\n\t/**\r\n  * @param {number} rotation\r\n  * @param {boolean} relative\r\n  * @return {void}\r\n  */\n\n\n\tinstance.setDirection = function setDirection(direction, relative) {\n\t\tthis.direction = relative ? this.direction + direction : direction;\n\t};\n\n\t/** Start moving in the direction of a given point. */\n\n\n\tinstance.moveTowardsPoint = function moveTowardsPoint(inst, x, y, spd) {\n\t\tinst.direction = _math2.default.pointDirection(inst.x, inst.y, x, y);\n\t\tinst.speed = spd;\n\t};\n\n\t/** Step towards the given point */\n\n\n\tinstance.stepTowardsPoint = function stepTowardsPoint(inst, x, y, spd) {\n\t\tvar dir = _math2.default.pointDirection(inst.x, inst.y, x, y);\n\t\tvar vec = _math2.default.lengthDir(spd, dir);\n\t\tinst.x += vec[0];\n\t\tinst.y += vec[1];\n\t};\n\n\t/** */\n\n\n\tinstance.distanceToPoint = function distanceToPoint(inst, x, y) {\n\t\treturn _math2.default.pointDistance(inst.x, inst.y, x, y);\n\t};\n\n\t/** */\n\n\n\tinstance.position = function position(x, y, obj) {\n\t\tvar all = _object2.default.get(obj).getAllInstances();\n\t\tfor (var n = 0; n < all.length; n++) {\n\t\t\tvar inst = all[n];\n\t\t\tif (instance.pointOn(x, y, inst)) {\n\t\t\t\treturn inst;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t};\n\n\t/** Returns whether the given point is over the given instance. */\n\n\n\tinstance.pointOn = function pointOn(x, y, inst) {\n\t\treturn !(inst.boxTop > y - _draw2.default.offsetY || inst.boxBottom < y - _draw2.default.offsetY || inst.boxLeft > x - _draw2.default.offsetX || inst.boxRight < x - _draw2.default.offsetX);\n\t};\n\n\t/** */\n\n\n\tinstance.mouseOn = function mouseOn(inst) {\n\t\treturn instance.pointOn(_input2.default.mouse.x, _input2.default.mouse.y, inst);\n\t};\n\n\t/**\r\n  * Execute step event.\r\n  * @param {Object} inst\r\n  * @return {void}\r\n  */\n\n\n\tinstance.step = function step(inst) {\n\n\t\t// Step events.\n\t\texecuteEvent(inst, \"step\");\n\t\tupdateAnimation(inst);\n\t\tupdatePosition(inst);\n\t\tupdateBoundingBox(inst);\n\t\tupdateCollisionBox(inst);\n\n\t\t// Collision events.\n\t\tinstanceExecuteListeners(inst);\n\n\t\t// Input events.\n\t\t_input2.default.triggerEvents.forEach(function (event) {\n\t\t\texecuteEvent(inst, event);\n\t\t});\n\t};\n\n\t/** */\n\n\n\tinstance.destroy = function destroy(inst) {\n\t\texecuteEvent(inst, \"destroy\");\n\t\tinst.exists = false;\n\t};\n\n\t/** */\n\n\n\tinstance.uninstantiate = function uninstantiate(inst) {\n\t\tinst.exists = false;\n\t\tvar arr = inst.object.instances;\n\t\tvar index = arr.indexOf(inst);\n\t\tif (index >= 0) {\n\t\t\tarr[index] = arr[arr.length - 1];\n\t\t\tarr.length -= 1;\n\t\t}\n\t};\n\n\t/** */\n\n\n\tinstance.draw = function draw(inst) {\n\t\tif (!inst.visible) return;\n\t\tinst.events[\"draw\"] ? executeEvent(inst, \"draw\") : instance.drawSelf(inst);\n\t};\n\n\t/**\r\n  * @param {Object} inst Instance to draw.\r\n  * @param {Object} [opts] Options object.\r\n  */\n\n\n\tinstance.drawSelf = function drawSelf(inst, opts) {\n\t\tif (inst.sprite === null) return;\n\t\t_draw2.default.sprite(inst.sprite, inst.index, inst.x, inst.y, inst.scaleX, inst.scaleY, inst.rotation, opts);\n\t};\n\n\t/** */\n\n\n\tinstance.drawDebug = function drawDebug(inst) {\n\t\tvar box = inst.boxCollision;\n\t\t_draw2.default.shape.rectangle(box.left, box.top, box.right - box.left, box.bottom - box.top, {\n\t\t\tcolor: \"rgba(255,0,0,0.5)\"\n\t\t});\n\t};\n\n\t/** */\n\n\n\tinstance.changeSprite = function changeSprite(sprite) {\n\t\tthis.sprite = sprite;\n\t};\n\n\t/**\r\n  * Execute a particular event for all current instances.\r\n  * @param {string} event The event to execute.\r\n  * @param {Object} otherInst\r\n  * @return {void}\r\n  */\n\n\n\tinstance.executeEventAll = function executeEventAll(event, otherInst) {\n\t\tvar n = instanceArray.length;\n\t\twhile (n--) {\n\t\t\texecuteEvent(instanceArray[n], event, otherInst);\n\t\t}\n\t};\n\n\t/** */\n\n\n\tinstance.stepAll = function stepAll() {\n\t\tnewStep();\n\t\tvar arr = instanceArray.slice();\n\t\tarr.forEach(function (inst) {\n\t\t\texecuteEvent(inst, \"stepBegin\");\n\t\t});\n\t\tarr.forEach(instance.step);\n\t\tarr.forEach(function (inst) {\n\t\t\texecuteEvent(inst, \"stepEnd\");\n\t\t});\n\t\tclearDestroyed();\n\t};\n\n\t/** */\n\n\n\tinstance.drawAll = function drawAll() {\n\t\tif (doDepthSort) {\n\t\t\tinstanceArray.sort(sortFunction);\n\t\t}\n\t\tinstanceArray.forEach(instance.draw);\n\t};\n\n\t/** */\n\n\n\tinstance.drawGuiAll = function drawGuiAll() {\n\t\tvar n = instanceArray.length;\n\t\twhile (n--) {\n\t\t\texecuteEvent(instanceArray[n], \"drawGUI\");\n\t\t}\n\t};\n\n\t_createClass(instance, null, [{\n\t\tkey: \"instanceArray\",\n\t\tget: function get() {\n\t\t\treturn instanceArray;\n\t\t}\n\t}, {\n\t\tkey: \"doDepthSort\",\n\t\tset: function set(x) {\n\t\t\tdoDepthSort = x;\n\t\t}\n\t}]);\n\n\treturn instance;\n}();\n\n/** Resets some instance variables/states. */\n\n\nfunction newStep() {\n\tvar arr = instanceArray.slice();\n\tvar i = void 0,\n\t    n = arr.length;\n\twhile (n--) {\n\t\ti = arr[n];\n\t\ti.previousX = i.x;\n\t\ti.previousY = i.y;\n\t}\n}\n\n/** */\nfunction updatePosition(inst) {\n\n\t// if the instance is already falling at terminal velocity then we no longer apply gravity\n\tvar gravVector = {\n\t\tx: _math2.default.lengthDirX(inst.terminal, inst.gravityDirection),\n\t\ty: _math2.default.lengthDirY(inst.terminal, inst.gravityDirection)\n\t};\n\n\tif (gravVector.x > 0 && inst.speedX <= gravVector.x || gravVector.x < 0 && inst.speedX >= gravVector.x) {\n\t\tinst.speedX += _math2.default.lengthDirX(inst.gravity, inst.gravityDirection);\n\t}\n\n\tif (gravVector.y > 0 && inst.speedY <= gravVector.y || gravVector.y < 0 && inst.speedY >= gravVector.y) {\n\t\tinst.speedY += _math2.default.lengthDirY(inst.gravity, inst.gravityDirection);\n\t}\n\n\t// move instance\n\tinst.x += inst.speedX;\n\tinst.y += inst.speedY;\n}\n\n/**\r\n * Update the instance's bounding box.\r\n * @param {Object} i Instance.\r\n * @return {void}\r\n */\nfunction updateBoundingBox(i) {\n\tvar spr = _sprite2.default.get(i.sprite);\n\tif (spr === null) return;\n\ti.boxTop = i.y - spr.originY * i.scaleY;\n\ti.boxLeft = i.x - spr.originX * i.scaleX;\n\ti.boxBottom = i.boxTop + spr.height * i.scaleY;\n\ti.boxRight = i.boxLeft + spr.width * i.scaleX;\n}\n\n/**\r\n * Update the instance's collision box.\r\n * @param {Object} i Instance.\r\n * @return {void}\r\n */\nfunction updateCollisionBox(i) {\n\tvar box = i.boxCollision;\n\tbox.top = i.y - box.y * i.scaleY;\n\tbox.left = i.x - box.x * i.scaleX;\n\tbox.bottom = box.top + box.height * i.scaleY;\n\tbox.right = box.left + box.width * i.scaleX;\n}\n\n/**\r\n * Update the instance's animation.\r\n * @param {Object} inst Instance.\r\n * @return {void}\r\n */\nfunction updateAnimation(inst) {\n\n\tinst.index += inst.imageSpeed;\n\tvar spr = _sprite2.default.get(inst.sprite);\n\tif (spr) {\n\t\tvar length = spr.images.length;\n\t\tif (inst.index >= length) {\n\n\t\t\tvar behavior = inst.animationBehavior;\n\t\t\tvar type = typeof behavior === \"undefined\" ? \"undefined\" : _typeof(behavior);\n\n\t\t\t//\n\t\t\tif (type === \"string\") {\n\n\t\t\t\t//\n\t\t\t\tif (behavior === \"loop\") {\n\t\t\t\t\tinst.index -= length;\n\t\t\t\t} else if (behavior === \"stop\") {\n\t\t\t\t\tinst.index = length - 1;\n\t\t\t\t\tinst.imageSpeed = 0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//\n\t\t\telse if (type === \"function\") {\n\t\t\t\t\tbehavior.call(inst);\n\t\t\t\t}\n\t\t}\n\t}\n}\n\n/**\r\n * @param {Object} inst Instance.\r\n * @return {void}\r\n */\nfunction addToArray(inst) {\n\tfor (var i = 0; i < instanceArray.length; i++) {\n\t\tif (inst.depth > instanceArray[i].depth) {\n\t\t\tinstanceArray.splice(i, 0, inst);\n\t\t\treturn;\n\t\t}\n\t}\n\tinstanceArray.push(inst);\n}\n\n/**\r\n * Returns all instances set as \"solid\".\r\n * @return {Array<Object>}\r\n */\nfunction getAllSolid() {\n\tvar arr = [];\n\tvar i,\n\t    n = instanceArray.length;\n\twhile (i = instanceArray[--n]) {\n\t\tif (i.solid) {\n\t\t\tarr.push(i);\n\t\t}\n\t}\n\treturn arr;\n}\n\n/**\r\n * Remove isntances that have been requested to be destroyed.\r\n * @return {void}\r\n */\nfunction clearDestroyed() {\n\tvar l = instanceArray.length;\n\tvar i,\n\t    n = l;\n\twhile (i = instanceArray[--n]) {\n\t\tif (!i.exists) {\n\t\t\tinstance.uninstantiate(i);\n\t\t\ti.object.pool.release(i);\n\t\t\tinstanceArray[n] = instanceArray[--l];\n\t\t}\n\t}\n\tinstanceArray.length = l;\n}\n\n/**\r\n * The function used for instance depth ordering. Sorts by ID is depth same.\r\n * @param {Object} a Instance.\r\n * @param {Object} b Instance.\r\n * @return {number} 0, -1 or 1.\r\n */\nfunction sortFunction(a, b) {\n\treturn a.depth === b.depth ? a.id - b.id : a.depth - b.depth;\n}\n\n/**\r\n * @param {Object} inst Instance.\r\n * @return {void}\r\n */\nfunction instanceExecuteListeners(inst) {\n\tinst.listeners.forEach(function (listener) {\n\t\tswitch (listener.type) {\n\t\t\tcase \"collision\":\n\t\t\t\tinstanceCollisionInstance(inst, listener.target);\n\t\t\t\tbreak;\n\t\t}\n\t});\n}\n\n/**\r\n * Execute an event for the given instance only.\r\n * @param {Object} inst\r\n * @param {event} event\r\n * @param {Object} otherInst The other instance, in collisions for example.\r\n * @return {void}\r\n */\nfunction executeEvent(inst, event, otherInst) {\n\n\t// Set the current \"other\" instance.\n\totherStack.push(window.other);\n\twindow.other = otherInst;\n\tcurrentEvent = event;\n\n\t//\n\ttry {\n\t\tif (inst.exists) {\n\t\t\tvar actions = inst.events[event];\n\t\t\tif (actions) {\n\t\t\t\texecuteActions(inst, actions, otherInst);\n\t\t\t}\n\t\t}\n\t} catch (err) {\n\t\tconsole.error(err);\n\t\twindow.addConsoleText(\"#F00\", \"Failed to execute event [\" + event + \"]\" + \" of object [\" + inst.objectName + \"]\" + \" with error: \" + err);\n\t\twindow._GB_stop();\n\t\treturn;\n\t}\n\n\t// Restore previous \"other\" instance.\n\twindow.other = otherStack.pop();\n}\n\n/** */\nfunction instanceCollisionInstance(inst, target) {\n\n\tif (!inst.exists) return;\n\n\t//\n\tvar arr = target === \"solid\" ? getAllSolid(target) : _object2.default.getAllInstances(target);\n\n\tvar box1 = inst.boxCollision;\n\tarr.forEach(function (targ) {\n\n\t\t// If target doesn't exist, or is same instance\n\t\tif (!targ.exists || inst === targ) return;\n\n\t\t// No collision, boxes do not overlap.\n\t\tvar box2 = targ.boxCollision;\n\t\tif (box1.left > box2.right || box1.right < box2.left || box1.top > box2.bottom || box1.bottom < box2.top) return;\n\n\t\t// Execute collision event.\n\t\texecuteEvent(inst, \"collision_\" + target, targ);\n\t});\n}\n\n/**\r\n * @param {Object} inst\r\n * @param {Array} actions\r\n * @param {Object} otherInst\r\n * @return {void}\r\n */\nfunction executeActions(inst, actions, otherInst) {\n\tvar steps = [];\n\tvar condition = true;\n\tvar executeIfElse = false;\n\tvar scope = 0;\n\tvar len = actions.length;\n\n\tfor (var a = 0; a < len; a++) {\n\n\t\tvar action = actions[a];\n\t\tswitch (action.flow) {\n\n\t\t\t// regular action\n\t\t\tcase \"\":\n\n\t\t\t\tif (condition) {\n\t\t\t\t\texecuteIfElse = false;\n\t\t\t\t\tcondition = action.cache.call(inst);\n\t\t\t\t\tif (condition === undefined) {\n\t\t\t\t\t\tcondition = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsteps[scope] = 0;\n\t\t\t\t\t\tif (condition === false) {\n\t\t\t\t\t\t\texecuteIfElse = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\t// control actions\n\t\t\tcase \"ifElse\":\n\t\t\t\texecuteIfElse ? steps[scope] = 0 : condition = false;\n\t\t\t\tbreak;\n\t\t\tcase \"blockBegin\":\n\t\t\t\tscope++;break;\n\t\t\tcase \"blockEnd\":\n\t\t\t\tscope--;break;\n\t\t\tcase \"exitEvent\":\n\t\t\t\tif (condition) return false;\n\n\t\t}\n\n\t\t// exit from a single statement after an expression not contained in a block\n\t\tif (steps[scope]++ === 1) {\n\t\t\tcondition = true;\n\t\t}\n\t}\n}\n\nexports.default = instance;\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n/**\r\n * @module math\r\n */\n\nvar math = {\n\n\t// constances\n\tPI: Math.PI,\n\tRADTODEG: 180 / Math.PI,\n\tDEGTORAD: Math.PI / 180,\n\n\t// copied functions\n\tcos: Math.cos,\n\tsin: Math.sin,\n\tsign: Math.sign,\n\n\t/**\r\n  *\r\n  */\n\trandomInt: function randomInt(min, max) {\n\t\tmin = Math.ceil(min);\n\t\tmax = Math.floor(max);\n\t\treturn Math.floor(Math.random() * (max - min + 1)) + min;\n\t},\n\n\t/**\r\n  *\r\n  */\n\tchoose: function choose() {\n\t\tfor (var _len = arguments.length, value = Array(_len), _key = 0; _key < _len; _key++) {\n\t\t\tvalue[_key] = arguments[_key];\n\t\t}\n\n\t\treturn value[Math.floor(Math.random() * value.length)];\n\t},\n\n\t/** */\n\tlengthDir: function lengthDir(l, d) {\n\t\td *= math.DEGTORAD;\n\t\treturn [Math.cos(d) * l, Math.sin(d) * l];\n\t},\n\n\t/** */\n\tlengthDirX: function lengthDirX(l, d) {\n\t\treturn Math.cos(d * math.DEGTORAD) * l;\n\t},\n\n\t/** */\n\tlengthDirY: function lengthDirY(l, d) {\n\t\treturn Math.sin(d * math.DEGTORAD) * l;\n\t},\n\n\t/**\r\n  * @param {number} x1\r\n  * @param {number} y1\r\n  * @param {number} x2\r\n  * @param {number} y2\r\n  */\n\tpointDistance: function pointDistance(x1, y1, x2, y2) {\n\t\tvar a = x1 - x2;\n\t\tvar b = y1 - y2;\n\t\treturn Math.sqrt(a * a + b * b);\n\t},\n\n\t/**\r\n  * @param {number} x1\r\n  * @param {number} y1\r\n  * @param {number} x2\r\n  * @param {number} y2\r\n  */\n\tpointDirection: function pointDirection(x1, y1, x2, y2) {\n\t\treturn (Math.atan2(y2 - y1, x2 - x1) * math.RADTODEG + 360) % 360;\n\t},\n\n\t/**\r\n  *\r\n  */\n\tangleDifference: function angleDifference(angle1, angle2) {\n\n\t\tvar diff = (angle2 - angle1) % 360;\n\n\t\tif (diff <= -180) {\n\t\t\tdiff += 360;\n\t\t} else if (diff > 180) {\n\t\t\tdiff -= 360;\n\t\t}\n\n\t\treturn diff;\n\t}\n\n\t//\n};exports.default = math;\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _pool = __webpack_require__(16);\n\nvar _pool2 = _interopRequireDefault(_pool);\n\nvar _generator = __webpack_require__(1);\n\nvar _generator2 = _interopRequireDefault(_generator);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n * @author Jack Oatley\r\n */\nvar Grid = function () {\n\n\t/**\r\n  * @param {number} Initial width of the grid.\r\n  * @param {number} Initial height of the grid\r\n  * @param {object} [opts={}] Options object.\r\n  * @param {*} [opts.value=0] Initial value for each cell of the grid.\r\n  */\n\tfunction Grid(width, height) {\n\t\tvar opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n\t\t_classCallCheck(this, Grid);\n\n\t\tvar myGrid = Grid.pool.get(this);\n\t\tmyGrid.size = width * height;\n\t\tmyGrid.data = myGrid === this ? [] : myGrid.data;\n\t\tmyGrid.data.length = myGrid.size;\n\t\tmyGrid.width = width;\n\t\tmyGrid.height = height;\n\t\tmyGrid.clear(opts.value || 0);\n\t\treturn myGrid;\n\t}\n\n\t/**\r\n  *\r\n  */\n\n\n\tGrid.prototype.get = function get(x, y) {\n\t\treturn this.data[x + y * this.width];\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tGrid.prototype.set = function set(x, y, value) {\n\t\tthis.data[x + y * this.width] = value;\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tGrid.prototype.add = function add(x, y, value) {\n\t\tthis.data[x + y * this.width] += value;\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tGrid.prototype.multiply = function multiply(x, y, value) {\n\t\tthis.data[x + y * this.width] *= value;\n\t};\n\n\t/**\r\n  * Clears all cells in the grid to the given value.\r\n  * @param {*} value Value to clear the grid to.\r\n  */\n\n\n\tGrid.prototype.clear = function clear(value) {\n\t\tthis.data.fill(value);\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tGrid.prototype.destroy = function destroy() {\n\t\tGrid.pool.release(this);\n\t};\n\n\treturn Grid;\n}();\n\n//\n\n\nexports.default = Grid;\nGrid.pool = new _pool2.default(Grid);\n_generator2.default.classStaticMatch(Grid);\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _generator = __webpack_require__(1);\n\nvar _generator2 = _interopRequireDefault(_generator);\n\nvar _transition = __webpack_require__(8);\n\nvar _transition2 = _interopRequireDefault(_transition);\n\nvar _instance = __webpack_require__(4);\n\nvar _instance2 = _interopRequireDefault(_instance);\n\nvar _sprite = __webpack_require__(3);\n\nvar _sprite2 = _interopRequireDefault(_sprite);\n\nvar _draw2 = __webpack_require__(0);\n\nvar _draw3 = _interopRequireDefault(_draw2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n *\r\n */\nvar Room = function () {\n\n\t/**\r\n  * @param {string} name\r\n  * @param {number} width\r\n  * @param {number} height\r\n  */\n\tfunction Room(name, width, height) {\n\t\t_classCallCheck(this, Room);\n\n\t\tthis.name = name;\n\t\tthis.width = Number(width);\n\t\tthis.height = Number(height);\n\t\tthis.background = null;\n\t\tthis.backgroundFrame = 0;\n\t\tthis.backgroundAnimate = false;\n\t\tthis.backgroundAnimateSpeed = 1;\n\t\tthis.backgroundMethod = \"no-repeat\";\n\t\tthis.backgroundColor = \"#FF0000\";\n\t\tthis.instances = [];\n\t\tRoom.names.push(name);\n\t\tRoom.array.push(this);\n\t\tif (Room.current === null) Room.current = this;\n\t}\n\n\t/**\r\n  * @param {string} spr\r\n  * @return {void}\r\n  */\n\n\n\tRoom.prototype.setBackground = function setBackground(spr) {\n\t\tthis.background = spr;\n\t};\n\n\t/**\r\n  * @param {string} inst Name of the instance to add.\r\n  * @param {number} x\r\n  * @param {number} y\r\n  * @return {void}\r\n  */\n\n\n\tRoom.prototype.addInstance = function addInstance(inst, x, y) {\n\t\tif ((typeof inst === \"undefined\" ? \"undefined\" : _typeof(inst)) === \"object\") inst = inst.objectName;\n\t\tthis.instances.push({\n\t\t\tname: inst, x: x, y: y\n\t\t});\n\t};\n\n\t/**\r\n  * @param {object} [opts={}]\r\n  * @return {void}\r\n  */\n\n\n\tRoom.prototype.enter = function enter() {\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\n\t\tif (opts.transition) {\n\t\t\tnew _transition2.default({\n\t\t\t\tprefab: opts.transition,\n\t\t\t\tcallback: Room.enter.bind(null, this)\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\t// leave room event\n\t\t_instance2.default.executeEventAll(\"roomleave\");\n\n\t\t// clear current instances\n\t\t_instance2.default.instanceArray.forEach(function (i) {\n\t\t\tif (!i.persistent) {\n\t\t\t\t_instance2.default.uninstantiate(i);\n\t\t\t}\n\t\t});\n\n\t\t// goto new room and create new instances\n\t\tRoom.current = this;\n\t\tthis.instances.forEach(function (inst) {\n\t\t\t_instance2.default.create(inst.name, inst.x, inst.y);\n\t\t});\n\t\t_instance2.default.doDepthSort = true;\n\n\t\t// enter room event\n\t\t_instance2.default.executeEventAll(\"roomenter\");\n\t};\n\n\t/**\r\n  * @return {void}\r\n  */\n\n\n\tRoom.prototype.draw = function draw() {\n\t\tvar canvas = _draw3.default.target.domElement;\n\t\tvar ctx = _draw3.default.context;\n\t\t_draw3.default.clear(this.backgroundColor);\n\t\tvar spr = _sprite2.default.get(this.background);\n\t\tif (spr !== null) {\n\n\t\t\tif (!(ctx instanceof CanvasRenderingContext2D)) {\n\t\t\t\twindow.addConsoleText(\"#F00\", \"Room background images are currently only supported in Canvas 2D!\");\n\t\t\t\twindow._GB_stop();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar frame = this.backgroundFrame;\n\t\t\tvar animate = this.backgroundAnimate;\n\t\t\tvar index = frame;\n\t\t\tif (animate) {\n\t\t\t\tthis.backgroundFrame += this.backgroundAnimateSpeed;\n\t\t\t\tindex = ~~(this.backgroundFrame % spr.images.length);\n\t\t\t}\n\n\t\t\tvar image = spr.images[index].img;\n\n\t\t\tif (this.backgroundMethod === \"stretch\") {\n\t\t\t\tctx.drawImage(image, 0, 0, canvas.width, canvas.height);\n\t\t\t}\n\n\t\t\t// Iso patterns.\n\t\t\telse if (this.backgroundMethod.indexOf(\"iso-\") !== -1) {\n\t\t\t\t\tvar pattern = this.backgroundMethod.replace(\"iso-\", \"\");\n\n\t\t\t\t\t// First.\n\t\t\t\t\tctx.fillStyle = ctx.createPattern(image, pattern);\n\t\t\t\t\tctx.fillRect(0, 0, canvas.width, canvas.height);\n\n\t\t\t\t\t// Second.\n\t\t\t\t\tctx.save();\n\t\t\t\t\tctx.translate(spr.width / 2, spr.height / 2);\n\t\t\t\t\tctx.fillRect(-spr.width / 2, -spr.height / 2, canvas.width, canvas.height);\n\t\t\t\t\tctx.restore();\n\t\t\t\t}\n\n\t\t\t\t// Regular patterns.\n\t\t\t\telse {\n\t\t\t\t\t\tctx.fillStyle = ctx.createPattern(image, this.backgroundMethod);\n\t\t\t\t\t\tctx.fillRect(0, 0, canvas.width, canvas.height);\n\t\t\t\t\t}\n\t\t}\n\t};\n\n\t/** */\n\n\n\tRoom.next = function next() {\n\t\tvar index = Room.array.indexOf(Room.current);\n\t\tRoom.enter(Room.array[index + 1]);\n\t};\n\n\t/** */\n\n\n\tRoom.previous = function previous() {\n\t\tvar index = Room.array.indexOf(Room.current);\n\t\tRoom.enter(Room.array[index - 1]);\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tRoom.get = function get(name) {\n\t\tif ((typeof name === \"undefined\" ? \"undefined\" : _typeof(name)) === \"object\") return name;\n\t\tfor (var n = 0; n < Room.array.length; n++) {\n\t\t\tif (Room.array[n][\"name\"] === name) {\n\t\t\t\treturn Room.array[n];\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t};\n\n\treturn Room;\n}();\n\nRoom.prototype.assetType = \"room\";\nRoom.names = [];\nRoom.array = [];\nRoom.current = null;\n_generator2.default.classStaticMatch(Room);\n\nexports.default = Room;\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _draw2 = __webpack_require__(0);\n\nvar _draw3 = _interopRequireDefault(_draw2);\n\nvar _noop = __webpack_require__(12);\n\nvar _noop2 = _interopRequireDefault(_noop);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n *\r\n */\nvar Transition = function () {\n\n\t/**\r\n * @param {object} opts Options.\r\n * @param {string} opts.type\r\n * @param {string} opts.time Time in steps the tranistion will last per stage (in/out).\r\n * @param {string} opts.color Color of the transition.\r\n * @param {string} opts.callback Function to execute mid-transition.\r\n */\n\tfunction Transition() {\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\t\t_classCallCheck(this, Transition);\n\n\t\tthis.type = opts.type || \"fade\";\n\t\tthis.time = opts.time || 60;\n\t\tthis.color = opts.color || \"#000000\";\n\t\tthis.callback = opts.callback || _noop2.default;\n\t\tif (opts.prefab) _extends(this, opts.prefab);\n\t\tthis.direction = 1;\n\t\tthis.alpha = 0;\n\t\tthis.delta = 1 / this.time;\n\t\tTransition.allInstances.push(this);\n\n\t\t// Check transition type exists and log warning otherwise\n\t\tif (!Transition.prefabs.hasOwnProperty(this.type)) {\n\t\t\twindow.addConsoleText(\"#F00\", \"Unknown transition type: \" + this.type);\n\t\t\tthis.type = \"fade\";\n\t\t}\n\t}\n\n\t/** */\n\n\n\tTransition.prototype.update = function update() {\n\t\tif (Transition.prefabs.hasOwnProperty(this.type)) Transition.prefabs[this.type].update.call(this);\n\t};\n\n\t/** */\n\n\n\tTransition.prototype.draw = function draw() {\n\t\tif (Transition.prefabs.hasOwnProperty(this.type)) Transition.prefabs[this.type].draw.call(this);\n\t};\n\n\t/** */\n\n\n\tTransition.prototype.destroy = function destroy() {\n\t\tvar x = Transition.allInstances.indexOf(this);\n\t\tTransition.allInstances.splice(x, 1);\n\t};\n\n\t/** */\n\n\n\tTransition.create = function create(opts) {\n\t\treturn new Transition(opts);\n\t};\n\n\t/** */\n\n\n\tTransition.updateAll = function updateAll() {\n\t\tTransition.allInstances.forEach(function (t) {\n\t\t\tt.update();\n\t\t});\n\t};\n\n\t/** */\n\n\n\tTransition.drawAll = function drawAll() {\n\t\tTransition.allInstances.forEach(function (t) {\n\t\t\tt.draw();\n\t\t});\n\t};\n\n\treturn Transition;\n}();\n\n//\n\n\nTransition.allInstances = [];\n\n/**\r\n * @namespace\r\n */\nTransition.prefabs = {\n\n\t\"fade\": {\n\t\tupdate: function update() {\n\t\t\tthis.alpha += this.direction ? this.delta : -this.delta;\n\t\t\tif (this.alpha >= 1) {\n\t\t\t\tthis.callback();\n\t\t\t\tthis.direction = 0;\n\t\t\t} else if (this.alpha <= 0) {\n\t\t\t\tthis.destroy();\n\t\t\t}\n\t\t},\n\t\tdraw: function draw() {\n\t\t\tvar ctx = _draw3.default.context;\n\t\t\tctx.globalAlpha = this.alpha;\n\t\t\tctx.fillStyle = this.color;\n\t\t\tctx.fillRect(0, 0, 9999999, 9999999);\n\t\t}\n\t}\n\n};\n\nexports.default = Transition;\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _Canvas = __webpack_require__(2);\n\nvar _Canvas2 = _interopRequireDefault(_Canvas);\n\nvar _keyvalues = __webpack_require__(18);\n\nvar _keyvalues2 = _interopRequireDefault(_keyvalues);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// Mouse object\nvar __mouseMap = [\"Left\", \"Middle\", \"Right\"];\nvar __mouse = {\n\tpress: [false, false, false],\n\tdown: [false, false, false],\n\trelease: [false, false, false],\n\twheelUp: false,\n\twheelDown: false,\n\trawX: 0,\n\trawY: 0,\n\tx: 0,\n\ty: 0\n\n\t// Keyboard object\n};var __keyboard = {\n\tpress: {},\n\tdown: {},\n\trelease: {}\n\n\t// Touch object\n};var __touch = {\n\tstart: [],\n\theld: [],\n\tmove: [],\n\tend: [],\n\tcancel: [],\n\tx: [],\n\ty: []\n\n\t/**\r\n  * @author Jack Oatley\r\n  */\n};\nvar Input = function () {\n\tfunction Input() {\n\t\t_classCallCheck(this, Input);\n\t}\n\n\t/**\r\n  *\r\n  */\n\tInput.initMouse = function initMouse() {\n\n\t\tfunction handleMouseDown(e) {\n\t\t\te.preventDefault();\n\t\t\tif (!__mouse.press[e.button]) window.focus();\n\t\t\t__mouse.press[e.button] = true;\n\t\t\t__mouse.down[e.button] = true;\n\t\t}\n\n\t\tfunction handleMouseUp(e) {\n\t\t\te.preventDefault();\n\t\t\t__mouse.press[e.button] = false;\n\t\t\t__mouse.release[e.button] = true;\n\t\t\t__mouse.down[e.button] = false;\n\t\t}\n\n\t\tfunction handleMouseMove(e) {\n\t\t\tvar canv = _Canvas2.default.main.domElement;\n\t\t\tvar rect = canv.getBoundingClientRect();\n\t\t\tvar hs = canv.width / rect.width;\n\t\t\tvar vs = canv.height / rect.height;\n\t\t\t__mouse.rawX = ~~(e.clientX - rect.left);\n\t\t\t__mouse.rawY = ~~(e.clientY - rect.top);\n\t\t\t__mouse.x = ~~(__mouse.rawX * hs);\n\t\t\t__mouse.y = ~~(__mouse.rawY * vs);\n\t\t}\n\n\t\tfunction handleMouseWheel(e) {\n\t\t\te.preventDefault();\n\t\t\tvar delta = Math.sign(e.wheelDelta);\n\t\t\t__mouse.wheelUp = delta > 0;\n\t\t\t__mouse.wheelDown = delta < 0;\n\t\t}\n\n\t\tInput.element.addEventListener(\"mousedown\", handleMouseDown);\n\t\tInput.element.addEventListener(\"mouseup\", handleMouseUp);\n\t\tInput.element.addEventListener(\"mousemove\", handleMouseMove);\n\t\tInput.element.addEventListener(\"mousewheel\", handleMouseWheel);\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tInput.initKeyboard = function initKeyboard() {\n\n\t\t//\n\t\t_keyvalues2.default.forEach(function (key) {\n\t\t\t__keyboard.press[key] = false;\n\t\t\t__keyboard.down[key] = false;\n\t\t\t__keyboard.release[key] = false;\n\t\t});\n\n\t\t//\n\t\tfunction handleKeyDown(e) {\n\t\t\te.preventDefault();\n\t\t\tvar code = e.code || e.key;\n\t\t\tif (!__keyboard.down[code]) {\n\t\t\t\t__keyboard.press[code] = true;\n\t\t\t\t__keyboard.down[code] = true;\n\t\t\t}\n\t\t}\n\n\t\t//\n\t\tfunction handleKeyUp(e) {\n\t\t\te.preventDefault();\n\t\t\tvar code = e.code || e.key;\n\t\t\t__keyboard.release[code] = true;\n\t\t\t__keyboard.down[code] = false;\n\t\t}\n\n\t\t//\n\t\tInput.element.addEventListener(\"keydown\", handleKeyDown);\n\t\tInput.element.addEventListener(\"keyup\", handleKeyUp);\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tInput.initTouch = function initTouch() {\n\n\t\t//\n\t\tfunction handleTouchStart(e) {\n\t\t\te.preventDefault();\n\t\t\t!__touch.start[0] && window.focus();\n\t\t\t__touch.start[0] = true;\n\t\t\t__touch.held[0] = true;\n\t\t}\n\n\t\t//\n\t\tfunction handleTouchEnd(e) {\n\t\t\te.preventDefault();\n\t\t\t__touch.start[0] = false;\n\t\t\t__touch.end[0] = true;\n\t\t\t__touch.held[0] = false;\n\t\t}\n\n\t\t//\n\t\tfunction handleTouchMove(e) {\n\t\t\te.preventDefault();\n\t\t\tvar touches = e.changedTouches;\n\t\t\t__touch.x[0] = touches[0].pageX;\n\t\t\t__touch.y[0] = touches[0].pageY;\n\t\t}\n\n\t\t//\n\t\tInput.element.addEventListener(\"touchstart\", handleTouchStart);\n\t\tInput.element.addEventListener(\"touchend\", handleTouchEnd);\n\t\tInput.element.addEventListener(\"touchcancel\", handleTouchEnd);\n\t\tInput.element.addEventListener(\"touchmove\", handleTouchMove);\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tInput.getTriggerEvents = function getTriggerEvents() {\n\n\t\t// Reset.\n\t\tvar triggers = Input.triggerEvents;\n\t\ttriggers.length = 0;\n\n\t\t// Keyboard events.\n\t\tObject.keys(__keyboard.down).forEach(function (key) {\n\t\t\tif (_keyvalues2.default.includes(key)) {\n\t\t\t\tif (__keyboard.down[key]) triggers.push(key);\n\t\t\t\tif (__keyboard.press[key]) triggers.push(key + \"Press\");\n\t\t\t\tif (__keyboard.release[key]) triggers.push(key + \"Release\");\n\t\t\t} else {\n\t\t\t\tconsole.warn(\"input key not supported: \", key);\n\t\t\t\tdelete __keyboard.down[key];\n\t\t\t}\n\t\t});\n\n\t\t// Mouse events.\n\t\tfor (var n = 0; n < 3; n++) {\n\t\t\tif (__mouse.down[n]) triggers.push(__mouseMap[n] + \"Down\");\n\t\t\tif (__mouse.press[n]) triggers.push(__mouseMap[n] + \"Press\");\n\t\t\tif (__mouse.release[n]) triggers.push(__mouseMap[n] + \"Release\");\n\t\t}\n\n\t\tif (__mouse.wheelUp) triggers.push(\"WheelUp\");\n\t\tif (__mouse.wheelDown) triggers.push(\"WheelDown\");\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tInput.update = function update() {\n\n\t\tObject.keys(__keyboard.down).forEach(function (key) {\n\t\t\t__keyboard.press[key] = false;\n\t\t\t__keyboard.release[key] = false;\n\t\t});\n\n\t\tObject.keys(__mouse.down).forEach(function (button) {\n\t\t\t__mouse.press[button] = false;\n\t\t\t__mouse.release[button] = false;\n\t\t});\n\n\t\tObject.keys(__touch.held).forEach(function (button) {\n\t\t\t__touch.start[button] = false;\n\t\t\t__touch.end[button] = false;\n\t\t\t__touch.held[button] = false;\n\t\t});\n\n\t\t__mouse.wheelUp = false;\n\t\t__mouse.wheelDown = false;\n\t};\n\n\treturn Input;\n}();\n\nInput.element = document;\nInput.triggerEvents = [];\nInput.mouse = __mouse;\nInput.keyboard = __keyboard;\nInput.touch = __touch;\n\nexports.default = Input;\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\n/**\r\n * @param {string} hex A hex string.\r\n * @return {Object}\r\n */\nfunction hexToRgb(hex) {\n\tvar result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n\treturn result ? {\n\t\tr: parseInt(result[1], 16),\n\t\tg: parseInt(result[2], 16),\n\t\tb: parseInt(result[3], 16),\n\t\ta: 255\n\t} : {\n\t\tr: 0,\n\t\tg: 0,\n\t\tb: 0,\n\t\ta: 255\n\t};\n}\n\n/**\r\n * @param {string} hex A hex string.\r\n * @return {Array}\r\n */\nfunction hexToArray(hex) {\n\tvar result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n\treturn result ? [parseInt(result[1], 16), parseInt(result[2], 16), parseInt(result[3], 16), 255] : [0, 0, 0, 255];\n}\n\n/**\r\n * @param {number} c The component.\r\n * @return {string}\r\n */\nfunction componentToHex(c) {\n\tvar hex = c.toString(16);\n\treturn hex.length == 1 ? \"0\" + hex : hex;\n}\n\n/**\r\n * @param {number} r The red component.\r\n * @param {number} g The green component.\r\n * @param {number} b The blue component.\r\n * @return {string}\r\n */\nfunction rgbToHex(r, g, b) {\n\treturn \"#\" + componentToHex(r) + componentToHex(g) + componentToHex(b);\n}\n\n//\nexports.default = {\n\thexToRgb: hexToRgb,\n\tcomponentToHex: componentToHex,\n\trgbToHex: rgbToHex,\n\thexToArray: hexToArray\n};\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _generator = __webpack_require__(1);\n\nvar _generator2 = _interopRequireDefault(_generator);\n\nvar _grid = __webpack_require__(6);\n\nvar _grid2 = _interopRequireDefault(_grid);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n * @author Jack Oatley\r\n */\nvar Font = function () {\n\n\t/**\r\n  * @param {object} [opts={}] Options.\r\n  * @param {string} [opts.name=\"_UNNAMEDFONT\"] Name of the font.\r\n  * @param {string} [opts.src=\"\"] Source of the font.\r\n  * @param {image} [opts.bitmap=null] An existing bitmap.\r\n  * @param {string} [opts.method=\"normal\"] Initial drawing method.\r\n  * @param {boolean} [opts.apply] Apply the font in CSS,\r\n  */\n\tfunction Font() {\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\t\t_classCallCheck(this, Font);\n\n\t\tthis.name = opts.name || \"_UNNAMEDFONT\";\n\t\tthis.source = opts.src || \"\";\n\t\tthis.hasFontFace = false;\n\t\tthis.forceSize = 0;\n\t\tthis.bitmapFont = []; //opts.bitmap || null;\n\t\tthis.hasBitmapFont = this.bitmap !== null;\n\t\tthis.method = opts.method || \"normal\";\n\t\tif (opts.apply) {\n\t\t\tthis.applyCss();\n\t\t}\n\t\tFont.names.push(this.name);\n\t\tFont.array.push(this);\n\t}\n\n\t/**\r\n  * Returns the CSS code that's needed to be applied to the page to use this font in the DOM or on the canvas.\r\n  */\n\n\n\tFont.prototype.getCss = function getCss() {\n\t\treturn \"@font-face {\" + \"font-family: \" + this.name + \";\" + \"src: url('\" + this.source + \"') format('truetype');\" + \"}\";\n\t};\n\n\t/**\r\n  * Applies the CSS code.\r\n  */\n\n\n\tFont.prototype.applyCss = function applyCss() {\n\t\tvar style = document.createElement(\"STYLE\");\n\t\tstyle.textContent = this.getCss();\n\t\tdocument.head.appendChild(style);\n\t};\n\n\t/**\r\n  * @param {Object} [opts={}] Options object.\r\n  * @param {number} [opts.size=8] Size of the font.\r\n  * @param {string} [opts.map] A string of all the characters to include in the bitmap font.\r\n  * @param {number} [opts.alphaThreshold=150] Threshold that dertmines which pixels shall be visible.\r\n  * @param {Array} [opts.color=[0,0,0,255]] An array containing the RGBA channels respectively.\r\n  */\n\n\n\tFont.prototype.convertToBitmapFont = function convertToBitmapFont() {\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\n\t\tvar scale = 3;\n\t\tvar psize = (opts.size || 8) * scale;\n\t\tvar size = (1 + (opts.size || 8)) * scale;\n\t\tvar map = opts.map || \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789/\\\\,.<>{}[]!\\\"$%^&*():;@'~#|`=+-_?\";\n\t\tvar cx = size * 0.5;\n\t\tvar cy = cx;\n\t\tvar alphaThreshold = opts.alphaThreshold || 150;\n\t\tvar color = opts.color || [0, 0, 0, 255];\n\n\t\tvar atlas = document.createElement(\"CANVAS\");\n\t\tatlas.width = size / scale * map.length;\n\t\tatlas.height = size / scale;\n\t\tvar atlasCtx = atlas.getContext(\"2d\");\n\t\tvar pointImageData = atlasCtx.createImageData(1, 1);\n\t\tpointImageData.data.set(color, 0);\n\n\t\tvar canvas = document.createElement(\"CANVAS\");\n\t\tcanvas.width = size;\n\t\tcanvas.height = size;\n\n\t\tvar ctx = canvas.getContext(\"2d\");\n\t\tctx.font = psize + \"px \" + this.name;\n\t\tctx.textAlign = \"center\";\n\t\tctx.textBaseline = \"middle\";\n\n\t\tvar charMap = new _grid2.default(size / scale, size / scale);\n\t\tvar lookupTable = {};\n\t\tfor (var n = 0; n < map.length; n++) {\n\n\t\t\tctx.clearRect(0, 0, size, size);\n\t\t\tcharMap.clear(-1);\n\n\t\t\tvar c = map[n];\n\t\t\tctx.fillStyle = \"#000\";\n\t\t\tctx.fillText(c, cx, cy);\n\n\t\t\tvar imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n\t\t\tvar data = imageData.data;\n\t\t\tvar p, r, g, b, a;\n\t\t\tfor (p = 0; p < data.length; p += 4 * scale) {\n\t\t\t\tvar _x3 = ~~(p / 4 % size / scale);\n\t\t\t\tvar _y = ~~(~~(p / 4 / size) / scale);\n\t\t\t\tvar i = _x3 + size / scale * _y;\n\t\t\t\tif (charMap.get(_x3, _y) === -1) {\n\t\t\t\t\tcharMap.set(_x3, _y, data[p + 3]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Get metrics\n\t\t\tvar metrics = { left: 10000, top: 10000, right: 0, bottom: 0 };\n\t\t\tvar minY = 100;\n\t\t\tvar maxY = 0;\n\t\t\tvar x = void 0,\n\t\t\t    y = void 0;\n\t\t\tvar hits = 0;\n\t\t\tfor (y = 0; y < size / scale; y++) {\n\t\t\t\tfor (x = 0; x < size / scale; x++) {\n\t\t\t\t\tif (charMap.get(x, y) > alphaThreshold) {\n\t\t\t\t\t\tmetrics.left = Math.min(metrics.left, x);\n\t\t\t\t\t\tmetrics.top = Math.min(metrics.top, y);\n\t\t\t\t\t\tmetrics.right = Math.max(metrics.right, x + 1);\n\t\t\t\t\t\tmetrics.bottom = Math.max(metrics.bottom, y + 1);\n\t\t\t\t\t\tminY = Math.min(minY, metrics.top);\n\t\t\t\t\t\tmaxY = Math.max(maxY, metrics.bottom);\n\t\t\t\t\t\thits++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} // No visible character.\n\t\t\tif (hits === 0) {\n\t\t\t\tmetrics = { left: 0, top: 0, right: 0, bottom: 0 };\n\t\t\t}\n\n\t\t\t// Print to atlas\n\t\t\tfor (y = 0; y < size / scale; y++) {\n\t\t\t\tfor (x = 0; x < size / scale; x++) {\n\t\t\t\t\tif (charMap.get(x, y) > alphaThreshold) {\n\t\t\t\t\t\tatlasCtx.putImageData(pointImageData, n * (size / scale) + x, y);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} // Tweak metrics into atlas coords and add to lookup table\n\t\t\tmetrics.left += n * (size / scale);\n\t\t\tmetrics.right += n * (size / scale);\n\t\t\tmetrics.top = 0;\n\t\t\tmetrics.bottom = size / scale;\n\t\t\tlookupTable[c] = metrics;\n\t\t}\n\n\t\t// Space is special because it can't actually be measured\n\t\tlookupTable[\" \"] = { left: -3, top: 0, right: 0, bottom: size / scale\n\n\t\t\t//\n\t\t};var key = \"\" + opts.size + color[0] + color[1] + color[2] + color[3];\n\t\tconsole.log(key);\n\t\tthis.bitmapFont[key] = {\n\t\t\tsize: psize / scale,\n\t\t\tlookup: lookupTable,\n\t\t\timage: atlas\n\t\t};\n\n\t\tthis.method = \"bitmap\";\n\t};\n\n\t/**\r\n  * @param {*} value The string name of the font to get.\r\n  * @return {Object}\r\n  */\n\n\n\tFont.get = function get(value) {\n\n\t\tif ((typeof value === \"undefined\" ? \"undefined\" : _typeof(value)) === \"object\" || typeof value === \"function\") return value;\n\n\t\tvar arr = Font.array;\n\t\tvar n = arr.length;\n\t\twhile (n--) {\n\t\t\tif (arr[n].name === value) {\n\t\t\t\treturn arr[n];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t};\n\n\treturn Font;\n}();\n\n_generator2.default.classStaticMatch(Font);\nFont.prototype.assetType = \"font\";\nFont.names = [];\nFont.array = [];\n\nexports.default = Font;\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = function () {};\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _event = __webpack_require__(19);\n\nvar _event2 = _interopRequireDefault(_event);\n\nvar _instance = __webpack_require__(4);\n\nvar _instance2 = _interopRequireDefault(_instance);\n\nvar _objectVars = __webpack_require__(27);\n\nvar _objectVars2 = _interopRequireDefault(_objectVars);\n\nvar _pool = __webpack_require__(16);\n\nvar _pool2 = _interopRequireDefault(_pool);\n\nvar _generator = __webpack_require__(1);\n\nvar _generator2 = _interopRequireDefault(_generator);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n *\r\n */\nvar GameObject = function () {\n\n\t/**\r\n  * @param {string} name\r\n  * @param {number} sprite\r\n  */\n\tfunction GameObject(name, sprite) {\n\t\t_classCallCheck(this, GameObject);\n\n\t\t// Create new constructor.\n\t\tvar obj = function obj(x, y) {\n\t\t\tvar inst = obj.pool.get(this);\n\t\t\t_instance2.default.setup(inst, obj, x, y);\n\t\t\tobj.instances.push(inst);\n\t\t\treturn inst;\n\t\t};\n\n\t\t_extends(obj, GameObject.prototype);\n\t\t_objectVars2.default.set(obj.prototype);\n\t\tobj.objectName = name || \"object_\" + obj.id;\n\t\tobj.prototype.sprite = sprite || null;\n\t\tobj.pool = new _pool2.default(obj);\n\t\tobj.instances = [];\n\t\tGameObject.names.push(obj.objectName);\n\t\tGameObject.array.push(obj);\n\t\treturn obj;\n\t}\n\n\t/**\r\n  * @param {number} index\r\n  * @return {Object}\r\n  */\n\n\n\tGameObject.prototype.find = function find(index) {\n\t\treturn _instance2.default.find(this, index);\n\t};\n\n\t/**\r\n  * Add an action with variable parameters to an event of an object.\r\n  * @param {*} object Can be an object constructor or integer ID.\r\n  * @param {*} event\r\n  * @param {*} action\r\n  * @return {void}\r\n  */\n\n\n\tGameObject.prototype.eventAddAction = function eventAddAction(event, action) {\n\n\t\tif (action === undefined) {\n\t\t\tconsole.warn(\"tried to add an undefined action to an event!\");\n\t\t}\n\n\t\t// If flow action, get flow tag.\n\t\tvar flow = \"\";\n\t\t//console.warn(action);\n\t\tif (typeof action === \"string\") {\n\t\t\tflow = action;\n\t\t}\n\n\t\t// Create a new event if not yet defined.\n\t\tif (!this.prototype.events[event]) {\n\t\t\tthis.prototype.events[event] = [];\n\t\t}\n\n\t\t// Create collision listeners, if applicable.\n\t\tif (event.includes(\"collision_\")) {\n\t\t\tvar index = event.indexOf(\"_\") + 1;\n\t\t\tvar name = event.slice(index, 200);\n\t\t\tGameObject.addCollisionListener(this, name);\n\t\t}\n\n\t\t// Add action to event.\n\t\tthis.prototype.events[event].push({\n\t\t\tflow: flow,\n\t\t\tcache: action\n\t\t});\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tGameObject.prototype.addCollisionListener = function addCollisionListener(target) {\n\t\tthis.prototype.listeners.push({\n\t\t\ttype: \"collision\",\n\t\t\ttarget: target\n\t\t});\n\t};\n\n\t/**\r\n  * @return {Array}\r\n  */\n\n\n\tGameObject.prototype.getAllInstances = function getAllInstances() {\n\t\tvar _this = this;\n\n\t\tvar arr = [];\n\t\t_instance2.default.instanceArray.forEach(function (inst) {\n\t\t\tvar name = inst.constructor.objectName;\n\t\t\tif (name === _this.objectName) {\n\t\t\t\tarr.push(inst);\n\t\t\t}\n\t\t});\n\t\treturn arr;\n\t};\n\n\t/**\r\n  * @param {*} obj\r\n  * @return {Object} The found object, or null if not found.\r\n  */\n\n\n\tGameObject.get = function get(obj) {\n\n\t\t// If obj is already an object/constructor.\n\t\tif (typeof obj !== \"string\") return obj;\n\n\t\t// Iterate all objects to find the one we want.\n\t\tvar a = GameObject.array;\n\t\tvar n = a.length;\n\t\twhile (n--) {\n\t\t\tif (a[n].objectName === obj) {\n\t\t\t\treturn a[n];\n\t\t\t}\n\t\t}\n\n\t\t// Failed to find an object.\n\t\treturn null;\n\t};\n\n\treturn GameObject;\n}();\n\n_generator2.default.classStaticMatch(GameObject);\nGameObject.prototype.assetType = \"object\";\nGameObject.names = [];\nGameObject.array = [];\n\nexports.default = GameObject;\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _room = __webpack_require__(7);\n\nvar _room2 = _interopRequireDefault(_room);\n\nvar _draw = __webpack_require__(0);\n\nvar _draw2 = _interopRequireDefault(_draw);\n\nvar _generator = __webpack_require__(1);\n\nvar _generator2 = _interopRequireDefault(_generator);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n * @author Jack Oatley\r\n */\nvar Camera = function () {\n\n\t/**\r\n  * Create a new Camera instance.\r\n  * @param {object} [opts={}]\r\n  * @param {number} [x]\r\n  * @param {number} [y]\r\n  * @param {number} [angle]\r\n  * @param {number} [width]\r\n  * @param {number} [height]\r\n  * @param {number} [follow]\r\n  * @param {number} [gridLocked]\r\n  */\n\tfunction Camera() {\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\t\t_classCallCheck(this, Camera);\n\n\t\tthis.x = 0, this.y = 0, this.angle = 0, this.width = _room2.default.current.width, this.height = _room2.default.current.height, this.follow = null, this.gridLocked = false, this.left = 0, this.right = 0, this.top = 0, this.bottom = 0;\n\t\t_extends(this, opts);\n\t\tCamera.array.push(this);\n\t}\n\n\t/**\r\n  * Update the Camera.\r\n  */\n\n\n\tCamera.prototype.update = function update() {\n\t\tif (this.follow) {\n\n\t\t\t// if single instance, put into array\n\t\t\tif (!Array.isArray(this.follow)) this.follow = [this.follow];\n\n\t\t\t//\n\t\t\tvar x = 0,\n\t\t\t    y = 0,\n\t\t\t    count = 0,\n\t\t\t    weight = 1;\n\t\t\tthis.follow.forEach(function (inst) {\n\n\t\t\t\tif (Array.isArray(inst)) {\n\t\t\t\t\tweight = inst[1] || 1;\n\t\t\t\t\tinst = inst[0];\n\t\t\t\t} else {\n\t\t\t\t\tweight = 1;\n\t\t\t\t}\n\n\t\t\t\tx += inst.x * weight;\n\t\t\t\ty += inst.y * weight;\n\t\t\t\tcount += weight;\n\t\t\t});\n\n\t\t\tthis.x = x / count;\n\t\t\tthis.y = y / count;\n\t\t}\n\n\t\t// update bounds\n\t\tthis.left = this.x - this.width * 0.5;\n\t\tthis.right = this.x + this.width * 0.5;\n\t\tthis.top = this.y - this.height * 0.5;\n\t\tthis.bottom = this.y + this.height * 0.5;\n\n\t\t// apply camera\n\t\t_draw2.default.transform.translate(-this.left, -this.top);\n\t};\n\n\treturn Camera;\n}();\n\nCamera.array = [];\n\nCamera.create = _generator2.default.functionFromConstructor(Camera);\nCamera.updateAll = _generator2.default.arrayExecute(Camera.array, Camera.prototype.update);\n\nexports.default = Camera;\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _Canvas = __webpack_require__(2);\n\nvar _Canvas2 = _interopRequireDefault(_Canvas);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n *\r\n */\nvar App = function () {\n\tfunction App() {\n\t\t_classCallCheck(this, App);\n\t}\n\n\t/**\r\n  * Sets the cursor to use when the mouse is in the game window.\r\n  * @param {string} cursor Same as the CSS cursor property.\r\n  * See {@link https://developer.mozilla.org/en-US/docs/Web/CSS/cursor}\r\n  */\n\tApp.setCursor = function setCursor(cursor) {\n\t\t_Canvas2.default.main.style.cursor = cursor;\n\t};\n\n\treturn App;\n}();\n\nexports.default = App;\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = Pool;\n/**\r\n * @module Pool\r\n */\n\n/**\r\n * The Pool object contains an array (the pool) called stack to which we can give objects. The Pool also maintains it's own length property, as the true length of the stack array does not change, so as to avoid garbage collection.\r\n * @param {Object} newConstructor The constructor function for this pool. During get, if no items are in the pool and no default value is provided, a new object is created from this constructor and returned.\r\n */\nfunction Pool(newConstructor) {\n  this.stack = [];\n  this.length = 0;\n  this.newConstructor = newConstructor;\n}\n\n/**\r\n * @param {Object} [def] The default object (or even value) to return if no items are found in the pool. If this is not defined, and no items are found in the pool, then a new object is created as per the Pool's newConstructor property.\r\n */\nPool.prototype.get = function (def) {\n  if (this.length) {\n    def = this.stack[--this.length];\n    this.stack[this.length] = undefined;\n  }\n  return def || new this.newConstructor();\n};\n\n/**\r\n * @param {Object} i Objec to release, adding it to the pool.\r\n */\nPool.prototype.release = function (i) {\n  this.stack[this.length++] = i;\n};\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _Canvas = __webpack_require__(2);\n\nvar _Canvas2 = _interopRequireDefault(_Canvas);\n\nvar _room = __webpack_require__(7);\n\nvar _room2 = _interopRequireDefault(_room);\n\nvar _input = __webpack_require__(9);\n\nvar _input2 = _interopRequireDefault(_input);\n\nvar _instance = __webpack_require__(4);\n\nvar _instance2 = _interopRequireDefault(_instance);\n\nvar _global = __webpack_require__(20);\n\nvar _global2 = _interopRequireDefault(_global);\n\nvar _draw = __webpack_require__(0);\n\nvar _draw2 = _interopRequireDefault(_draw);\n\nvar _camera = __webpack_require__(14);\n\nvar _camera2 = _interopRequireDefault(_camera);\n\nvar _transition = __webpack_require__(8);\n\nvar _transition2 = _interopRequireDefault(_transition);\n\nvar _noop = __webpack_require__(12);\n\nvar _noop2 = _interopRequireDefault(_noop);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar fpsFrames = 0;\nvar fpsTime = 0;\nvar lastTick = performance.now();\nvar tickLength = 1000 / 60;\nvar last = 0;\n\n//\nwindow.addConsoleText = window.addConsoleText || console.log;\nwindow._GB_stop = window._GB_stop || _noop2.default;\n\n//\nvar main = {\n\n\t/**\r\n  *\r\n  */\n\tstart: function start() {\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\n\t\t// Basic site-locking\n\t\tif (opts.host !== undefined && opts.host !== \"\") {\n\t\t\tvar loc = window.parent ? window.parent.location : window.location;\n\t\t\tvar host = loc.hostname;\n\t\t\tvar arr = opts.host.split(\" \").join(\"\").split(\",\");\n\t\t\tif (!opts.host.includes(host)) return;\n\t\t}\n\n\t\t//\n\t\tvar canv = new _Canvas2.default({\n\t\t\twidth: _room2.default.current.width,\n\t\t\theight: _room2.default.current.height,\n\t\t\tcrisp2D: true,\n\t\t\tapplication: true,\n\t\t\tcontext: opts.defaultContext || \"2d\"\n\t\t});\n\n\t\t// selectively enable input methods\n\t\tif (opts.enableMouse) _input2.default.initMouse();\n\t\tif (opts.enableKeyboard) _input2.default.initKeyboard();\n\t\tif (opts.enableTouch) _input2.default.initTouch();\n\t\tif (opts.hideCursor) canv.domElement.style.cursor = \"none\";\n\n\t\t//\n\t\t_room2.default.enter(_room2.default.current);\n\t\ttick(performance.now());\n\t},\n\n\t/**\r\n  *\r\n  */\n\tsetGameSpeed: function setGameSpeed(speed) {\n\t\ttickLength = 1000 / speed;\n\t}\n\n\t/**\r\n  *\r\n  */\n};function tick(timestamp) {\n\n\ttry {\n\n\t\t// Exit game with Esc key.\n\t\tif (window._GB_stop && _input2.default.triggerEvents.includes(\"EscapePress\")) window._GB_stop();\n\n\t\t// request the next frame\n\t\twindow.requestAnimationFrame(tick);\n\t\tvar nextTick = lastTick + tickLength;\n\t\tvar numTicks = 0;\n\t\t_global2.default.fpsNow = 1000 / (timestamp - last);\n\t\t_global2.default.dt = timestamp - last;\n\t\tfpsFrames += 1;\n\t\tfpsTime += _global2.default.dt;\n\t\twhile (fpsTime >= 1000) {\n\t\t\t_global2.default.fps = fpsFrames;\n\t\t\tfpsFrames = 0;\n\t\t\tfpsTime -= 1000;\n\t\t}\n\t\tlast = timestamp;\n\n\t\t//\n\t\tif (timestamp > nextTick) {\n\t\t\tvar timeSinceTick = timestamp - lastTick;\n\t\t\tvar maxTicks = Math.floor(timeSinceTick / tickLength);\n\t\t\tlastTick = lastTick + tickLength * maxTicks;\n\t\t\tnumTicks = Math.min(maxTicks, 60);\n\t\t}\n\n\t\t//\n\t\t_input2.default.getTriggerEvents();\n\t\tqueueUpdates(numTicks);\n\t\tgameDraw();\n\n\t\t//\n\t\tif (numTicks) {\n\t\t\t_input2.default.update();\n\t\t}\n\t} catch (err) {\n\t\tconsole.error(err);\n\t\twindow.addConsoleText(\"#F00\", \"Error: \" + err);\n\t\twindow._GB_stop();\n\t}\n}\n\n/**\r\n * @param {number} ticks\r\n * @return {void}\r\n */\nfunction queueUpdates(ticks) {\n\twhile (ticks--) {\n\t\tgameUpdate();\n\t}\n}\n\n/**\r\n * Update sequence.\r\n * @return {void}\r\n */\nfunction gameUpdate() {\n\t_instance2.default.stepAll();\n\t_transition2.default.updateAll();\n}\n\n/**\r\n * @return {void}\r\n */\nfunction gameDraw() {\n\t_draw2.default.reset();\n\t_Canvas2.default.main.fill(\"#000\");\n\t_room2.default.draw(_room2.default.current);\n\t_camera2.default.updateAll();\n\t_instance2.default.drawAll();\n\t_draw2.default.reset();\n\t_instance2.default.drawGuiAll();\n\t_transition2.default.drawAll();\n}\n\n/**\r\n * @return {void}\r\n */\nfunction handleResizeEvent() {\n\t_instance2.default.executeEventAll(\"resize\");\n}\n\n// attach event listerners\nwindow.addEventListener(\"resize\", handleResizeEvent);\n\n//\nexports.default = main;\n\n/***/ }),\n/* 18 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n/**\r\n * @module keyvalues\r\n */\n\nvar values = [\"ArrowUp\", \"ArrowDown\", \"ArrowLeft\", \"ArrowRight\", \"Enter\", \"Space\", \"Backspace\", \"Escape\", \"ShiftLeft\", \"ShiftRight\", \"ControlLeft\", \"ControlRight\", \"AltLeft\", \"AltRight\", \"KeyA\", \"KeyB\", \"KeyC\", \"KeyD\", \"KeyE\", \"KeyF\", \"KeyG\", \"KeyH\", \"KeyI\", \"KeyJ\", \"KeyK\", \"KeyL\", \"KeyM\", \"KeyN\", \"KeyO\", \"KeyP\", \"KeyQ\", \"KeyR\", \"KeyS\", \"KeyT\", \"KeyU\", \"KeyV\", \"KeyW\", \"KeyX\", \"KeyY\", \"KeyZ\", \"Digit0\", \"Digit1\", \"Digit2\", \"Digit3\", \"Digit4\", \"Digit5\", \"Digit6\", \"Digit7\", \"Digit8\", \"Digit9\"];\n\nexports.default = values;\n\n/***/ }),\n/* 19 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _keyvalues = __webpack_require__(18);\n\nvar _keyvalues2 = _interopRequireDefault(_keyvalues);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//\nvar events = {\n\tcreate: \"create\",\n\troomEnter: \"roomEnter\",\n\troomLeave: \"roomLeave\",\n\tstep: \"step\",\n\tdraw: \"draw\",\n\tcollision: \"collision_\",\n\tresize: \"resize\",\n\tkeyboard: _extends({}, translate(_keyvalues2.default), {\n\t\tpressed: translate(_keyvalues2.default, \"Press\"),\n\t\treleased: translate(_keyvalues2.default, \"Release\")\n\t})\n\n\t/**\r\n  * @param {array} array\r\n  * @param {string} [postfix=\"\"]\r\n  */\n};function translate(array) {\n\tvar postfix = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"\";\n\n\tvar obj = {};\n\tarray.forEach(function (name) {\n\t\tobj[name] = name + postfix;\n\t});\n\treturn obj;\n}\n\n//\nexports.default = events;\n\n/***/ }),\n/* 20 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar global = {\n\tdt: 0,\n\tfps: 0,\n\tfpsNow: 0\n};\n\nexports.default = global;\n\n/***/ }),\n/* 21 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _generator = __webpack_require__(1);\n\nvar _generator2 = _interopRequireDefault(_generator);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n * @author Jack Oatley\r\n */\nvar Sound = function () {\n\n\t/**\r\n  * @param {string} name name for the resource.\r\n  * @param {string} source A path to an audio source, or a base64 encoded audio.\r\n  */\n\tfunction Sound(name, source) {\n\t\t_classCallCheck(this, Sound);\n\n\t\tthis.name = name;\n\t\tthis.instances = [new Audio(source)];\n\t\tthis.ready = false;\n\t\tthis.volume = 1.0;\n\t\tSound.names.push(name);\n\t\tSound.array.push(this);\n\t\tthis.__test();\n\t}\n\n\t/**\r\n  * Returns the asset type, this can't/shouldn't be overwitten.\r\n  * @return {string}\r\n  */\n\n\n\t/**\r\n  * @param {number} number\r\n  * @return {void}\r\n  */\n\tSound.prototype.preload = function preload(number) {\n\t\tvar a = this.instances;\n\t\tvar n = number - a.length;\n\t\twhile (n-- > 0) {\n\t\t\ta.push(a[0].cloneNode());\n\t\t}\n\t};\n\n\t/**\r\n  * @param {Object} [opts={}] object.\r\n  */\n\n\n\tSound.prototype.play = function play() {\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\t\tif (Sound.isEnabled) {\n\n\t\t\t// Find an existing sound instance to play.\n\t\t\tvar playSound;\n\t\t\tvar n = this.instances.length;\n\t\t\twhile (n--) {\n\t\t\t\tvar instance = this.instances[n];\n\t\t\t\tif (instance.paused) {\n\t\t\t\t\tplaySound = instance;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Create new instance of sound.\n\t\t\tif (!playSound) {\n\t\t\t\tplaySound = this.instances[0].cloneNode();\n\t\t\t\tthis.instances.push(playSound);\n\t\t\t}\n\n\t\t\t//\n\t\t\tplaySound.onError = function (err) {\n\t\t\t\tconsole.error(soundName, err);\n\t\t\t};\n\n\t\t\t// Play the sound.\n\t\t\tplaySound.volume = this.volume;\n\t\t\tvar promise = playSound.play();\n\t\t\tif (promise !== undefined) {\n\t\t\t\tpromise.then(function () {\n\n\t\t\t\t\t// on end event\n\t\t\t\t\tplaySound.onended = function () {\n\n\t\t\t\t\t\t// Internal event stuff.\n\t\t\t\t\t\tthis.currentTime = 0;\n\t\t\t\t\t\tif (Number(opts.loop || false)) {\n\t\t\t\t\t\t\tthis.play();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.pause();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Custom event, if defined.\n\t\t\t\t\t\tif (opts.onEnd) {\n\t\t\t\t\t\t\topts.onEnd();\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}).catch(function (err) {\n\t\t\t\t\tconsole.warn(err);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t//\n\t\t\treturn playSound;\n\t\t}\n\n\t\t// sound is disabled\n\t\treturn null;\n\t};\n\n\t/**\r\n  * Stop all instances of the sound from playing.\r\n  * @return {void}\r\n  */\n\n\n\tSound.prototype.stop = function stop() {\n\t\tvar a = this.instances;\n\t\tvar n = a.length;\n\t\twhile (n--) {\n\t\t\tvar i = a[n];\n\t\t\tif (!i.paused) {\n\t\t\t\ti.currentTime = 0;\n\t\t\t\ti.pause();\n\t\t\t}\n\t\t}\n\t};\n\n\t/**\r\n  * Tests whether the Sound resource has an instance that is ready to play.\r\n  * Generates a callback function that sets the resource's \"ready\" property.\r\n  * @return {void}\r\n  */\n\n\n\tSound.prototype.__test = function __test() {\n\t\tvar i = this;\n\t\tvar a = this.instances[0];\n\t\ta.oncanplaythrough = function () {\n\t\t\ti.ready = true;\n\t\t\ta.oncanplaythrough = null;\n\t\t};\n\t};\n\n\t/**\r\n  * @return {boolean}\r\n  */\n\n\n\tSound.readyAll = function readyAll() {\n\t\tvar a = Sound.array;\n\t\tvar n = a.length;\n\t\twhile (n--) {\n\t\t\tif (!a[n].ready) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t};\n\n\t/**\r\n  * @param {boolean} x\r\n  * @return {void}\r\n  */\n\n\n\tSound.enable = function enable(x) {\n\t\tSound.isEnabled = x;\n\t};\n\n\t/**\r\n  * Gets the sound resource from the given string.\r\n  * If a sound resource is passed, it's returned immedietly.\r\n  * @param {*} name Name as string, or object.\r\n  * @return {Object}\r\n  */\n\n\n\tSound.get = function get(name) {\n\n\t\tif ((typeof name === \"undefined\" ? \"undefined\" : _typeof(name)) === \"object\") {\n\t\t\treturn name;\n\t\t}\n\n\t\tvar a = Sound.array;\n\t\tvar n = a.length;\n\t\twhile (n--) {\n\t\t\tif (a[n].name === name) {\n\t\t\t\treturn a[n];\n\t\t\t}\n\t\t}\n\n\t\twindow.addConsoleText(\"#F00\", \"Unknown sound: \" + name);\n\t\treturn null;\n\t};\n\n\t_createClass(Sound, [{\n\t\tkey: \"assetType\",\n\t\tget: function get() {\n\t\t\treturn \"sound\";\n\t\t}\n\t}]);\n\n\treturn Sound;\n}();\n\n_generator2.default.classStaticMatch(Sound);\nSound.isEnabled = true;\nSound.names = [];\nSound.array = [];\n\n// Export.\nexports.default = Sound;\n\n/***/ }),\n/* 22 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\n//\nvar tween = {\n\n\t/**\r\n  *\r\n  */\n\tblend: function blend(n1, n2, perc) {\n\t\tvar diff = n2 - n1;\n\t\treturn n1 + diff * perc;\n\t},\n\n\n\t/**\r\n  *\r\n  */\n\tcubicBezier: function cubicBezier(x2, y2, x3, y3, i) {\n\n\t\tvar x1 = 0,\n\t\t    y1 = 0,\n\t\t    x4 = 1,\n\t\t    y4 = 1;\n\n\t\t// The Green Lines\n\t\tvar xa = tween.blend(x1, x2, i),\n\t\t    ya = tween.blend(y1, y2, i),\n\t\t    xb = tween.blend(x2, x3, i),\n\t\t    yb = tween.blend(y2, y3, i),\n\t\t    xc = tween.blend(x3, x4, i),\n\t\t    yc = tween.blend(y3, y4, i),\n\n\n\t\t// The Blue Line\n\t\txm = tween.blend(xa, xb, i),\n\t\t    ym = tween.blend(ya, yb, i),\n\t\t    xn = tween.blend(xb, xc, i),\n\t\t    yn = tween.blend(yb, yc, i),\n\n\n\t\t// The Black Dot\n\t\tx = tween.blend(xm, xn, i),\n\t\t    y = tween.blend(ym, yn, i);\n\n\t\t//\n\t\treturn y;\n\t}\n};\n\n//\nexports.default = tween;\n\n/***/ }),\n/* 23 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _draw = __webpack_require__(0);\n\nvar _draw2 = _interopRequireDefault(_draw);\n\nvar _sprite = __webpack_require__(3);\n\nvar _sprite2 = _interopRequireDefault(_sprite);\n\nvar _generator = __webpack_require__(1);\n\nvar _generator2 = _interopRequireDefault(_generator);\n\nvar _noop = __webpack_require__(12);\n\nvar _noop2 = _interopRequireDefault(_noop);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/** */\nvar Primitive = function () {\n\n\t/**\r\n  * @param {Object} opts Options object.\r\n  * @param {Array} opts.points Array of Point objects.\r\n  * @param {*} opts.texture Sprite object or name of sprite resource.\r\n  * @param {*} opts.color Color of the primitive.\r\n  * @param {string} opts.format Format of the points array.\r\n  * @param {Function} opts.modifier Point modifier function.\r\n  * @param {number} opts.x X position to draw the primitive.\r\n  * @param {number} opts.y Y position to draw the primitive.\r\n  */\n\tfunction Primitive() {\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\t\t_classCallCheck(this, Primitive);\n\n\t\tthis.points = opts.points || [];\n\t\tthis.texture = opts.texture || null;\n\t\tthis.color = opts.color || \"#000000\";\n\t\tthis.format = opts.format || \"quads\";\n\t\tthis.modifier = opts.modifier || _noop2.default;\n\t\tthis.x = opts.x || 0;\n\t\tthis.y = opts.y || 0;\n\t}\n\n\t/**\r\n  * Method for drawing instantiated Primitive.\r\n  * @return {void}\r\n  */\n\n\n\tPrimitive.prototype.draw = function draw(opts) {\n\t\tvar i = opts || this;\n\t\tif (i.texture) {\n\t\t\tdrawTextured(i);\n\t\t} else {\n\t\t\tdrawBasic(i);\n\t\t}\n\t};\n\n\treturn Primitive;\n}();\n\n/**\r\n *\r\n */\n\n\nfunction drawTextured() {\n\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\n\tvar texture = opts.texture;\n\tvar spr = _sprite2.default.get(texture);\n\tif (spr === null) {\n\t\tconsole.warn(\"No such texture: \" + texture);\n\t\treturn;\n\t}\n\n\tvar ctx = _draw2.default.context;\n\tvar frame = spr.images[0];\n\tvar img = frame.img;\n\tvar w = spr.width;\n\tvar h = spr.height;\n\tvar tris = orderTriangleList(opts);\n\n\t//\n\tvar pts = opts.points;\n\tif (opts.modifier) {\n\t\tpts = applyModifier(opts.points, opts.modifier);\n\t}\n\n\tpts.forEach(function (p) {\n\t\tp.x += opts.x;\n\t\tp.y += opts.y;\n\t});\n\n\tvar t = tris.length;\n\twhile (t--) {\n\n\t\tvar pp = tris[t];\n\t\tvar x0 = pts[pp[0]].x,\n\t\t    x1 = pts[pp[1]].x,\n\t\t    x2 = pts[pp[2]].x;\n\t\tvar y0 = pts[pp[0]].y,\n\t\t    y1 = pts[pp[1]].y,\n\t\t    y2 = pts[pp[2]].y;\n\t\tvar u0 = pts[pp[0]].u * w,\n\t\t    u1 = pts[pp[1]].u * w,\n\t\t    u2 = pts[pp[2]].u * w;\n\t\tvar v0 = pts[pp[0]].v * h,\n\t\t    v1 = pts[pp[1]].v * h,\n\t\t    v2 = pts[pp[2]].v * h;\n\n\t\t// Set clipping area so that only pixels inside the triangle will\n\t\t// be affected by the image drawing operation\n\t\tctx.save();\n\t\tctx.beginPath();\n\t\tctx.moveTo(x0, y0);\n\t\tctx.lineTo(x1, y1);\n\t\tctx.lineTo(x2, y2);\n\t\tctx.closePath();\n\t\tctx.clip();\n\n\t\t// Compute matrix transform\n\t\tvar delta = u0 * v1 + v0 * u2 + u1 * v2 - v1 * u2 - v0 * u1 - u0 * v2;\n\t\tvar delta_a = x0 * v1 + v0 * x2 + x1 * v2 - v1 * x2 - v0 * x1 - x0 * v2;\n\t\tvar delta_b = u0 * x1 + x0 * u2 + u1 * x2 - x1 * u2 - x0 * u1 - u0 * x2;\n\t\tvar delta_c = u0 * v1 * x2 + v0 * x1 * u2 + x0 * u1 * v2 - x0 * v1 * u2 - v0 * u1 * x2 - u0 * x1 * v2;\n\t\tvar delta_d = y0 * v1 + v0 * y2 + y1 * v2 - v1 * y2 - v0 * y1 - y0 * v2;\n\t\tvar delta_e = u0 * y1 + y0 * u2 + u1 * y2 - y1 * u2 - y0 * u1 - u0 * y2;\n\t\tvar delta_f = u0 * v1 * y2 + v0 * y1 * u2 + y0 * u1 * v2 - y0 * v1 * u2 - v0 * u1 * y2 - u0 * y1 * v2;\n\n\t\t// Draw the transformed image\n\t\tctx.transform(delta_a / delta, delta_d / delta, delta_b / delta, delta_e / delta, delta_c / delta, delta_f / delta);\n\t\tctx.drawImage(img, 0, 0);\n\t\tctx.restore();\n\t}\n}\n\n/**\r\n *\r\n */\nfunction drawBasic() {\n\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\tvar points = opts.points;\n\tif (opts.modifier) {\n\t\tpoints = applyModifier(opts.points, opts.modifier);\n\t}\n\tvar length = points.length;\n\tif (length > 0) {\n\t\tvar tris = orderQuadList(opts);\n\t\tvar i = void 0,\n\t\t    ctx = _draw2.default.context;\n\t\tctx.fillStyle = opts.color || _draw2.default.color;\n\t\tfor (i = 0; i < tris.length; i++) {\n\t\t\tvar tri = tris[i];\n\t\t\tvar n = void 0,\n\t\t\t    p = points[tri[0]];\n\t\t\tctx.beginPath();\n\t\t\tctx.moveTo(opts.x + p.x, opts.y + p.y);\n\t\t\tfor (n = 1; n < tri.length; n++) {\n\t\t\t\tp = points[tri[n]];\n\t\t\t\tctx.lineTo(opts.x + p.x, opts.y + p.y);\n\t\t\t}\n\t\t\tctx.closePath();\n\t\t\tctx.fill();\n\t\t}\n\t}\n}\n\n/**\r\n *\r\n */\nfunction applyModifier(points, modifier) {\n\tvar newPoints = [];\n\tvar n = points.length;\n\twhile (n--) {\n\t\tvar newP = _extends({}, points[n]);\n\t\tmodifier(newP);\n\t\tnewPoints.push(newP);\n\t}\n\treturn newPoints;\n}\n\n/**\r\n * @param {object} opts\r\n */\nfunction orderTriangleList() {\n\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\tvar tris = [];\n\tif (opts.format === \"quads\") {\n\t\tvar n = Math.floor(opts.points.length / 4);\n\t\tvar o = 0;\n\t\twhile (n--) {\n\t\t\ttris.push([o + 0, o + 1, o + 2], [o + 2, o + 3, o + 0]);\n\t\t\to += 4;\n\t\t}\n\t}\n\treturn tris;\n}\n\n/**\r\n * @param {object} opts\r\n * @return {Array}\r\n */\nfunction orderQuadList() {\n\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\tvar tris = [];\n\tvar n = Math.floor(opts.points.length / 4);\n\tvar o = 0;\n\twhile (n--) {\n\t\ttris.push([o++, o++, o++, o++]);\n\t}\n\treturn tris;\n}\n\n_generator2.default.classStaticMatch(Primitive);\n\nexports.default = Primitive;\n\n/***/ }),\n/* 24 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _generator = __webpack_require__(1);\n\nvar _generator2 = _interopRequireDefault(_generator);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/** */\nvar Vector2 = function () {\n\n\t/** */\n\tfunction Vector2(x, y) {\n\t\t_classCallCheck(this, Vector2);\n\n\t\tthis.set(x, y);\n\t}\n\n\t/** */\n\n\n\tVector2.prototype.set = function set(x, y) {\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t};\n\n\t/** */\n\n\n\tVector2.prototype.copy = function copy(v) {\n\t\tthis.x = v.x;\n\t\tthis.y = v.y;\n\t};\n\n\t/** */\n\n\n\tVector2.prototype.add = function add(v) {\n\t\tthis.x += v.x;\n\t\tthis.y += v.y;\n\t};\n\n\t/** */\n\n\n\tVector2.prototype.mul = function mul(v) {\n\t\tthis.x *= v.x;\n\t\tthis.y *= v.y;\n\t};\n\n\t/** */\n\n\n\tVector2.prototype.div = function div(v) {\n\t\tthis.x /= v.x;\n\t\tthis.y /= v.y;\n\t};\n\n\treturn Vector2;\n}();\n\n_generator2.default.classStaticMatch(Vector2);\n\nexports.default = Vector2;\n\n/***/ }),\n/* 25 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\nexports.Vector2 = exports.Grid = exports.Font = exports.Transition = exports.tween = exports.math = exports.main = exports.draw = exports.instance = exports.action = exports.event = exports.object = exports.Script = exports.Sound = exports.sprite = exports.input = exports.Room = exports.Camera = exports.canvas = exports.App = undefined;\n\nvar _App = __webpack_require__(15);\n\nvar _App2 = _interopRequireDefault(_App);\n\nvar _main = __webpack_require__(17);\n\nvar _main2 = _interopRequireDefault(_main);\n\nvar _Canvas = __webpack_require__(2);\n\nvar _Canvas2 = _interopRequireDefault(_Canvas);\n\nvar _camera = __webpack_require__(14);\n\nvar _camera2 = _interopRequireDefault(_camera);\n\nvar _room = __webpack_require__(7);\n\nvar _room2 = _interopRequireDefault(_room);\n\nvar _input = __webpack_require__(9);\n\nvar _input2 = _interopRequireDefault(_input);\n\nvar _Script = __webpack_require__(28);\n\nvar _Script2 = _interopRequireDefault(_Script);\n\nvar _sprite = __webpack_require__(3);\n\nvar _sprite2 = _interopRequireDefault(_sprite);\n\nvar _Sound = __webpack_require__(21);\n\nvar _Sound2 = _interopRequireDefault(_Sound);\n\nvar _object = __webpack_require__(13);\n\nvar _object2 = _interopRequireDefault(_object);\n\nvar _event = __webpack_require__(19);\n\nvar _event2 = _interopRequireDefault(_event);\n\nvar _action = __webpack_require__(29);\n\nvar action = _interopRequireWildcard(_action);\n\nvar _instance = __webpack_require__(4);\n\nvar _instance2 = _interopRequireDefault(_instance);\n\nvar _draw = __webpack_require__(0);\n\nvar _draw2 = _interopRequireDefault(_draw);\n\nvar _math = __webpack_require__(5);\n\nvar _math2 = _interopRequireDefault(_math);\n\nvar _tween = __webpack_require__(22);\n\nvar _tween2 = _interopRequireDefault(_tween);\n\nvar _transition = __webpack_require__(8);\n\nvar _transition2 = _interopRequireDefault(_transition);\n\nvar _primitive = __webpack_require__(23);\n\nvar _primitive2 = _interopRequireDefault(_primitive);\n\nvar _font = __webpack_require__(11);\n\nvar _font2 = _interopRequireDefault(_font);\n\nvar _grid = __webpack_require__(6);\n\nvar _grid2 = _interopRequireDefault(_grid);\n\nvar _Vector = __webpack_require__(24);\n\nvar _Vector2 = _interopRequireDefault(_Vector);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.App = _App2.default;\nexports.canvas = _Canvas2.default;\nexports.Camera = _camera2.default;\nexports.Room = _room2.default;\nexports.input = _input2.default;\nexports.sprite = _sprite2.default;\nexports.Sound = _Sound2.default;\nexports.Script = _Script2.default;\nexports.object = _object2.default;\nexports.event = _event2.default;\nexports.action = action;\nexports.instance = _instance2.default;\nexports.draw = _draw2.default;\nexports.main = _main2.default;\nexports.math = _math2.default;\nexports.tween = _tween2.default;\nexports.Transition = _transition2.default;\nexports.Font = _font2.default;\nexports.Grid = _grid2.default;\nexports.Vector2 = _Vector2.default;\n\n/***/ }),\n/* 26 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _draw = __webpack_require__(0);\n\nvar _draw2 = _interopRequireDefault(_draw);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * @param {number} x1\n * @param {number} y1\n * @param {number} x2\n * @param {number} y2\n * @param {Object} [opts={}]\n * @return {void}\n */\nfunction line(x1, y1, x2, y2) {\n\tvar opts = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n\n\tvar ctx = _draw2.default.context;\n\tctx.strokeStyle = opts.color || _draw2.default.color;\n\tctx.beginPath();\n\tctx.moveTo(x1, y1);\n\tctx.lineTo(x2, y2);\n\tctx.stroke();\n}\n\n/**\n * @param {number} x1\n * @param {number} y1\n * @param {number} x2\n * @param {number} y2\n * @param {Object} [opts={}]\n * @return {void}\n */\nfunction ellipse(x, y, xr, yr) {\n\tvar opts = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n\n\n\t//\n\tvar ctx = _draw2.default.context;\n\tctx.save();\n\tctx.beginPath();\n\tctx.translate(x - xr, y - yr);\n\tctx.scale(xr, yr);\n\tctx.arc(1, 1, 1, 0, 2 * Math.PI, false);\n\tctx.restore();\n\n\t//\n\tvar style = void 0;\n\tif (opts.healthbar) {\n\t\tvar amount = opts.healthbar.amount || 1;\n\t\tvar color = opts.healthbar.color || \"#0F0\";\n\t\tvar background = opts.healthbar.background || \"#F00\";\n\t\tstyle = ctx.createLinearGradient(x - xr, 0, x + xr, 0);\n\t\tstyle.addColorStop(0, color);\n\t\tstyle.addColorStop(amount, color);\n\t\tstyle.addColorStop(amount, background);\n\t\tstyle.addColorStop(1, background);\n\t} else {\n\t\tstyle = opts.color || _draw2.default.color;\n\t}\n\n\t//\n\tif (opts.fill || !opts.fill && !opts.stroke) {\n\t\tctx.fillStyle = style;\n\t\tctx.fill();\n\t}\n\n\tif (opts.stroke) {\n\t\tctx.strokeStyle = style;\n\t\tctx.lineWidth = opts.lineWidth || 1;\n\t\tctx.stroke();\n\t}\n}\n\n/**\n * @param {number} x\n * @param {number} y\n * @param {number} w\n * @param {number} h\n * @param {Object} [opts={}]\n * @return {void}\n */\nfunction rectangle(x, y, w, h) {\n\tvar opts = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n\n\n\t//\n\tvar ctx = _draw2.default.context;\n\tctx.beginPath();\n\tctx.rect(x, y, w, h);\n\n\t//\n\tvar style = void 0;\n\tif (opts.healthbar) {\n\t\tvar amount = opts.healthbar.amount || 1;\n\t\tvar color = opts.healthbar.color || \"#0F0\";\n\t\tvar background = opts.healthbar.background || \"#F00\";\n\t\tstyle = ctx.createLinearGradient(x, 0, x + w, 0);\n\t\tstyle.addColorStop(0, color);\n\t\tstyle.addColorStop(amount, color);\n\t\tstyle.addColorStop(amount, background);\n\t\tstyle.addColorStop(1, background);\n\t} else {\n\t\tstyle = opts.color || _draw2.default.color;\n\t}\n\n\t//\n\tif (opts.fill || !opts.fill && !opts.stroke) {\n\t\tctx.fillStyle = style;\n\t\tctx.fill();\n\t}\n\n\tif (opts.stroke) {\n\t\tctx.strokeStyle = style;\n\t\tctx.lineWidth = opts.lineWidth || 1;\n\t\tctx.stroke();\n\t}\n}\n\n//\nexports.default = { line: line, ellipse: ellipse, rectangle: rectangle };\n\n/***/ }),\n/* 27 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _math = __webpack_require__(5);\n\nvar _math2 = _interopRequireDefault(_math);\n\nvar _instance = __webpack_require__(4);\n\nvar _instance2 = _interopRequireDefault(_instance);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//\nvar basic = JSON.stringify({\n\tsprite: null,\n\tindex: 0,\n\timageSpeed: 1,\n\tanimationBehavior: \"loop\",\n\tvisible: true,\n\tsolid: false,\n\tpersistent: false,\n\texists: true,\n\tscaleX: 1,\n\tscaleY: 1,\n\trotation: 0,\n\tterminal: 100,\n\tgravity: 0,\n\tgravityDirection: 0,\n\tspeedX: 0,\n\tspeedY: 0,\n\tboxTop: 0,\n\tboxBottom: 0,\n\tboxLeft: 0,\n\tboxRight: 0,\n\tbehaviours: [],\n\tlisteners: [],\n\tevents: {},\n\tboxCollision: {\n\t\tx: 0,\n\t\ty: 0,\n\t\twidth: 0,\n\t\theight: 0,\n\t\ttop: 0,\n\t\tbottom: 0,\n\t\tleft: 0,\n\t\tright: 0\n\t},\n\t_depth: 0\n});\n\n//\nvar ObjectVars = {\n\n\t/**\r\n  *\r\n  */\n\tset: function set(proto) {\n\t\t_extends(proto, JSON.parse(basic));\n\n\t\tproto.nearest = function (obj) {\n\t\t\treturn _instance2.default.nearest(this.x, this.y, obj);\n\t\t};\n\n\t\tproto.furthest = function (obj) {\n\t\t\treturn _instance2.default.furthest(this.x, this.y, obj);\n\t\t};\n\n\t\tproto.moveTowardsPoint = function (x, y, spd) {\n\t\t\t_instance2.default.moveTowardsPoint(this, x, y, spd);\n\t\t};\n\n\t\tproto.stepTowardsPoint = function (x, y, spd) {\n\t\t\t_instance2.default.stepTowardsPoint(this, x, y, spd);\n\t\t};\n\n\t\tproto.distanceToPoint = function (x, y) {\n\t\t\treturn _instance2.default.distanceToPoint(this, x, y);\n\t\t};\n\n\t\tproto.destroy = function () {\n\t\t\t_instance2.default.destroy(this);\n\t\t};\n\n\t\tproto.mouseOn = function () {\n\t\t\treturn _instance2.default.mouseOn(this);\n\t\t};\n\n\t\tObject.defineProperty(proto, \"depth\", {\n\t\t\tset: function set(x) {\n\t\t\t\tif (this._depth !== x) {\n\t\t\t\t\tthis._depth = x;\n\t\t\t\t\t_instance2.default.doDepthSort = true;\n\t\t\t\t}\n\t\t\t},\n\t\t\tget: function get() {\n\t\t\t\treturn this._depth;\n\t\t\t}\n\t\t});\n\n\t\tObject.defineProperty(proto, \"speed\", {\n\t\t\tset: function set(x) {\n\t\t\t\tvar y = this.direction * _math2.default.DEGTORAD;\n\t\t\t\tthis.speedX = Math.cos(y) * x;\n\t\t\t\tthis.speedY = Math.sin(y) * x;\n\t\t\t},\n\t\t\tget: function get(x) {\n\t\t\t\treturn _math2.default.pointDistance(0, 0, this.speedX, this.speedY);\n\t\t\t}\n\t\t});\n\n\t\tObject.defineProperty(proto, \"direction\", {\n\t\t\tset: function set(x) {\n\t\t\t\tvar y = this.speed;\n\t\t\t\tthis.speedX = Math.cos(x * _math2.default.DEGTORAD) * y;\n\t\t\t\tthis.speedY = Math.sin(x * _math2.default.DEGTORAD) * y;\n\t\t\t},\n\t\t\tget: function get(x) {\n\t\t\t\treturn _math2.default.pointDirection(0, 0, this.speedX, this.speedY);\n\t\t\t}\n\t\t});\n\t}\n\n\t//\n};exports.default = ObjectVars;\n\n/***/ }),\n/* 28 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n *\r\n */\nvar Script = function Script() {\n  _classCallCheck(this, Script);\n};\n\nexports.default = Script;\n\n\nScript.names = [];\n\n/***/ }),\n/* 29 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\nexports.GAME = exports.confirm = exports.alert = exports.message = exports.script = exports.func = exports.confine = exports.wrap = exports.actionConfine = exports.actionWrap = exports.moveReverseY = exports.moveReverseX = exports.moveSpeedY = exports.moveSpeedX = exports.moveDirect = exports.moveFree = exports.jumpRandom = exports.jump = exports.setGravity = exports.test = exports.get = exports.set = exports.exitEvent = exports.ifElse = exports.blockEnd = exports.blockBegin = exports.roomPrevious = exports.roomNext = exports.roomEnter = exports.drawSprite = exports.instanceDrawSelf = exports.drawSelf = exports.drawRectangle = exports.drawText = exports.drawSetFontSize = exports.drawSetFont = exports.drawSetColor = exports.soundStop = exports.soundPlay = exports.instanceChangeSprite = exports.changeSprite = exports.instanceSetDirection = exports.instanceSetRotation = exports.instanceDestroy = exports.instanceCreateMoving = exports.instanceCreate = undefined;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _room = __webpack_require__(7);\n\nvar _room2 = _interopRequireDefault(_room);\n\nvar _Sound = __webpack_require__(21);\n\nvar _Sound2 = _interopRequireDefault(_Sound);\n\nvar _draw = __webpack_require__(0);\n\nvar _draw2 = _interopRequireDefault(_draw);\n\nvar _instance = __webpack_require__(4);\n\nvar _instance2 = _interopRequireDefault(_instance);\n\nvar _input = __webpack_require__(9);\n\nvar _input2 = _interopRequireDefault(_input);\n\nvar _math = __webpack_require__(5);\n\nvar _math2 = _interopRequireDefault(_math);\n\nvar _sprite = __webpack_require__(3);\n\nvar _sprite2 = _interopRequireDefault(_sprite);\n\nvar _Canvas = __webpack_require__(2);\n\nvar _Canvas2 = _interopRequireDefault(_Canvas);\n\nvar _Color = __webpack_require__(10);\n\nvar _Color2 = _interopRequireDefault(_Color);\n\nvar _main = __webpack_require__(17);\n\nvar _main2 = _interopRequireDefault(_main);\n\nvar _camera = __webpack_require__(14);\n\nvar _camera2 = _interopRequireDefault(_camera);\n\nvar _App = __webpack_require__(15);\n\nvar _App2 = _interopRequireDefault(_App);\n\nvar _grid = __webpack_require__(6);\n\nvar _grid2 = _interopRequireDefault(_grid);\n\nvar _tilemap = __webpack_require__(30);\n\nvar _tilemap2 = _interopRequireDefault(_tilemap);\n\nvar _tween = __webpack_require__(22);\n\nvar _tween2 = _interopRequireDefault(_tween);\n\nvar _transition = __webpack_require__(8);\n\nvar _transition2 = _interopRequireDefault(_transition);\n\nvar _font = __webpack_require__(11);\n\nvar _font2 = _interopRequireDefault(_font);\n\nvar _object = __webpack_require__(13);\n\nvar _object2 = _interopRequireDefault(_object);\n\nvar _primitive = __webpack_require__(23);\n\nvar _primitive2 = _interopRequireDefault(_primitive);\n\nvar _Vector = __webpack_require__(24);\n\nvar _Vector2 = _interopRequireDefault(_Vector);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\r\n * Set the variable with the given name.\r\n * @param {string} varName\r\n * @param {*} value\r\n * @param {boolean} relative\r\n * @param {boolean} global\r\n * @return {void}\r\n */\nfunction set(varName, value, relative, global) {\n\tvar target = global ? window.global : this;\n\tif (relative) {\n\t\ttarget[varName] += value;\n\t} else {\n\t\ttarget[varName] = value;\n\t}\n}\n\n/**\r\n * @param {string} varName\r\n * @param {string} op Operation.\r\n * @param {value} value Value to check against.\r\n * @param {boolean} global\r\n * @return {boolean}\r\n */\nfunction test(varName, op, value, global) {\n\tvar target = global ? window.global : this;\n\tswitch (op) {\n\t\tcase \"!==\":\n\t\t\treturn target[varName] !== value;\n\t\tcase \"===\":\n\t\t\treturn target[varName] === value;\n\t\tcase \"!=\":\n\t\t\treturn target[varName] != value;\n\t\tcase \"==\":\n\t\t\treturn target[varName] == value;\n\t\tcase \"<\":\n\t\t\treturn target[varName] < value;\n\t\tcase \">\":\n\t\t\treturn target[varName] > value;\n\t\tcase \"<=\":\n\t\t\treturn target[varName] <= value;\n\t\tcase \">=\":\n\t\t\treturn target[varName] >= value;\n\t\tdefault:\n\t\t\treturn false;\n\t}\n}\n\n/**\r\n * Sets the instance's gravity to the given value.\r\n * @param {number} value The gravity strength.\r\n * @return {void}\r\n */\nfunction setGravity(value) {\n\tthis.gravity = value;\n}\n\n/**\r\n * Instantly sets the instance's x and y values to a random position within\r\n * the current room.\r\n * @param {number} x\r\n * @param {number} y\r\n * @param {boolean} relative\r\n * @return {void}\r\n */\nfunction jump(x, y, relative) {\n\tif (relative) {\n\t\tthis.x += Number(x);\n\t\tthis.y += Number(y);\n\t} else {\n\t\tthis.x = Number(x);\n\t\tthis.y = Number(y);\n\t}\n}\n\n/**\r\n * Instantly sets the instance's x and y values to a random position within\r\n * the current room.\r\n * @return {void}\r\n */\nfunction jumpRandom() {\n\tvar x1 = 0,\n\t    y1 = 0,\n\t    x2 = 640,\n\t    y2 = 480;\n\tthis.x = Math.floor(Math.random() * (x2 - x1 + 1)) + x1;\n\tthis.y = Math.floor(Math.random() * (y2 - y1 + 1)) + y1;\n}\n\n/**\r\n * @param {number} speed\r\n * @param {number} direction\r\n * @return {void}\r\n */\nfunction moveFree(speed, direction) {\n\tthis.speed = speed;\n\tthis.direction = direction;\n}\n\n/**\r\n * Instantly sets the instance's x and y values to a random position within\r\n * the current room.\r\n * @param {number} x\r\n * @param {number} y\r\n * @return {void}\r\n */\nfunction moveDirect(x, y) {\n\tthis.x += x * _main2.default.dt;\n\tthis.y += y * _main2.default.dt;\n}\n\n/**\r\n * @param  {type} speed\r\n * @return {void}\r\n */\nfunction moveSpeedX(speed) {\n\tthis.speedX = Number(speed);\n}\n\n/**\r\n * @param  {type} speed\r\n * @return {void}\r\n */\nfunction moveSpeedY(speed) {\n\tthis.speedY = Number(speed);\n}\n\n/**\r\n * @return {void}\r\n */\nfunction moveReverseX() {\n\tthis.speedX = -this.speedX;\n}\n\n/**\r\n * @return {void}\r\n */\nfunction moveReverseY() {\n\tthis.speedY = -this.speedY;\n}\n\n/**\r\n * Wraps the instance back into the room when it leaves.\r\n * @return {void}\r\n */\nfunction actionWrap() {\n\tvar width = this.boxRight - this.boxLeft;\n\tvar height = this.boxBottom - this.boxTop;\n\tvar thisRoom = _room2.default.current;\n\tvar roomW = thisRoom.width;\n\tvar roomH = thisRoom.height;\n\tif (this.boxRight < 0) this.x += roomW + width;\n\tif (this.boxBottom < 0) this.y += roomH + height;\n\tif (this.boxLeft > roomW) this.x -= roomW + width;\n\tif (this.boxTop > roomH) this.y -= roomH + height;\n}\n\n/**\r\n * Wraps the instance back into the room when it leaves.\r\n * @return {void}\r\n */\nfunction actionConfine() {\n\tvar width = this.boxRight - this.boxLeft;\n\tvar height = this.boxBottom - this.boxTop;\n\tvar thisRoom = _room2.default.current;\n\tvar roomW = thisRoom.width;\n\tvar roomH = thisRoom.height;\n\tif (this.boxLeft < 0) this.x = this.x - this.boxLeft;\n\tif (this.boxTop < 0) this.y = this.y - this.boxTop;\n\tif (this.boxRight > roomW) this.x = roomW - width + this.x - this.boxLeft;\n\tif (this.boxBottom > roomH) this.y = roomH - height + this.y - this.boxTop;\n}\n\n/**\r\n * Executes the given function with variable arguments on the instance.\r\n * @param {function} func\r\n * @param {...*} args\r\n * @return {void}\r\n */\nfunction actionFunc(func) {\n\tfor (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n\t\targs[_key - 1] = arguments[_key];\n\t}\n\n\tfunc.apply(this, args);\n}\n\n/**\r\n * Executes the given Script with an array of arguments.\r\n * @param {script} func\r\n * @param {array} args\r\n * @return {void}\r\n */\nfunction script(s, args) {\n\tif (typeof s === \"string\") {\n\t\twindow[s].apply(this, args);\n\t} else {\n\t\ts.apply(this, args);\n\t}\n}\n\n/**\r\n * Shows the value of the given variable of the instance, in the console.\r\n * @param {...*} args\r\n * @return {void}\r\n */\nfunction get() {\n\tfor (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n\t\targs[_key2] = arguments[_key2];\n\t}\n\n\tconsole.log(this[args].toFixed(2));\n}\n\n// Fucntions for use in code.\nvar GAME = {\n\tApp: _App2.default,\n\tCamera: _camera2.default,\n\tCanvas: _Canvas2.default,\n\tColor: _Color2.default,\n\tmain: {\n\t\tsetGameSpeed: _main2.default.setGameSpeed\n\t},\n\tinstance: _instance2.default,\n\tdraw: _extends(_draw2.default, {\n\t\tself: _instance2.default.drawSelf,\n\t\tdebug: _instance2.default.drawDebug\n\t}),\n\tRoom: _room2.default,\n\tsprite: _sprite2.default,\n\tSound: _Sound2.default,\n\tinput: {\n\t\tkeyboard: _input2.default.keyboard,\n\t\tmouse: _input2.default.mouse,\n\t\ttouch: _input2.default.touch\n\t},\n\tmath: _math2.default,\n\tFont: _font2.default,\n\tGrid: _grid2.default,\n\tTilemap: _tilemap2.default,\n\ttween: _tween2.default,\n\tTransition: _transition2.default,\n\tObject: _object2.default,\n\tPrimitive: _primitive2.default,\n\tVector2: _Vector2.default\n\n\t//\n};var blockBegin = \"blockBegin\",\n    blockEnd = \"blockEnd\",\n    exitEvent = \"exitEvent\",\n    ifElse = \"ifElse\",\n    roomEnter = _room2.default.enter,\n    roomNext = _room2.default.next,\n    roomPrevious = _room2.default.previous,\n    instanceCreate = _instance2.default.create,\n    instanceCreateMoving = _instance2.default.createMoving,\n    instanceDestroy = _instance2.default.destroy,\n    changeSprite = _instance2.default.changeSprite,\n    instanceSetRotation = _instance2.default.setRotation,\n    instanceSetDirection = _instance2.default.setDirection,\n    message = function message(args) {\n\treturn console.log(args);\n},\n    alert = function alert(m) {\n\twindow.alert(m);\n},\n    confirm = function confirm(m) {\n\treturn window.confirm(m);\n},\n    drawSetColor = _draw2.default.setColor,\n    drawSetFont = _draw2.default.setFont,\n    drawSetFontSize = _draw2.default.setFontSize,\n    drawText = _draw2.default.text,\n    drawRectangle = _draw2.default.shape.rectangle,\n    drawSelf = _instance2.default.drawSelf,\n    drawSprite = _draw2.default.sprite,\n    soundPlay = function soundPlay(snd, loop) {\n\t_Sound2.default.play(snd, { loop: loop });\n},\n    soundStop = _Sound2.default.stop;\n\n//\nexports.instanceCreate = instanceCreate;\nexports.instanceCreateMoving = instanceCreateMoving;\nexports.instanceDestroy = instanceDestroy;\nexports.instanceSetRotation = instanceSetRotation;\nexports.instanceSetDirection = instanceSetDirection;\nexports.changeSprite = changeSprite;\nexports.instanceChangeSprite = changeSprite;\nexports.soundPlay = soundPlay;\nexports.soundStop = soundStop;\nexports.drawSetColor = drawSetColor;\nexports.drawSetFont = drawSetFont;\nexports.drawSetFontSize = drawSetFontSize;\nexports.drawText = drawText;\nexports.drawRectangle = drawRectangle;\nexports.drawSelf = drawSelf;\nexports.instanceDrawSelf = drawSelf;\nexports.drawSprite = drawSprite;\nexports.roomEnter = roomEnter;\nexports.roomNext = roomNext;\nexports.roomPrevious = roomPrevious;\nexports.blockBegin = blockBegin;\nexports.blockEnd = blockEnd;\nexports.ifElse = ifElse;\nexports.exitEvent = exitEvent;\nexports.set = set;\nexports.get = get;\nexports.test = test;\nexports.setGravity = setGravity;\nexports.jump = jump;\nexports.jumpRandom = jumpRandom;\nexports.moveFree = moveFree;\nexports.moveDirect = moveDirect;\nexports.moveSpeedX = moveSpeedX;\nexports.moveSpeedY = moveSpeedY;\nexports.moveReverseX = moveReverseX;\nexports.moveReverseY = moveReverseY;\nexports.actionWrap = actionWrap;\nexports.actionConfine = actionConfine;\nexports.wrap = actionWrap;\nexports.confine = actionConfine;\nexports.func = actionFunc;\nexports.script = script;\nexports.message = message;\nexports.alert = alert;\nexports.confirm = confirm;\nexports.GAME = GAME;\n\n/***/ }),\n/* 30 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _generator = __webpack_require__(1);\n\nvar _generator2 = _interopRequireDefault(_generator);\n\nvar _grid = __webpack_require__(6);\n\nvar _grid2 = _interopRequireDefault(_grid);\n\nvar _draw = __webpack_require__(0);\n\nvar _draw2 = _interopRequireDefault(_draw);\n\nvar _sprite = __webpack_require__(3);\n\nvar _sprite2 = _interopRequireDefault(_sprite);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n * @author Jack Oatley\r\n */\nvar Tilemap = function () {\n\n\t/**\r\n  * @param {Object} [opts={}] Options object to define the Tilemap.\r\n  * @param {Object} [opts.atlas]\r\n  * @param {number} [opts.tileWidth]\r\n  * @param {number} [opts.tileHeight]\r\n  * @param {number} [opts.tileSpacing]\r\n  * @param {number} [opts.tileOverlay]\r\n  * @param {number} [opts.tilesWide]\r\n  * @param {number} [opts.mapWidth]\r\n  * @param {number} [opts.mapHeight]\r\n  */\n\tfunction Tilemap() {\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\t\t_classCallCheck(this, Tilemap);\n\n\t\tthis.textureAtlas = opts.atlas || null;\n\t\tthis.tileWidth = opts.tileWidth || 16;\n\t\tthis.tileHeight = opts.tileHeight || 16;\n\t\tthis.tileSpacing = opts.tileSpacing || 0;\n\t\tthis.tileOverlay = opts.tileOverlay || 0;\n\t\tthis.tilesWide = opts.tilesWide || 16;\n\t\tthis.mapWidth = opts.mapWidth || 16;\n\t\tthis.mapHeight = opts.mapHeight || 16;\n\t\tthis.layers = {};\n\n\t\tthis.__gap = this.tileSpacing + this.tileOverlay;\n\t\tif (this.textureAtlas) this.__atlas = _sprite2.default.get(this.textureAtlas).images[0].img;\n\t}\n\n\t/**\r\n  * @param {string} layer Name of the player in which to place the tile.\r\n  * @param {number} x The X grid position to place this tile.\r\n  * @param {number} y The Y grid position to place this tile.\r\n  * @param {number} index The tile index.\r\n  * @return {void}\r\n  */\n\n\n\tTilemap.prototype.set = function set(layer, x, y, index) {\n\t\tif (!this.layers[layer]) {\n\t\t\tthis.layers[layer] = new _grid2.default(this.mapWidth, this.mapHeight);\n\t\t}\n\t\tthis.layers[layer].set(x, y, index);\n\t};\n\n\t/**\r\n  * @param {Object} [opts={}]\r\n  * @param {Array} [opts.order]\r\n  * @param {number} [opts.left]\r\n  * @param {number} [opts.top]\r\n  * @param {number} [opts.right]\r\n  * @param {number} [opts.bottom]\r\n  * @return {void}\r\n  */\n\n\n\tTilemap.prototype.draw = function draw(opts) {\n\t\tvar atlas = this.__atlas;\n\t\tvar tw = this.tileWidth;\n\t\tvar th = this.tileHeight;\n\t\tvar tsw = this.tilesWide;\n\t\tvar gap = this.__gap;\n\t\tvar overlay = this.tileOverlay;\n\t\tvar renderWidth = tw + overlay * 2;\n\t\tvar renderHeight = th + overlay * 2;\n\t\tvar order = opts.order || Object.keys(this.layers);\n\t\tvar startX = ~~Math.max(0, (opts.left || 0) / tw);\n\t\tvar startY = ~~Math.max(0, (opts.top || 0) / th);\n\t\tvar endX = Math.ceil(Math.min(this.mapWidth, (opts.right || 0) / tw));\n\t\tvar endY = Math.ceil(Math.min(this.mapHeight, (opts.bottom || 0) / th));\n\t\tvar x, y, n, layer, tile, iX, iY;\n\t\tfor (n = 0; n < order.length; n++) {\n\t\t\tlayer = this.layers[order[n]];\n\t\t\tfor (x = startX; x < endX; x++) {\n\t\t\t\tfor (y = startY; y < endY; y++) {\n\t\t\t\t\ttile = layer.get(x, y) - 1;\n\t\t\t\t\tif (tile >= 0) {\n\t\t\t\t\t\tiX = tile % tsw * (tw + gap * 2) + gap;;\n\t\t\t\t\t\tiY = ~~(tile / tsw) * (th + gap * 2) + gap;\n\t\t\t\t\t\t_draw2.default.context.drawImage(atlas, iX - overlay, iY - overlay, renderWidth, renderHeight, x * tw - overlay, // target x\n\t\t\t\t\t\ty * th - overlay, // target y\n\t\t\t\t\t\trenderWidth, renderHeight);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\treturn Tilemap;\n}();\n\n// Static methods, created via the Generator class\n\n\n_generator2.default.classStaticMatch(Tilemap);\nTilemap.prototype.assetType = \"tilemap\";\n\nexports.default = Tilemap;\n\n/***/ })\n/******/ ]);\n});\n\n\n// WEBPACK FOOTER //\n// GameBeans.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 25);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 7742389b5a415bc76a5b","import math from \"./math\";\r\nimport sprite from \"./sprite\";\r\nimport canvas from \"./Canvas\";\r\nimport Font from \"./font\";\r\nimport Color from \"./Color\";\r\nimport DrawShapes from \"./drawing/DrawShapes\";\r\n\r\n//\r\nclass Draw {\r\n\r\n\t/** */\r\n\tstatic setTarget(target) {\r\n\t\tDraw.targetStack.push(Draw.target);\r\n\t\tDraw.target = target;\r\n\t\tDraw.context = target.context;\r\n\t}\r\n\r\n\t/** */\r\n\tstatic resetTarget() {\r\n\t\tlet target = Draw.targetStack.pop();\r\n\t\tDraw.target = target;\r\n\t\tDraw.context = target.context;\r\n\t}\r\n\r\n\t/** */\r\n\tstatic getTarget() {\r\n\t\treturn Draw.target;\r\n\t}\r\n\r\n\t/** */\r\n\tstatic clear(col) {\r\n\t\tcanvas.fill(Draw.target, col);\r\n\t}\r\n\r\n\t/** */\r\n\tstatic save() {\r\n\t\tDraw.context.save();\r\n\t}\r\n\r\n\t/** */\r\n\tstatic restore() {\r\n\t\tDraw.context.restore();\r\n\t}\r\n\r\n\t/** */\r\n\tstatic reset() {\r\n\t\tDraw.context.imageSmoothingEnabled = Draw.imageSmoothing;\r\n\t\tDraw.context.globalAlpha = 1;\r\n\t\tif (Draw.context instanceof CanvasRenderingContext2D) {\r\n\t\t\tDraw.context.setTransform.apply(Draw.context, Draw.defaultTransform);\r\n\t\t}\r\n\t}\r\n\r\n\t/** */\r\n\tstatic setImageSmoothing(enable) {\r\n\t\tDraw.imageSmoothing = enable;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {*} c Can be a number, a hex-value or an object containing R,\r\n\t * G, B and optionally A properties or H, S, L and optionally A properties.\r\n\t * @return {void}\r\n\t */\r\n\tstatic setColor(c) {\r\n\r\n\t\t// quick exit if c is already a CSS color value\r\n\t\tif (typeof c === \"string\") {\r\n\t\t\tDraw.color = c;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// RGB / RGBA\r\n\t\tif (\"r\" in c && \"g\" in c && \"b\" in c) {\r\n\t\t\tvar a = \"a\" in c ? c.a : 1;\r\n\t\t\tDraw.color = \"rgba(\"+c.r+\",\"+c.g+\",\"+c.b+\",\"+a+\")\";\r\n\t\t}\r\n\r\n\t\t// HSL / HSLA\r\n\t\telse if (\"h\" in c && \"s\" in c && \"l\" in c) {\r\n\t\t\tvar a = \"a\" in c ? c.a : 1;\r\n\t\t\tDraw.color = \"hsla(\"+c.r+\",\"+c.g+\",\"+c.b+\",\"+a+\")\";\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Draws the sprite at the given x, y position.\r\n\t * @param {Object} sprite\r\n\t * @param {number} index\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @param {number} scaleX\r\n\t * @param {number} scaleY\r\n\t * @param {number} rotation\r\n\t * @param {Object} [opts={}]\r\n\t * @param {number} [originX] Overrides sprite's originX property.\r\n\t * @param {number} [originY] Overrides sprite's originY property.\r\n\t * @return {void}\r\n\t */\r\n\tstatic sprite(spr, index, x, y, scaleX, scaleY, rotation, opts = {}) {\r\n\r\n\t\tif (!spr) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar ctx = Draw.context;\r\n\t\tif (!(ctx instanceof CanvasRenderingContext2D)) {\r\n\t\t\twindow.addConsoleText(\"#F00\", \"Sprites are currently only supported in Canvas 2D!\");\r\n\t\t\twindow._GB_stop();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tspr = sprite.get(spr);\r\n\r\n\t\t//\r\n\t\tvar ox = (opts.originX !== undefined) ? opts.originX : spr.originX;\r\n\t\tvar oy = (opts.originY !== undefined) ? opts.originY : spr.originY;\r\n\r\n\t\t//\r\n\t\tctx.save();\r\n\t\tctx.translate(x, y);\r\n\t\tctx.rotate(rotation * math.DEGTORAD);\r\n\t\tctx.scale(scaleX, scaleY);\r\n\r\n\t\t//\r\n\t\tindex = Math.floor(index || 0) % spr.images.length;\r\n\r\n\t\t//\r\n\t\tlet frame = spr.images[index];\r\n\t\tlet img = frame.img;\r\n\t\tctx.drawImage(\r\n\t\t\timg, frame.clip.x, frame.clip.y,\r\n\t\t\tframe.clip.w, frame.clip.h,\r\n\t\t\t-ox, -oy,\r\n\t\t\tspr.width, spr.height\r\n\t\t);\r\n\r\n\t\t//\r\n\t\tctx.restore();\r\n\t}\r\n\r\n\t/**\r\n\t * Draws the sprite at the given x, y position.\r\n\t * @param {sprite} sprite\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @param {number} w\r\n\t * @param {number} h\r\n\t */\r\n\tstatic spriteTiled(spr, index, x, y, w, h) {\r\n\t\tspr = sprite.get(spr);\r\n\t\tlet dx, dy, rx, ry;\r\n\t\tfor (rx=0, dx=x; rx<w; rx++, dx+=spr.width)\r\n\t\tfor (ry=0, dy=y; ry<h; ry++, dy+=spr.height) {\r\n\t\t\tdrawSprite(spr, index, dx, dy, 1, 1, 0);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Draws a canvas at the given position.\r\n\t * @param {canvas} canvas The canvas to draw.\r\n\t * @param {number} x The X position to draw at.\r\n\t * @param {number} y The Y position to draw at.\r\n\t */\r\n\tstatic canvas(canv, x, y) {\r\n\t\tDraw.context.drawImage(canv.domElement, x, y);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} font\r\n\t * @param {number} size\r\n\t * @param {string} align Horizontal alignment.\r\n\t * @param {string} baseline Vertical alignment.\r\n\t * @return {void}\r\n\t */\r\n\tstatic setFont(font, size, align, baseline) {\r\n\t\tvar ctx = Draw.context;\r\n\t\tfont = typeof font === \"string\" ? font : font.name;\r\n\t\tDraw.font = font;\r\n\t\tDraw.fontSize = size || 16;\r\n\t\tctx.font = Draw.fontSize + \"px \" + font;\r\n\t\tctx.textAlign = Draw.textAlign = align || \"left\";\r\n\t\tctx.textBaseline = Draw.textBaseline = baseline || \"alphabetic\";\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} text\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @param {Object=} opts\r\n\t * @return {void}\r\n\t */\r\n\tstatic text(text, x, y, opts = {}) {\r\n\r\n\t\tx = Number(x);\r\n\t\ty = Number(y);\r\n\r\n\t\tlet drawSize, bitmap, lookup, scale, useBitmap = false;\r\n\t\tlet font = Font.get(Draw.font);\r\n\t\tif (font && font.method === \"bitmap\") {\r\n\r\n\t\t\tdrawSize = font.forceSize || Draw.fontSize;\r\n\t\t\tvar c = Color.hexToArray(Draw.color);\r\n\t\t\tvar key = \"\" + drawSize + c[0] + c[1] + c[2] + c[3];\r\n\r\n\t\t\tif (!font.bitmapFont[key]) {\r\n\t\t\t\tfont.convertToBitmapFont({\r\n\t\t\t\t\tsize: drawSize,\r\n\t\t\t\t\tcolor: c\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tuseBitmap = true;\r\n\t\t\tlookup = font.bitmapFont[key].lookup\r\n\t\t\tbitmap = font.bitmapFont[key].image;\r\n\t\t\tscale = Draw.fontSize / font.bitmapFont[key].size;\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tlet ctx = Draw.context;\r\n\t\tlet drawMethod = \"fillText\";\r\n\t\tif (opts.stroke) {\r\n\t\t\tctx.strokeStyle = opts.strokeColor || Draw.color;\r\n\t\t\tctx.lineWidth = opts.lineWidth || 2;\r\n\t\t\tdrawMethod = \"strokeText\";\r\n\t\t} else {\r\n\t\t\tctx.fillStyle = Draw.color;\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tlet lineLength;\r\n\t\tlet drawX = x;\r\n\t\tlet startN = 0;\r\n\t\tlet endN = text.toString().length;\r\n\t\t//if (opts.pattern) {\r\n\t\t\t//startN = opts.pattern.start;\r\n\t\t\t//endN = opts.pattern.end;\r\n\t\t//}\r\n\r\n\t\t//\r\n\t\tlet lineHeight = Draw.lineHeight || ctx.measureText(\"Mp\").width * 1.2;\r\n\t\tlet lines = text.toString().split(\"#\");\r\n\t\tfor (var i=0; i<lines.length; i++) {\r\n\r\n\t\t\tif (opts.maxWidth) {\r\n\t\t\t\tvar words = lines[i].split(' ');\r\n\t\t\t\tvar line = '';\r\n\r\n\t\t\t\tfor(var n=0; n<words.length; n++) {\r\n\r\n\t\t\t\t\tvar testLine = line + words[n] + ' ';\r\n\t\t\t\t\tvar metrics = ctx.measureText(testLine);\r\n\t\t\t\t\tvar testWidth = metrics.width;\r\n\t\t\t\t\tif (testWidth > opts.maxWidth && n > 0) {\r\n\r\n\t\t\t\t\t\tlet a = line.slice(0, startN);\r\n\t\t\t\t\t\tlet b = line.slice(startN, endN);\r\n\t\t\t\t\t\t//drawX += Draw.measureText(a).width;\r\n\t\t\t\t\t\tdrawX += ctx.measureText(a).width;\r\n\t\t\t\t\t\tif ( 0 < endN ) {\r\n\t\t\t\t\t\t\t_drawWord(drawX, y, b, lookup, ctx, useBitmap, bitmap, scale, drawMethod);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tlineLength = testLine.length;\r\n\t\t\t\t\t\tstartN -= lineLength;\r\n\t\t\t\t\t\tendN -= lineLength;\r\n\r\n\r\n\t\t\t\t\t\tline = words[n] + ' ';\r\n\t\t\t\t\t\ty += lineHeight;\r\n\t\t\t\t\t\tdrawX = x;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tline = testLine;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet a = line.slice(0, startN);\r\n\t\t\t\tlet b = line.slice(startN, endN);\r\n\t\t\t\tdrawX += ctx.measureText(a).width;\r\n\t\t\t\t_drawWord(drawX, y, b, lookup, ctx, useBitmap, bitmap, scale, drawMethod);\r\n\t\t\t\tlineLength = line.length;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tlet t = lines[i];\r\n\t\t\t\tif (useBitmap && ctx.textAlign === \"center\") {\r\n\t\t\t\t\tdrawX -= ctx.measureText(t).width / 2;\r\n\t\t\t\t}\r\n\t\t\t\t_drawWord(~~drawX, y, t, lookup, ctx, useBitmap, bitmap, scale, drawMethod);\r\n\r\n\t\t\t}\r\n\r\n\t\t\tdrawX = x;\r\n\t\t\ty += lineHeight;\r\n\r\n\t\t}\r\n\r\n\r\n\r\n\t}\r\n\r\n}\r\n\r\nDraw.color = \"#FFFFFF\";\r\nDraw.font = \"Arial\";\r\nDraw.fontSize = 30;\r\nDraw.lineHeight = 0;\r\nDraw.textAlign = \"start\";\r\nDraw.textBaseline = \"alphabetic\";\r\nDraw.target = null;\r\nDraw.context = null;\r\nDraw.defaultTransform = [1, 0, 0, 1, 0, 0];\r\nDraw.targetStack = [];\r\nDraw.imageSmoothing = false;\r\nDraw.offsetX = 0;\r\nDraw.offsetY = 0;\r\nDraw.shape = DrawShapes;\r\n\r\nDraw.transform = {\r\n\r\n\tscale: function(x, y) {\r\n\t\tDraw.context.scale(x, y);\r\n\t},\r\n\r\n\trotate: function(rot) {\r\n\t\tDraw.context.rotate(rot * math.DEGTORAD);\r\n\t},\r\n\r\n\ttranslate: function(x, y) {\r\n\t\tDraw.offsetX = x;\r\n\t\tDraw.offsetY = y;\r\n\t\tDraw.context.translate(x, y);\r\n\t}\r\n}\r\n\r\n/**\r\n *\r\n */\r\nfunction _drawWord(drawX, drawY, word, lookup, ctx, useBitmap, bitmap, scale, drawMethod) {\r\n\tif (useBitmap) {\r\n\t\tvar dx = ~~drawX;\r\n\t\tvar len = word.length;\r\n\t\tfor (var cn=0; cn<len; cn++) {\r\n\t\t\tvar metrics = lookup[word[cn]];\r\n\t\t\tif (!metrics) continue;\r\n\t\t\tvar sx = ~~metrics.left;\r\n\t\t\tvar sy = ~~metrics.top;\r\n\t\t\tvar sh = Math.ceil(metrics.bottom) - sy;\r\n\t\t\tvar sw = Math.ceil(metrics.right) - sx;\r\n\t\t\tctx.drawImage(bitmap, sx, sy, sw, sh, dx, drawY, sw*scale, sh*scale);\r\n\t\t\tdx += (sw + 1) * scale;\r\n\t\t}\r\n\t} else {\r\n\t\tctx[drawMethod](word, drawX, drawY);\r\n\t}\r\n}\r\n\r\n//\r\nexport default Draw;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/draw.js","/**\r\n * @author Jack Oatley\r\n */\r\nexport default class Generator {\r\n\t\r\n\t/**\r\n\t * If class has a static \"get\" method it is used in functions created from\r\n\t * prototype methods. If there is a \"get\" method on the prototype it is not\r\n\t * used in the created functions, however it will overide the static \"get\"\r\n\t * method. If there is both a static \"get\" method and a \"get\" method on the\r\n\t * prototype, the static one is used in created functions and remains so,\r\n\t * but the static method on the class is still overwritten.\r\n\t * @param {function} c Constructor function.\r\n\t */\r\n\tstatic classStaticMatch(c) {\r\n\t\tc.create = Generator.functionFromConstructor(c);\r\n\t\tconst get = c.get;\r\n\t\tfor (var m in c.prototype) {\r\n\t\t\tc[m] = Generator.functionFromMethod(c.prototype[m], get);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {function} c Constructor function.\r\n\t */\r\n\tstatic functionFromConstructor(c) {\r\n\t\treturn (...a) => new c(...a);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {function} m Prototype method.\r\n\t * @param {function} [get] Optional get function (static on the constructor.)\r\n\t */\r\n\tstatic functionFromMethod(m, get) {\r\n\t\tif (get)\r\n\t\t\treturn (s, ...a) => m.call(get(s), ...a);\r\n\t\telse\r\n\t\t\treturn (...a) => m.call(...a);\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {array} a An array of instances of constructor with the following method.\r\n\t * @param {function} m The method to execute for each instance in the array.\r\n\t */\r\n\tstatic arrayExecute(a, m) {\r\n\t\treturn (...p) => a.forEach(i => m.call(i, ...p));\r\n\t}\r\n\t\r\n}\n\n\n// WEBPACK FOOTER //\n// ./core/js/generator.js","import draw from \"./draw\";\r\nimport Generator from \"./generator\";\r\n\r\n/**\r\n *\r\n */\r\nclass Canvas {\r\n\r\n\t/**\r\n\t * @param {Object} [opts={}]\r\n\t * @param {bumber} [opts.width=300]\r\n\t * @param {bumber} [opts.height=150]\r\n\t * @param {bumber} [opts.scale=1]\r\n\t * @param {boolean} [opts.application=false]\r\n\t * @param {boolean} [opts.crisp2D=false]\r\n\t * @param {string} [opts.context=\"2d\"]\r\n\t */\r\n\tconstructor(opts = {}) {\r\n\t\tvar defaultContext = opts.context || \"2d\";\r\n\t\tvar c = document.createElement(\"CANVAS\");\r\n\t\tvar ctx = c.getContext(defaultContext);\r\n\t\tthis.domElement = c;\r\n\t\tthis.context = ctx;\r\n\t\tthis.width = this._width = opts.width || 300;\r\n\t\tthis.height = this._height = opts.height || 150;\r\n\r\n\t\t//\r\n\t\tc.scale = opts.scale || 1;\r\n\t\tc.application = opts.application || false;\r\n\r\n\t\t//\r\n\t\tif (opts.crisp2D) {\r\n\t\t\tctx.imageSmoothingEnabled = false;\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tif (c.application) {\r\n\t\t\tdraw.setTarget(this);\r\n\t\t\tCanvas.setMain(this);\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tc.oncontextmenu = function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tCanvas.array.push(this);\r\n\t}\r\n\r\n\tget width() {\r\n\t\treturn this._width;\r\n\t}\r\n\r\n\tset width(x) {\r\n\t\tthis._width = x;\r\n\t\tthis.domElement.width = x;\r\n\t}\r\n\r\n\tget height() {\r\n\t\treturn this._height;\r\n\t}\r\n\r\n\tset height(x) {\r\n\t\tthis._height = x;\r\n\t\tthis.domElement.height = x;\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the canvas as the main canvas for the game.\r\n\t * @return {void}\r\n\t */\r\n\tsetMain() {\r\n\t\tvar c = this.domElement;\r\n\t\tCanvas.main = this;\r\n\t\tif (Canvas.dom === null) {\r\n\t\t\tCanvas.dom = c;\r\n\t\t\tvar el = document.getElementById(\"gbgamebox\") || document.body;\r\n\t\t\tel.appendChild(c);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} [color=\"#000\"] CSS value as a string.\r\n\t * @return {void}\r\n\t */\r\n\tfill(color) {\r\n\t\tvar c = this.domElement;\r\n\t\tvar ctx = this.context;\r\n\t\tif (ctx instanceof CanvasRenderingContext2D) {\r\n\t\t\tctx.fillStyle = color || \"#000\";\r\n\t\t\tctx.fillRect(0, 0, c.width / c.scale, c.height / c.scale);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Clears the canvas.\r\n\t * @return {void}\r\n\t */\r\n\tclear() {\r\n\t\tvar c = this.domElement;\r\n\t\tvar ctx = this.context;\r\n\t\tif (ctx instanceof CanvasRenderingContext2D) {\r\n\t\t\tctx.clearRect(0, 0, c.width / c.scale, c.height / c.scale);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Set the RGBA components of a pixel on the canvas as an ArrayBuffer.\r\n\t * @param {number} x X position of the pixel, must be an integer.\r\n\t * @param {number} y Y position of the pixel, must be an integer.\r\n\t * @returns {void}\r\n\t */\r\n\tsetPixel(x, y, data) {\r\n\t\tvar imageData = this.context.getImageData(x, y, 1, 1);\r\n\t\timageData.data.set(data);\r\n\t\tthis.context.putImageData(imageData, x, y);\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the RGBA components of a pixel on the canvas as an ArrayBuffer.\r\n\t * @param {number} x X position of the pixel, must be an integer.\r\n\t * @param {number} y Y position of the pixel, must be an integer.\r\n\t * @returns {ArrayBuffer} An ArrayBuffer with 4 values (for R, G, B, A).\r\n\t */\r\n\tgetPixel(x, y) {\r\n\t\treturn this.context.getImageData(x, y, 1, 1).data;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {ImageData} data\r\n\t * @return {void}\r\n\t */\r\n\tsetImageData(data) {\r\n\t\tthis.context.putImageData(data, 0, 0);\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the entire pixel buffer of the canvas.\r\n\t * @return {ArrayBuffer}\r\n\t */\r\n\tgetImageData() {\r\n\t\treturn this.context.getImageData(0, 0, this.width, this.height).data;\r\n\t}\r\n\r\n\t/**\r\n\t * Gets the Canvas that is currently set as the main game canvas.\r\n\t * @return {Object}\r\n\t */\r\n\tstatic getMain() {\r\n\t\treturn Canvas.main;\r\n\t}\r\n\r\n}\r\n\r\nGenerator.classStaticMatch(Canvas);\r\nCanvas.array = [];\r\nCanvas.main = null;\r\nCanvas.dom = null;\r\n\r\nexport default Canvas;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/Canvas.js","import Canvas from \"./Canvas\";\r\nimport Color from \"./Color\";\r\nimport Generator from \"./generator\";\r\n\r\n/**\r\n *\r\n */\r\nclass Sprite {\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tconstructor(opts = {}) {\r\n\r\n\t\t//\r\n\t\tlet atlas, atlasIndex;\r\n\t\tif (opts.atlas) {\r\n\t\t\tatlasIndex = opts.atlasIndex || 0;\r\n\t\t\tatlas = opts.atlas.images[atlasIndex];\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tthis.assetType = \"sprite\";\r\n\t\tthis.name = opts.name || Sprite.newName();\r\n\t\tthis.originX = opts.originX || 0;\r\n\t\tthis.originY = opts.originY || 0;\r\n\t\tthis.width = 0;\r\n\t\tthis.height = 0;\r\n\t\tthis.images = [];\r\n\r\n\t\t//\r\n\t\tif (opts.frames) {\r\n\t\t\topts.frames.forEach((frame) => {\r\n\t\t\t\tthis.addFrame({\r\n\t\t\t\t\tsource: frame.src\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tlet length = Sprite.array.length;\r\n\t\tSprite.names[length] = this.name;\r\n\t\tSprite.array[length++] = this;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @return {void}\r\n\t */\r\n\taddFrame(opts = {}) {\r\n\r\n\t\t//\r\n\t\tlet atlas;\r\n\t\tif (opts.atlas) {\r\n\t\t\tatlas = Sprite.get(opts.atlas).images[0].img;\r\n\t\t}\r\n\r\n\t\tlet image = {\r\n\t\t\timg: atlas || new Image(),\r\n\t\t\tclip: null,\r\n\t\t\tready: false\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tif (opts.source) {\r\n\r\n\t\t\timage.img.onload = () => {\r\n\r\n\t\t\t\timage.ready = true;\r\n\t\t\t\timage.clip = {\r\n\t\t\t\t\tx: 0,\r\n\t\t\t\t\ty: 0,\r\n\t\t\t\t\tw: image.img.width,\r\n\t\t\t\t\th: image.img.height\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//\r\n\t\t\t\tif (this.width * this.height === 0) {\r\n\t\t\t\t\tthis.width = image.clip.w;\r\n\t\t\t\t\tthis.height = image.clip.h;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\timage.img.src = opts.source || \"\";\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tif (atlas && opts.clip) {\r\n\t\t\timage.ready = true;\r\n\t\t\timage.clip = opts.clip;\r\n\t\t\tif (this.width * this.height === 0) {\r\n\t\t\t\tthis.width = image.clip.w;\r\n\t\t\t\tthis.height = image.clip.h;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tthis.images.push(image);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @return {void}\r\n\t */\r\n\tcache(opts = {}) {\r\n\t\tthis.images.forEach((frame) => {\r\n\t\t\tlet canvas = document.createElement(\"CANVAS\");\r\n\t\t\tcanvas.width = opts.width || frame.img.width;\r\n\t\t\tcanvas.height = opts.height || frame.img.height;\r\n\t\t\tlet ctx = canvas.getContext(\"2d\");\r\n\t\t\tctx.drawImage(frame.img, 0, 0, canvas.width+1, canvas.height+1);\r\n\t\t\tframe.__orig = Object.assign({}, frame);\r\n\t\t\tframe.clip.x = 0;\r\n\t\t\tframe.clip.y = 0;\r\n\t\t\tframe.clip.w = canvas.width;\r\n\t\t\tframe.clip.h = canvas.height;\r\n\t\t\tframe.img = canvas;\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * @return {void}\r\n\t */\r\n\trestore() {\r\n\t\tthis.images.forEach((frame) => {\r\n\t\t\tif (frame.__orig) frame = frame._orig;\r\n\t\t\tif (frame.__origSrc) frame.img.src = frame.__origSrc;\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @return {void}\r\n\t */\r\n\tsetOrigin(x, y) {\r\n\t\tthis.originX = Number(x);\r\n\t\tthis.originY = Number(y);\r\n\t}\r\n\r\n\t/**\r\n\t * Tints (multiplies) the sprite to the given color. Effects all frames.\r\n\t * @param {string} col A CSS color value.\r\n\t * @return {void}\r\n\t */\r\n\ttint(col) {\r\n\r\n\t\tvar n = this.images.length;\r\n\t\twhile (n--) {\r\n\t\t\tvar frame = this.images[n];\r\n\r\n\t\t\t// Create canvas, draw image.\r\n\t\t\tvar canvas = document.createElement(\"CANVAS\");\r\n\t\t\tvar ctx = canvas.getContext(\"2d\");\r\n\t\t\tcanvas.width = this.width;\r\n\t\t\tcanvas.height = this.height;\r\n\t\t\tframe.img = frame.__orig || frame.img;\r\n\t\t\tctx.drawImage(frame.img, 0, 0);\r\n\r\n\t\t\t// Get data, do thing, put data back.\r\n\t\t\tvar imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\r\n\t\t\tvar color = (typeof col === \"object\") ? col : Color.hexToRgb(col);\r\n\t\t\tpixelDataTint(imageData.data, color);\r\n\t\t\tctx.putImageData(imageData, 0, 0);\r\n\r\n\t\t\t// Cache old image, then set new one.\r\n\t\t\tframe.__orig = frame.img;\r\n\t\t\tframe.__origSrc = frame.img.src;\r\n\t\t\tframe.img = canvas;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Tints (multiplies) the sprite to the given color. Effects all frames.\r\n\t * @param {string} col A CSS color value.\r\n\t * @return {void}\r\n\t */\r\n\tfade(col) {\r\n\r\n\t\tvar n = this.images.length;\r\n\t\twhile (n--) {\r\n\t\t\tvar frame = this.images[n];\r\n\r\n\t\t\t// Create canvas, draw image.\r\n\t\t\tlet canvas = document.createElement(\"CANVAS\");\r\n\t\t\tlet ctx = canvas.getContext(\"2d\");\r\n\t\t\tcanvas.width = this.width;\r\n\t\t\tcanvas.height = this.height;\r\n\t\t\tframe.img = frame.__orig || frame.img;\r\n\t\t\tctx.drawImage(frame.img, 0, 0);\r\n\r\n\t\t\t// Get data, do thing, put data back.\r\n\t\t\tlet imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\r\n\t\t\tlet color = (typeof col === \"object\") ? col : Color.hexToRgb(col);\r\n\t\t\tpixelDataFade(imageData.data, color);\r\n\t\t\tctx.putImageData(imageData, 0, 0);\r\n\r\n\t\t\t// Cache old image, then set new one.\r\n\t\t\tframe.__orig = frame.img;\r\n\t\t\tframe.__origSrc = frame.img.src;\r\n\t\t\tframe.img = canvas;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} index The index of the frame to draw onto the canvas.\r\n\t * @return {Object}\r\n\t */\r\n\ttoCanvas(index) {\r\n\t\tvar c = new Canvas({\r\n\t\t\twidth: this.width,\r\n\t\t\theight: this.height\r\n\t\t})\r\n\t\tvar img = this.images[index].img;\r\n\t\tc.context.drawImage(img, 0, 0);\r\n\t\treturn c;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the RGBA components of a pixel on the Sprite as an ArrayBuffer.\r\n\t * @param {number} x X position of the pixel, must be an integer.\r\n\t * @param {number} y Y position of the pixel, must be an integer.\r\n\t * @returns {ArrayBuffer} An ArrayBuffer with 4 values (for R, G, B, A).\r\n\t */\r\n\tgetPixel(index, x, y) {\r\n\t\tvar c = this.toCanvas(index);\r\n\t\treturn c.context.getImageData(x, y, 1, 1).data;\r\n\t}\r\n\r\n\t/**\r\n\t * @return {boolean}\r\n\t */\r\n\tstatic readyAll() {\r\n\r\n\t\tvar sa = Sprite.array;\r\n\t\tvar n = sa.length;\r\n\t\twhile (n--) {\r\n\t\t\tvar ia = sa[n].images;\r\n\t\t\tvar i = ia.length;\r\n\t\t\twhile (i--) {\r\n\t\t\t\tif (!ia[i].ready) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Generates a new, unused, sprite name.\r\n\t * @return {string}\r\n\t */\r\n\tstatic newName() {\r\n\t\treturn \"sprNewSprite\" + Sprite.array.length;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {*} name String or Object.\r\n\t * @return {Object}\r\n\t */\r\n\tstatic get(name) {\r\n\r\n\t\tif (typeof name === \"object\") {\r\n\t\t\treturn name;\r\n\t\t}\r\n\r\n\t\tvar n = Sprite.array.length;\r\n\t\twhile (n--) {\r\n\t\t\tif (Sprite.array[n].name === name) {\r\n\t\t\t\treturn Sprite.array[n];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * Iterates pixel data and tints (multiplies) it with the given color.\r\n * @param {Uint8ClampedArray} data\r\n * @param {Object} rgb\r\n * @return {void}\r\n */\r\nfunction pixelDataTint(data, rgb) {\r\n\tvar r = rgb.r / 255;\r\n\tvar g = rgb.g / 255;\r\n\tvar b = rgb.b / 255;\r\n\tvar i = data.length;\r\n\twhile (i -= 4) {\r\n\t\tdata[i] *= r;\r\n\t\tdata[i + 1] *= g;\r\n\t\tdata[i + 2] *= b;\r\n\t}\r\n}\r\n\r\n/**\r\n * Iterates pixel data and tints (multiplies) it with the given color.\r\n * @param {Uint8ClampedArray} data\r\n * @param {Object} rgba\r\n * @return {void}\r\n */\r\nfunction pixelDataFade(data, rgba) {\r\n\tvar a = rgba.a / 255;\r\n\tvar r = rgba.r * a;\r\n\tvar g = rgba.g * a;\r\n\tvar b = rgba.b * a;\r\n\tvar o = 1 - a;\r\n\tvar i = data.length;\r\n\twhile (i -= 4) {\r\n\t\tdata[i] = r + data[i] * o;\r\n\t\tdata[i + 1] = g + data[i + 1] * o;\r\n\t\tdata[i + 2] = b + data[i + 2] * o;\r\n\t}\r\n}\r\n\r\n//\r\nGenerator.classStaticMatch(Sprite);\r\nSprite.names = [];\r\nSprite.array = [];\r\n\r\n//\r\nexport default Sprite;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/sprite.js","import math from \"./math\";\r\nimport input from \"./input\";\r\nimport object from \"./object\";\r\nimport sprite from \"./sprite\";\r\nimport Draw from \"./draw\";\r\nimport global from \"./global\";\r\n\r\nconst INSTANCE_HARD_LIMIT = 10000;\r\n\r\n//\r\nwindow.global = global;\r\n\r\n//\r\nconst instanceArray = [];\r\nconst otherStack = [];\r\nvar uniqueId = 1;\r\nvar doDepthSort = false;\r\nvar currentEvent = \"\";\r\n\r\n//\r\nclass instance {\r\n\r\n\tstatic get instanceArray() { return instanceArray; }\r\n\tstatic set doDepthSort(x) { doDepthSort = x; }\r\n\r\n\t/**\r\n\t * Create a new instance of an object.\r\n\t * @param {string|Object} obj\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @return {?Object}\r\n\t */\r\n\tstatic create(obj, x, y) {\r\n\r\n\t\tvar o = object.get(obj);\r\n\r\n\t\tif (o === null) {\r\n\t\t\twindow.addConsoleText(\"#F00\", \"Instance creation failed! No such object as \" + obj + \".\");\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tif (instanceArray.length >= INSTANCE_HARD_LIMIT) {\r\n\t\t\twindow.addConsoleText(\"#F00\", \"instance number hard limit reached:\", INSTANCE_HARD_LIMIT);\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn new o(x, y);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @param {object} obj\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @param {number} speed\r\n\t * @param {number} direction\r\n\t */\r\n\tstatic createMoving(obj, x, y, speed, direction) {\r\n\t\tlet newInst = instance.create(obj, x, y);\r\n\t\tnewInst.speed = speed;\r\n\t\tnewInst.direction = direction;\r\n\t\treturn newInst;\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tstatic setup(inst, o, x, y) {\r\n\r\n\t\tinst.id = uniqueId++;\r\n\t\tinst.exists = true;\r\n\t\tinst.speed = 0;\r\n\t\tinst.object = o;\r\n\t\tinst.objectName = o.objectName;\r\n\t\tinst.assetType = \"instance\";\r\n\t\tinst.x = Number(x);\r\n\t\tinst.y = Number(y);\r\n\t\tinst.startX = inst.x;\r\n\t\tinst.startY = inst.y;\r\n\t\tinst.previousX = inst.x;\r\n\t\tinst.previousY = inst.y;\r\n\t\tinst.boxCollision = {};\r\n\r\n\t\t//\r\n\t\tlet spr = sprite.get(inst.sprite);\r\n\t\tif (spr) {\r\n\t\t\tinst.boxCollision.x = spr.originX;\r\n\t\t\tinst.boxCollision.y = spr.originY;\r\n\t\t\tinst.boxCollision.width = spr.width;\r\n\t\t\tinst.boxCollision.height = spr.height;\r\n\t\t}\r\n\r\n\t\t//\r\n\t\taddToArray(inst);\r\n\t\tupdateBoundingBox(inst);\r\n\t\tupdateCollisionBox(inst);\r\n\t\texecuteEvent(inst, \"create\");\r\n\t}\r\n\r\n\t/**\r\n\t * Finds instance n of the given object.\r\n\t * @param {Object} obj\r\n\t * @param {number} n\r\n\t * @return {?Object}\r\n\t */\r\n\tstatic find(obj, n) {\r\n\t\tif (typeof obj === \"function\") obj = obj.objectName;\r\n\t\tlet i, c=0, inst;\r\n\t\tfor (i=0; i<instanceArray.length; i++) {\r\n\t\t\tinst = instanceArray[i];\r\n\t\t\tif (inst.objectName === obj) {\r\n\t\t\t\tif (c++ === n)\r\n\t\t\t\t\treturn inst;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/** */\r\n\tstatic findRandom(obj) {\r\n\t\tif (typeof obj === \"function\") obj = obj.objectName;\r\n\t\tlet n = math.randomInt(0, count(obj) - 1);\r\n\t\treturn find(obj, n);\r\n\t}\r\n\r\n\t/**\r\n\t * Find the nearest instance of an object to a point.\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @param {string|Object} obj\r\n\t * @param {?Object}\r\n\t */\r\n\tstatic nearest(x, y, obj) {\r\n\r\n\t\tvar all = [];\r\n\t\tif (!Array.isArray(obj)) {\r\n\t\t\tall.push(...(object.get(obj).getAllInstances()));\r\n\t\t} else {\r\n\t\t\tobj.forEach(o => {\r\n\t\t\t\tall.push(...(object.get(o).getAllInstances()));\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (all.length === 0) { return null; }\r\n\t\tif (all.length === 1) { return all[0]; }\r\n\t\tlet nrst, dist = 1e9, newDist;\r\n\t\tall.forEach(inst => {\r\n\t\t\tnewDist = math.pointDistance(x, y, inst.x, inst.y);\r\n\t\t\tif (newDist < dist) {\r\n\t\t\t\tnrst = inst;\r\n\t\t\t\tdist = newDist;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn nrst;\r\n\t}\r\n\r\n\t/**\r\n\t * Find the furthest instance of an object from a point.\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @param {string|Object} obj\r\n\t * @param {?Object}\r\n\t */\r\n\tstatic furthest(x, y, obj) {\r\n\t\tlet all = object.get(obj).getAllInstances();\r\n\t\tif (all.length === 0) { return null; }\r\n\t\tif (all.length === 1) { return all[0]; }\r\n\t\tlet frst, dist = 0, newDist;\r\n\t\tall.forEach(inst => {\r\n\t\t\tnewDist = math.pointDistance(x, y, inst.x, inst.y);\r\n\t\t\tif (newDist > dist) {\r\n\t\t\t\tfrst = inst;\r\n\t\t\t\tdist = newDist;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn frst;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the number of instances of a given object.\r\n\t * @param {string|Object} obj\r\n\t * @return {number}\r\n\t */\r\n\tstatic count(obj) {\r\n\t\tconst name = object.get(obj).objectName;\r\n\t\tvar c = 0;\r\n\t\tfor (var n=instanceArray.length-1; n>0; n--) {\r\n\t\t\tc += (instanceArray[n].objectName === name);\r\n\t\t}\r\n\t\treturn c;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} rotation\r\n\t * @param {boolean} relative\r\n\t * @return {void}\r\n\t */\r\n\tstatic setRotation(rotation, relative) {\r\n\t\tthis.rotation = (relative) ? this.rotation + rotation : rotation;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} rotation\r\n\t * @param {boolean} relative\r\n\t * @return {void}\r\n\t */\r\n\tstatic setDirection(direction, relative) {\r\n\t\tthis.direction = (relative) ? this.direction + direction : direction;\r\n\t}\r\n\r\n\t/** Start moving in the direction of a given point. */\r\n\tstatic moveTowardsPoint(inst, x, y, spd) {\r\n\t\tinst.direction = math.pointDirection(inst.x, inst.y, x, y);\r\n\t\tinst.speed = spd;\r\n\t}\r\n\r\n\t/** Step towards the given point */\r\n\tstatic stepTowardsPoint(inst, x, y, spd) {\r\n\t\tlet dir = math.pointDirection(inst.x, inst.y, x, y);\r\n\t\tlet vec = math.lengthDir(spd, dir);\r\n\t\tinst.x += vec[0];\r\n\t\tinst.y += vec[1];\r\n\t}\r\n\r\n\t/** */\r\n\tstatic distanceToPoint(inst, x, y) {\r\n\t\treturn math.pointDistance(inst.x, inst.y, x, y);\r\n\t}\r\n\r\n\t/** */\r\n\tstatic position(x, y, obj) {\r\n\t\tlet all = object.get(obj).getAllInstances();\r\n\t\tfor (var n=0; n<all.length; n++) {\r\n\t\t\tlet inst = all[n];\r\n\t\t\tif (instance.pointOn(x, y, inst)) {\r\n\t\t\t\treturn inst;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/** Returns whether the given point is over the given instance. */\r\n\tstatic pointOn(x, y, inst) {\r\n\t\treturn !(inst.boxTop > y - Draw.offsetY\r\n\t\t|| inst.boxBottom < y - Draw.offsetY\r\n\t\t|| inst.boxLeft > x - Draw.offsetX\r\n\t\t|| inst.boxRight < x - Draw.offsetX);\r\n\t}\r\n\r\n\t/** */\r\n\tstatic mouseOn(inst) {\r\n\t\treturn instance.pointOn(input.mouse.x, input.mouse.y, inst);\r\n\t}\r\n\r\n\t/**\r\n\t * Execute step event.\r\n\t * @param {Object} inst\r\n\t * @return {void}\r\n\t */\r\n\tstatic step(inst) {\r\n\r\n\t\t// Step events.\r\n\t\texecuteEvent(inst, \"step\");\r\n\t\tupdateAnimation(inst);\r\n\t\tupdatePosition(inst);\r\n\t\tupdateBoundingBox(inst);\r\n\t\tupdateCollisionBox(inst);\r\n\r\n\t\t// Collision events.\r\n\t\tinstanceExecuteListeners(inst);\r\n\r\n\t\t// Input events.\r\n\t\tinput.triggerEvents.forEach((event) => {\r\n\t\t\texecuteEvent(inst, event);\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t/** */\r\n\tstatic destroy(inst) {\r\n\t\texecuteEvent(inst, \"destroy\");\r\n\t\tinst.exists = false;\r\n\t}\r\n\r\n\t/** */\r\n\tstatic uninstantiate(inst) {\r\n\t\tinst.exists = false;\r\n\t\tlet arr = inst.object.instances;\r\n\t\tlet index = arr.indexOf(inst);\r\n\t\tif (index >= 0) {\r\n\t\t\tarr[index] = arr[arr.length-1];\r\n\t\t\tarr.length -= 1;\r\n\t\t}\r\n\t}\r\n\r\n\t/** */\r\n\tstatic draw(inst) {\r\n\t\tif (!inst.visible) return;\r\n\t\t(inst.events[\"draw\"])\r\n\t\t\t? executeEvent(inst, \"draw\")\r\n\t\t\t: instance.drawSelf(inst);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {Object} inst Instance to draw.\r\n\t * @param {Object} [opts] Options object.\r\n\t */\r\n\tstatic drawSelf(inst, opts) {\r\n\t\tif (inst.sprite === null) return;\r\n\t\tDraw.sprite(\r\n\t\t\tinst.sprite,\r\n\t\t\tinst.index,\r\n\t\t\tinst.x, inst.y,\r\n\t\t\tinst.scaleX, inst.scaleY,\r\n\t\t\tinst.rotation,\r\n\t\t\topts\r\n\t\t);\r\n\t}\r\n\r\n\t/** */\r\n\tstatic drawDebug(inst) {\r\n\t\tlet box = inst.boxCollision;\r\n\t\tDraw.shape.rectangle(\r\n\t\t\tbox.left,\r\n\t\t\tbox.top,\r\n\t\t\tbox.right - box.left,\r\n\t\t\tbox.bottom - box.top, {\r\n\t\t\t\tcolor: \"rgba(255,0,0,0.5)\"\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\t/** */\r\n\tstatic changeSprite(sprite) {\r\n\t\tthis.sprite = sprite;\r\n\t}\r\n\r\n\t/**\r\n\t * Execute a particular event for all current instances.\r\n\t * @param {string} event The event to execute.\r\n\t * @param {Object} otherInst\r\n\t * @return {void}\r\n\t */\r\n\tstatic executeEventAll(event, otherInst) {\r\n\t\tvar n = instanceArray.length;\r\n\t\twhile (n--) {\r\n\t\t\texecuteEvent(instanceArray[n], event, otherInst);\r\n\t\t}\r\n\t}\r\n\r\n\t/** */\r\n\tstatic stepAll() {\r\n\t\tnewStep();\r\n\t\tlet arr = instanceArray.slice();\r\n\t\tarr.forEach(function(inst) { executeEvent(inst, \"stepBegin\"); });\r\n\t\tarr.forEach(instance.step);\r\n\t\tarr.forEach(function(inst) { executeEvent(inst, \"stepEnd\"); });\r\n\t\tclearDestroyed();\r\n\t}\r\n\r\n\t/** */\r\n\tstatic drawAll() {\r\n\t\tif (doDepthSort) {\r\n\t\t\tinstanceArray.sort(sortFunction);\r\n\t\t}\r\n\t\tinstanceArray.forEach(instance.draw);\r\n\t}\r\n\r\n\t/** */\r\n\tstatic drawGuiAll() {\r\n\t\tvar n = instanceArray.length;\r\n\t\twhile (n--) {\r\n\t\t\texecuteEvent(instanceArray[n], \"drawGUI\");\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\n/** Resets some instance variables/states. */\r\nfunction newStep() {\r\n\tlet arr = instanceArray.slice();\r\n\tlet i, n = arr.length;\r\n\twhile (n--) {\r\n\t\ti = arr[n];\r\n\t\ti.previousX = i.x;\r\n\t\ti.previousY = i.y;\r\n\t}\r\n}\r\n\r\n/** */\r\nfunction updatePosition(inst) {\r\n\r\n\t// if the instance is already falling at terminal velocity then we no longer apply gravity\r\n\tlet gravVector = {\r\n\t\tx: math.lengthDirX(inst.terminal, inst.gravityDirection),\r\n\t\ty: math.lengthDirY(inst.terminal, inst.gravityDirection)\r\n\t};\r\n\r\n\tif (gravVector.x > 0 && inst.speedX <= gravVector.x\r\n\t|| gravVector.x < 0 && inst.speedX >= gravVector.x) {\r\n\t\tinst.speedX += math.lengthDirX(inst.gravity, inst.gravityDirection);\r\n\t}\r\n\r\n\tif (gravVector.y > 0 && inst.speedY <= gravVector.y\r\n\t|| gravVector.y < 0 && inst.speedY >= gravVector.y) {\r\n\t\tinst.speedY += math.lengthDirY(inst.gravity, inst.gravityDirection);\r\n\t}\r\n\r\n\t// move instance\r\n\tinst.x += inst.speedX;\r\n\tinst.y += inst.speedY;\r\n\r\n}\r\n\r\n/**\r\n * Update the instance's bounding box.\r\n * @param {Object} i Instance.\r\n * @return {void}\r\n */\r\nfunction updateBoundingBox(i) {\r\n\tlet spr = sprite.get(i.sprite);\r\n\tif (spr === null) return;\r\n\ti.boxTop = i.y - spr.originY * i.scaleY;\r\n\ti.boxLeft = i.x - spr.originX * i.scaleX;\r\n\ti.boxBottom = i.boxTop + spr.height * i.scaleY;\r\n\ti.boxRight = i.boxLeft + spr.width * i.scaleX;\r\n}\r\n\r\n/**\r\n * Update the instance's collision box.\r\n * @param {Object} i Instance.\r\n * @return {void}\r\n */\r\nfunction updateCollisionBox(i) {\r\n\tlet box = i.boxCollision;\r\n\tbox.top = i.y - box.y * i.scaleY;\r\n\tbox.left = i.x - box.x * i.scaleX;\r\n\tbox.bottom = box.top + box.height * i.scaleY;\r\n\tbox.right = box.left + box.width * i.scaleX;\r\n}\r\n\r\n/**\r\n * Update the instance's animation.\r\n * @param {Object} inst Instance.\r\n * @return {void}\r\n */\r\nfunction updateAnimation(inst) {\r\n\r\n\tinst.index += inst.imageSpeed;\r\n\tlet spr = sprite.get(inst.sprite);\r\n\tif (spr) {\r\n\t\tlet length = spr.images.length;\r\n\t\tif (inst.index >= length) {\r\n\r\n\t\t\tlet behavior = inst.animationBehavior;\r\n\t\t\tlet type = typeof behavior;\r\n\r\n\t\t\t//\r\n\t\t\tif (type === \"string\") {\r\n\r\n\t\t\t\t//\r\n\t\t\t\tif (behavior === \"loop\") {\r\n\t\t\t\t\tinst.index -= length;\r\n\t\t\t\t}\r\n\t\t\t\telse if (behavior === \"stop\") {\r\n\t\t\t\t\tinst.index = length - 1;\r\n\t\t\t\t\tinst.imageSpeed = 0;\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\t\t\telse if (type === \"function\") {\r\n\t\t\t\tbehavior.call(inst);\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * @param {Object} inst Instance.\r\n * @return {void}\r\n */\r\nfunction addToArray(inst) {\r\n\tfor (var i=0; i<instanceArray.length; i++) {\r\n\t\tif (inst.depth > instanceArray[i].depth) {\r\n\t\t\tinstanceArray.splice(i, 0, inst);\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\tinstanceArray.push(inst);\r\n}\r\n\r\n/**\r\n * Returns all instances set as \"solid\".\r\n * @return {Array<Object>}\r\n */\r\nfunction getAllSolid() {\r\n\tvar arr = [];\r\n\tvar i, n = instanceArray.length;\r\n\twhile (i = instanceArray[--n]) {\r\n\t\tif (i.solid) {\r\n\t\t\tarr.push(i);\r\n\t\t}\r\n\t}\r\n\treturn arr;\r\n}\r\n\r\n/**\r\n * Remove isntances that have been requested to be destroyed.\r\n * @return {void}\r\n */\r\nfunction clearDestroyed() {\r\n\tvar l = instanceArray.length;\r\n\tvar i, n = l;\r\n\twhile (i = instanceArray[--n]) {\r\n\t\tif (!i.exists) {\r\n\t\t\tinstance.uninstantiate(i)\r\n\t\t\ti.object.pool.release(i);\r\n\t\t\tinstanceArray[n] = instanceArray[--l];\r\n\t\t}\r\n\t}\r\n\tinstanceArray.length = l;\r\n}\r\n\r\n/**\r\n * The function used for instance depth ordering. Sorts by ID is depth same.\r\n * @param {Object} a Instance.\r\n * @param {Object} b Instance.\r\n * @return {number} 0, -1 or 1.\r\n */\r\nfunction sortFunction(a, b) {\r\n\treturn (a.depth === b.depth) ? a.id - b.id : a.depth - b.depth;\r\n}\r\n\r\n/**\r\n * @param {Object} inst Instance.\r\n * @return {void}\r\n */\r\nfunction instanceExecuteListeners(inst) {\r\n\tinst.listeners.forEach((listener) => {\r\n\t\tswitch (listener.type) {\r\n\t\t\tcase (\"collision\"):\r\n\t\t\t\tinstanceCollisionInstance(inst, listener.target);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t});\r\n}\r\n\r\n/**\r\n * Execute an event for the given instance only.\r\n * @param {Object} inst\r\n * @param {event} event\r\n * @param {Object} otherInst The other instance, in collisions for example.\r\n * @return {void}\r\n */\r\nfunction executeEvent(inst, event, otherInst) {\r\n\r\n\t// Set the current \"other\" instance.\r\n\totherStack.push(window.other);\r\n\twindow.other = otherInst;\r\n\tcurrentEvent = event;\r\n\r\n\t//\r\n\ttry {\r\n\t\tif (inst.exists) {\r\n\t\t\tlet actions = inst.events[event];\r\n\t\t\tif (actions) {\r\n\t\t\t\texecuteActions(inst, actions, otherInst);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tcatch (err) {\r\n\t\tconsole.error(err);\r\n\t\twindow.addConsoleText(\"#F00\", \"Failed to execute event [\" + event + \"]\" + \" of object [\" + inst.objectName + \"]\" + \" with error: \" + err);\r\n\t\twindow._GB_stop();\r\n\t\treturn;\r\n\t}\r\n\r\n\t// Restore previous \"other\" instance.\r\n\twindow.other = otherStack.pop();\r\n\r\n}\r\n\r\n/** */\r\nfunction instanceCollisionInstance(inst, target) {\r\n\r\n\tif (!inst.exists) return;\r\n\r\n\t//\r\n\tlet arr =(target === \"solid\")\r\n\t\t? getAllSolid(target)\r\n\t \t: object.getAllInstances(target);\r\n\r\n\tlet box1 = inst.boxCollision;\r\n\tarr.forEach(function(targ) {\r\n\r\n\t\t// If target doesn't exist, or is same instance\r\n\t\tif (!targ.exists || inst === targ)\r\n\t\t\treturn;\r\n\r\n\t\t// No collision, boxes do not overlap.\r\n\t\tlet box2 = targ.boxCollision;\r\n\t\tif (box1.left > box2.right\r\n\t\t|| box1.right < box2.left\r\n\t\t|| box1.top > box2.bottom\r\n\t\t|| box1.bottom < box2.top)\r\n\t\t\treturn;\r\n\r\n\t\t// Execute collision event.\r\n\t\texecuteEvent(inst, \"collision_\" + target, targ);\r\n\r\n\t});\r\n\r\n}\r\n\r\n/**\r\n * @param {Object} inst\r\n * @param {Array} actions\r\n * @param {Object} otherInst\r\n * @return {void}\r\n */\r\nfunction executeActions(inst, actions, otherInst) {\r\n\tconst steps = [];\r\n\tvar condition = true;\r\n\tvar executeIfElse = false;\r\n\tvar scope = 0;\r\n\tvar len = actions.length;\r\n\r\n\tfor (var a=0; a<len; a++) {\r\n\r\n\t\tvar action = actions[a];\r\n\t\tswitch (action.flow) {\r\n\r\n\t\t\t// regular action\r\n\t\t\tcase (\"\"):\r\n\r\n\t\t\t\tif (condition) {\r\n\t\t\t\t\texecuteIfElse = false;\r\n\t\t\t\t\tcondition = action.cache.call(inst);\r\n\t\t\t\t\tif (condition === undefined) {\r\n\t\t\t\t\t\tcondition = true;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tsteps[scope] = 0;\r\n\t\t\t\t\t\tif (condition === false) {\r\n\t\t\t\t\t\t\texecuteIfElse = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t// control actions\r\n\t\t\tcase (\"ifElse\"):\r\n\t\t\t\t(executeIfElse)\r\n\t\t\t\t\t? steps[scope] = 0\r\n\t\t\t\t\t: condition = false;\r\n\t\t\tbreak;\r\n\t\t\tcase (\"blockBegin\"): scope++; break;\r\n\t\t\tcase (\"blockEnd\"): scope--; break;\r\n\t\t\tcase (\"exitEvent\"): if (condition) return false;\r\n\r\n\t\t}\r\n\r\n\t\t// exit from a single statement after an expression not contained in a block\r\n\t\tif (steps[scope]++ === 1) {\r\n\t\t\tcondition = true;\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport default instance;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/instance.js","/**\r\n * @module math\r\n */\r\n\r\nlet math = {\r\n\r\n\t// constances\r\n\tPI: Math.PI,\r\n\tRADTODEG: 180 / Math.PI,\r\n\tDEGTORAD: Math.PI / 180,\r\n\r\n\t// copied functions\r\n\tcos: Math.cos,\r\n\tsin: Math.sin,\r\n\tsign: Math.sign,\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\trandomInt: function( min, max ) {\r\n\t\tmin = Math.ceil( min );\r\n\t\tmax = Math.floor( max );\r\n\t\treturn Math.floor( Math.random() * ( max - min + 1 ) ) + min;\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tchoose: function( ...value ) {\r\n\t\treturn value[Math.floor( Math.random() * value.length )];\r\n\t},\r\n\t\r\n\t/** */\r\n\tlengthDir: (l, d) => {\r\n\t\td *= math.DEGTORAD;\r\n\t\treturn [Math.cos(d) * l, Math.sin(d) * l];\r\n\t},\r\n\r\n\t/** */\r\n\tlengthDirX: function(l, d) {\r\n\t\treturn Math.cos(d * math.DEGTORAD) * l;\r\n\t},\r\n\r\n\t/** */\r\n\tlengthDirY: function(l, d) {\r\n\t\treturn Math.sin(d * math.DEGTORAD) * l;\r\n\t},\r\n\r\n\t/**\r\n\t * @param {number} x1\r\n\t * @param {number} y1\r\n\t * @param {number} x2\r\n\t * @param {number} y2\r\n\t */\r\n\tpointDistance: function(x1, y1, x2, y2) {\r\n\t\tconst a = x1 - x2;\r\n\t\tconst b = y1 - y2;\r\n\t\treturn Math.sqrt(a*a + b*b);\r\n\t},\r\n\r\n\t/**\r\n\t * @param {number} x1\r\n\t * @param {number} y1\r\n\t * @param {number} x2\r\n\t * @param {number} y2\r\n\t */\r\n\tpointDirection: function( x1, y1, x2, y2 ) {\r\n\t\treturn ( ( Math.atan2( y2 - y1, x2 - x1 ) * math.RADTODEG ) + 360 ) % 360;\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tangleDifference: function( angle1, angle2 ) {\r\n\r\n\t\tlet diff = ( angle2 - angle1 ) % 360;\r\n\r\n\t\tif ( diff <= -180 ) {\r\n\t\t\tdiff += 360;\r\n\t\t} else if ( diff > 180 ) {\r\n\t\t\tdiff -= 360;\r\n\t\t}\r\n\r\n\t\treturn diff;\r\n\r\n\t}\r\n\r\n}\r\n\r\n//\r\nexport default math;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/math.js","import Pool from \"../utils/pool.js\";\r\nimport Generator from \"../generator.js\";\r\n\r\n/**\r\n * @author Jack Oatley\r\n */\r\nexport default class Grid {\r\n\r\n\t/**\r\n\t * @param {number} Initial width of the grid.\r\n\t * @param {number} Initial height of the grid\r\n\t * @param {object} [opts={}] Options object.\r\n\t * @param {*} [opts.value=0] Initial value for each cell of the grid.\r\n\t */\r\n\tconstructor(width, height, opts = {}) {\r\n\t\tlet myGrid = Grid.pool.get(this);\r\n\t\tmyGrid.size = width * height;\r\n\t\tmyGrid.data = (myGrid === this) ? [] : myGrid.data;\r\n\t\tmyGrid.data.length = myGrid.size;\r\n\t\tmyGrid.width = width;\r\n\t\tmyGrid.height = height;\r\n\t\tmyGrid.clear(opts.value || 0);\r\n\t\treturn myGrid;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tget(x, y) {\r\n\t\treturn this.data[x + y * this.width];\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tset(x, y, value) {\r\n\t\tthis.data[x + y * this.width] = value;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tadd(x, y, value) {\r\n\t\tthis.data[x + y * this.width] += value;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tmultiply(x, y, value) {\r\n\t\tthis.data[x + y * this.width] *= value;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Clears all cells in the grid to the given value.\r\n\t * @param {*} value Value to clear the grid to.\r\n\t */\r\n\tclear(value) {\r\n\t\tthis.data.fill(value);\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tdestroy() {\r\n\t\tGrid.pool.release(this);\r\n\t}\r\n\r\n}\r\n\r\n//\r\nGrid.pool = new Pool(Grid);\r\nGenerator.classStaticMatch(Grid);\n\n\n// WEBPACK FOOTER //\n// ./core/js/data/grid.js","import Generator from \"./generator\";\r\nimport Transition from \"./transition\";\r\nimport instance from \"./instance\";\r\nimport Sprite from \"./sprite\";\r\nimport draw from \"./draw\";\r\n\r\n/**\r\n *\r\n */\r\nclass Room {\r\n\r\n\t/**\r\n\t * @param {string} name\r\n\t * @param {number} width\r\n\t * @param {number} height\r\n\t */\r\n\tconstructor(name, width, height) {\r\n\t\tthis.name = name;\r\n\t\tthis.width = Number(width);\r\n\t\tthis.height = Number(height);\r\n\t\tthis.background = null;\r\n\t\tthis.backgroundFrame = 0;\r\n\t\tthis.backgroundAnimate = false;\r\n\t\tthis.backgroundAnimateSpeed = 1;\r\n\t\tthis.backgroundMethod = \"no-repeat\";\r\n\t\tthis.backgroundColor = \"#FF0000\";\r\n\t\tthis.instances = [];\r\n\t\tRoom.names.push(name);\r\n\t\tRoom.array.push(this);\r\n\t\tif (Room.current === null)\r\n\t\t\tRoom.current = this;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} spr\r\n\t * @return {void}\r\n\t */\r\n\tsetBackground(spr) {\r\n\t\tthis.background = spr;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} inst Name of the instance to add.\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @return {void}\r\n\t */\r\n\taddInstance(inst, x, y) {\r\n\t\tif (typeof inst === \"object\") inst = inst.objectName;\r\n\t\tthis.instances.push({\r\n\t\t\tname: inst, x: x, y: y\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * @param {object} [opts={}]\r\n\t * @return {void}\r\n\t */\r\n\tenter(opts = {}) {\r\n\r\n\t\tif (opts.transition) {\r\n\t\t\tnew Transition({\r\n\t\t\t\tprefab: opts.transition,\r\n\t\t\t\tcallback: Room.enter.bind(null, this)\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// leave room event\r\n\t\tinstance.executeEventAll(\"roomleave\");\r\n\r\n\t\t// clear current instances\r\n\t\tinstance.instanceArray.forEach(function(i) {\r\n\t\t\tif (!i.persistent) {\r\n\t\t\t\tinstance.uninstantiate(i);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// goto new room and create new instances\r\n\t\tRoom.current = this;\r\n\t\tthis.instances.forEach(function(inst) {\r\n\t\t\tinstance.create(inst.name, inst.x, inst.y);\r\n\t\t});\r\n\t\tinstance.doDepthSort = true;\r\n\r\n\t\t// enter room event\r\n\t\tinstance.executeEventAll(\"roomenter\");\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @return {void}\r\n\t */\r\n\tdraw() {\r\n\t\tvar canvas = draw.target.domElement;\r\n\t\tvar ctx = draw.context;\r\n\t\tdraw.clear(this.backgroundColor);\r\n\t\tvar spr = Sprite.get(this.background);\r\n\t\tif (spr !== null) {\r\n\r\n\t\t\tif (!(ctx instanceof CanvasRenderingContext2D)) {\r\n\t\t\t\twindow.addConsoleText(\"#F00\", \"Room background images are currently only supported in Canvas 2D!\");\r\n\t\t\t\twindow._GB_stop();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst frame = this.backgroundFrame;\r\n\t\t\tconst animate = this.backgroundAnimate;\r\n\t\t\tlet index = frame;\r\n\t\t\tif (animate) {\r\n\t\t\t\tthis.backgroundFrame += this.backgroundAnimateSpeed;\r\n\t\t\t\tindex = ~~(this.backgroundFrame % spr.images.length);\r\n\t\t\t}\r\n\r\n\t\t\tconst image = spr.images[index].img;\r\n\r\n\t\t\tif (this.backgroundMethod === \"stretch\" ) {\r\n\t\t\t\tctx.drawImage(image, 0, 0, canvas.width, canvas.height);\r\n\t\t\t}\r\n\r\n\t\t\t// Iso patterns.\r\n\t\t\telse if (this.backgroundMethod.indexOf(\"iso-\") !== -1) {\r\n\t\t\t\tlet pattern = this.backgroundMethod.replace(\"iso-\", \"\");\r\n\r\n\t\t\t\t// First.\r\n\t\t\t\tctx.fillStyle = ctx.createPattern(image, pattern);\r\n\t\t\t\tctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\r\n\t\t\t\t// Second.\r\n\t\t\t\tctx.save();\r\n\t\t\t\tctx.translate(spr.width/2, spr.height/2);\r\n\t\t\t\tctx.fillRect(-spr.width/2, -spr.height/2, canvas.width, canvas.height);\r\n\t\t\t\tctx.restore();\r\n\t\t\t}\r\n\r\n\t\t\t// Regular patterns.\r\n\t\t\telse {\r\n\t\t\t\tctx.fillStyle = ctx.createPattern(image, this.backgroundMethod);\r\n\t\t\t\tctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t}\r\n\r\n\t/** */\r\n\tstatic next() {\r\n\t\tconst index = Room.array.indexOf(Room.current);\r\n\t\tRoom.enter(Room.array[index+1]);\r\n\t}\r\n\r\n\t/** */\r\n\tstatic previous() {\r\n\t\tconst index = Room.array.indexOf(Room.current);\r\n\t\tRoom.enter(Room.array[index-1]);\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tstatic get(name) {\r\n\t\tif (typeof name === \"object\") return name;\r\n\t\tfor (var n=0; n<Room.array.length; n++) {\r\n\t\t\tif ( Room.array[n][\"name\"] === name ) {\r\n\t\t\t\treturn Room.array[n];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n}\r\n\r\nRoom.prototype.assetType = \"room\";\r\nRoom.names = [];\r\nRoom.array = [];\r\nRoom.current = null;\r\nGenerator.classStaticMatch(Room);\r\n\r\nexport default Room;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/room.js","import draw from \"./draw\";\r\nimport noop from \"./utils/noop\";\r\n\r\n/**\r\n *\r\n */\r\nclass Transition {\r\n\r\n\t/**\r\n\t* @param {object} opts Options.\r\n\t* @param {string} opts.type\r\n\t* @param {string} opts.time Time in steps the tranistion will last per stage (in/out).\r\n\t* @param {string} opts.color Color of the transition.\r\n\t* @param {string} opts.callback Function to execute mid-transition.\r\n\t*/\r\n\tconstructor(opts = {}) {\r\n\t\tthis.type = opts.type || \"fade\";\r\n\t\tthis.time = opts.time || 60;\r\n\t\tthis.color = opts.color || \"#000000\";\r\n\t\tthis.callback = opts.callback || noop;\r\n\t\tif (opts.prefab) Object.assign(this, opts.prefab);\r\n\t\tthis.direction = 1;\r\n\t\tthis.alpha = 0;\r\n\t\tthis.delta = 1/this.time;\r\n\t\tTransition.allInstances.push(this);\r\n\r\n\t\t// Check transition type exists and log warning otherwise\r\n\t\tif (!Transition.prefabs.hasOwnProperty(this.type)) {\r\n\t\t\twindow.addConsoleText(\"#F00\", \"Unknown transition type: \" + this.type);\r\n\t\t\tthis.type = \"fade\";\r\n\t\t}\r\n\t}\r\n\r\n\t/** */\r\n\tupdate() {\r\n\t\tif (Transition.prefabs.hasOwnProperty(this.type))\r\n\t\t\tTransition.prefabs[this.type].update.call(this);\r\n\t}\r\n\r\n\t/** */\r\n\tdraw() {\r\n\t\tif (Transition.prefabs.hasOwnProperty(this.type))\r\n\t\t\tTransition.prefabs[this.type].draw.call(this);\r\n\t}\r\n\r\n\t/** */\r\n\tdestroy() {\r\n\t\tlet x = Transition.allInstances.indexOf(this);\r\n\t\tTransition.allInstances.splice(x, 1);\r\n\t}\r\n\r\n\t/** */\r\n\tstatic create(opts) {\r\n\t\treturn new Transition(opts);\r\n\t}\r\n\r\n\t/** */\r\n\tstatic updateAll() {\r\n\t\tTransition.allInstances.forEach((t) => {\r\n\t\t\tt.update();\r\n\t\t});\r\n\t}\r\n\r\n\t/** */\r\n\tstatic drawAll() {\r\n\t\tTransition.allInstances.forEach((t) => {\r\n\t\t\tt.draw();\r\n\t\t});\r\n\t}\r\n\r\n}\r\n\r\n//\r\nTransition.allInstances = [];\r\n\r\n/**\r\n * @namespace\r\n */\r\nTransition.prefabs = {\r\n\r\n\t\"fade\": {\r\n\t\tupdate: function() {\r\n\t\t\tthis.alpha += this.direction ? this.delta : -this.delta;\r\n\t\t\tif (this.alpha >= 1) {\r\n\t\t\t\tthis.callback();\r\n\t\t\t\tthis.direction = 0;\r\n\t\t\t} else if (this.alpha <= 0) {\r\n\t\t\t\tthis.destroy();\r\n\t\t\t}\r\n\t\t},\r\n\t\tdraw: function() {\r\n\t\t\tvar ctx = draw.context;\r\n\t\t\tctx.globalAlpha = this.alpha;\r\n\t\t\tctx.fillStyle = this.color;\r\n\t\t\tctx.fillRect(0, 0, 9999999, 9999999);\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\nexport default Transition;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/transition.js","import Canvas from \"./Canvas\";\r\nimport keyValues from \"./keyvalues\";\r\n\r\n// Mouse object\r\nlet __mouseMap = [\"Left\", \"Middle\", \"Right\"];\r\nlet __mouse = {\r\n\tpress: [false, false, false],\r\n\tdown: [false, false, false],\r\n\trelease: [false, false, false],\r\n\twheelUp: false,\r\n\twheelDown: false,\r\n\trawX: 0,\r\n\trawY: 0,\r\n\tx: 0,\r\n\ty: 0\r\n}\r\n\r\n// Keyboard object\r\nlet __keyboard = {\r\n\tpress: {},\r\n\tdown: {},\r\n\trelease: {}\r\n}\r\n\r\n// Touch object\r\nlet __touch = {\r\n\tstart: [],\r\n\theld: [],\r\n\tmove: [],\r\n\tend: [],\r\n\tcancel: [],\r\n\tx: [],\r\n\ty: []\r\n}\r\n\r\n/**\r\n * @author Jack Oatley\r\n */\r\nclass Input {\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tstatic initMouse() {\r\n\r\n\t\tfunction handleMouseDown(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\tif (!__mouse.press[e.button]) window.focus();\r\n\t\t\t__mouse.press[e.button] = true;\r\n\t\t\t__mouse.down[e.button] = true;\r\n\t\t}\r\n\r\n\t\tfunction handleMouseUp(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\t__mouse.press[e.button] = false;\r\n\t\t\t__mouse.release[e.button] = true;\r\n\t\t\t__mouse.down[e.button] = false;\r\n\t\t}\r\n\r\n\t\tfunction handleMouseMove(e) {\r\n\t\t\tconst canv = Canvas.main.domElement;\r\n\t\t\tconst rect = canv.getBoundingClientRect();\r\n\t\t\tconst hs = canv.width / rect.width;\r\n\t\t\tconst vs = canv.height / rect.height;\r\n\t\t\t__mouse.rawX = ~~(e.clientX - rect.left);\r\n\t\t\t__mouse.rawY = ~~(e.clientY - rect.top);\r\n\t\t\t__mouse.x = ~~(__mouse.rawX * hs);\r\n\t\t\t__mouse.y = ~~(__mouse.rawY * vs);\r\n\t\t}\r\n\r\n\t\tfunction handleMouseWheel(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\tconst delta = Math.sign(e.wheelDelta);\r\n\t\t\t__mouse.wheelUp = delta > 0;\r\n\t\t\t__mouse.wheelDown = delta < 0;\r\n\t\t}\r\n\r\n\t\tInput.element.addEventListener(\"mousedown\", handleMouseDown);\r\n\t\tInput.element.addEventListener(\"mouseup\", handleMouseUp);\r\n\t\tInput.element.addEventListener(\"mousemove\", handleMouseMove);\r\n\t\tInput.element.addEventListener(\"mousewheel\", handleMouseWheel);\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tstatic initKeyboard() {\r\n\r\n\t\t//\r\n\t\tkeyValues.forEach((key) => {\r\n\t\t\t__keyboard.press[key] = false;\r\n\t\t\t__keyboard.down[key] = false;\r\n\t\t\t__keyboard.release[key] = false;\r\n\t\t});\r\n\r\n\t\t//\r\n\t\tfunction handleKeyDown(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\tconst code = e.code || e.key;\r\n\t\t\tif (!__keyboard.down[code]) {\r\n\t\t\t\t__keyboard.press[code] = true;\r\n\t\t\t\t__keyboard.down[code] = true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tfunction handleKeyUp(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\tconst code = e.code || e.key;\r\n\t\t\t__keyboard.release[code] = true;\r\n\t\t\t__keyboard.down[code] = false;\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tInput.element.addEventListener(\"keydown\", handleKeyDown);\r\n\t\tInput.element.addEventListener(\"keyup\", handleKeyUp);\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tstatic initTouch() {\r\n\r\n\t\t//\r\n\t\tfunction handleTouchStart(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\t(!__touch.start[0]) && window.focus();\r\n\t\t\t__touch.start[0] = true;\r\n\t\t\t__touch.held[0] = true;\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tfunction handleTouchEnd(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\t__touch.start[0] = false;\r\n\t\t\t__touch.end[0] = true;\r\n\t\t\t__touch.held[0] = false;\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tfunction handleTouchMove(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\tlet touches = e.changedTouches;\r\n\t\t\t__touch.x[0] = touches[0].pageX;\r\n\t\t\t__touch.y[0] = touches[0].pageY;\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tInput.element.addEventListener(\"touchstart\", handleTouchStart);\r\n\t\tInput.element.addEventListener(\"touchend\", handleTouchEnd);\r\n\t\tInput.element.addEventListener(\"touchcancel\", handleTouchEnd);\r\n\t\tInput.element.addEventListener(\"touchmove\", handleTouchMove);\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tstatic getTriggerEvents() {\r\n\r\n\t\t// Reset.\r\n\t\tlet triggers = Input.triggerEvents;\r\n\t\ttriggers.length = 0;\r\n\r\n\t\t// Keyboard events.\r\n\t\tObject.keys(__keyboard.down).forEach((key) => {\r\n\t\t\tif (keyValues.includes(key)) {\r\n\t\t\t\tif (__keyboard.down[key]) triggers.push(key);\r\n\t\t\t\tif (__keyboard.press[key]) triggers.push(key + \"Press\");\r\n\t\t\t\tif (__keyboard.release[key]) triggers.push(key + \"Release\");\r\n\t\t\t} else {\r\n\t\t\t\tconsole.warn( \"input key not supported: \", key );\r\n\t\t\t\tdelete __keyboard.down[key];\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// Mouse events.\r\n\t\tfor(var n=0; n<3; n++) {\r\n\t\t\tif (__mouse.down[n]) triggers.push(__mouseMap[n] + \"Down\");\r\n\t\t\tif (__mouse.press[n]) triggers.push(__mouseMap[n] + \"Press\");\r\n\t\t\tif (__mouse.release[n]) triggers.push(__mouseMap[n] + \"Release\");\r\n\t\t}\r\n\r\n\t\tif (__mouse.wheelUp) triggers.push(\"WheelUp\");\r\n\t\tif (__mouse.wheelDown) triggers.push(\"WheelDown\");\r\n\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tstatic update() {\r\n\r\n\t\tObject.keys(__keyboard.down).forEach((key) => {\r\n\t\t\t__keyboard.press[key] = false;\r\n\t\t\t__keyboard.release[key] = false;\r\n\t\t});\r\n\r\n\t\tObject.keys(__mouse.down).forEach((button) => {\r\n\t\t\t__mouse.press[button] = false;\r\n\t\t\t__mouse.release[button] = false;\r\n\t\t});\r\n\r\n\t\tObject.keys(__touch.held).forEach((button) => {\r\n\t\t\t__touch.start[button] = false;\r\n\t\t\t__touch.end[button] = false;\r\n\t\t\t__touch.held[button] = false;\r\n\t\t});\r\n\r\n\t\t__mouse.wheelUp = false;\r\n\t\t__mouse.wheelDown = false;\r\n\r\n\t}\r\n\r\n}\r\n\r\nInput.element = document;\r\nInput.triggerEvents = [];\r\nInput.mouse = __mouse;\r\nInput.keyboard = __keyboard;\r\nInput.touch = __touch;\r\n\r\nexport default Input;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/input.js","\r\n/**\r\n * @param {string} hex A hex string.\r\n * @return {Object}\r\n */\r\nfunction hexToRgb(hex) {\r\n\tvar result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n\treturn result ? {\r\n\t\tr: parseInt(result[1], 16),\r\n\t\tg: parseInt(result[2], 16),\r\n\t\tb: parseInt(result[3], 16),\r\n\t\ta: 255\r\n\t} : {\r\n\t\tr: 0,\r\n\t\tg: 0,\r\n\t\tb: 0,\r\n\t\ta: 255\r\n\t};\r\n}\r\n\r\n/**\r\n * @param {string} hex A hex string.\r\n * @return {Array}\r\n */\r\nfunction hexToArray(hex) {\r\n\tvar result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n\treturn result ? [\r\n\t\tparseInt(result[1], 16),\r\n\t\tparseInt(result[2], 16),\r\n\t\tparseInt(result[3], 16),\r\n\t\t255\r\n\t] : [0, 0, 0, 255];\r\n}\r\n\r\n/**\r\n * @param {number} c The component.\r\n * @return {string}\r\n */\r\nfunction componentToHex(c) {\r\n\tvar hex = c.toString(16);\r\n\treturn hex.length == 1 ? \"0\" + hex : hex;\r\n}\r\n\r\n/**\r\n * @param {number} r The red component.\r\n * @param {number} g The green component.\r\n * @param {number} b The blue component.\r\n * @return {string}\r\n */\r\nfunction rgbToHex(r, g, b) {\r\n\treturn \"#\" + componentToHex(r) + componentToHex(g) + componentToHex(b);\r\n}\r\n\r\n//\r\nexport default {\r\n\thexToRgb,\r\n\tcomponentToHex,\r\n\trgbToHex,\r\n\thexToArray\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/Color.js","import Generator from \"./generator\";\r\nimport Grid from \"./data/grid\";\r\n\r\n/**\r\n * @author Jack Oatley\r\n */\r\nclass Font {\r\n\r\n\t/**\r\n\t * @param {object} [opts={}] Options.\r\n\t * @param {string} [opts.name=\"_UNNAMEDFONT\"] Name of the font.\r\n\t * @param {string} [opts.src=\"\"] Source of the font.\r\n\t * @param {image} [opts.bitmap=null] An existing bitmap.\r\n\t * @param {string} [opts.method=\"normal\"] Initial drawing method.\r\n\t * @param {boolean} [opts.apply] Apply the font in CSS,\r\n\t */\r\n\tconstructor(opts = {}) {\r\n\t\tthis.name = opts.name || \"_UNNAMEDFONT\";\r\n\t\tthis.source = opts.src || \"\";\r\n\t\tthis.hasFontFace = false;\r\n\t\tthis.forceSize = 0;\r\n\t\tthis.bitmapFont = [];//opts.bitmap || null;\r\n\t\tthis.hasBitmapFont = this.bitmap !== null;\r\n\t\tthis.method = opts.method || \"normal\";\r\n\t\tif (opts.apply) {\r\n\t\t\tthis.applyCss();\r\n\t\t}\r\n\t\tFont.names.push(this.name);\r\n\t\tFont.array.push(this);\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the CSS code that's needed to be applied to the page to use this font in the DOM or on the canvas.\r\n\t */\r\n\tgetCss() {\r\n\t\treturn \"@font-face {\"\r\n\t\t\t+ \"font-family: \" + this.name + \";\"\r\n\t\t\t+ \"src: url('\" + this.source + \"') format('truetype');\"\r\n\t\t+ \"}\";\r\n\t}\r\n\r\n\t/**\r\n\t * Applies the CSS code.\r\n\t */\r\n\tapplyCss() {\r\n\t\tlet style = document.createElement(\"STYLE\");\r\n\t\tstyle.textContent = this.getCss();\r\n\t\tdocument.head.appendChild(style);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {Object} [opts={}] Options object.\r\n\t * @param {number} [opts.size=8] Size of the font.\r\n\t * @param {string} [opts.map] A string of all the characters to include in the bitmap font.\r\n\t * @param {number} [opts.alphaThreshold=150] Threshold that dertmines which pixels shall be visible.\r\n\t * @param {Array} [opts.color=[0,0,0,255]] An array containing the RGBA channels respectively.\r\n\t */\r\n\tconvertToBitmapFont(opts = {}) {\r\n\r\n\t\tconst scale = 3;\r\n\t\tconst psize = (opts.size || 8) * scale;\r\n\t\tconst size = (1 + (opts.size || 8)) * scale;\r\n\t\tconst map = opts.map || \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789/\\\\,.<>{}[]!\\\"$%^&*():;@'~#|`=+-_?\";\r\n\t\tconst cx = size * 0.5;\r\n\t\tconst cy = cx;\r\n\t\tconst alphaThreshold = opts.alphaThreshold || 150;\r\n\t\tconst color = opts.color || [0, 0, 0, 255];\r\n\r\n\t\tconst atlas = document.createElement(\"CANVAS\");\r\n\t\tatlas.width = (size /scale) * map.length;\r\n\t\tatlas.height = (size / scale);\r\n\t\tconst atlasCtx = atlas.getContext(\"2d\");\r\n\t\tconst pointImageData = atlasCtx.createImageData(1, 1);\r\n\t\tpointImageData.data.set(color, 0);\r\n\r\n\t\tconst canvas = document.createElement(\"CANVAS\");\r\n\t\tcanvas.width = size;\r\n\t\tcanvas.height = size;\r\n\r\n\t\tlet ctx = canvas.getContext(\"2d\");\r\n\t\tctx.font = psize + \"px \" + this.name;\r\n\t\tctx.textAlign = \"center\";\r\n\t\tctx.textBaseline = \"middle\";\r\n\r\n\t\tlet charMap = new Grid(size/scale, size/scale);\r\n\t\tlet lookupTable = {};\r\n\t\tfor (var n=0; n<map.length; n++) {\r\n\r\n\t\t\tctx.clearRect(0, 0, size, size);\r\n\t\t\tcharMap.clear(-1);\r\n\r\n\t\t\tlet c = map[n];\r\n\t\t\tctx.fillStyle = \"#000\";\r\n\t\t\tctx.fillText(c, cx, cy);\r\n\r\n\t\t\tlet imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\r\n\t\t\tlet data = imageData.data;\r\n\t\t\tvar p, r, g, b, a;\r\n\t\t\tfor (p=0; p<data.length; p+=4*scale) {\r\n\t\t\t\tlet x = ~~(((p/4) % size) / scale);\r\n\t\t\t\tlet y = ~~((~~((p/4) / size)) / scale);\r\n\t\t\t\tlet i = x+(size/scale)*y;\r\n\t\t\t\tif (charMap.get(x, y) === -1) {\r\n\t\t\t\t\tcharMap.set(x, y, data[p+3]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Get metrics\r\n\t\t\tlet metrics = { left: 10000, top: 10000, right: 0, bottom: 0 };\r\n\t\t\tlet minY = 100;\r\n\t\t\tlet maxY = 0;\r\n\t\t\tlet x, y;\r\n\t\t\tlet hits = 0;\r\n\t\t\tfor (y=0; y<size/scale; y++)\r\n\t\t\tfor (x=0; x<size/scale; x++) {\r\n\t\t\t\tif (charMap.get(x, y) > alphaThreshold) {\r\n\t\t\t\t\tmetrics.left = Math.min(metrics.left, x);\r\n\t\t\t\t\tmetrics.top = Math.min(metrics.top, y);\r\n\t\t\t\t\tmetrics.right = Math.max(metrics.right, x+1);\r\n\t\t\t\t\tmetrics.bottom = Math.max(metrics.bottom, y+1);\r\n\t\t\t\t\tminY = Math.min(minY, metrics.top);\r\n\t\t\t\t\tmaxY = Math.max(maxY, metrics.bottom);\r\n\t\t\t\t\thits++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// No visible character.\r\n\t\t\tif (hits === 0) {\r\n\t\t\t\tmetrics = { left: 0, top: 0, right: 0, bottom: 0 };\r\n\t\t\t}\r\n\r\n\t\t\t// Print to atlas\r\n\t\t\tfor (y=0; y<size/scale; y++)\r\n\t\t\tfor (x=0; x<size/scale; x++) {\r\n\t\t\t\tif (charMap.get(x, y) > alphaThreshold) {\r\n\t\t\t\t\tatlasCtx.putImageData(pointImageData, n*(size/scale)+x, y);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Tweak metrics into atlas coords and add to lookup table\r\n\t\t\tmetrics.left += n*(size/scale);\r\n\t\t\tmetrics.right += n*(size/scale);\r\n\t\t\tmetrics.top = 0;\r\n\t\t\tmetrics.bottom = size/scale;\r\n\t\t\tlookupTable[c] = metrics;\r\n\r\n\t\t}\r\n\r\n\t\t// Space is special because it can't actually be measured\r\n\t\tlookupTable[\" \"] = {left: -3, top: 0, right: 0, bottom: size/scale}\r\n\r\n\t\t//\r\n\t\tvar key = \"\" + opts.size + color[0] + color[1] + color[2] + color[3];\r\n\t\tconsole.log(key);\r\n\t\tthis.bitmapFont[key] = {\r\n\t\t\tsize: psize/scale,\r\n\t\t\tlookup: lookupTable,\r\n\t\t\timage: atlas\r\n\t\t}\r\n\r\n\t\tthis.method = \"bitmap\";\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @param {*} value The string name of the font to get.\r\n\t * @return {Object}\r\n\t */\r\n\tstatic get(value) {\r\n\r\n\t\tif (typeof value === \"object\" || typeof value === \"function\")\r\n\t\t\treturn value;\r\n\r\n\t\tlet arr = Font.array;\r\n\t\tlet n = arr.length;\r\n\t\twhile (n--) {\r\n\t\t\tif (arr[n].name === value) {\r\n\t\t\t\treturn arr[n];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\r\n\t}\r\n\r\n}\r\n\r\nGenerator.classStaticMatch(Font);\r\nFont.prototype.assetType = \"font\";\r\nFont.names = [];\r\nFont.array = [];\r\n\r\nexport default Font;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/font.js","export default () => {};\n\n\n// WEBPACK FOOTER //\n// ./core/js/utils/noop.js","import event from \"./event\";\r\nimport instance from \"./instance\";\r\nimport objectVars from \"./objectVars\";\r\nimport Pool from \"./utils/pool\";\r\nimport Generator from \"./generator\"\r\n\r\n/**\r\n *\r\n */\r\nclass GameObject {\r\n\r\n\t/**\r\n\t * @param {string} name\r\n\t * @param {number} sprite\r\n\t */\r\n\tconstructor(name, sprite) {\r\n\r\n\t\t// Create new constructor.\r\n\t\tvar obj = function(x, y) {\r\n\t\t\tvar inst = obj.pool.get(this);\r\n\t\t\tinstance.setup(inst, obj, x, y);\r\n\t\t\tobj.instances.push(inst);\r\n\t\t\treturn inst;\r\n\t\t};\r\n\r\n\t\tObject.assign(obj, GameObject.prototype);\r\n\t\tobjectVars.set(obj.prototype);\r\n\t\tobj.objectName = name || \"object_\" + obj.id;\r\n\t\tobj.prototype.sprite = sprite || null;\r\n\t\tobj.pool = new Pool(obj);\r\n\t\tobj.instances = [];\r\n\t\tGameObject.names.push(obj.objectName);\r\n\t\tGameObject.array.push(obj);\r\n\t\treturn obj;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} index\r\n\t * @return {Object}\r\n\t */\r\n\tfind(index) {\r\n\t\treturn instance.find(this, index);\r\n\t}\r\n\r\n\t/**\r\n\t * Add an action with variable parameters to an event of an object.\r\n\t * @param {*} object Can be an object constructor or integer ID.\r\n\t * @param {*} event\r\n\t * @param {*} action\r\n\t * @return {void}\r\n\t */\r\n\teventAddAction(event, action) {\r\n\r\n\t\tif (action === undefined) {\r\n\t\t\tconsole.warn(\"tried to add an undefined action to an event!\");\r\n\t\t}\r\n\r\n\t\t// If flow action, get flow tag.\r\n\t\tlet flow = \"\";\r\n\t\t//console.warn(action);\r\n\t\tif (typeof action === \"string\") {\r\n\t\t\tflow = action;\r\n\t\t}\r\n\r\n\t\t// Create a new event if not yet defined.\r\n\t\tif (!this.prototype.events[event]) {\r\n\t\t\tthis.prototype.events[event] = [];\r\n\t\t}\r\n\r\n\t\t// Create collision listeners, if applicable.\r\n\t\tif (event.includes(\"collision_\")) {\r\n\t\t\tlet index = event.indexOf(\"_\") + 1;\r\n\t\t\tlet name = event.slice(index, 200);\r\n\t\t\tGameObject.addCollisionListener(this, name);\r\n\t\t}\r\n\r\n\t\t// Add action to event.\r\n\t\tthis.prototype.events[event].push({\r\n\t\t\tflow: flow,\r\n\t\t\tcache: action\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\taddCollisionListener(target) {\r\n\t\tthis.prototype.listeners.push({\r\n\t\t\ttype: \"collision\",\r\n\t\t\ttarget: target\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * @return {Array}\r\n\t */\r\n\tgetAllInstances() {\r\n\t\tlet arr = [];\r\n\t\tinstance.instanceArray.forEach(inst => {\r\n\t\t\tlet name = inst.constructor.objectName;\r\n\t\t\tif (name === this.objectName) {\r\n\t\t\t\tarr.push(inst);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn arr;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {*} obj\r\n\t * @return {Object} The found object, or null if not found.\r\n\t */\r\n\tstatic get(obj) {\r\n\r\n\t\t// If obj is already an object/constructor.\r\n\t\tif (typeof obj !== \"string\")\r\n\t\t\treturn obj;\r\n\r\n\t\t// Iterate all objects to find the one we want.\r\n\t\tvar a = GameObject.array;\r\n\t\tvar n = a.length;\r\n\t\twhile (n--) {\r\n\t\t\tif (a[n].objectName === obj) {\r\n\t\t\t\treturn a[n];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Failed to find an object.\r\n\t\treturn null;\r\n\r\n\t}\r\n\r\n}\r\n\r\nGenerator.classStaticMatch(GameObject);\r\nGameObject.prototype.assetType = \"object\";\r\nGameObject.names = [];\r\nGameObject.array = [];\r\n\r\nexport default GameObject;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/object.js","import room from \"./room\";\r\nimport draw from \"./draw\";\r\nimport Generator from \"./generator\";\r\n\r\n/**\r\n * @author Jack Oatley\r\n */\r\nclass Camera {\r\n\r\n\t/**\r\n\t * Create a new Camera instance.\r\n\t * @param {object} [opts={}]\r\n\t * @param {number} [x]\r\n\t * @param {number} [y]\r\n\t * @param {number} [angle]\r\n\t * @param {number} [width]\r\n\t * @param {number} [height]\r\n\t * @param {number} [follow]\r\n\t * @param {number} [gridLocked]\r\n\t */\r\n\tconstructor(opts = {}) {\r\n\t\tthis.x = 0,\r\n\t\tthis.y = 0,\r\n\t\tthis.angle = 0,\r\n\t\tthis.width = room.current.width,\r\n\t\tthis.height = room.current.height,\r\n\t\tthis.follow = null,\r\n\t\tthis.gridLocked = false,\r\n\t\tthis.left = 0,\r\n\t\tthis.right = 0,\r\n\t\tthis.top = 0,\r\n\t\tthis.bottom = 0\r\n\t\tObject.assign(this, opts);\r\n\t\tCamera.array.push(this);\r\n\t}\r\n\r\n\t/**\r\n\t * Update the Camera.\r\n\t */\r\n\tupdate() {\r\n\t\tif (this.follow) {\r\n\r\n\t\t\t// if single instance, put into array\r\n\t\t\tif (!Array.isArray(this.follow))\r\n\t\t\t\tthis.follow = [this.follow];\r\n\r\n\t\t\t//\r\n\t\t\tlet x = 0, y = 0, count = 0, weight = 1;\r\n\t\t\tthis.follow.forEach((inst) => {\r\n\r\n\t\t\t\tif (Array.isArray(inst)) {\r\n\t\t\t\t\tweight = inst[1] || 1;\r\n\t\t\t\t\tinst = inst[0];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tweight = 1;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tx += inst.x * weight;\r\n\t\t\t\ty += inst.y * weight;\r\n\t\t\t\tcount += weight;\r\n\r\n\t\t\t});\r\n\r\n\t\t\tthis.x = x / count;\r\n\t\t\tthis.y = y / count;\r\n\t\t}\r\n\r\n\t\t// update bounds\r\n\t\tthis.left = this.x - this.width * 0.5;\r\n\t\tthis.right = this.x + this.width * 0.5;\r\n\t\tthis.top = this.y - this.height * 0.5;\r\n\t\tthis.bottom = this.y + this.height * 0.5;\r\n\r\n\t\t// apply camera\r\n\t\tdraw.transform.translate(-this.left, -this.top);\r\n\t}\r\n\r\n}\r\n\r\nCamera.array = [];\r\n\r\nCamera.create = Generator.functionFromConstructor(Camera);\r\nCamera.updateAll = Generator.arrayExecute(Camera.array, Camera.prototype.update);\r\n\r\nexport default Camera;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/camera.js","import Canvas from \"./Canvas\";\r\n\r\n/**\r\n *\r\n */\r\nexport default class App {\r\n\r\n\t/**\r\n\t * Sets the cursor to use when the mouse is in the game window.\r\n\t * @param {string} cursor Same as the CSS cursor property.\r\n\t * See {@link https://developer.mozilla.org/en-US/docs/Web/CSS/cursor}\r\n\t */\r\n\tstatic setCursor(cursor) {\r\n\t\tCanvas.main.style.cursor = cursor;\r\n\t}\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/App.js","/**\r\n * @module Pool\r\n */\r\n\r\n/**\r\n * The Pool object contains an array (the pool) called stack to which we can give objects. The Pool also maintains it's own length property, as the true length of the stack array does not change, so as to avoid garbage collection.\r\n * @param {Object} newConstructor The constructor function for this pool. During get, if no items are in the pool and no default value is provided, a new object is created from this constructor and returned.\r\n */\r\nexport default function Pool(newConstructor) {\r\n\tthis.stack = [];\r\n\tthis.length = 0;\r\n\tthis.newConstructor = newConstructor;\r\n}\r\n\r\n/**\r\n * @param {Object} [def] The default object (or even value) to return if no items are found in the pool. If this is not defined, and no items are found in the pool, then a new object is created as per the Pool's newConstructor property.\r\n */\r\nPool.prototype.get = function(def) {\r\n\tif (this.length) {\r\n\t\tdef = this.stack[--this.length];\r\n\t\tthis.stack[this.length] = undefined;\r\n\t}\r\n\treturn def || new this.newConstructor();\r\n}\r\n\r\n/**\r\n * @param {Object} i Objec to release, adding it to the pool.\r\n */\r\nPool.prototype.release = function(i) {\r\n\tthis.stack[this.length++] = i;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/utils/pool.js","import Canvas from \"./Canvas\";\r\nimport room from \"./room\";\r\nimport input from \"./input\";\r\nimport Instance from \"./instance\";\r\nimport global from \"./global\";\r\nimport draw from \"./draw\";\r\nimport Camera from \"./camera\";\r\nimport Transition from \"./transition\";\r\nimport NOOP from \"./utils/noop\";\r\n\r\nvar fpsFrames = 0;\r\nvar fpsTime = 0;\r\nvar lastTick = performance.now();\r\nvar tickLength = 1000 / 60;\r\nvar last = 0;\r\n\r\n//\r\nwindow.addConsoleText = window.addConsoleText || console.log;\r\nwindow._GB_stop = window._GB_stop || NOOP;\r\n\r\n//\r\nvar main = {\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tstart: function(opts = {}) {\r\n\r\n\t\t// Basic site-locking\r\n\t\tif (opts.host !== undefined && opts.host !== \"\") {\r\n\t\t\tlet loc = (window.parent) ? window.parent.location : window.location;\r\n\t\t\tlet host = loc.hostname;\r\n\t\t\tlet arr = opts.host.split(\" \").join(\"\").split(\",\");\r\n\t\t\tif (!opts.host.includes(host))\r\n\t\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tlet canv = new Canvas({\r\n\t\t\twidth: room.current.width,\r\n\t\t\theight: room.current.height,\r\n\t\t\tcrisp2D: true,\r\n\t\t\tapplication: true,\r\n\t\t\tcontext: opts.defaultContext || \"2d\"\r\n\t\t});\r\n\r\n\t\t// selectively enable input methods\r\n\t\tif (opts.enableMouse) input.initMouse();\r\n\t\tif (opts.enableKeyboard) input.initKeyboard();\r\n\t\tif (opts.enableTouch) input.initTouch();\r\n\t\tif (opts.hideCursor) canv.domElement.style.cursor = \"none\";\r\n\r\n\t\t//\r\n\t\troom.enter(room.current);\r\n\t\ttick(performance.now());\r\n\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tsetGameSpeed: function(speed) {\r\n\t\ttickLength = 1000 / speed;\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n *\r\n */\r\nfunction tick(timestamp) {\r\n\r\n\ttry {\r\n\r\n\t\t// Exit game with Esc key.\r\n\t\tif (window._GB_stop && input.triggerEvents.includes(\"EscapePress\"))\r\n\t\t\twindow._GB_stop();\r\n\r\n\t\t// request the next frame\r\n\t\twindow.requestAnimationFrame(tick);\r\n\t\tlet nextTick = lastTick + tickLength;\r\n\t\tlet numTicks = 0;\r\n\t\tglobal.fpsNow = 1000 / (timestamp - last);\r\n\t\tglobal.dt = timestamp - last;\r\n\t\tfpsFrames += 1;\r\n\t\tfpsTime += global.dt;\r\n\t\twhile (fpsTime >= 1000) {\r\n\t\t\tglobal.fps = fpsFrames;\r\n\t\t\tfpsFrames = 0;\r\n\t\t\tfpsTime -= 1000;\r\n\t\t}\r\n\t\tlast = timestamp;\r\n\r\n\t\t//\r\n\t\tif ( timestamp > nextTick ) {\r\n\t\t\tlet timeSinceTick = timestamp - lastTick;\r\n\t\t\tlet maxTicks = Math.floor(timeSinceTick / tickLength);\r\n\t\t\tlastTick = lastTick + tickLength * maxTicks;\r\n\t\t\tnumTicks = Math.min(maxTicks, 60);\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tinput.getTriggerEvents();\r\n\t\tqueueUpdates(numTicks);\r\n\t\tgameDraw();\r\n\r\n\t\t//\r\n\t\tif (numTicks) {\r\n\t\t\tinput.update();\r\n\t\t}\r\n\r\n\t} catch (err) {\r\n\t\tconsole.error(err);\r\n\t\twindow.addConsoleText(\"#F00\", \"Error: \" + err);\r\n\t\twindow._GB_stop();\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * @param {number} ticks\r\n * @return {void}\r\n */\r\nfunction queueUpdates(ticks) {\r\n\twhile (ticks--) {\r\n\t\tgameUpdate();\r\n\t}\r\n}\r\n\r\n/**\r\n * Update sequence.\r\n * @return {void}\r\n */\r\nfunction gameUpdate() {\r\n\tInstance.stepAll();\r\n\tTransition.updateAll();\r\n}\r\n\r\n/**\r\n * @return {void}\r\n */\r\nfunction gameDraw() {\r\n\tdraw.reset();\r\n\tCanvas.main.fill(\"#000\");\r\n\troom.draw(room.current);\r\n\tCamera.updateAll();\r\n\tInstance.drawAll();\r\n\tdraw.reset();\r\n\tInstance.drawGuiAll();\r\n\tTransition.drawAll();\r\n}\r\n\r\n/**\r\n * @return {void}\r\n */\r\nfunction handleResizeEvent() {\r\n\tInstance.executeEventAll(\"resize\");\r\n}\r\n\r\n// attach event listerners\r\nwindow.addEventListener(\"resize\", handleResizeEvent);\r\n\r\n//\r\nexport default main;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/main.js","/**\r\n * @module keyvalues\r\n */\r\n \r\nlet values = [\r\n\t\"ArrowUp\",\r\n\t\"ArrowDown\",\r\n\t\"ArrowLeft\",\r\n\t\"ArrowRight\",\r\n\t\"Enter\",\r\n\t\"Space\",\r\n\t\"Backspace\",\r\n\t\"Escape\",\r\n\t\"ShiftLeft\",\r\n\t\"ShiftRight\",\r\n\t\"ControlLeft\",\r\n\t\"ControlRight\",\r\n\t\"AltLeft\",\r\n\t\"AltRight\",\r\n\t\"KeyA\",\r\n\t\"KeyB\",\r\n\t\"KeyC\",\r\n\t\"KeyD\",\r\n\t\"KeyE\",\r\n\t\"KeyF\",\r\n\t\"KeyG\",\r\n\t\"KeyH\",\r\n\t\"KeyI\",\r\n\t\"KeyJ\",\r\n\t\"KeyK\",\r\n\t\"KeyL\",\r\n\t\"KeyM\",\r\n\t\"KeyN\",\r\n\t\"KeyO\",\r\n\t\"KeyP\",\r\n\t\"KeyQ\",\r\n\t\"KeyR\",\r\n\t\"KeyS\",\r\n\t\"KeyT\",\r\n\t\"KeyU\",\r\n\t\"KeyV\",\r\n\t\"KeyW\",\r\n\t\"KeyX\",\r\n\t\"KeyY\",\r\n\t\"KeyZ\",\r\n\t\"Digit0\",\r\n\t\"Digit1\",\r\n\t\"Digit2\",\r\n\t\"Digit3\",\r\n\t\"Digit4\",\r\n\t\"Digit5\",\r\n\t\"Digit6\",\r\n\t\"Digit7\",\r\n\t\"Digit8\",\r\n\t\"Digit9\"\r\n];\r\n\r\nexport default values;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/keyvalues.js","import keyValues from \"./keyvalues.js\";\r\n\r\n//\r\nlet events = {\r\n\tcreate: \"create\",\r\n\troomEnter: \"roomEnter\",\r\n\troomLeave: \"roomLeave\",\r\n\tstep: \"step\",\r\n\tdraw: \"draw\",\r\n\tcollision: \"collision_\",\r\n\tresize: \"resize\",\r\n\tkeyboard: {\r\n\t\t...translate(keyValues),\r\n\t\tpressed: translate(keyValues, \"Press\"),\r\n\t\treleased: translate(keyValues, \"Release\")\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {array} array\r\n * @param {string} [postfix=\"\"]\r\n */\r\nfunction translate(array, postfix = \"\") {\r\n\tlet obj = {};\r\n\tarray.forEach((name) => {\r\n\t\tobj[name] = name + postfix;\r\n\t});\r\n\treturn obj;\r\n}\r\n\r\n//\r\nexport default events;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/event.js","\r\nlet global = {\r\n\tdt: 0,\r\n\tfps: 0,\r\n\tfpsNow: 0\r\n}\r\n\r\nexport default global;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/global.js","import Generator from \"./generator\";\r\n\r\n/**\r\n * @author Jack Oatley\r\n */\r\nclass Sound {\r\n\r\n\t/**\r\n\t * @param {string} name name for the resource.\r\n\t * @param {string} source A path to an audio source, or a base64 encoded audio.\r\n\t */\r\n\tconstructor(name, source) {\r\n\t\tthis.name = name;\r\n\t\tthis.instances = [new Audio(source)];\r\n\t\tthis.ready = false;\r\n\t\tthis.volume = 1.0;\r\n\t\tSound.names.push(name);\r\n\t\tSound.array.push(this);\r\n\t\tthis.__test();\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Returns the asset type, this can't/shouldn't be overwitten.\r\n\t * @return {string}\r\n\t */\r\n\tget assetType() {\r\n\t\treturn \"sound\";\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} number\r\n\t * @return {void}\r\n\t */\r\n\tpreload(number) {\r\n\t\tvar a = this.instances;\r\n\t\tvar n = number - a.length;\r\n\t\twhile (n-- > 0) {\r\n\t\t\ta.push(a[0].cloneNode());\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {Object} [opts={}] object.\r\n\t */\r\n\tplay(opts = {}) {\r\n\t\tif (Sound.isEnabled) {\r\n\r\n\t\t\t// Find an existing sound instance to play.\r\n\t\t\tvar playSound;\r\n\t\t\tvar n = this.instances.length;\r\n\t\t\twhile (n--) {\r\n\t\t\t\tvar instance = this.instances[n];\r\n\t\t\t\tif (instance.paused) {\r\n\t\t\t\t\tplaySound = instance;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Create new instance of sound.\r\n\t\t\tif (!playSound) {\r\n\t\t\t\tplaySound = this.instances[0].cloneNode();\r\n\t\t\t\tthis.instances.push(playSound);\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\t\t\tplaySound.onError = (err) => {\r\n\t\t\t\tconsole.error(soundName, err);\r\n\t\t\t}\r\n\r\n\t\t\t// Play the sound.\r\n\t\t\tplaySound.volume = this.volume;\r\n\t\t\tlet promise = playSound.play();\r\n\t\t\tif (promise !== undefined) {\r\n\t\t\t\tpromise.then(function() {\r\n\r\n\t\t\t\t\t// on end event\r\n\t\t\t\t\tplaySound.onended = function() {\r\n\r\n\t\t\t\t\t\t// Internal event stuff.\r\n\t\t\t\t\t\tthis.currentTime = 0;\r\n\t\t\t\t\t\tif (Number(opts.loop || false)) {\r\n\t\t\t\t\t\t\tthis.play();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.pause();\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Custom event, if defined.\r\n\t\t\t\t\t\tif (opts.onEnd) {\r\n\t\t\t\t\t\t\topts.onEnd();\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}).catch((err) => {\r\n\t\t\t\t\tconsole.warn(err);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\t\t\treturn playSound;\r\n\t\t}\r\n\r\n\t\t// sound is disabled\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * Stop all instances of the sound from playing.\r\n\t * @return {void}\r\n\t */\r\n\tstop() {\r\n\t\tvar a = this.instances;\r\n\t\tvar n = a.length;\r\n\t\twhile (n--) {\r\n\t\t\tvar i = a[n];\r\n\t\t\tif (!i.paused) {\r\n\t\t\t\ti.currentTime = 0;\r\n\t\t\t\ti.pause();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Tests whether the Sound resource has an instance that is ready to play.\r\n\t * Generates a callback function that sets the resource's \"ready\" property.\r\n\t * @return {void}\r\n\t */\r\n\t__test() {\r\n\t\tvar i = this;\r\n\t\tlet a = this.instances[0];\r\n\t\ta.oncanplaythrough = function() {\r\n\t\t\ti.ready = true;\r\n\t\t\ta.oncanplaythrough = null;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @return {boolean}\r\n\t */\r\n\tstatic readyAll() {\r\n\t\tvar a = Sound.array;\r\n\t\tvar n = a.length;\r\n\t\twhile (n--) {\r\n\t\t\tif (!a[n].ready) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {boolean} x\r\n\t * @return {void}\r\n\t */\r\n\tstatic enable(x) {\r\n\t\tSound.isEnabled = x;\r\n\t}\r\n\r\n\t/**\r\n\t * Gets the sound resource from the given string.\r\n\t * If a sound resource is passed, it's returned immedietly.\r\n\t * @param {*} name Name as string, or object.\r\n\t * @return {Object}\r\n\t */\r\n\tstatic get(name) {\r\n\r\n\t\tif (typeof name === \"object\") {\r\n\t\t\treturn name;\r\n\t\t}\r\n\r\n\t\tvar a = Sound.array;\r\n\t\tvar n = a.length;\r\n\t\twhile (n--) {\r\n\t\t\tif (a[n].name === name) {\r\n\t\t\t\treturn a[n];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\twindow.addConsoleText(\"#F00\", \"Unknown sound: \"+ name);\r\n\t\treturn null;\r\n\r\n\t}\r\n\r\n}\r\n\r\nGenerator.classStaticMatch(Sound);\r\nSound.isEnabled = true;\r\nSound.names = [];\r\nSound.array = [];\r\n\r\n// Export.\r\nexport default Sound;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/Sound.js","\r\n//\r\nlet tween = {\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tblend( n1 , n2 , perc ) {\r\n\t\tlet diff = n2 - n1;\r\n\t\treturn n1 + ( diff * perc );\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tcubicBezier( x2, y2, x3, y3, i ) {\r\n\t\t\r\n\t\tlet x1 = 0,\r\n\t\t\ty1 = 0,\r\n\t\t\tx4 = 1,\r\n\t\t\ty4 = 1;\r\n\t\t\r\n\t\t // The Green Lines\r\n\t\tlet xa = tween.blend( x1 , x2 , i ),\r\n\t\t\tya = tween.blend( y1 , y2 , i ),\r\n\t\t\txb = tween.blend( x2 , x3 , i ),\r\n\t\t\tyb = tween.blend( y2 , y3 , i ),\r\n\t\t\txc = tween.blend( x3 , x4 , i ),\r\n\t\t\tyc = tween.blend( y3 , y4 , i ),\r\n\r\n\t\t\t// The Blue Line\r\n\t\t\txm = tween.blend( xa , xb , i ),\r\n\t\t\tym = tween.blend( ya , yb , i ),\r\n\t\t\txn = tween.blend( xb , xc , i ),\r\n\t\t\tyn = tween.blend( yb , yc , i ),\r\n\r\n\t\t\t// The Black Dot\r\n\t\t\tx = tween.blend( xm , xn , i ),\r\n\t\t\ty = tween.blend( ym , yn , i );\r\n\t\t\r\n\t\t//\r\n\t\treturn y;\r\n\t\t\r\n\t}\r\n\t\r\n}\r\n\r\n//\r\nexport default tween;\n\n\n// WEBPACK FOOTER //\n// ./core/js/tween.js","import Draw from \"./../draw\";\r\nimport sprite from \"./../sprite\";\r\nimport Generator from \"./../generator\";\r\nimport NOOP from \"./../utils/noop\";\r\n\r\n/** */\r\nclass Primitive {\r\n\r\n\t/**\r\n\t * @param {Object} opts Options object.\r\n\t * @param {Array} opts.points Array of Point objects.\r\n\t * @param {*} opts.texture Sprite object or name of sprite resource.\r\n\t * @param {*} opts.color Color of the primitive.\r\n\t * @param {string} opts.format Format of the points array.\r\n\t * @param {Function} opts.modifier Point modifier function.\r\n\t * @param {number} opts.x X position to draw the primitive.\r\n\t * @param {number} opts.y Y position to draw the primitive.\r\n\t */\r\n\tconstructor(opts = {}) {\r\n\t\tthis.points = opts.points || [];\r\n\t\tthis.texture = opts.texture || null;\r\n\t\tthis.color = opts.color || \"#000000\";\r\n\t\tthis.format = opts.format || \"quads\";\r\n\t\tthis.modifier = opts.modifier || NOOP;\r\n\t\tthis.x = opts.x || 0;\r\n\t\tthis.y = opts.y || 0;\r\n\t}\r\n\r\n\t/**\r\n\t * Method for drawing instantiated Primitive.\r\n\t * @return {void}\r\n\t */\r\n\tdraw(opts) {\r\n\t\tvar i = opts || this;\r\n\t\tif (i.texture) {\r\n\t\t\tdrawTextured(i);\r\n\t\t} else {\r\n\t\t\tdrawBasic(i);\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n *\r\n */\r\nfunction drawTextured(opts = {}) {\r\n\r\n\tlet texture = opts.texture;\r\n\tlet spr = sprite.get(texture);\r\n\tif (spr === null) {\r\n\t\tconsole.warn(\"No such texture: \" + texture);\r\n\t\treturn;\r\n\t}\r\n\r\n\tlet ctx = Draw.context;\r\n\tlet frame = spr.images[0];\r\n\tlet img = frame.img;\r\n\tlet w = spr.width;\r\n\tlet h = spr.height;\r\n\tlet tris = orderTriangleList(opts);\r\n\r\n\t//\r\n\tvar pts = opts.points;\r\n\tif (opts.modifier) {\r\n\t\tpts = applyModifier(opts.points, opts.modifier);\r\n\t}\r\n\r\n\tpts.forEach(function(p) {\r\n\t\tp.x += opts.x;\r\n\t\tp.y += opts.y;\r\n\t});\r\n\r\n\tvar t = tris.length\r\n\twhile (t--) {\r\n\r\n\t\tvar pp = tris[t];\r\n\t\tvar x0 = pts[pp[0]].x, x1 = pts[pp[1]].x, x2 = pts[pp[2]].x;\r\n\t\tvar y0 = pts[pp[0]].y, y1 = pts[pp[1]].y, y2 = pts[pp[2]].y;\r\n\t\tvar u0 = pts[pp[0]].u*w, u1 = pts[pp[1]].u*w, u2 = pts[pp[2]].u*w;\r\n\t\tvar v0 = pts[pp[0]].v*h, v1 = pts[pp[1]].v*h, v2 = pts[pp[2]].v*h;\r\n\r\n\t\t// Set clipping area so that only pixels inside the triangle will\r\n\t\t// be affected by the image drawing operation\r\n\t\tctx.save();\r\n\t\tctx.beginPath();\r\n\t\tctx.moveTo(x0, y0);\r\n\t\tctx.lineTo(x1, y1);\r\n\t\tctx.lineTo(x2, y2);\r\n\t\tctx.closePath();\r\n\t\tctx.clip();\r\n\r\n\t\t// Compute matrix transform\r\n\t\tvar delta = u0*v1 + v0*u2 + u1*v2 - v1*u2 - v0*u1 - u0*v2;\r\n\t\tvar delta_a = x0*v1 + v0*x2 + x1*v2 - v1*x2 - v0*x1 - x0*v2;\r\n\t\tvar delta_b = u0*x1 + x0*u2 + u1*x2 - x1*u2 - x0*u1 - u0*x2;\r\n\t\tvar delta_c = u0*v1*x2 + v0*x1*u2 + x0*u1*v2 - x0*v1*u2 - v0*u1*x2 - u0*x1*v2;\r\n\t\tvar delta_d = y0*v1 + v0*y2 + y1*v2 - v1*y2 - v0*y1 - y0*v2;\r\n\t\tvar delta_e = u0*y1 + y0*u2 + u1*y2 - y1*u2 - y0*u1 - u0*y2;\r\n\t\tvar delta_f = u0*v1*y2 + v0*y1*u2 + y0*u1*v2 - y0*v1*u2 - v0*u1*y2 - u0*y1*v2;\r\n\r\n\t\t// Draw the transformed image\r\n\t\tctx.transform(delta_a/delta, delta_d/delta,\r\n\t\t\t\t\t  delta_b/delta, delta_e/delta,\r\n\t\t\t\t\t  delta_c/delta, delta_f/delta);\r\n\t\tctx.drawImage(img, 0, 0);\r\n\t\tctx.restore();\r\n\t}\r\n}\r\n\r\n/**\r\n *\r\n */\r\nfunction drawBasic(opts = {}) {\r\n\tvar points = opts.points;\r\n\tif (opts.modifier) {\r\n\t\tpoints = applyModifier(opts.points, opts.modifier);\r\n\t}\r\n\tlet length = points.length;\r\n\tif (length > 0) {\r\n\t\tlet tris = orderQuadList(opts);\r\n\t\tlet i, ctx = Draw.context;\r\n\t\tctx.fillStyle = opts.color || Draw.color;\r\n\t\tfor (i=0; i<tris.length; i++) {\r\n\t\t\tlet tri = tris[i];\r\n\t\t\tlet n, p = points[tri[0]];\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.moveTo(opts.x+p.x, opts.y+p.y);\r\n\t\t\tfor (n=1; n<tri.length; n++) {\r\n\t\t\t\tp = points[tri[n]];\r\n\t\t\t\tctx.lineTo(opts.x+p.x, opts.y+p.y);\r\n\t\t\t}\r\n\t\t\tctx.closePath();\r\n\t\t\tctx.fill();\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n *\r\n */\r\nfunction applyModifier(points, modifier) {\r\n\tvar newPoints = [];\r\n\tvar n = points.length;\r\n\twhile (n--) {\r\n\t\tvar newP = Object.assign({}, points[n]);\r\n\t\tmodifier(newP)\r\n\t\tnewPoints.push(newP);\r\n\t}\r\n\treturn newPoints;\r\n}\r\n\r\n/**\r\n * @param {object} opts\r\n */\r\nfunction orderTriangleList(opts = {}) {\r\n\tvar tris = [];\r\n\tif (opts.format === \"quads\") {\r\n\t\tvar n = Math.floor(opts.points.length / 4);\r\n\t\tvar o = 0;\r\n\t\twhile (n--) {\r\n\t\t\ttris.push([o+0, o+1, o+2], [o+2, o+3, o+0]);\r\n\t\t\to += 4;\r\n\t\t}\r\n\t}\r\n\treturn tris;\r\n}\r\n\r\n/**\r\n * @param {object} opts\r\n * @return {Array}\r\n */\r\nfunction orderQuadList(opts = {}) {\r\n\tvar tris = [];\r\n\tvar n = Math.floor(opts.points.length / 4);\r\n\tvar o = 0;\r\n\twhile (n--) {\r\n\t\ttris.push([o++, o++, o++, o++]);\r\n\t}\r\n\treturn tris;\r\n}\r\n\r\nGenerator.classStaticMatch(Primitive);\r\n\r\nexport default Primitive;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/drawing/primitive.js","import Generator from \"./generator\";\r\n\r\n/** */\r\nclass Vector2 {\r\n\r\n\t/** */\r\n\tconstructor(x, y) {\r\n\t\tthis.set(x, y);\r\n\t}\r\n\r\n\t/** */\r\n\tset(x, y) {\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t}\r\n\r\n\t/** */\r\n\tcopy(v) {\r\n\t\tthis.x = v.x;\r\n\t\tthis.y = v.y;\r\n\t}\r\n\r\n\t/** */\r\n\tadd(v) {\r\n\t\tthis.x += v.x;\r\n\t\tthis.y += v.y;\r\n\t}\r\n\r\n\t/** */\r\n\tmul(v) {\r\n\t\tthis.x *= v.x;\r\n\t\tthis.y *= v.y;\r\n\t}\r\n\r\n\t/** */\r\n\tdiv(v) {\r\n\t\tthis.x /= v.x;\r\n\t\tthis.y /= v.y;\r\n\t}\r\n\r\n}\r\n\r\nGenerator.classStaticMatch(Vector2);\r\n\r\nexport default Vector2;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/Vector2.js","import App from \"./App\";\r\nimport main from \"./main\";\r\nimport canvas from \"./Canvas\";\r\nimport Camera from \"./camera\";\r\nimport Room from \"./room\";\r\nimport input from \"./input\";\r\nimport Script from \"./Script\";\r\nimport sprite from \"./sprite\";\r\nimport Sound from \"./Sound\";\r\nimport object from \"./object\";\r\nimport event from \"./event\";\r\nimport * as action from \"./action\";\r\nimport instance from \"./instance\";\r\nimport draw from \"./draw\";\r\nimport math from \"./math\";\r\nimport tween from \"./tween\";\r\nimport Transition from \"./transition\";\r\nimport Primitive from \"./drawing/primitive\";\r\nimport Font from \"./font\";\r\nimport Grid from \"./data/grid\";\r\nimport Vector2 from \"./Vector2\";\r\n\r\nexport {\r\n\tApp,\r\n\tcanvas,\r\n\tCamera,\r\n\tRoom,\r\n\tinput,\r\n\tsprite,\r\n\tSound,\r\n\tScript,\r\n\tobject,\r\n\tevent,\r\n\taction,\r\n\tinstance,\r\n\tdraw,\r\n\tmain,\r\n\tmath,\r\n\ttween,\r\n\tTransition,\r\n\tFont,\r\n\tGrid,\r\n\tVector2\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/core.js","import Draw from \"../draw\";\n\n/**\n * @param {number} x1\n * @param {number} y1\n * @param {number} x2\n * @param {number} y2\n * @param {Object} [opts={}]\n * @return {void}\n */\nfunction line(x1, y1, x2, y2, opts = {}) {\n\tvar ctx = Draw.context;\n\tctx.strokeStyle = opts.color || Draw.color;\n\tctx.beginPath();\n\tctx.moveTo(x1, y1);\n\tctx.lineTo(x2, y2);\n\tctx.stroke();\n}\n\n/**\n * @param {number} x1\n * @param {number} y1\n * @param {number} x2\n * @param {number} y2\n * @param {Object} [opts={}]\n * @return {void}\n */\nfunction ellipse(x, y, xr, yr, opts = {}) {\n\n\t//\n\tvar ctx = Draw.context;\n\tctx.save();\n\tctx.beginPath();\n\tctx.translate(x-xr, y-yr);\n\tctx.scale(xr, yr);\n\tctx.arc(1, 1, 1, 0, 2 * Math.PI, false);\n\tctx.restore();\n\n\t//\n\tlet style;\n\tif (opts.healthbar) {\n\t\tlet amount = opts.healthbar.amount || 1;\n\t\tlet color = opts.healthbar.color || \"#0F0\";\n\t\tlet background = opts.healthbar.background || \"#F00\";\n\t\tstyle = ctx.createLinearGradient( x-xr, 0, x+xr, 0 );\n\t\tstyle.addColorStop(0, color);\n\t\tstyle.addColorStop(amount, color);\n\t\tstyle.addColorStop(amount, background);\n\t\tstyle.addColorStop(1, background);\n\t} else {\n\t\tstyle = opts.color || Draw.color;\n\t}\n\n\t//\n\tif (opts.fill || (!opts.fill && !opts.stroke)) {\n\t\tctx.fillStyle = style;\n\t\tctx.fill();\n\t}\n\n\tif (opts.stroke) {\n\t\tctx.strokeStyle = style\n\t\tctx.lineWidth = opts.lineWidth || 1;\n\t\tctx.stroke();\n\t}\n\n}\n\n/**\n * @param {number} x\n * @param {number} y\n * @param {number} w\n * @param {number} h\n * @param {Object} [opts={}]\n * @return {void}\n */\nfunction rectangle(x, y, w, h, opts = {}) {\n\n\t//\n\tvar ctx = Draw.context;\n\tctx.beginPath();\n\tctx.rect(x, y, w, h);\n\n\t//\n\tlet style;\n\tif (opts.healthbar) {\n\t\tlet amount = opts.healthbar.amount || 1;\n\t\tlet color = opts.healthbar.color || \"#0F0\";\n\t\tlet background = opts.healthbar.background || \"#F00\";\n\t\tstyle = ctx.createLinearGradient(x, 0, x+w, 0);\n\t\tstyle.addColorStop(0, color);\n\t\tstyle.addColorStop(amount, color);\n\t\tstyle.addColorStop(amount, background);\n\t\tstyle.addColorStop(1, background);\n\t} else {\n\t\tstyle = opts.color || Draw.color;\n\t}\n\n\t//\n\tif (opts.fill || (!opts.fill && !opts.stroke)) {\n\t\tctx.fillStyle = style;\n\t\tctx.fill();\n\t}\n\n\tif (opts.stroke) {\n\t\tctx.strokeStyle = style;\n\t\tctx.lineWidth = opts.lineWidth || 1;\n\t\tctx.stroke();\n\t}\n\n}\n\n//\nexport default { line, ellipse, rectangle }\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/drawing/DrawShapes.js","import math from \"./math.js\";\r\nimport instance from \"./instance.js\";\r\n\r\n//\r\nlet basic = JSON.stringify({\r\n\tsprite: null,\r\n\tindex: 0,\r\n\timageSpeed: 1,\r\n\tanimationBehavior: \"loop\",\r\n\tvisible: true,\r\n\tsolid: false,\r\n\tpersistent: false,\r\n\texists: true,\r\n\tscaleX: 1,\r\n\tscaleY: 1,\r\n\trotation: 0,\r\n\tterminal: 100,\r\n\tgravity: 0,\r\n\tgravityDirection: 0,\r\n\tspeedX: 0,\r\n\tspeedY: 0,\r\n\tboxTop: 0,\r\n\tboxBottom: 0,\r\n\tboxLeft: 0,\r\n\tboxRight: 0,\r\n\tbehaviours: [],\r\n\tlisteners: [],\r\n\tevents: {},\r\n\tboxCollision: {\r\n\t\tx: 0,\r\n\t\ty: 0,\r\n\t\twidth: 0,\r\n\t\theight: 0,\r\n\t\ttop: 0,\r\n\t\tbottom: 0,\r\n\t\tleft: 0,\r\n\t\tright: 0\r\n\t},\r\n\t_depth: 0\r\n});\r\n\r\n//\r\nlet ObjectVars = {\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tset: function(proto) {\r\n\t\tObject.assign(proto, JSON.parse(basic));\r\n\r\n\t\tproto.nearest = function(obj) {\r\n\t\t\treturn instance.nearest(this.x, this.y, obj);\r\n\t\t}\r\n\r\n\t\tproto.furthest = function(obj) {\r\n\t\t\treturn instance.furthest(this.x, this.y, obj);\r\n\t\t}\r\n\r\n\t\tproto.moveTowardsPoint = function(x, y, spd) {\r\n\t\t\tinstance.moveTowardsPoint(this, x, y, spd);\r\n\t\t}\r\n\r\n\t\tproto.stepTowardsPoint = function(x, y, spd) {\r\n\t\t\tinstance.stepTowardsPoint(this, x, y, spd);\r\n\t\t}\r\n\r\n\t\tproto.distanceToPoint = function(x, y) {\r\n\t\t\treturn instance.distanceToPoint(this, x, y);\r\n\t\t}\r\n\r\n\t\tproto.destroy = function() {\r\n\t\t\tinstance.destroy(this);\r\n\t\t}\r\n\r\n\t\tproto.mouseOn = function() {\r\n\t\t\treturn instance.mouseOn(this);\r\n\t\t}\r\n\r\n\t\tObject.defineProperty(proto, \"depth\", {\r\n\t\t\tset: function(x) {\r\n\t\t\t\tif (this._depth !== x) {\r\n\t\t\t\t\tthis._depth = x;\r\n\t\t\t\t\tinstance.doDepthSort = true;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tget: function() { return this._depth; }\r\n\t\t});\r\n\r\n\t\tObject.defineProperty(proto, \"speed\", {\r\n\t\t\tset: function(x) {\r\n\t\t\t\tlet y = this.direction * math.DEGTORAD;\r\n\t\t\t\tthis.speedX = Math.cos(y) * x;\r\n\t\t\t\tthis.speedY = Math.sin(y) * x;\r\n\t\t\t},\r\n\t\t\tget: function( x ) {\r\n\t\t\t\treturn math.pointDistance( 0, 0, this.speedX, this.speedY );\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\t\tObject.defineProperty(proto, \"direction\", {\r\n\t\t\tset: function(x) {\r\n\t\t\t\tlet y = this.speed;\r\n\t\t\t\tthis.speedX = Math.cos(x * math.DEGTORAD) * y;\r\n\t\t\t\tthis.speedY = Math.sin(x * math.DEGTORAD) * y;\r\n\t\t\t},\r\n\t\t\tget: function( x ) {\r\n\t\t\t\treturn math.pointDirection( 0, 0, this.speedX, this.speedY );\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\t}\r\n\r\n}\r\n\r\n//\r\nexport default ObjectVars;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/objectVars.js","\r\n/**\r\n *\r\n */\r\nexport default class Script {\r\n}\r\n\r\nScript.names = [];\n\n\n// WEBPACK FOOTER //\n// ./core/js/Script.js","import Room from \"./room\";\r\nimport Sound from \"./Sound\";\r\nimport draw from \"./draw\";\r\nimport instance from \"./instance\";\r\nimport input from \"./input\";\r\nimport math from \"./math\";\r\nimport Sprite from \"./sprite\";\r\nimport Canvas from \"./Canvas\";\r\nimport Color from \"./Color\";\r\nimport main from \"./main\";\r\nimport Camera from \"./camera\";\r\nimport App from \"./App\";\r\nimport Grid from \"./data/grid\";\r\nimport Tilemap from \"./tilemap\";\r\nimport tween from \"./tween\";\r\nimport Transition from \"./transition\";\r\nimport Font from \"./font\";\r\nimport GameObject from \"./object\";\r\nimport Primitive from \"./drawing/primitive\";\r\nimport Vector2 from \"./Vector2\";\r\n\r\n/**\r\n * Set the variable with the given name.\r\n * @param {string} varName\r\n * @param {*} value\r\n * @param {boolean} relative\r\n * @param {boolean} global\r\n * @return {void}\r\n */\r\nfunction set(varName, value, relative, global) {\r\n\tlet target = global ? window.global : this;\r\n\tif (relative) {\r\n\t\ttarget[varName] += value\r\n\t} else {\r\n\t\ttarget[varName] = value;\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string} varName\r\n * @param {string} op Operation.\r\n * @param {value} value Value to check against.\r\n * @param {boolean} global\r\n * @return {boolean}\r\n */\r\nfunction test(varName, op, value, global) {\r\n\tlet target = global ? window.global : this;\r\n\tswitch (op) {\r\n\t\tcase(\"!==\"): return target[varName] !== value;\r\n\t\tcase(\"===\"): return target[varName] === value;\r\n\t\tcase(\"!=\"): return target[varName] != value;\r\n\t\tcase(\"==\"): return target[varName] == value;\r\n\t\tcase(\"<\"): return target[varName] < value;\r\n\t\tcase(\">\"): return target[varName] > value;\r\n\t\tcase(\"<=\"): return target[varName] <= value;\r\n\t\tcase(\">=\"): return target[varName] >= value;\r\n\t\tdefault: return false;\r\n\t}\r\n}\r\n\r\n/**\r\n * Sets the instance's gravity to the given value.\r\n * @param {number} value The gravity strength.\r\n * @return {void}\r\n */\r\nfunction setGravity(value) {\r\n\tthis.gravity = value;\r\n}\r\n\r\n/**\r\n * Instantly sets the instance's x and y values to a random position within\r\n * the current room.\r\n * @param {number} x\r\n * @param {number} y\r\n * @param {boolean} relative\r\n * @return {void}\r\n */\r\nfunction jump(x, y, relative) {\r\n\tif (relative) {\r\n\t\tthis.x += Number(x);\r\n\t\tthis.y += Number(y);\r\n\t} else {\r\n\t\tthis.x = Number(x);\r\n\t\tthis.y = Number(y);\r\n\t}\r\n}\r\n\r\n/**\r\n * Instantly sets the instance's x and y values to a random position within\r\n * the current room.\r\n * @return {void}\r\n */\r\nfunction jumpRandom() {\r\n\tlet x1 = 0, y1 = 0, x2 = 640, y2 = 480;\r\n\tthis.x = Math.floor(Math.random() * (x2 - x1 + 1)) + x1;\r\n\tthis.y = Math.floor(Math.random() * (y2 - y1 + 1)) + y1;\r\n}\r\n\r\n/**\r\n * @param {number} speed\r\n * @param {number} direction\r\n * @return {void}\r\n */\r\nfunction moveFree(speed, direction) {\r\n\tthis.speed = speed;\r\n\tthis.direction = direction;\r\n}\r\n\r\n/**\r\n * Instantly sets the instance's x and y values to a random position within\r\n * the current room.\r\n * @param {number} x\r\n * @param {number} y\r\n * @return {void}\r\n */\r\nfunction moveDirect(x, y) {\r\n\tthis.x += x * main.dt;\r\n\tthis.y += y * main.dt;\r\n}\r\n\r\n/**\r\n * @param  {type} speed\r\n * @return {void}\r\n */\r\nfunction moveSpeedX(speed) {\r\n\tthis.speedX = Number(speed);\r\n}\r\n\r\n/**\r\n * @param  {type} speed\r\n * @return {void}\r\n */\r\nfunction moveSpeedY(speed) {\r\n\tthis.speedY = Number(speed);\r\n}\r\n\r\n/**\r\n * @return {void}\r\n */\r\nfunction moveReverseX() {\r\n\tthis.speedX = -this.speedX;\r\n}\r\n\r\n/**\r\n * @return {void}\r\n */\r\nfunction moveReverseY() {\r\n\tthis.speedY = -this.speedY;\r\n}\r\n\r\n/**\r\n * Wraps the instance back into the room when it leaves.\r\n * @return {void}\r\n */\r\nfunction actionWrap() {\r\n\tlet width = this.boxRight - this.boxLeft;\r\n\tlet height = this.boxBottom - this.boxTop;\r\n\tlet thisRoom = Room.current;\r\n\tlet roomW = thisRoom.width;\r\n\tlet roomH = thisRoom.height;\r\n\tif (this.boxRight < 0) this.x += roomW + width;\r\n\tif (this.boxBottom < 0) this.y += roomH + height;\r\n\tif (this.boxLeft > roomW) this.x -= roomW + width;\r\n\tif (this.boxTop > roomH) this.y -= roomH + height;\r\n}\r\n\r\n/**\r\n * Wraps the instance back into the room when it leaves.\r\n * @return {void}\r\n */\r\nfunction actionConfine() {\r\n\tlet width = this.boxRight - this.boxLeft;\r\n\tlet height = this.boxBottom - this.boxTop;\r\n\tlet thisRoom = Room.current;\r\n\tlet roomW = thisRoom.width;\r\n\tlet roomH = thisRoom.height;\r\n\tif (this.boxLeft < 0) this.x = this.x - this.boxLeft;\r\n\tif (this.boxTop < 0) this.y = this.y - this.boxTop;\r\n\tif (this.boxRight > roomW) this.x = roomW - width + this.x - this.boxLeft;\r\n\tif (this.boxBottom > roomH) this.y = roomH - height + this.y - this.boxTop;\r\n}\r\n\r\n/**\r\n * Executes the given function with variable arguments on the instance.\r\n * @param {function} func\r\n * @param {...*} args\r\n * @return {void}\r\n */\r\nfunction actionFunc(func, ...args) {\r\n\tfunc.apply(this, args);\r\n}\r\n\r\n/**\r\n * Executes the given Script with an array of arguments.\r\n * @param {script} func\r\n * @param {array} args\r\n * @return {void}\r\n */\r\nfunction script(s, args) {\r\n\tif (typeof s === \"string\") {\r\n\t\twindow[s].apply(this, args);\r\n\t} else {\r\n\t\ts.apply(this, args);\r\n\t}\r\n}\r\n\r\n/**\r\n * Shows the value of the given variable of the instance, in the console.\r\n * @param {...*} args\r\n * @return {void}\r\n */\r\nfunction get(...args) {\r\n\tconsole.log(this[args].toFixed(2));\r\n}\r\n\r\n// Fucntions for use in code.\r\nlet GAME = {\r\n\tApp: App,\r\n\tCamera: Camera,\r\n\tCanvas: Canvas,\r\n\tColor: Color,\r\n\tmain: {\r\n\t\tsetGameSpeed: main.setGameSpeed\r\n\t},\r\n\tinstance: instance,\r\n\tdraw: Object.assign(draw, {\r\n\t\tself: instance.drawSelf,\r\n\t\tdebug: instance.drawDebug\r\n\t}),\r\n\tRoom: Room,\r\n\tsprite: Sprite,\r\n\tSound: Sound,\r\n\tinput: {\r\n\t\tkeyboard: input.keyboard,\r\n\t\tmouse: input.mouse,\r\n\t\ttouch: input.touch\r\n\t},\r\n\tmath: math,\r\n\tFont: Font,\r\n\tGrid: Grid,\r\n\tTilemap: Tilemap,\r\n\ttween: tween,\r\n\tTransition: Transition,\r\n\tObject: GameObject,\r\n\tPrimitive: Primitive,\r\n\tVector2: Vector2\r\n}\r\n\r\n//\r\nlet blockBegin = \"blockBegin\",\r\n\tblockEnd = \"blockEnd\",\r\n\texitEvent = \"exitEvent\",\r\n\tifElse = \"ifElse\",\r\n\troomEnter = Room.enter,\r\n\troomNext = Room.next,\r\n\troomPrevious = Room.previous,\r\n\tinstanceCreate = instance.create,\r\n\tinstanceCreateMoving = instance.createMoving,\r\n\tinstanceDestroy = instance.destroy,\r\n\tchangeSprite = instance.changeSprite,\r\n\tinstanceSetRotation = instance.setRotation,\r\n\tinstanceSetDirection = instance.setDirection,\r\n\tmessage = args => console.log(args),\r\n\talert = function(m) { window.alert(m) },\r\n\tconfirm = function(m) { return window.confirm(m) },\r\n\tdrawSetColor = draw.setColor,\r\n\tdrawSetFont = draw.setFont,\r\n\tdrawSetFontSize = draw.setFontSize,\r\n\tdrawText = draw.text,\r\n\tdrawRectangle = draw.shape.rectangle,\r\n\tdrawSelf = instance.drawSelf,\r\n\tdrawSprite = draw.sprite,\r\n\tsoundPlay = function(snd, loop) {Sound.play(snd, {loop: loop})},\r\n\tsoundStop = Sound.stop;\r\n\r\n//\r\nexport {\r\n\tinstanceCreate,\r\n\tinstanceCreateMoving,\r\n\tinstanceDestroy,\r\n\tinstanceSetRotation,\r\n\tinstanceSetDirection,\r\n\tchangeSprite,\r\n\tchangeSprite as instanceChangeSprite,\r\n\tsoundPlay, soundStop,\r\n\tdrawSetColor,\r\n\tdrawSetFont,\r\n\tdrawSetFontSize,\r\n\tdrawText,\r\n\tdrawRectangle,\r\n\tdrawSelf,\r\n\tdrawSelf as instanceDrawSelf,\r\n\tdrawSprite,\r\n\troomEnter, roomNext, roomPrevious,\r\n\tblockBegin, blockEnd, ifElse,\r\n\texitEvent,\r\n\tset,\r\n\tget,\r\n\ttest,\r\n\tsetGravity,\r\n\tjump,\r\n\tjumpRandom,\r\n\tmoveFree,\r\n\tmoveDirect,\r\n\tmoveSpeedX,\r\n\tmoveSpeedY,\r\n\tmoveReverseX,\r\n\tmoveReverseY,\r\n\tactionWrap,\r\n\tactionConfine,\r\n\tactionWrap       as wrap,\r\n\tactionConfine    as confine,\r\n\tactionFunc       as func,\t// DEPRECATE?\r\n\tscript,\r\n\tmessage,\r\n\talert,\r\n\tconfirm,\r\n\tGAME\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/action.js","import Generator from \"./generator\";\r\nimport Grid from \"./data/grid\";\r\nimport Draw from \"./draw\";\r\nimport Sprite from \"./sprite\";\r\n\r\n/**\r\n * @author Jack Oatley\r\n */\r\nclass Tilemap {\r\n\r\n\t/**\r\n\t * @param {Object} [opts={}] Options object to define the Tilemap.\r\n\t * @param {Object} [opts.atlas]\r\n\t * @param {number} [opts.tileWidth]\r\n\t * @param {number} [opts.tileHeight]\r\n\t * @param {number} [opts.tileSpacing]\r\n\t * @param {number} [opts.tileOverlay]\r\n\t * @param {number} [opts.tilesWide]\r\n\t * @param {number} [opts.mapWidth]\r\n\t * @param {number} [opts.mapHeight]\r\n\t */\r\n\tconstructor(opts = {}) {\r\n\t\tthis.textureAtlas = opts.atlas || null;\r\n\t\tthis.tileWidth = opts.tileWidth || 16;\r\n\t\tthis.tileHeight = opts.tileHeight || 16;\r\n\t\tthis.tileSpacing = opts.tileSpacing || 0;\r\n\t\tthis.tileOverlay = opts.tileOverlay || 0;\r\n\t\tthis.tilesWide = opts.tilesWide || 16;\r\n\t\tthis.mapWidth = opts.mapWidth || 16;\r\n\t\tthis.mapHeight = opts.mapHeight || 16;\r\n\t\tthis.layers = {};\r\n\r\n\t\tthis.__gap = this.tileSpacing + this.tileOverlay;\r\n\t\tif (this.textureAtlas)\r\n\t\t\tthis.__atlas = Sprite.get(this.textureAtlas).images[0].img;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} layer Name of the player in which to place the tile.\r\n\t * @param {number} x The X grid position to place this tile.\r\n\t * @param {number} y The Y grid position to place this tile.\r\n\t * @param {number} index The tile index.\r\n\t * @return {void}\r\n\t */\r\n\tset(layer, x, y, index) {\r\n\t\tif (!this.layers[layer]) {\r\n\t\t\tthis.layers[layer] = new Grid(this.mapWidth, this.mapHeight);\r\n\t\t}\r\n\t\tthis.layers[layer].set(x, y, index);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {Object} [opts={}]\r\n\t * @param {Array} [opts.order]\r\n\t * @param {number} [opts.left]\r\n\t * @param {number} [opts.top]\r\n\t * @param {number} [opts.right]\r\n\t * @param {number} [opts.bottom]\r\n\t * @return {void}\r\n\t */\r\n\tdraw(opts) {\r\n\t\tconst atlas = this.__atlas;\r\n\t\tconst tw = this.tileWidth;\r\n\t\tconst th = this.tileHeight;\r\n\t\tconst tsw = this.tilesWide;\r\n\t\tconst gap = this.__gap;\r\n\t\tconst overlay = this.tileOverlay;\r\n\t\tconst renderWidth = tw + overlay * 2;\r\n\t\tconst renderHeight = th + overlay * 2;\r\n\t\tconst order = opts.order || Object.keys(this.layers);\r\n\t\tconst startX = ~~(Math.max(0, (opts.left || 0) / tw));\r\n\t\tconst startY = ~~(Math.max(0, (opts.top || 0) / th));\r\n\t\tconst endX = Math.ceil(Math.min(this.mapWidth, (opts.right || 0) / tw));\r\n\t\tconst endY = Math.ceil(Math.min(this.mapHeight, (opts.bottom || 0) / th));\r\n\t\tvar x, y, n, layer, tile, iX, iY;\r\n\t\tfor (n=0; n<order.length; n++) {\r\n\t\t\tlayer = this.layers[order[n]];\r\n\t\t\tfor (x=startX; x<endX; x++)\r\n\t\t\tfor (y=startY; y<endY; y++) {\r\n\t\t\t\ttile = layer.get(x, y) - 1;\r\n\t\t\t\tif (tile >= 0) {\r\n\t\t\t\t\tiX = (tile % tsw) * (tw + gap*2) + gap;;\r\n\t\t\t\t\tiY = ~~(tile / tsw) * (th + gap*2) + gap;\r\n\t\t\t\t\tDraw.context.drawImage(\r\n\t\t\t\t\t\tatlas,\r\n\t\t\t\t\t\tiX - overlay, iY - overlay,\r\n\t\t\t\t\t\trenderWidth, renderHeight,\r\n\t\t\t\t\t\tx * tw - overlay, // target x\r\n\t\t\t\t\t\ty * th - overlay, // target y\r\n\t\t\t\t\t\trenderWidth, renderHeight\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\n// Static methods, created via the Generator class\r\nGenerator.classStaticMatch(Tilemap);\r\nTilemap.prototype.assetType = \"tilemap\";\r\n\r\nexport default Tilemap;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/tilemap.js"],"sourceRoot":""}