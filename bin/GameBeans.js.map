{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///GameBeans.js","webpack:///webpack/bootstrap dd8871391537333c7b29","webpack:///./core/js/draw.js","webpack:///./core/js/generator.js","webpack:///./core/js/sprite.js","webpack:///./core/js/canvas.js","webpack:///./core/js/instance.js","webpack:///./core/js/math.js","webpack:///./core/js/room.js","webpack:///./core/js/data/grid.js","webpack:///./core/js/transition.js","webpack:///./core/js/input.js","webpack:///./core/js/object.js","webpack:///./core/js/font.js","webpack:///./core/js/global.js","webpack:///./core/js/Sound.js","webpack:///./core/js/camera.js","webpack:///./core/js/App.js","webpack:///./core/js/color.js","webpack:///./core/js/utils/pool.js","webpack:///./core/js/main.js","webpack:///./core/js/keyvalues.js","webpack:///./core/js/event.js","webpack:///./core/js/Script.js","webpack:///./core/js/tween.js","webpack:///./core/js/drawing/primitive.js","webpack:///./core/js/Vector2.js","webpack:///./core/js/core.js","webpack:///./core/js/objectVars.js","webpack:///./core/js/compile.js","webpack:///./core/js/action.js","webpack:///./core/js/tilemap.js"],"names":["root","factory","exports","module","define","amd","self","this","modules","__webpack_require__","moduleId","installedModules","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","_interopRequireDefault","obj","default","_toConsumableArray","arr","Array","isArray","arr2","length","from","_drawWord","drawX","drawY","word","lookup","ctx","useBitmap","bitmap","scale","drawMethod","dx","cn","metrics","sx","left","sy","top","sw","right","sh","bottom","drawImage","value","_math","_math2","_sprite2","_sprite3","_canvas","_canvas2","_font","_font2","draw","color","font","fontSize","textAlign","textBaseline","target","context","defaultTransform","targetStack","imageSmoothing","offsetX","offsetY","setTarget","push","domElement","getContext","resetTarget","pop","getTarget","clear","col","canvas","fill","save","restore","reset","_draw$context","imageSmoothingEnabled","setTransform","apply","globalAlpha","setImageSmoothing","enable","transform","x","y","rotate","rot","math","DEGTORAD","translate","setDefault","opts","arguments","undefined","trans","scaleX","skewX","skewY","scaleY","moveX","moveY","setColor","r","g","b","a","h","sprite","spr","index","rotation","ox","originX","oy","originY","Math","floor","images","frame","img","clip","w","width","height","spriteTiled","dy","rx","ry","drawSprite","canv","setFont","size","align","baseline","text","Number","Font","method","bitmapFont","image","stroke","strokeStyle","strokeColor","lineWidth","fillStyle","lineLength","startN","endN","toString","pattern","start","end","lineHeight","measureText","lines","split","maxWidth","words","line","testLine","slice","shape","x1","y1","x2","y2","beginPath","moveTo","lineTo","ellipse","xr","yr","arc","PI","style","healthbar","amount","background","createLinearGradient","addColorStop","rectangle","rect","_classCallCheck","instance","Constructor","TypeError","Generator","classStaticMatch","create","functionFromConstructor","functionFromMethod","_len","_key","Function","bind","concat","_len2","_key2","arrayExecute","_len3","_key3","forEach","newSpriteName","Sprite","array","pixelDataTint","data","rgb","_typeof","Symbol","iterator","constructor","_extends","assign","source","key","_generator","_generator2","_color","_color2","_this","atlasIndex","atlas","assetType","frames","addFrame","src","names","_this2","Image","ready","onload","cache","document","createElement","__orig","_orig","__origSrc","setOrigin","tint","_this3","imageData","getImageData","Color","hexToRgb","putImageData","readyAll","_createClass","defineProperties","props","descriptor","writable","protoProps","staticProps","_draw","_draw2","Canvas","application","crisp2D","setMain","oncontextmenu","e","preventDefault","main","dom","getElementById","body","appendChild","getMain","fillRect","clearRect","getPixel","_width","set","_height","_input","_input2","_object","_object2","_sprite","_compile","_compile2","_global","_global2","window","global","addConsoleText","_GB_stop","setup","inst","id","uniqueId","exists","speed","objectName","startX","startY","previousX","previousY","boxCollision","addToArray","updateBoundingBox","updateCollisionBox","executeEvent","instanceArray","depth","splice","createMoving","direction","instanceHardLimit","console","warn","newInst","find","findRandom","randomInt","count","setRotation","relative","setDirection","mouseOn","boxTop","input","mouse","Draw","boxBottom","boxLeft","boxRight","step","updateAnimation","updatePosition","instanceExecuteListeners","triggerEvents","event","imageSpeed","behavior","animationBehavior","type","gravVector","lengthDirX","terminal","gravityDirection","lengthDirY","speedX","gravity","speedY","box","destroy","instances","indexOf","visible","events","drawSelf","drawDebug","changeSprite","listeners","listener","instanceCollisionInstance","getAllSolid","getAllInstances","box1","targ","box2","executeEventAll","otherInst","otherStack","other","currentEvent","actions","executeActions","err","error","steps","condition","scope","_loop","action","flow","args","newArgs","Compiler","actionExpression","includes","v","t","f","eval","join","_ret","newStep","stepAll","clearDestroyed","drawAll","doDepthSort","sort","sortFunction","drawGuiAll","pool","release","solid","RADTODEG","cos","sin","sign","min","max","ceil","random","choose","lengthDir","pointDistance","sqrt","pointDirection","atan2","angleDifference","angle1","angle2","diff","_transition","_transition2","_instance","_instance2","_draw3","Room","backgroundMethod","backgroundColor","current","setBackground","addInstance","enter","transition","Transition","prefab","callback","ptrn","createPattern","next","previous","_pool","_pool2","Grid","myGrid","add","multiply","Pool","_noop","_noop2","time","noop","alpha","delta","allInstances","prefabs","update","updateAll","fade","_keyvalues","_keyvalues2","__mouse","pressed","down","released","wheelUp","wheelDown","rawX","rawY","__keyboard","__touch","held","move","cancel","Input","init","initMouse","initKeyboard","initTouch","element","addEventListener","handleMouseDown","button","focus","handleMouseUp","handleMouseMove","getBoundingClientRect","hs","vs","clientX","clientY","handleMouseWheel","wheelDelta","keyValues","handleKeyDown","code","handleKeyUp","handleTouchStart","handleTouchEnd","handleTouchMove","touches","changedTouches","pageX","pageY","getTriggerEvents","triggers","keys","mouseMap","keyboard","touch","_event","_event2","_objectVars","_objectVars2","GameObject","objectVars","executeScript","closure","objectScript","eventAddAction","params","addCollisionListener","_grid","_grid2","hasFontFace","hasBitmapFont","applyCss","getCss","textContent","head","convertToBitmapFont","cy","alphaThreshold","cx","map","atlasCtx","pointImageData","createImageData","log","charMap","lookupTable","_y","_x3","maxY","minY","fps","currentTime","play","_end","pause","Sound","Audio","volume","test","oncanplaythrough","newSound","cloneNode","isEnabled","playSound","paused","onError","soundName","promise","then","onended","onEnd","catch","_room","_room2","Camera","angle","follow","gridLocked","weight","App","setCursor","cursor","parseInt","hex","result","exec","componentToHex","rgbToHex","newConstructor","stack","def","tickLength","tick","timestamp","requestAnimationFrame","last","lastTick","dt","numTicks","maxTicks","timeSinceTick","queueUpdates","gameDraw","ticks","gameUpdate","room","Instance","handleResizeEvent","_camera","_camera2","performance","now","host","loc","parent","location","hostname","hideCursor","enableKeyboard","enableTouch","setGameSpeed","values","postfix","roomLeave","collision","resize","Script","tween","blend","n1","n2","perc","cubicBezier","x3","y3","yb","xc","x4","yc","y4","xm","yn","ym","ya","xn","xb","drawTextured","texture","tris","orderTriangleList","pts","applyModifier","points","modifier","len","x0","pp","y0","u0","u","u1","u2","v0","v1","v2","closePath","delta_c","delta_d","delta_e","delta_f","delta_a","delta_b","orderQuadList","tri","newP","newPoints","format","Primitive","drawBasic","Vector2","copy","mul","div","_App","_App2","_main","_main2","_Script","_Script2","_Sound","_Sound2","_action","newObj","_tween","_tween2","_primitive","_Vector","_Vector2","basic","stringify","behaviours","_depth","proto","exp","actionExpressionEval","String","isActionParam","isNaN","isBoolean","isFunction","isOperator","isResource","isCss","expression","getWords","joinWords","sIndex","sType","newArr","string","splitCharacters","num","isSingleWord","isString","charAt","booleans","assignmentOperators","varName","op","setGravity","jump","moveFree","moveDirect","moveSpeedY","moveReverseX","moveReverseY","thisRoom","roomW","roomH","actionFunc","func","script","message","toFixed","GAME","confirm","alert","confine","wrap","actionConfine","actionWrap","moveSpeedX","jumpRandom","exitEvent","blockEnd","blockBegin","roomPrevious","roomNext","roomEnter","instanceDrawSelf","drawText","drawSetFontSize","drawSetFont","drawSetColor","soundStop","soundPlay","instanceChangeSprite","instanceSetDirection","instanceSetRotation","instanceDestroy","instanceCreateMoving","instanceCreate","_tilemap","_tilemap2","_primitive2","Tilemap","loop","stop","snd","tileWidth","tileSpacing","tileOverlay","tilesWide","mapWidth","mapHeight","layers","__gap","textureAtlas","__atlas","layer","th","tileHeight","tsw","gap","overlay","renderWidth","renderHeight","order","endX","endY","tw","tile","iX","iY"],"mappings":"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","file":"GameBeans.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"GameBeans\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"GameBeans\"] = factory();\n\telse\n\t\troot[\"GameBeans\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"GameBeans\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"GameBeans\"] = factory();\n\telse\n\t\troot[\"GameBeans\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 25);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _math = __webpack_require__(5);\n\nvar _math2 = _interopRequireDefault(_math);\n\nvar _sprite2 = __webpack_require__(2);\n\nvar _sprite3 = _interopRequireDefault(_sprite2);\n\nvar _canvas = __webpack_require__(3);\n\nvar _canvas2 = _interopRequireDefault(_canvas);\n\nvar _font = __webpack_require__(11);\n\nvar _font2 = _interopRequireDefault(_font);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\n//\nvar draw = {\n\n\t//\n\tcolor: \"#FFFFFF\",\n\tfont: \"Arial\",\n\tfontSize: 30,\n\ttextAlign: \"start\",\n\ttextBaseline: \"alphabetic\",\n\ttarget: null,\n\tcontext: null,\n\tdefaultTransform: [1, 0, 0, 1, 0, 0],\n\ttargetStack: [],\n\timageSmoothing: false,\n\toffsetX: 0,\n\toffsetY: 0,\n\n\t/**\r\n  *\r\n  */\n\tsetTarget: function setTarget(target) {\n\t\tdraw.targetStack.push(draw.target);\n\t\tdraw.target = target;\n\t\tdraw.context = target.domElement.getContext(\"2d\");\n\t},\n\n\t/** */\n\tresetTarget: function resetTarget() {\n\t\tvar target = draw.targetStack.pop();\n\t\tdraw.target = target;\n\t\tdraw.context = target.domElement.getContext(\"2d\");\n\t},\n\n\t/** */\n\tgetTarget: function getTarget() {\n\t\treturn draw.target;\n\t},\n\n\t/** */\n\tclear: function clear(col) {\n\t\t_canvas2.default.fill(draw.target, col);\n\t},\n\n\t/** */\n\tsave: function save() {\n\t\tdraw.context.save();\n\t},\n\n\t/** */\n\trestore: function restore() {\n\t\tdraw.context.restore();\n\t},\n\n\t/** */\n\treset: function reset() {\n\t\tvar _draw$context;\n\n\t\tdraw.context.imageSmoothingEnabled = draw.imageSmoothing;\n\t\t(_draw$context = draw.context).setTransform.apply(_draw$context, _toConsumableArray(draw.defaultTransform));\n\t\tdraw.context.globalAlpha = 1;\n\t},\n\n\t/**\r\n  *\r\n  */\n\tsetImageSmoothing: function setImageSmoothing(enable) {\n\t\tdraw.imageSmoothing = enable;\n\t},\n\n\t//\n\ttransform: {\n\n\t\tscale: function scale(x, y) {\n\t\t\tdraw.context.scale(x, y);\n\t\t},\n\n\t\trotate: function rotate(rot) {\n\t\t\tdraw.context.rotate(rot * _math2.default.DEGTORAD);\n\t\t},\n\n\t\ttranslate: function translate(x, y) {\n\t\t\tdraw.offsetX = x;\n\t\t\tdraw.offsetY = y;\n\t\t\tdraw.context.translate(x, y);\n\t\t},\n\n\t\t/**\r\n   * @param {object} [opts={}]\r\n   */\n\t\tsetDefault: function setDefault() {\n\t\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\t\t\tvar trans = draw.defaultTransform;\n\t\t\tif (opts.scaleX) trans[0] = opts.scaleX;\n\t\t\tif (opts.skewX) trans[1] = opts.skewX;\n\t\t\tif (opts.skewY) trans[2] = opts.skewY;\n\t\t\tif (opts.scaleY) trans[3] = opts.scaleY;\n\t\t\tif (opts.moveX) trans[4] = opts.moveX;\n\t\t\tif (opts.moveY) trans[5] = opts.moveY;\n\t\t}\n\t},\n\n\t/**\r\n  * @param {color} c Can be a number, a hex-value or an object containing R, G, B and optionally A properties or H, S, L and optionally A properties.\r\n  */\n\tsetColor: function setColor(c) {\n\n\t\t// quick exit if c is already a CSS color value\n\t\tif (typeof c === \"string\") {\n\t\t\tdraw.color = c;\n\t\t}\n\n\t\t// c is an object\n\t\telse {\n\n\t\t\t\t// RGB / RGBA\n\t\t\t\tif (\"r\" in c && \"g\" in c && \"b\" in c) {\n\t\t\t\t\tdraw.color = \"a\" in c ? \"rgba(\" + c.r + \",\" + c.g + \",\" + c.b + \",\" + c.a + \")\" : \"rgb(\" + c.r + \",\" + c.g + \",\" + c.b + \")\";\n\t\t\t\t}\n\n\t\t\t\t// HSL / HSLA\n\t\t\t\telse if (\"h\" in c && \"s\" in c && \"l\" in c) {\n\t\t\t\t\t\tdraw.color = \"a\" in c ? \"hsla(\" + c.h + \",\" + c.s + \"%,\" + c.l + \"%,\" + c.a + \")\" : \"hsl(\" + c.h + \",\" + c.s + \"%,\" + c.l + \"%)\";\n\t\t\t\t\t}\n\t\t\t}\n\t},\n\n\t/**\r\n  * Draws the sprite at the given x, y position.\r\n  * @param {Object} sprite\r\n  * @param {number} index\r\n  * @param {number} x\r\n  * @param {number} y\r\n  * @param {number} scaleX\r\n  * @param {number} scaleY\r\n  * @param {number} rotation\r\n  * @param {Object} [opts={}]\r\n  * @param {number} [originX] Overrides sprite's originX property.\r\n  * @param {number} [originY] Overrides sprite's originY property.\r\n  */\n\tsprite: function sprite(spr, index, x, y, scaleX, scaleY, rotation) {\n\t\tvar opts = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : {};\n\n\n\t\tspr = _sprite3.default.get(spr);\n\n\t\t//\n\t\tvar ctx = draw.context;\n\t\tvar ox = spr.originX;\n\t\tvar oy = spr.originY;\n\t\tif (opts.originX !== undefined) ox = opts.originX;\n\t\tif (opts.originY !== undefined) oy = opts.originY;\n\n\t\t//\n\t\tctx.save();\n\t\tctx.translate(x, y);\n\t\tctx.rotate(rotation * _math2.default.DEGTORAD);\n\t\tctx.scale(scaleX, scaleY);\n\n\t\t//\n\t\tindex = Math.floor(index || 0) % spr.images.length;\n\n\t\t//\n\t\tvar frame = spr.images[index];\n\t\tvar img = frame.img;\n\t\tctx.drawImage(img, frame.clip.x, frame.clip.y, frame.clip.w, frame.clip.h, -ox, -oy, spr.width, spr.height);\n\n\t\t//\n\t\tctx.restore();\n\t},\n\n\t/**\r\n  * Draws the sprite at the given x, y position.\r\n  * @param {sprite} sprite\r\n  * @param {number} x\r\n  * @param {number} y\r\n  * @param {number} w\r\n  * @param {number} h\r\n  */\n\tspriteTiled: function spriteTiled(spr, index, x, y, w, h) {\n\t\tspr = _sprite3.default.get(spr);\n\t\tvar dx = void 0,\n\t\t    dy = void 0,\n\t\t    rx = void 0,\n\t\t    ry = void 0;\n\t\tfor (rx = 0, dx = x; rx < w; rx++, dx += spr.width) {\n\t\t\tfor (ry = 0, dy = y; ry < h; ry++, dy += spr.height) {\n\t\t\t\tdrawSprite(spr, index, dx, dy, 1, 1, 0);\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\r\n  * Draws a canvas at the given position.\r\n  * @param {canvas} canvas The canvas to draw.\r\n  * @param {number} x The X position to draw at.\r\n  * @param {number} y The Y position to draw at.\r\n  */\n\tcanvas: function canvas(canv, x, y) {\n\t\tdraw.context.drawImage(canv.domElement, x, y);\n\t},\n\n\t/**\r\n  * @param {string} font\r\n  * @param {number} size\r\n  * @param {string} align Horizontal alignment.\r\n  * @param {string} baseline Vertical alignment.\r\n  */\n\tsetFont: function setFont(font, size, align, baseline) {\n\t\tfont = typeof font === \"string\" ? font : font.name;\n\t\tdraw.font = font;\n\t\tdraw.fontSize = size;\n\t\tdraw.textAlign = align;\n\t\tdraw.textBaseline = baseline;\n\t\tvar ctx = draw.context;\n\t\tctx.font = size + \"px \" + font;\n\t\tctx.textAlign = align;\n\t\tctx.textBaseline = baseline;\n\t},\n\n\t/**\r\n  * @param {string} text\r\n  * @param {number} x\r\n  * @param {number} y\r\n  */\n\ttext: function text(_text, x, y) {\n\t\tvar opts = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n\n\n\t\tx = Number(x);\n\t\ty = Number(y);\n\n\t\tvar bitmap = void 0,\n\t\t    lookup = void 0,\n\t\t    scale = void 0,\n\t\t    useBitmap = false;\n\t\tvar font = _font2.default.get(draw.font);\n\t\tif (font && font.method === \"bitmap\") {\n\t\t\tuseBitmap = true;\n\t\t\tlookup = font.bitmapFont.lookup;\n\t\t\tbitmap = font.bitmapFont.image;\n\t\t\tscale = draw.fontSize / font.bitmapFont.size;\n\t\t}\n\n\t\t//\n\t\tvar ctx = draw.context;\n\t\tvar drawMethod = \"fillText\";\n\t\tif (opts.stroke) {\n\t\t\tctx.strokeStyle = opts.strokeColor || draw.color;\n\t\t\tctx.lineWidth = opts.lineWidth || 2;\n\t\t\tdrawMethod = \"strokeText\";\n\t\t} else {\n\t\t\tctx.fillStyle = draw.color;\n\t\t}\n\n\t\t//\n\t\tvar lineLength = void 0;\n\t\tvar drawX = x;\n\t\tvar startN = 0;\n\t\t//console.log(text);\n\t\tvar endN = _text.toString().length;\n\t\tif (opts.pattern) {\n\t\t\tstartN = opts.pattern.start;\n\t\t\tendN = opts.pattern.end;\n\t\t}\n\n\t\t//\n\t\tvar lineHeight = ctx.measureText(\"M\").width * 1.2;\n\t\tvar lines = _text.toString().split(\"#\");\n\t\tfor (var i = 0; i < lines.length; i++) {\n\n\t\t\tif (opts.maxWidth) {\n\t\t\t\tvar words = lines[i].split(' ');\n\t\t\t\tvar line = '';\n\n\t\t\t\tfor (var n = 0; n < words.length; n++) {\n\n\t\t\t\t\tvar testLine = line + words[n] + ' ';\n\t\t\t\t\tvar metrics = ctx.measureText(testLine);\n\t\t\t\t\tvar testWidth = metrics.width;\n\t\t\t\t\tif (testWidth > opts.maxWidth && n > 0) {\n\n\t\t\t\t\t\tvar _a = line.slice(0, startN);\n\t\t\t\t\t\tvar _b = line.slice(startN, endN);\n\t\t\t\t\t\t//drawX += Draw.measureText(a).width;\n\t\t\t\t\t\tdrawX += ctx.measureText(_a).width;\n\t\t\t\t\t\tif (0 < endN) {\n\t\t\t\t\t\t\t_drawWord(drawX, y, _b, lookup, ctx, useBitmap, bitmap, scale, drawMethod);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlineLength = testLine.length;\n\t\t\t\t\t\tstartN -= lineLength;\n\t\t\t\t\t\tendN -= lineLength;\n\n\t\t\t\t\t\tline = words[n] + ' ';\n\t\t\t\t\t\ty += lineHeight;\n\t\t\t\t\t\tdrawX = x;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tline = testLine;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar a = line.slice(0, startN);\n\t\t\t\tvar b = line.slice(startN, endN);\n\t\t\t\tdrawX += ctx.measureText(a).width;\n\t\t\t\t_drawWord(drawX, y, b, lookup, ctx, useBitmap, bitmap, scale, drawMethod);\n\t\t\t\tlineLength = line.length;\n\t\t\t} else {\n\n\t\t\t\tvar _a2 = lines[i].slice(0, startN);\n\t\t\t\tvar _b2 = lines[i].slice(startN, endN);\n\t\t\t\t//console.log(b);\n\t\t\t\tdrawX += ctx.measureText(_a2).width;\n\t\t\t\t_drawWord(~~drawX, y, _b2, lookup, ctx, useBitmap, bitmap, scale, drawMethod);\n\t\t\t\tlineLength = lines[i].length;\n\t\t\t}\n\n\t\t\tdrawX = x;\n\t\t\ty += lineHeight;\n\t\t\tstartN -= lineLength;\n\t\t\tendN -= lineLength;\n\t\t}\n\t},\n\n\t/**\r\n  *\r\n  */\n\tshape: {\n\n\t\t/**\r\n   * @param {number} x1\r\n   * @param {number} y1\r\n   * @param {number} x2\r\n   * @param {number} y2\r\n   * @param {object} [opts={}]\r\n   */\n\t\tline: function line(x1, y1, x2, y2) {\n\t\t\tvar opts = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n\n\t\t\tvar ctx = draw.context;\n\t\t\tctx.strokeStyle = opts.color || draw.color;\n\t\t\tctx.beginPath();\n\t\t\tctx.moveTo(x1, y1);\n\t\t\tctx.lineTo(x2, y2);\n\t\t\tctx.stroke();\n\t\t},\n\n\t\t/**\r\n   * @param {number} x1\r\n   * @param {number} y1\r\n   * @param {number} x2\r\n   * @param {number} y2\r\n   * @param {object} [opts={}]\r\n   */\n\t\tellipse: function ellipse(x, y, xr, yr) {\n\t\t\tvar opts = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n\n\n\t\t\t//\n\t\t\tvar ctx = draw.context;\n\t\t\tctx.save();\n\t\t\tctx.beginPath();\n\t\t\tctx.translate(x - xr, y - yr);\n\t\t\tctx.scale(xr, yr);\n\t\t\tctx.arc(1, 1, 1, 0, 2 * Math.PI, false);\n\t\t\tctx.restore();\n\n\t\t\t//\n\t\t\tvar style = void 0;\n\t\t\tif (opts.healthbar) {\n\t\t\t\tvar amount = opts.healthbar.amount || 1;\n\t\t\t\tvar color = opts.healthbar.color || \"#0F0\";\n\t\t\t\tvar background = opts.healthbar.background || \"#F00\";\n\t\t\t\tstyle = ctx.createLinearGradient(x - xr, 0, x + xr, 0);\n\t\t\t\tstyle.addColorStop(0, color);\n\t\t\t\tstyle.addColorStop(amount, color);\n\t\t\t\tstyle.addColorStop(amount, background);\n\t\t\t\tstyle.addColorStop(1, background);\n\t\t\t} else {\n\t\t\t\tstyle = opts.color || draw.color;\n\t\t\t}\n\n\t\t\t//\n\t\t\tif (!opts.fill && !opts.stroke) opts.fill = true;\n\n\t\t\t//\n\t\t\tif (opts.fill) {\n\t\t\t\tctx.fillStyle = style;\n\t\t\t\tctx.fill();\n\t\t\t}\n\n\t\t\tif (opts.stroke) {\n\t\t\t\tctx.strokeStyle = style;\n\t\t\t\tctx.lineWidth = opts.lineWidth || 1;\n\t\t\t\tctx.stroke();\n\t\t\t}\n\t\t},\n\n\t\t/**\r\n   * @param {number} x\r\n   * @param {number} y\r\n   * @param {number} w\r\n   * @param {number} h\r\n   * @param {object} [opts={}]\r\n   */\n\t\trectangle: function rectangle(x, y, w, h) {\n\t\t\tvar opts = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n\n\n\t\t\t//\n\t\t\tvar ctx = draw.context;\n\t\t\tctx.beginPath();\n\t\t\tctx.rect(x, y, w, h);\n\n\t\t\t//\n\t\t\tvar style = void 0;\n\t\t\tif (opts.healthbar) {\n\t\t\t\tvar amount = opts.healthbar.amount || 1;\n\t\t\t\tvar color = opts.healthbar.color || \"#0F0\";\n\t\t\t\tvar background = opts.healthbar.background || \"#F00\";\n\t\t\t\tstyle = ctx.createLinearGradient(x, 0, x + w, 0);\n\t\t\t\tstyle.addColorStop(0, color);\n\t\t\t\tstyle.addColorStop(amount, color);\n\t\t\t\tstyle.addColorStop(amount, background);\n\t\t\t\tstyle.addColorStop(1, background);\n\t\t\t} else {\n\t\t\t\tstyle = opts.color || draw.color;\n\t\t\t}\n\n\t\t\t//\n\t\t\tif (!opts.fill && !opts.stroke) opts.fill = true;\n\n\t\t\t//\n\t\t\tif (opts.fill) {\n\t\t\t\tctx.fillStyle = style;\n\t\t\t\tctx.fill();\n\t\t\t}\n\n\t\t\tif (opts.stroke) {\n\t\t\t\tctx.strokeStyle = style;\n\t\t\t\tctx.lineWidth = opts.lineWidth || 1;\n\t\t\t\tctx.stroke();\n\t\t\t}\n\t\t}\n\n\t}\n\n\t/**\r\n  *\r\n  */\n};function _drawWord(drawX, drawY, word, lookup, ctx, useBitmap, bitmap, scale, drawMethod) {\n\tif (useBitmap) {\n\t\tvar dx = ~~drawX;\n\t\tfor (var cn = 0; cn < word.length; cn++) {\n\t\t\tvar metrics = lookup[word[cn]];\n\t\t\tvar sx = metrics.left;\n\t\t\tvar sy = metrics.top;\n\t\t\tvar sw = metrics.right - metrics.left;\n\t\t\tvar sh = metrics.bottom - metrics.top;\n\t\t\tctx.drawImage(bitmap, sx, sy, sw, sh, dx, drawY, sw * scale, sh * scale);\n\t\t\tdx += (sw + 1) * scale;\n\t\t}\n\t} else {\n\t\tctx[drawMethod](word, drawX, drawY);\n\t}\n}\n\n//\nexports.default = draw;\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n * @author Jack Oatley\r\n */\nvar Generator = function () {\n\tfunction Generator() {\n\t\t_classCallCheck(this, Generator);\n\t}\n\n\t/**\r\n  * If class has a static \"get\" method it is used in functions created from\r\n  * prototype methods. If there is a \"get\" method on the prototype it is not\r\n  * used in the created functions, however it will overide the static \"get\"\r\n  * method. If there is both a static \"get\" method and a \"get\" method on the\r\n  * prototype, the static one is used in created functions and remains so,\r\n  * but the static method on the class is still overwritten.\r\n  * @param {function} c Constructor function.\r\n  */\n\tGenerator.classStaticMatch = function classStaticMatch(c) {\n\t\tc.create = Generator.functionFromConstructor(c);\n\t\tvar get = c.get;\n\t\tfor (var m in c.prototype) {\n\t\t\tc[m] = Generator.functionFromMethod(c.prototype[m], get);\n\t\t}\n\t};\n\n\t/**\r\n  * @param {function} c Constructor function.\r\n  */\n\n\n\tGenerator.functionFromConstructor = function functionFromConstructor(c) {\n\t\treturn function () {\n\t\t\tfor (var _len = arguments.length, a = Array(_len), _key = 0; _key < _len; _key++) {\n\t\t\t\ta[_key] = arguments[_key];\n\t\t\t}\n\n\t\t\treturn new (Function.prototype.bind.apply(c, [null].concat(a)))();\n\t\t};\n\t};\n\n\t/**\r\n  * @param {function} m Prototype method.\r\n  * @param {function} [get] Optional get function (static on the constructor.)\r\n  */\n\n\n\tGenerator.functionFromMethod = function functionFromMethod(m, get) {\n\t\tif (get) return function (s) {\n\t\t\tfor (var _len2 = arguments.length, a = Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n\t\t\t\ta[_key2 - 1] = arguments[_key2];\n\t\t\t}\n\n\t\t\treturn m.call.apply(m, [get(s)].concat(a));\n\t\t};else return function () {\n\t\t\treturn m.call.apply(m, arguments);\n\t\t};\n\t};\n\n\t/**\r\n  * @param {array} a An array of instances of constructor with the following method.\r\n  * @param {function} m The method to execute for each instance in the array.\r\n  */\n\n\n\tGenerator.arrayExecute = function arrayExecute(a, m) {\n\t\treturn function () {\n\t\t\tfor (var _len3 = arguments.length, p = Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n\t\t\t\tp[_key3] = arguments[_key3];\n\t\t\t}\n\n\t\t\treturn a.forEach(function (i) {\n\t\t\t\treturn m.call.apply(m, [i].concat(p));\n\t\t\t});\n\t\t};\n\t};\n\n\treturn Generator;\n}();\n\nexports.default = Generator;\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _generator = __webpack_require__(1);\n\nvar _generator2 = _interopRequireDefault(_generator);\n\nvar _color = __webpack_require__(16);\n\nvar _color2 = _interopRequireDefault(_color);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n *\r\n */\nvar Sprite = function () {\n\n\t/**\r\n  *\r\n  */\n\tfunction Sprite() {\n\t\tvar _this = this;\n\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\t\t_classCallCheck(this, Sprite);\n\n\t\t//\n\t\tvar atlas = void 0,\n\t\t    atlasIndex = void 0;\n\t\tif (opts.atlas) {\n\t\t\tatlasIndex = opts.atlasIndex || 0;\n\t\t\tatlas = opts.atlas.images[atlasIndex];\n\t\t}\n\n\t\t//\n\t\tthis.assetType = \"sprite\";\n\t\tthis.name = opts.name || newSpriteName();\n\t\tthis.originX = opts.originX || 0;\n\t\tthis.originY = opts.originY || 0;\n\t\tthis.width = 0;\n\t\tthis.height = 0;\n\t\tthis.images = [];\n\n\t\t//\n\t\tif (opts.frames) {\n\t\t\topts.frames.forEach(function (frame) {\n\t\t\t\t_this.addFrame({\n\t\t\t\t\tsource: frame.src\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\t//\n\t\tvar length = Sprite.array.length;\n\t\tSprite.names[length] = this.name;\n\t\tSprite.array[length++] = this;\n\t}\n\n\t/**\r\n  *\r\n  */\n\n\n\tSprite.prototype.addFrame = function addFrame() {\n\t\tvar _this2 = this;\n\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\n\t\t//\n\t\tvar atlas = void 0;\n\t\tif (opts.atlas) {\n\t\t\tatlas = Sprite.get(opts.atlas).images[0].img;\n\t\t}\n\n\t\tvar image = {\n\t\t\timg: atlas || new Image(),\n\t\t\tclip: null,\n\t\t\tready: false\n\n\t\t\t//\n\t\t};if (opts.source) {\n\n\t\t\timage.img.onload = function () {\n\n\t\t\t\t//\n\t\t\t\timage.clip = {\n\t\t\t\t\tx: 0,\n\t\t\t\t\ty: 0,\n\t\t\t\t\tw: image.img.width,\n\t\t\t\t\th: image.img.height\n\n\t\t\t\t\t//\n\t\t\t\t};if (_this2.width * _this2.height === 0) {\n\t\t\t\t\t_this2.width = image.clip.w;\n\t\t\t\t\t_this2.height = image.clip.h;\n\t\t\t\t}\n\n\t\t\t\t//\n\t\t\t\timage.ready = true;\n\t\t\t};\n\t\t\timage.img.src = opts.source || \"\";\n\t\t}\n\n\t\t//\n\t\tif (atlas && opts.clip) {\n\n\t\t\t//\n\t\t\timage.clip = opts.clip;\n\n\t\t\t//\n\t\t\tif (this.width * this.height === 0) {\n\t\t\t\tthis.width = image.clip.w;\n\t\t\t\tthis.height = image.clip.h;\n\t\t\t}\n\n\t\t\t//\n\t\t\timage.ready = true;\n\t\t}\n\n\t\t//\n\t\tthis.images.push(image);\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tSprite.prototype.cache = function cache() {\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\n\t\t//\n\t\tthis.images.forEach(function (frame) {\n\t\t\tvar canvas = document.createElement(\"CANVAS\");\n\t\t\tcanvas.width = opts.width || frame.img.width;\n\t\t\tcanvas.height = opts.height || frame.img.height;\n\t\t\tvar ctx = canvas.getContext(\"2d\");\n\t\t\tctx.drawImage(frame.img, 0, 0, canvas.width + 1, canvas.height + 1);\n\t\t\tframe.__orig = _extends({}, frame);\n\t\t\tframe.clip.x = 0;\n\t\t\tframe.clip.y = 0;\n\t\t\tframe.clip.w = canvas.width;\n\t\t\tframe.clip.h = canvas.height;\n\t\t\tframe.img = canvas;\n\t\t});\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tSprite.prototype.restore = function restore() {\n\t\tvar options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\t\tthis.images.forEach(function (frame) {\n\t\t\tif (frame.__orig) frame = frame._orig;\n\t\t\tif (frame.__origSrc) frame.img.src = frame.__origSrc;\n\t\t});\n\t};\n\n\t/**\r\n  * @param {number} x\r\n  * @param {number} y\r\n  * @return {void}\r\n  */\n\n\n\tSprite.prototype.setOrigin = function setOrigin(x, y) {\n\t\tthis.originX = Number(x);\n\t\tthis.originY = Number(y);\n\t};\n\n\t/**\r\n  * Tints the sprite to the given color. Effects all frames.\r\n  * @param {string} col A CSS color value.\r\n  * @return {void}\r\n  */\n\n\n\tSprite.prototype.tint = function tint(col) {\n\t\tvar _this3 = this;\n\n\t\t//\n\t\tthis.images.forEach(function (frame) {\n\n\t\t\t// create canvas, draw image\n\t\t\tvar canvas = document.createElement(\"CANVAS\");\n\t\t\tvar ctx = canvas.getContext(\"2d\");\n\t\t\tcanvas.width = _this3.width;\n\t\t\tcanvas.height = _this3.height;\n\t\t\tframe.img = frame.__orig || frame.img;\n\t\t\tctx.drawImage(frame.img, 0, 0);\n\n\t\t\t// get data, do thing, put data back\n\t\t\tvar imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n\t\t\tvar color = (typeof col === \"undefined\" ? \"undefined\" : _typeof(col)) === \"object\" ? col : _color2.default.hexToRgb(col);\n\t\t\tpixelDataTint(imageData.data, color);\n\t\t\tctx.putImageData(imageData, 0, 0);\n\n\t\t\t//\n\t\t\tframe.__orig = frame.img;\n\t\t\tframe.__origSrc = frame.img.src;\n\t\t\tframe.img = canvas;\n\t\t});\n\t};\n\n\t/**\r\n  * @return {boolean}\r\n  */\n\n\n\tSprite.readyAll = function readyAll() {\n\n\t\tfor (var n = 0; n < Sprite.array.length; n++) {\n\t\t\tvar spr = Sprite.array[n];\n\t\t\tfor (var i = 0; i < spr.images.length; i++) {\n\t\t\t\tvar image = spr.images[i];\n\t\t\t\tif (!image.ready) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t};\n\n\t/**\r\n  * @param {*} name String or Object.\r\n  * @return {Object}\r\n  */\n\n\n\tSprite.get = function get(name) {\n\n\t\tif ((typeof name === \"undefined\" ? \"undefined\" : _typeof(name)) === \"object\") return name;\n\n\t\tfor (var n = 0; n < Sprite.array.length; n++) {\n\t\t\tif (Sprite.array[n].name === name) return Sprite.array[n];\n\t\t}return null;\n\t};\n\n\treturn Sprite;\n}();\n\n/**\r\n *\r\n */\n\n\nfunction newSpriteName() {\n\treturn \"Sprite_\" + Sprite.array.length;\n}\n\n/**\r\n *\r\n */\nfunction pixelDataTint(data, rgb) {\n\n\t// cache as much as possible, there could be a lot of pixels\n\tvar l = data.length,\n\t    r = rgb.r / 255,\n\t    g = rgb.g / 255,\n\t    b = rgb.b / 255;\n\n\t//\n\tfor (var i = 0; i < l; i += 4) {\n\t\tdata[i] = r * data[i] >> 0;\n\t\tdata[i + 1] = g * data[i + 1] >> 0;\n\t\tdata[i + 2] = b * data[i + 2] >> 0;\n\t}\n}\n\n//\n_generator2.default.classStaticMatch(Sprite);\nSprite.names = [];\nSprite.array = [];\n\n//\nexports.default = Sprite;\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _draw = __webpack_require__(0);\n\nvar _draw2 = _interopRequireDefault(_draw);\n\nvar _generator = __webpack_require__(1);\n\nvar _generator2 = _interopRequireDefault(_generator);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n *\r\n */\nvar Canvas = function () {\n\n\t/**\r\n  * @param {Object} [opts={}]\r\n  * @param {Number} [opts.width=300]\r\n  * @param {Number} [opts.height=150]\r\n  * @param {Number} [opts.scale=1]\r\n  * @param {Boolean} [opts.application=false]\r\n  * @param {Boolean} [opts.script2D=false]\r\n  */\n\tfunction Canvas() {\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\t\t_classCallCheck(this, Canvas);\n\n\t\tvar c = document.createElement(\"CANVAS\");\n\t\tvar ctx = c.getContext(\"2d\");\n\t\tthis.domElement = c;\n\t\tthis.context = ctx;\n\t\tthis.width = opts.width || 300;\n\t\tthis.height = opts.height || 150;\n\n\t\t//\n\t\tc.scale = opts.scale || 1;\n\t\tc.application = opts.application || false;\n\n\t\t//\n\t\tif (opts.crisp2D) {\n\t\t\tctx.imageSmoothingEnabled = false;\n\t\t}\n\n\t\t//\n\t\tif (c.application) {\n\t\t\t_draw2.default.setTarget(this);\n\t\t\tCanvas.setMain(this);\n\t\t}\n\n\t\t//\n\t\tc.oncontextmenu = function (e) {\n\t\t\treturn e.preventDefault();\n\t\t};\n\n\t\t//\n\t\tCanvas.array.push(this);\n\t}\n\n\t/**\r\n  * Sets the canvas as the main canvas for the game.\r\n  */\n\tCanvas.prototype.setMain = function setMain() {\n\t\tvar c = this.domElement;\n\t\tCanvas.main = this;\n\t\tif (Canvas.dom === null) {\n\t\t\tCanvas.dom = c;\n\t\t\tvar el = document.getElementById(\"gbgamebox\") || document.body;\n\t\t\tel.appendChild(c);\n\t\t}\n\t};\n\n\t/**\r\n  * Gets the canvas that is currently set as the main game canvas.\r\n  */\n\n\n\tCanvas.getMain = function getMain() {\n\t\treturn Canvas.main;\n\t};\n\n\t/**\r\n  * @param {String} color=\"#000000\" CSS value as a string.\r\n  */\n\n\n\tCanvas.prototype.fill = function fill(color) {\n\t\tvar c = this.domElement;\n\t\tvar ctx = this.context;\n\t\tctx.fillStyle = color || \"#000000\";\n\t\tctx.fillRect(0, 0, c.width / c.scale, c.height / c.scale);\n\t};\n\n\t/**\r\n  * Clears the canvas.\r\n  */\n\n\n\tCanvas.prototype.clear = function clear() {\n\t\tvar c = this.domElement;\n\t\tvar ctx = this.context;\n\t\tctx.clearRect(0, 0, c.width / c.scale, c.height / c.scale);\n\t};\n\n\t/**\r\n  * Returns the RGBA components of a pixel on the canvas as an ArrayBuffer.\r\n  * @param {Number} x X position of the pixel, must be an integer.\r\n  * @param {Number} y Y position of the pixel, must be an integer.\r\n  * @returns {ArrayBuffer} An ArrayBuffer with 4 values (for R, G, B, A).\r\n  */\n\n\n\tCanvas.prototype.getPixel = function getPixel(x, y) {\n\t\tvar data = this.context.getImageData(x, y, 1, 1).data;\n\t\treturn data;\n\t};\n\n\t_createClass(Canvas, [{\n\t\tkey: \"width\",\n\t\tget: function get() {\n\t\t\treturn this._width;\n\t\t},\n\t\tset: function set(x) {\n\t\t\tthis._width = x;\n\t\t\tthis.domElement.width = x;\n\t\t}\n\t}, {\n\t\tkey: \"height\",\n\t\tget: function get() {\n\t\t\treturn this._height;\n\t\t},\n\t\tset: function set(x) {\n\t\t\tthis._height = x;\n\t\t\tthis.domElement.height = x;\n\t\t}\n\t}]);\n\n\treturn Canvas;\n}();\n\n_generator2.default.classStaticMatch(Canvas);\nCanvas.array = [];\nCanvas.main = null;\nCanvas.dom = null;\n\nexports.default = Canvas;\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _math = __webpack_require__(5);\n\nvar _math2 = _interopRequireDefault(_math);\n\nvar _input = __webpack_require__(9);\n\nvar _input2 = _interopRequireDefault(_input);\n\nvar _object = __webpack_require__(10);\n\nvar _object2 = _interopRequireDefault(_object);\n\nvar _sprite = __webpack_require__(2);\n\nvar _sprite2 = _interopRequireDefault(_sprite);\n\nvar _draw = __webpack_require__(0);\n\nvar _draw2 = _interopRequireDefault(_draw);\n\nvar _compile = __webpack_require__(28);\n\nvar _compile2 = _interopRequireDefault(_compile);\n\nvar _global = __webpack_require__(12);\n\nvar _global2 = _interopRequireDefault(_global);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//\nwindow.global = _global2.default;\n\n//\nvar instance = function () {\n\n\t//\n\tvar uniqueId = 1;\n\tvar instanceArray = [];\n\tvar instanceHardLimit = 1000;\n\tvar doDepthSort = false;\n\tvar otherStack = [];\n\tvar currentEvent = \"\";\n\n\t/***************************************************************************\r\n  * Create a new instance of an object.\r\n  * @param {Object} obj\r\n  * @param {number} x\r\n  * @param {number} y\r\n  * @return {Object}\r\n  */\n\tfunction create(obj, x, y) {\n\n\t\t//\n\t\tvar o = _object2.default.get(obj);\n\t\tif (o === null) {\n\t\t\twindow.addConsoleText(\"#F00\", \"No such object as \" + obj);\n\t\t\twindow._GB_stop();\n\t\t\treturn null;\n\t\t}\n\n\t\t//\n\t\treturn new o(x, y);\n\t}\n\n\t/***************************************************************************\r\n  *\r\n  */\n\tfunction setup(inst, o, x, y) {\n\n\t\tinst.id = uniqueId++;\n\t\tinst.exists = true;\n\t\tinst.speed = 0;\n\t\tinst.object = o;\n\t\tinst.objectName = o.objectName;\n\t\tinst.assetType = \"instance\";\n\t\tinst.x = Number(x);\n\t\tinst.y = Number(y);\n\t\tinst.startX = inst.x;\n\t\tinst.startY = inst.y;\n\t\tinst.previousX = inst.x;\n\t\tinst.previousY = inst.y;\n\t\tinst.boxCollision = {};\n\n\t\t//\n\t\tvar spr = _sprite2.default.get(inst.sprite);\n\t\tif (spr) {\n\t\t\tinst.boxCollision.x = spr.originX;\n\t\t\tinst.boxCollision.y = spr.originY;\n\t\t\tinst.boxCollision.width = spr.width;\n\t\t\tinst.boxCollision.height = spr.height;\n\t\t}\n\n\t\t//\n\t\taddToArray(inst);\n\t\tupdateBoundingBox(inst);\n\t\tupdateCollisionBox(inst);\n\t\texecuteEvent(inst, \"create\");\n\t}\n\n\t/***************************************************************************\r\n  * @param {Object} inst\r\n  * @return {void}\r\n  */\n\tfunction addToArray(inst) {\n\t\tvar i = instanceArray.length;\n\t\twhile (i--) {\n\t\t\tif (inst.depth <= instanceArray[i].depth) {\n\t\t\t\tinstanceArray.splice(i, 0, inst);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tinstanceArray.push(inst);\n\t}\n\n\t/**\r\n  * @param {object} obj\r\n  * @param {number} x\r\n  * @param {number} y\r\n  * @param {number} speed\r\n  * @param {number} direction\r\n  */\n\tfunction createMoving(obj, x, y, speed, direction) {\n\n\t\tif (instanceArray.length >= instanceHardLimit) {\n\t\t\tconsole.warn(\"instance number hard limit reached:\", instanceHardLimit);\n\t\t\treturn;\n\t\t}\n\n\t\tvar newInst = create(obj, x, y);\n\t\tnewInst.speed = speed;\n\t\tnewInst.direction = direction;\n\t\treturn newInst;\n\t}\n\n\t/**\r\n  *\r\n  */\n\tfunction find(obj, n) {\n\t\tif (typeof obj === \"function\") obj = obj.objectName;\n\t\tvar i = void 0,\n\t\t    c = 0,\n\t\t    inst = void 0;\n\t\tfor (i = 0; i < instanceArray.length; i++) {\n\t\t\tinst = instanceArray[i];\n\t\t\tif (inst.objectName === obj) {\n\t\t\t\tif (c++ === n) return inst;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\t/**\r\n  *\r\n  */\n\tfunction findRandom(obj) {\n\t\tif (typeof obj === \"function\") obj = obj.objectName;\n\t\tvar n = _math2.default.randomInt(0, count(obj) - 1);\n\t\treturn find(obj, n);\n\t}\n\n\t/**\r\n  *\r\n  */\n\tfunction count(objectName) {\n\t\tvar c = 0;\n\t\tinstanceArray.forEach(function (inst) {\n\t\t\tc += inst.objectName === objectName;\n\t\t});\n\t\treturn c;\n\t}\n\n\t/**\r\n  * @param {number} rotation\r\n  * @param {boolean} relative\r\n  */\n\tfunction setRotation(rotation, relative) {\n\t\tthis.rotation = relative ? this.rotation + rotation : rotation;\n\t}\n\n\t/**\r\n  * @param {number} rotation\r\n  * @param {boolean} relative\r\n  */\n\tfunction setDirection(direction, relative) {\n\t\tthis.direction = relative ? this.direction + direction : direction;\n\t}\n\n\t/**\r\n  * @param {object} inst Check the mouse is over this instance.\r\n  */\n\tfunction mouseOn(inst) {\n\t\treturn !(inst.boxTop > _input2.default.mouse.y / 2 - _draw2.default.offsetY || inst.boxBottom < _input2.default.mouse.y / 2 - _draw2.default.offsetY || inst.boxLeft > _input2.default.mouse.x / 2 - _draw2.default.offsetX || inst.boxRight < _input2.default.mouse.x / 2 - _draw2.default.offsetX);\n\t}\n\n\t/**\r\n  * @param {instance} inst Instance to execute step event of.\r\n  */\n\tfunction step(inst) {\n\n\t\t// step events\n\t\texecuteEvent(inst, \"step\");\n\t\tupdateAnimation(inst);\n\t\tupdatePosition(inst);\n\t\tupdateBoundingBox(inst);\n\t\tupdateCollisionBox(inst);\n\n\t\t// collision events\n\t\tinstanceExecuteListeners(inst);\n\n\t\t// input events\n\t\t_input2.default.triggerEvents.forEach(function (event) {\n\t\t\texecuteEvent(inst, event);\n\t\t});\n\t}\n\n\t/**\r\n  *\r\n  */\n\tfunction updateAnimation(inst) {\n\n\t\tinst.index += inst.imageSpeed;\n\t\tvar spr = _sprite2.default.get(inst.sprite);\n\t\tif (spr) {\n\t\t\tvar length = spr.images.length;\n\t\t\tif (inst.index >= length) {\n\n\t\t\t\tvar behavior = inst.animationBehavior;\n\t\t\t\tvar type = typeof behavior === \"undefined\" ? \"undefined\" : _typeof(behavior);\n\n\t\t\t\t//\n\t\t\t\tif (type === \"string\") {\n\n\t\t\t\t\t//\n\t\t\t\t\tif (behavior === \"loop\") {\n\t\t\t\t\t\tinst.index -= length;\n\t\t\t\t\t}\n\n\t\t\t\t\t//\n\t\t\t\t\telse if (behavior === \"stop\") {\n\t\t\t\t\t\t\tinst.index = length - 1;\n\t\t\t\t\t\t\tinst.imageSpeed = 0;\n\t\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t//\n\t\t\t\telse if (type === \"function\") {\n\t\t\t\t\t\tbehavior.call(inst);\n\t\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\r\n  *\r\n  */\n\tfunction updatePosition(inst) {\n\n\t\t// if the instance is already falling at terminal velocity then we no longer apply gravity\n\t\tvar gravVector = {\n\t\t\tx: _math2.default.lengthDirX(inst.terminal, inst.gravityDirection),\n\t\t\ty: _math2.default.lengthDirY(inst.terminal, inst.gravityDirection)\n\t\t};\n\n\t\tif (gravVector.x > 0 && inst.speedX <= gravVector.x || gravVector.x < 0 && inst.speedX >= gravVector.x) {\n\t\t\tinst.speedX += _math2.default.lengthDirX(inst.gravity, inst.gravityDirection);\n\t\t}\n\n\t\tif (gravVector.y > 0 && inst.speedY <= gravVector.y || gravVector.y < 0 && inst.speedY >= gravVector.y) {\n\t\t\tinst.speedY += _math2.default.lengthDirY(inst.gravity, inst.gravityDirection);\n\t\t}\n\n\t\t// move instance\n\t\tinst.x += inst.speedX;\n\t\tinst.y += inst.speedY;\n\t}\n\n\t/**\r\n  * @param {object} i Instance whos bounding box to update.\r\n  */\n\tfunction updateBoundingBox(i) {\n\t\tvar spr = _sprite2.default.get(i.sprite);\n\t\tif (spr === null) return;\n\t\ti.boxTop = i.y - spr.originY * i.scaleY;\n\t\ti.boxLeft = i.x - spr.originX * i.scaleX;\n\t\ti.boxBottom = i.boxTop + spr.height * i.scaleY;\n\t\ti.boxRight = i.boxLeft + spr.width * i.scaleX;\n\t}\n\n\t/**\r\n  * @param {object} i Instance.\r\n  */\n\tfunction updateCollisionBox(i) {\n\t\tvar box = i.boxCollision;\n\t\tbox.top = i.y - box.y * i.scaleY;\n\t\tbox.left = i.x - box.x * i.scaleX;\n\t\tbox.bottom = box.top + box.height * i.scaleY;\n\t\tbox.right = box.left + box.width * i.scaleX;\n\t}\n\n\t/**\r\n  *\r\n  */\n\tfunction destroy(inst) {\n\t\texecuteEvent(inst, \"destroy\");\n\t\tinst.exists = false;\n\t\tvar index = inst.object.instances.indexOf(inst);\n\t\tinst.object.instances.splice(index, 1);\n\t}\n\n\t/**\r\n  *\r\n  */\n\tfunction draw(inst) {\n\t\tif (!inst.visible) return;\n\t\tif (inst.events[\"draw\"]) {\n\t\t\texecuteEvent(inst, \"draw\");\n\t\t} else {\n\t\t\tdrawSelf(inst);\n\t\t}\n\t}\n\n\t/**\r\n  * @param {Object} inst Instance to draw.\r\n  * @param {Object} [opts] Options object.\r\n  */\n\tfunction drawSelf(inst, opts) {\n\t\tif (inst.sprite === null) return;\n\t\t_draw2.default.sprite(inst.sprite, inst.index, inst.x, inst.y, inst.scaleX, inst.scaleY, inst.rotation, opts);\n\t}\n\n\t/**\r\n  *\r\n  */\n\tfunction drawDebug(inst) {\n\t\tvar box = inst.boxCollision;\n\t\t_draw2.default.shape.rectangle(box.left, box.top, box.right - box.left, box.bottom - box.top, {\n\t\t\tcolor: \"#FF000055\"\n\t\t});\n\t}\n\n\t/**\r\n  * @param {object} sprite\r\n  */\n\tfunction changeSprite(sprite) {\n\t\tthis.sprite = sprite;\n\t}\n\n\t/**\r\n  * @param {object} inst\r\n  */\n\tfunction instanceExecuteListeners(inst) {\n\n\t\tinst.listeners.forEach(function (listener) {\n\t\t\tswitch (listener.type) {\n\n\t\t\t\tcase \"collision\":\n\t\t\t\t\tinstanceCollisionInstance(inst, listener.target);\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\r\n  *\r\n  */\n\tfunction instanceCollisionInstance(inst, target) {\n\n\t\t//\n\t\tvar arr = void 0;\n\t\tif (target === \"solid\") {\n\t\t\tarr = getAllSolid(target);\n\t\t} else {\n\t\t\tarr = _object2.default.getAllInstances(target);\n\t\t}\n\n\t\tvar box1 = inst.boxCollision;\n\t\tarr.forEach(function (targ) {\n\n\t\t\t// same instance\n\t\t\tif (inst === targ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// no collision\n\t\t\tvar box2 = targ.boxCollision;\n\t\t\tif (box1.left > box2.right || box1.right < box2.left || box1.top > box2.bottom || box1.bottom < box2.top) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// execute collision event\n\t\t\texecuteEvent(inst, \"collision_\" + target, targ);\n\t\t});\n\t}\n\n\t/***************************************************************************\r\n  * Execute a particular event for all current instances.\r\n  * @param {string} event The event to execute.\r\n  * @param {Object} otherInst\r\n  * @return {void}\r\n  */\n\tfunction executeEventAll(event, otherInst) {\n\t\tvar n = instanceArray.length;\n\t\twhile (n--) {\n\t\t\texecuteEvent(instanceArray[n], event, otherInst);\n\t\t}\n\t}\n\n\t/***************************************************************************\r\n  * Execute an event for the given instance only.\r\n  * @param {Object} inst\r\n  * @param {event} event\r\n  * @param {Object} otherInst The other instance, in collisions for example.\r\n  * @return {void}\r\n  */\n\tfunction executeEvent(inst, event, otherInst) {\n\n\t\t// Set the current \"other\" instance.\n\t\totherStack.push(window.other);\n\t\twindow.other = otherInst;\n\t\tcurrentEvent = event;\n\n\t\t//\n\t\ttry {\n\t\t\tif (inst.exists) {\n\t\t\t\tvar actions = inst.events[event];\n\t\t\t\tif (actions) {\n\t\t\t\t\texecuteActions(inst, actions, otherInst);\n\t\t\t\t}\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tconsole.error(err);\n\t\t\twindow.addConsoleText(\"#F00\", \"Failed to execute event [\" + event + \"]\" + \" of object [\" + inst.objectName + \"]\" + \" with error: \" + err);\n\t\t\twindow._GB_stop();\n\t\t\treturn false;\n\t\t}\n\n\t\t// Restore previous \"other\" instance.\n\t\twindow.other = otherStack.pop();\n\t}\n\n\t/***************************************************************************\r\n  * @param {Object} inst\r\n  * @param {Array} actions\r\n  * @param {Object} otherInst\r\n  */\n\tfunction executeActions(inst, actions, otherInst) {\n\t\tvar steps = [];\n\t\tvar condition = true;\n\t\tvar scope = 0;\n\n\t\tvar _loop = function _loop(a) {\n\n\t\t\tvar action = actions[a];\n\t\t\tswitch (action.flow) {\n\n\t\t\t\t// regular action\n\t\t\t\tcase \"\":\n\n\t\t\t\t\tif (!condition) break;\n\n\t\t\t\t\tif (!action.cache) {\n\n\t\t\t\t\t\tvar args = action.args;\n\t\t\t\t\t\tvar n = void 0,\n\t\t\t\t\t\t    newArgs = [];\n\t\t\t\t\t\tfor (n = 0; n < args.length; n++) {\n\t\t\t\t\t\t\tif (typeof args[n] === \"function\") {\n\t\t\t\t\t\t\t\tnewArgs[n] = args[n];\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tswitch (args[n]) {\n\t\t\t\t\t\t\t\t\tcase \"self\":\n\t\t\t\t\t\t\t\t\t\tnewArgs[n] = inst;break;\n\t\t\t\t\t\t\t\t\tcase \"other\":\n\t\t\t\t\t\t\t\t\t\tnewArgs[n] = otherInst;break;\n\t\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\t\tnewArgs[n] = _compile2.default.actionExpression.call(inst, args[n]);break;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Catch any undefined arguments.\n\t\t\t\t\t\tif (newArgs.includes(undefined)) {\n\t\t\t\t\t\t\twindow.addConsoleText(\"#F00\", \"[\" + inst.objectName + \"]\" + \" > [\" + currentEvent + \"]\" + \" > [\" + action.action.name + \"]\" + \" Action contains undefined values!\");\n\t\t\t\t\t\t\twindow._GB_stop();\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tv: false\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t//*\n\t\t\t\t\t\taction.cache = function () {\n\t\t\t\t\t\t\tif (typeof newArgs[0] === \"function\") {\n\t\t\t\t\t\t\t\treturn newArgs[0];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar t = inst;\n\t\t\t\t\t\t\tvar f = action.action;\n\t\t\t\t\t\t\treturn eval(\"\\n\\t\\t\\t\\t\\t\\t\\t\\t(function() {\\n\\t\\t\\t\\t\\t\\t\\t\\t\\treturn f.call(this, \" + newArgs.join(\",\") + \");\\n\\t\\t\\t\\t\\t\\t\\t\\t})\\n\\t\\t\\t\\t\\t\\t\\t\");\n\t\t\t\t\t\t}();\n\t\t\t\t\t}\n\n\t\t\t\t\tcondition = action.cache.call(inst);\n\t\t\t\t\tcondition === undefined ? condition = true : steps[scope] = 0;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\t// control actions\n\t\t\t\tcase \"blockBegin\":\n\t\t\t\t\tscope++;break;\n\t\t\t\tcase \"blockEnd\":\n\t\t\t\t\tscope--;break;\n\t\t\t\tcase \"exitEvent\":\n\t\t\t\t\tif (condition) return {\n\t\t\t\t\t\t\tv: false\n\t\t\t\t\t\t};\n\n\t\t\t}\n\n\t\t\t// exit from a single statement after an expression not contained in a block\n\t\t\tif (steps[scope]++ === 1) {\n\t\t\t\tcondition = true;\n\t\t\t}\n\t\t};\n\n\t\tfor (var a = 0; a < actions.length; a++) {\n\t\t\tvar _ret = _loop(a);\n\n\t\t\tif ((typeof _ret === \"undefined\" ? \"undefined\" : _typeof(_ret)) === \"object\") return _ret.v;\n\t\t}\n\t}\n\n\t/**\r\n  *\r\n  */\n\tfunction newStep() {\n\t\tvar arr = instanceArray.slice();\n\t\tarr.forEach(function (i) {\n\t\t\ti.previousX = i.x;\n\t\t\ti.previousY = i.y;\n\t\t});\n\t}\n\n\t/***************************************************************************\r\n  * @return {void}\r\n  */\n\tfunction stepAll() {\n\t\tnewStep();\n\t\tvar arr = instanceArray.slice();\n\t\tarr.forEach(function (inst) {\n\t\t\texecuteEvent(inst, \"stepBegin\");\n\t\t});\n\t\tarr.forEach(step);\n\t\tarr.forEach(function (inst) {\n\t\t\texecuteEvent(inst, \"stepEnd\");\n\t\t});\n\t\tclearDestroyed();\n\t}\n\n\t/**\r\n  *\r\n  */\n\tfunction drawAll() {\n\t\tif (doDepthSort) {\n\t\t\tinstanceArray.sort(sortFunction);\n\t\t}\n\t\tinstanceArray.forEach(draw);\n\t}\n\n\t/**\r\n  *\r\n  */\n\tfunction drawGuiAll() {\n\t\tinstanceArray.forEach(function (inst) {\n\t\t\texecuteEvent(inst, \"drawGUI\");\n\t\t});\n\t}\n\n\t/***************************************************************************\r\n  * The function used for instance depth ordering.\r\n  * @param {Object} a Instance.\r\n  * @param {Object} b Instance.\r\n  * @return {number} 0, -1 or 1.\r\n  */\n\tfunction sortFunction(a, b) {\n\t\treturn a.depth === b.depth ? a.id - b.id : a.depth - b.depth;\n\t}\n\n\t/***************************************************************************\r\n  * Remove isntances that have been requested to be destroyed.\r\n  * @return {void}\r\n  */\n\tfunction clearDestroyed() {\n\t\tvar l = instanceArray.length;\n\t\tvar n = l;\n\t\tvar i = void 0;\n\t\twhile (i = instanceArray[--n]) {\n\t\t\tif (!i.exists) {\n\t\t\t\ti.object.pool.release(i);\n\t\t\t\tinstanceArray[n] = instanceArray[--l];\n\t\t\t}\n\t\t}\n\t\tinstanceArray.length = l;\n\t}\n\n\t/***************************************************************************\r\n  * Returns all instances set as \"solid\".\r\n  * @return {Array}\r\n  */\n\tfunction getAllSolid() {\n\t\tvar arr = [];\n\t\tvar n = instanceArray.length;\n\t\tvar i = void 0;\n\t\twhile (i = instanceArray[--n]) {\n\t\t\tif (i.solid) {\n\t\t\t\tarr.push(i);\n\t\t\t}\n\t\t}\n\t\treturn arr;\n\t}\n\n\treturn {\n\t\tget instanceArray() {\n\t\t\treturn instanceArray;\n\t\t},\n\t\tset doDepthSort(x) {\n\t\t\tdoDepthSort = x;\n\t\t},\n\t\tcreate: create,\n\t\tsetup: setup,\n\t\tstepAll: stepAll,\n\t\tdrawAll: drawAll,\n\t\tdrawGuiAll: drawGuiAll,\n\t\texecuteEventAll: executeEventAll,\n\t\tchangeSprite: changeSprite,\n\t\tcreateMoving: createMoving,\n\t\tdestroy: destroy,\n\t\tdrawSelf: drawSelf,\n\t\tsetDirection: setDirection,\n\t\tsetRotation: setRotation\n\t};\n}();\n\nexports.default = instance;\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n/**\r\n * @module math\r\n */\n\nvar math = {\n\n\t// constances\n\tPI: Math.PI,\n\tRADTODEG: 180 / Math.PI,\n\tDEGTORAD: Math.PI / 180,\n\n\t// copied functions\n\tcos: Math.cos,\n\tsin: Math.sin,\n\tsign: Math.sign,\n\n\t/**\r\n  *\r\n  */\n\trandomInt: function randomInt(min, max) {\n\t\tmin = Math.ceil(min);\n\t\tmax = Math.floor(max);\n\t\treturn Math.floor(Math.random() * (max - min + 1)) + min;\n\t},\n\n\t/**\r\n  *\r\n  */\n\tchoose: function choose() {\n\t\tfor (var _len = arguments.length, value = Array(_len), _key = 0; _key < _len; _key++) {\n\t\t\tvalue[_key] = arguments[_key];\n\t\t}\n\n\t\treturn value[Math.floor(Math.random() * value.length)];\n\t},\n\n\t/**\r\n  *\r\n  */\n\tlengthDir: function lengthDir(l, d) {\n\t\td *= math.DEGTORAD;\n\t\treturn [Math.cos(d) * l, Math.sin(d) * l];\n\t},\n\n\t/**\r\n  *\r\n  */\n\tlengthDirX: function lengthDirX(l, d) {\n\t\treturn Math.cos(d * math.DEGTORAD) * l;\n\t},\n\n\t/**\r\n  *\r\n  */\n\tlengthDirY: function lengthDirY(l, d) {\n\t\treturn Math.sin(d * math.DEGTORAD) * l;\n\t},\n\n\t/**\r\n  * @param {number} x1\r\n  * @param {number} y1\r\n  * @param {number} x2\r\n  * @param {number} y2\r\n  */\n\tpointDistance: function pointDistance(x1, y1, x2, y2) {\n\t\tvar a = x1 - x2;\n\t\tvar b = y1 - y2;\n\t\treturn Math.sqrt(a * a + b * b);\n\t},\n\n\t/**\r\n  * @param {number} x1\r\n  * @param {number} y1\r\n  * @param {number} x2\r\n  * @param {number} y2\r\n  */\n\tpointDirection: function pointDirection(x1, y1, x2, y2) {\n\t\treturn (Math.atan2(y2 - y1, x2 - x1) * math.RADTODEG + 360) % 360;\n\t},\n\n\t/**\r\n  *\r\n  */\n\tangleDifference: function angleDifference(angle1, angle2) {\n\n\t\tvar diff = (angle2 - angle1) % 360;\n\n\t\tif (diff <= -180) {\n\t\t\tdiff += 360;\n\t\t} else if (diff > 180) {\n\t\t\tdiff -= 360;\n\t\t}\n\n\t\treturn diff;\n\t}\n\n\t//\n};exports.default = math;\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _generator = __webpack_require__(1);\n\nvar _generator2 = _interopRequireDefault(_generator);\n\nvar _transition = __webpack_require__(8);\n\nvar _transition2 = _interopRequireDefault(_transition);\n\nvar _instance = __webpack_require__(4);\n\nvar _instance2 = _interopRequireDefault(_instance);\n\nvar _sprite = __webpack_require__(2);\n\nvar _sprite2 = _interopRequireDefault(_sprite);\n\nvar _draw2 = __webpack_require__(0);\n\nvar _draw3 = _interopRequireDefault(_draw2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n * @author Jack Oatley\r\n */\nvar Room = function () {\n\n\t/**\r\n  * @param {string} name\r\n  * @param {number} width\r\n  * @param {number} height\r\n  */\n\tfunction Room(name, width, height) {\n\t\t_classCallCheck(this, Room);\n\n\t\tthis.name = name;\n\t\tthis.width = Number(width);\n\t\tthis.height = Number(height);\n\t\tthis.background = null;\n\t\tthis.backgroundMethod = \"no-repeat\";\n\t\tthis.backgroundColor = \"#FF0000\";\n\t\tthis.instances = [];\n\t\tRoom.names.push(name);\n\t\tRoom.array.push(this);\n\t\tif (Room.current === null) Room.current = this;\n\t}\n\n\t/**\r\n  * @param {string} spr\r\n  */\n\n\n\tRoom.prototype.setBackground = function setBackground(spr) {\n\t\tthis.background = spr;\n\t};\n\n\t/**\r\n  * @param {string} inst Name of the instance to add.\r\n  * @param {number} x\r\n  * @param {number} y\r\n  */\n\n\n\tRoom.prototype.addInstance = function addInstance(inst, x, y) {\n\t\tif ((typeof inst === \"undefined\" ? \"undefined\" : _typeof(inst)) === \"object\") inst = inst.objectName;\n\t\tthis.instances.push({\n\t\t\tname: inst, x: x, y: y\n\t\t});\n\t};\n\n\t/**\r\n  * @param {object} [opts={}]\r\n  */\n\n\n\tRoom.prototype.enter = function enter() {\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\n\t\tif (opts.transition) {\n\t\t\tnew _transition2.default({\n\t\t\t\tprefab: opts.transition,\n\t\t\t\tcallback: Room.enter.bind(null, this)\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\t// leave room event\n\t\t_instance2.default.executeEventAll(\"roomleave\");\n\n\t\t// clear current instances\n\t\t_instance2.default.instanceArray.forEach(function (i) {\n\t\t\t_instance2.default.destroy(i, false);\n\t\t});\n\n\t\t// goto new room and create new instances\n\t\tRoom.current = this;\n\t\tthis.instances.forEach(function (inst) {\n\t\t\t_instance2.default.create(inst.name, inst.x, inst.y);\n\t\t});\n\n\t\t// enter room event\n\t\t_instance2.default.executeEventAll(\"roomenter\");\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tRoom.prototype.draw = function draw() {\n\t\tvar canvas = _draw3.default.target.domElement;\n\t\tvar ctx = _draw3.default.context;\n\t\t_draw3.default.clear(this.backgroundColor);\n\t\tvar spr = _sprite2.default.get(this.background);\n\t\tif (spr !== null) {\n\t\t\tvar image = spr.images[0].img;\n\t\t\tif (this.backgroundMethod === \"stretch\") {\n\t\t\t\tctx.drawImage(image, 0, 0, canvas.width, canvas.height);\n\t\t\t} else {\n\t\t\t\tvar ptrn = ctx.createPattern(image, this.backgroundMethod);\n\t\t\t\tctx.fillStyle = ptrn;\n\t\t\t\tctx.fillRect(0, 0, canvas.width, canvas.height);\n\t\t\t}\n\t\t}\n\t};\n\n\t/** */\n\n\n\tRoom.next = function next() {\n\t\tvar index = Room.array.indexOf(Room.current);\n\t\tRoom.enter(Room.array[index + 1]);\n\t};\n\n\t/** */\n\n\n\tRoom.previous = function previous() {\n\t\tvar index = Room.array.indexOf(Room.current);\n\t\tRoom.enter(Room.array[index - 1]);\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tRoom.get = function get(name) {\n\t\tif ((typeof name === \"undefined\" ? \"undefined\" : _typeof(name)) === \"object\") return name;\n\t\tfor (var n = 0; n < Room.array.length; n++) {\n\t\t\tif (Room.array[n][\"name\"] === name) {\n\t\t\t\treturn Room.array[n];\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t};\n\n\treturn Room;\n}();\n\nRoom.prototype.assetType = \"room\";\nRoom.names = [];\nRoom.array = [];\nRoom.current = null;\n_generator2.default.classStaticMatch(Room);\n\nexports.default = Room;\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _pool = __webpack_require__(17);\n\nvar _pool2 = _interopRequireDefault(_pool);\n\nvar _generator = __webpack_require__(1);\n\nvar _generator2 = _interopRequireDefault(_generator);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n * @author Jack Oatley\r\n */\nvar Grid = function () {\n\n\t/**\r\n  * @param {number} Initial width of the grid.\r\n  * @param {number} Initial height of the grid\r\n  * @param {object} [opts={}] Options object.\r\n  * @param {*} [opts.value=0] Initial value for each cell of the grid.\r\n  */\n\tfunction Grid(width, height) {\n\t\tvar opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n\t\t_classCallCheck(this, Grid);\n\n\t\tvar myGrid = Grid.pool.get(this);\n\t\tmyGrid.size = width * height;\n\t\tmyGrid.data = myGrid === this ? [] : myGrid.data;\n\t\tmyGrid.data.length = myGrid.size;\n\t\tmyGrid.width = width;\n\t\tmyGrid.height = height;\n\t\tmyGrid.clear(opts.value || 0);\n\t\treturn myGrid;\n\t}\n\n\t/**\r\n  *\r\n  */\n\n\n\tGrid.prototype.get = function get(x, y) {\n\t\treturn this.data[x + y * this.width];\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tGrid.prototype.set = function set(x, y, value) {\n\t\tthis.data[x + y * this.width] = value;\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tGrid.prototype.add = function add(x, y, value) {\n\t\tthis.data[x + y * this.width] += value;\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tGrid.prototype.multiply = function multiply(x, y, value) {\n\t\tthis.data[x + y * this.width] *= value;\n\t};\n\n\t/**\r\n  * Clears all cells in the grid to the given value.\r\n  * @param {*} value Value to clear the grid to.\r\n  */\n\n\n\tGrid.prototype.clear = function clear(value) {\n\t\tthis.data.fill(value);\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tGrid.prototype.destroy = function destroy() {\n\t\tGrid.pool.release(this);\n\t};\n\n\treturn Grid;\n}();\n\n//\n\n\nexports.default = Grid;\nGrid.pool = new _pool2.default(Grid);\n_generator2.default.classStaticMatch(Grid);\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _draw2 = __webpack_require__(0);\n\nvar _draw3 = _interopRequireDefault(_draw2);\n\nvar _noop = __webpack_require__(26);\n\nvar _noop2 = _interopRequireDefault(_noop);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n *\r\n */\nvar Transition = function () {\n\n\t/**\r\n * @param {object} opts Options.\r\n * @param {string} opts.type\r\n * @param {string} opts.time Time in steps the tranistion will last per stage (in/out).\r\n * @param {string} opts.color Color of the transition.\r\n * @param {string} opts.callback Function to execute mid-transition.\r\n */\n\tfunction Transition() {\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\t\t_classCallCheck(this, Transition);\n\n\t\tthis.type = opts.type || \"fade\";\n\t\tthis.time = opts.time || 60;\n\t\tthis.color = opts.color || \"#000000\";\n\t\tthis.callback = opts.callback || _noop2.default;\n\t\tif (opts.prefab) _extends(this, opts.prefab);\n\t\tthis.direction = 1;\n\t\tthis.alpha = 0;\n\t\tthis.delta = 1 / this.time;\n\t\tTransition.allInstances.push(this);\n\n\t\t// Check transition type exists and log warning otherwise\n\t\tif (!Transition.prefabs.hasOwnProperty(this.type)) {\n\t\t\twindow.addConsoleText(\"#F00\", \"Unknown transition type: \" + this.type);\n\t\t\tthis.type = \"fade\";\n\t\t}\n\t}\n\n\t/** */\n\n\n\tTransition.prototype.update = function update() {\n\t\tif (Transition.prefabs.hasOwnProperty(this.type)) Transition.prefabs[this.type].update.call(this);\n\t};\n\n\t/** */\n\n\n\tTransition.prototype.draw = function draw() {\n\t\tif (Transition.prefabs.hasOwnProperty(this.type)) Transition.prefabs[this.type].draw.call(this);\n\t};\n\n\t/** */\n\n\n\tTransition.prototype.destroy = function destroy() {\n\t\tvar x = Transition.allInstances.indexOf(this);\n\t\tTransition.allInstances.splice(x, 1);\n\t};\n\n\t/** */\n\n\n\tTransition.create = function create(opts) {\n\t\treturn new Transition(opts);\n\t};\n\n\t/** */\n\n\n\tTransition.updateAll = function updateAll() {\n\t\tTransition.allInstances.forEach(function (t) {\n\t\t\tt.update();\n\t\t});\n\t};\n\n\t/** */\n\n\n\tTransition.drawAll = function drawAll() {\n\t\tTransition.allInstances.forEach(function (t) {\n\t\t\tt.draw();\n\t\t});\n\t};\n\n\treturn Transition;\n}();\n\n//\n\n\nTransition.allInstances = [];\n\n/**\r\n * @namespace\r\n */\nTransition.prefabs = {\n\n\t\"fade\": {\n\t\tupdate: function update() {\n\t\t\tthis.alpha += this.direction ? this.delta : -this.delta;\n\t\t\tif (this.alpha >= 1) {\n\t\t\t\tthis.callback();\n\t\t\t\tthis.direction = 0;\n\t\t\t} else if (this.alpha <= 0) {\n\t\t\t\tthis.destroy();\n\t\t\t}\n\t\t},\n\t\tdraw: function draw() {\n\t\t\tvar ctx = _draw3.default.context;\n\t\t\tctx.globalAlpha = this.alpha;\n\t\t\tctx.fillStyle = this.color;\n\t\t\tctx.fillRect(0, 0, 9999999, 9999999);\n\t\t}\n\t}\n\n};\n\nexports.default = Transition;\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _canvas = __webpack_require__(3);\n\nvar _canvas2 = _interopRequireDefault(_canvas);\n\nvar _keyvalues = __webpack_require__(19);\n\nvar _keyvalues2 = _interopRequireDefault(_keyvalues);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// Mouse object\nvar __mouse = {\n\tpressed: [false, false, false],\n\tdown: [false, false, false],\n\treleased: [false, false, false],\n\twheelUp: false,\n\twheelDown: false,\n\trawX: 0,\n\trawY: 0,\n\tx: 0,\n\ty: 0\n\n\t// Keyboard object\n};var __keyboard = {\n\tpressed: {},\n\tdown: {},\n\treleased: {}\n\n\t// Touch object\n};var __touch = {\n\tstart: [],\n\theld: [],\n\tmove: [],\n\tend: [],\n\tcancel: [],\n\tx: [],\n\ty: []\n\n\t/**\r\n  * @author Jack Oatley\r\n  */\n};\nvar Input = function () {\n\tfunction Input() {\n\t\t_classCallCheck(this, Input);\n\t}\n\n\t/**\r\n  *\r\n  */\n\tInput.init = function init() {\n\t\tInput.initMouse();\n\t\tInput.initKeyboard();\n\t\tInput.initTouch();\n\t\tInput.element.addEventListener(\"contextmenu\", function (e) {\n\t\t\te.preventDefault();\n\t\t});\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tInput.initMouse = function initMouse() {\n\n\t\tvar handleMouseDown = function handleMouseDown(e) {\n\t\t\te.preventDefault();\n\t\t\tif (!__mouse.pressed[e.button]) window.focus();\n\t\t\t__mouse.pressed[e.button] = true;\n\t\t\t__mouse.down[e.button] = true;\n\t\t};\n\n\t\tvar handleMouseUp = function handleMouseUp(e) {\n\t\t\te.preventDefault();\n\t\t\t__mouse.pressed[e.button] = false;\n\t\t\t__mouse.released[e.button] = true;\n\t\t\t__mouse.down[e.button] = false;\n\t\t};\n\n\t\tvar handleMouseMove = function handleMouseMove(e) {\n\t\t\tvar canv = _canvas2.default.main.domElement;\n\t\t\tvar rect = canv.getBoundingClientRect();\n\t\t\tvar hs = canv.width / rect.width;\n\t\t\tvar vs = canv.height / rect.height;\n\t\t\t__mouse.rawX = e.clientX - rect.left;\n\t\t\t__mouse.rawY = e.clientY - rect.top;\n\t\t\t__mouse.x = ~~__mouse.rawX * hs;\n\t\t\t__mouse.y = ~~__mouse.rawY * vs;\n\t\t};\n\n\t\tvar handleMouseWheel = function handleMouseWheel(e) {\n\t\t\te.preventDefault();\n\t\t\tvar delta = Math.max(-1, Math.min(1, e.wheelDelta));\n\t\t\t__mouse.wheelUp = delta > 0;\n\t\t\t__mouse.wheelDown = delta < 0;\n\t\t};\n\n\t\tInput.element.addEventListener(\"mousedown\", handleMouseDown);\n\t\tInput.element.addEventListener(\"mouseup\", handleMouseUp);\n\t\tInput.element.addEventListener(\"mousemove\", handleMouseMove);\n\t\tInput.element.addEventListener(\"mousewheel\", handleMouseWheel);\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tInput.initKeyboard = function initKeyboard() {\n\n\t\t//\n\t\t_keyvalues2.default.forEach(function (key) {\n\t\t\t__keyboard.pressed[key] = false;\n\t\t\t__keyboard.down[key] = false;\n\t\t\t__keyboard.released[key] = false;\n\t\t});\n\n\t\t//\n\t\tvar handleKeyDown = function handleKeyDown(e) {\n\t\t\te.preventDefault();\n\t\t\tvar code = e.code || e.key;\n\t\t\tif (!__keyboard.down[code]) {\n\t\t\t\t__keyboard.pressed[code] = true;\n\t\t\t\t__keyboard.down[code] = true;\n\t\t\t}\n\t\t};\n\n\t\t//\n\t\tvar handleKeyUp = function handleKeyUp(e) {\n\t\t\te.preventDefault();\n\t\t\tvar code = e.code || e.key;\n\t\t\t__keyboard.released[code] = true;\n\t\t\t__keyboard.down[code] = false;\n\t\t};\n\n\t\t//\n\t\tInput.element.addEventListener(\"keydown\", handleKeyDown);\n\t\tInput.element.addEventListener(\"keyup\", handleKeyUp);\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tInput.initTouch = function initTouch() {\n\n\t\t//\n\t\tvar handleTouchStart = function handleTouchStart(e) {\n\t\t\te.preventDefault();\n\t\t\t!__touch.start[0] && window.focus();\n\t\t\t__touch.start[0] = true;\n\t\t\t__touch.held[0] = true;\n\t\t};\n\n\t\t//\n\t\tvar handleTouchEnd = function handleTouchEnd(e) {\n\t\t\te.preventDefault();\n\t\t\t__touch.start[0] = false;\n\t\t\t__touch.end[0] = true;\n\t\t\t__touch.held[0] = false;\n\t\t};\n\n\t\t//\n\t\tvar handleTouchMove = function handleTouchMove(e) {\n\t\t\te.preventDefault();\n\t\t\tvar touches = e.changedTouches;\n\t\t\t__touch.x[0] = touches[0].pageX;\n\t\t\t__touch.y[0] = touches[0].pageY;\n\t\t};\n\n\t\t//\n\t\tInput.element.addEventListener(\"touchstart\", handleTouchStart);\n\t\tInput.element.addEventListener(\"touchend\", handleTouchEnd);\n\t\tInput.element.addEventListener(\"touchcancel\", handleTouchEnd);\n\t\tInput.element.addEventListener(\"touchmove\", handleTouchMove);\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tInput.getTriggerEvents = function getTriggerEvents() {\n\t\tvar triggers = Input.triggerEvents;\n\t\ttriggers.length = 0;\n\t\tObject.keys(__keyboard.down).forEach(function (key) {\n\t\t\tif (_keyvalues2.default.includes(key)) {\n\t\t\t\tif (__keyboard.down[key]) triggers.push(key);\n\t\t\t\tif (__keyboard.pressed[key]) triggers.push(key + \"Pressed\");\n\t\t\t\tif (__keyboard.released[key]) triggers.push(key + \"Released\");\n\t\t\t} else {\n\t\t\t\tconsole.warn(\"input key not supported: \", key);\n\t\t\t\tdelete __keyboard.down[key];\n\t\t\t}\n\t\t});\n\n\t\t// mouse events\n\t\tvar mouseMap = [\"Left\", \"Middle\", \"Right\"];\n\t\tfor (var n = 0; n < 3; n++) {\n\t\t\tif (__mouse.down[n]) triggers.push(mouseMap[n] + \"Down\");\n\t\t\tif (__mouse.pressed[n]) triggers.push(mouseMap[n] + \"Pressed\");\n\t\t\tif (__mouse.released[n]) triggers.push(mouseMap[n] + \"Released\");\n\t\t}\n\n\t\tif (__mouse.wheelUp) triggers.push(\"WheelUp\");\n\t\tif (__mouse.wheelDown) triggers.push(\"WheelDown\");\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tInput.update = function update() {\n\n\t\tObject.keys(__keyboard.down).forEach(function (key) {\n\t\t\t__keyboard.pressed[key] = false;\n\t\t\t__keyboard.released[key] = false;\n\t\t});\n\n\t\tObject.keys(__mouse.down).forEach(function (button) {\n\t\t\t__mouse.pressed[button] = false;\n\t\t\t__mouse.released[button] = false;\n\t\t});\n\n\t\tObject.keys(__touch.held).forEach(function (button) {\n\t\t\t__touch.start[button] = false;\n\t\t\t__touch.end[button] = false;\n\t\t\t__touch.held[button] = false;\n\t\t});\n\n\t\t__mouse.wheelUp = false;\n\t\t__mouse.wheelDown = false;\n\t};\n\n\treturn Input;\n}();\n\nInput.element = document;\nInput.triggerEvents = [];\nInput.mouse = __mouse;\nInput.keyboard = __keyboard;\nInput.touch = __touch;\n\nexports.default = Input;\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _event = __webpack_require__(20);\n\nvar _event2 = _interopRequireDefault(_event);\n\nvar _instance = __webpack_require__(4);\n\nvar _instance2 = _interopRequireDefault(_instance);\n\nvar _objectVars = __webpack_require__(27);\n\nvar _objectVars2 = _interopRequireDefault(_objectVars);\n\nvar _pool = __webpack_require__(17);\n\nvar _pool2 = _interopRequireDefault(_pool);\n\nvar _generator = __webpack_require__(1);\n\nvar _generator2 = _interopRequireDefault(_generator);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n *\r\n */\nvar GameObject = function () {\n\n\t/**\r\n  * @param {string} name\r\n  * @param {number} sprite\r\n  */\n\tfunction GameObject(name, sprite) {\n\t\t_classCallCheck(this, GameObject);\n\n\t\tvar obj = function obj(x, y) {\n\t\t\tvar inst = obj.pool.get(this);\n\t\t\t_instance2.default.setup(inst, obj, x, y);\n\t\t\tobj.instances.push(inst);\n\t\t\treturn inst;\n\t\t};\n\t\t_extends(obj, GameObject.prototype);\n\t\t_objectVars2.default.set(obj.prototype);\n\t\tobj.objectName = name || \"object_\" + obj.id;\n\t\tobj.prototype.sprite = sprite || null;\n\t\tobj.pool = new _pool2.default(obj);\n\t\tobj.instances = [];\n\t\tGameObject.names.push(obj.objectName);\n\t\tGameObject.array.push(obj);\n\t\treturn obj;\n\t}\n\n\t/**\r\n  *\r\n  */\n\n\n\tGameObject.prototype.set = function set(property, value) {\n\t\tthis.prototype[property] = value;\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tGameObject.prototype.executeScript = function executeScript() {\n\t\tvar closure = function () {\n\t\t\teval(this.objectScript);\n\t\t}.call(this);\n\t};\n\n\t/**\r\n  * Add an action with variable parameters to an event of an object.\r\n  * @param {*} object Can be an object constructor or integer ID.\r\n  * @param {*} event\r\n  * @param {*} action\r\n  * @param {...*} args\r\n  * @return {void}\r\n  */\n\n\n\tGameObject.prototype.eventAddAction = function eventAddAction(event, action) {\n\t\tfor (var _len = arguments.length, args = Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n\t\t\targs[_key - 2] = arguments[_key];\n\t\t}\n\n\t\tvar _this = this;\n\n\t\t//console.log(event, action);\n\n\t\tif ((typeof event === \"undefined\" ? \"undefined\" : _typeof(event)) === \"object\") {\n\t\t\tObject.keys(event).forEach(function (key) {\n\t\t\t\tevent[key].forEach(function (params) {\n\t\t\t\t\tGameObject.eventAddAction.apply(GameObject, [_this, key].concat(_toConsumableArray(params)));\n\t\t\t\t});\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tif (action !== undefined) {\n\n\t\t\t// if flow action, get flow tag\n\t\t\tvar flow = \"\";\n\t\t\tif (typeof action === \"string\") flow = action;\n\n\t\t\t// create a new event if not yet defined\n\t\t\tif (!this.prototype.events[event]) {\n\t\t\t\tthis.prototype.events[event] = [];\n\t\t\t\tif (event.includes(\"collision_\")) {\n\t\t\t\t\tvar index = event.indexOf(\"_\") + 1;\n\t\t\t\t\tvar name = event.slice(index, 200);\n\t\t\t\t\tGameObject.addCollisionListener(this, name);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// add action data to event\n\t\t\tthis.prototype.events[event].push({\n\t\t\t\tflow: flow,\n\t\t\t\taction: action,\n\t\t\t\targs: args\n\t\t\t});\n\t\t} else {\n\t\t\tconsole.warn(\"tried to add an undefined action to an event!\");\n\t\t}\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tGameObject.prototype.addCollisionListener = function addCollisionListener(target) {\n\t\tthis.prototype.listeners.push({\n\t\t\ttype: \"collision\",\n\t\t\ttarget: target\n\t\t});\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tGameObject.prototype.getAllInstances = function getAllInstances() {\n\t\tvar _this2 = this;\n\n\t\tvar arr = [];\n\t\t_instance2.default.instanceArray.forEach(function (inst) {\n\t\t\tvar name = inst.constructor.objectName;\n\t\t\tif (name === _this2.objectName) arr.push(inst);\n\t\t});\n\t\treturn arr;\n\t};\n\n\t/***************************************************************************\r\n  * @param {*} obj\r\n  * @return {Object} THe found object, or null if not found.\r\n  */\n\n\n\tGameObject.get = function get(obj) {\n\n\t\t// If obj is already an object/constructor.\n\t\tif ((typeof obj === \"undefined\" ? \"undefined\" : _typeof(obj)) === \"object\" || typeof obj === \"function\") return obj;\n\n\t\t// Iterate all objects to find the one we want.\n\t\tvar n = GameObject.array.length;\n\t\twhile (n--) {\n\t\t\tif (GameObject.array[n].objectName === obj) {\n\t\t\t\treturn GameObject.array[n];\n\t\t\t}\n\t\t}\n\n\t\t// Failed to find an object.\n\t\treturn null;\n\t};\n\n\treturn GameObject;\n}();\n\n_generator2.default.classStaticMatch(GameObject);\nGameObject.prototype.assetType = \"object\";\nGameObject.names = [];\nGameObject.array = [];\n\nexports.default = GameObject;\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _generator = __webpack_require__(1);\n\nvar _generator2 = _interopRequireDefault(_generator);\n\nvar _grid = __webpack_require__(7);\n\nvar _grid2 = _interopRequireDefault(_grid);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n * @author Jack Oatley\r\n */\nvar Font = function () {\n\n\t/**\r\n  * @param {object} [opts={}] Options.\r\n  * @param {string} [opts.name=\"_UNNAMEDFONT\"] Name of the font.\r\n  * @param {string} [opts.src=\"\"] Source of the font.\r\n  * @param {image} [opts.bitmap=null] An existing bitmap.\r\n  * @param {string} [opts.method=\"normal\"] Initial drawing method.\r\n  * @param {boolean} [opts.apply] Apply the font in CSS,\r\n  */\n\tfunction Font() {\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\t\t_classCallCheck(this, Font);\n\n\t\tthis.name = opts.name || \"_UNNAMEDFONT\";\n\t\tthis.source = opts.src || \"\";\n\t\tthis.hasFontFace = false;\n\t\tthis.bitmapFont = opts.bitmap || null;\n\t\tthis.hasBitmapFont = this.bitmap !== null;\n\t\tthis.method = opts.method || \"normal\";\n\t\tif (opts.apply) this.applyCss();\n\t\tFont.names.push(this.name);\n\t\tFont.array.push(this);\n\t}\n\n\t/**\r\n  * Returns the CSS code that's needed to be applied to the page to use this font in the DOM or on the canvas.\r\n  */\n\n\n\tFont.prototype.getCss = function getCss() {\n\t\treturn \"@font-face {\\\r\n\t\t\tfont-family: \" + this.name + \";\\\r\n\t\t\tsrc: url('\" + this.source + \"') format('truetype');\\\r\n\t\t}\";\n\t};\n\n\t/**\r\n  * Applies the CSS code.\r\n  */\n\n\n\tFont.prototype.applyCss = function applyCss() {\n\t\tvar style = document.createElement(\"STYLE\");\n\t\tstyle.textContent = this.getCss();\n\t\tdocument.head.appendChild(style);\n\t};\n\n\t/**\r\n  * @param {object} [opts={}] Options object.\r\n  * @param {number} [opts.size=8] Size of the font.\r\n  * @param {string} [opts.map] A string of all the characters to include in the bitmap font.\r\n  * @param {int} [opts.alphaThreshold=150] Threshold that dertmines which pixels shall be visible.\r\n  * @param {array} [opts.color=[0,0,0,255]] An array containing the RGBA channels respectively.\r\n  */\n\n\n\tFont.prototype.convertToBitmapFont = function convertToBitmapFont() {\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\n\t\tvar scale = 3;\n\t\tvar size = (opts.size || 8) * scale;\n\t\tvar map = opts.map || \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\n\t\tvar cx = size * 0.5;\n\t\tvar cy = cx;\n\t\tvar alphaThreshold = opts.alphaThreshold || 150;\n\t\tvar color = opts.color || [0, 0, 0, 255];\n\n\t\tvar atlas = document.createElement(\"CANVAS\");\n\t\tatlas.width = size / scale * map.length;\n\t\tatlas.height = size / scale;\n\t\tvar atlasCtx = atlas.getContext(\"2d\");\n\t\tvar pointImageData = atlasCtx.createImageData(1, 1);\n\t\tpointImageData.data.set(color, 0);\n\n\t\tvar canvas = document.createElement(\"CANVAS\");\n\t\tcanvas.width = canvas.height = size;\n\n\t\tvar ctx = canvas.getContext(\"2d\");\n\t\tctx.font = size + \"px \" + this.name;\n\t\tconsole.log(ctx.font);\n\t\tctx.textAlign = \"center\";\n\t\tctx.textBaseline = \"middle\";\n\n\t\tvar charMap = new _grid2.default(size / scale, size / scale);\n\t\tvar lookupTable = {};\n\t\tfor (var n = 0; n < map.length; n++) {\n\n\t\t\tctx.clearRect(0, 0, size, size);\n\t\t\tcharMap.clear(-1);\n\n\t\t\tvar c = map[n];\n\t\t\tctx.fillStyle = \"#000000\";\n\t\t\tctx.fillText(c, cx, cy);\n\n\t\t\tvar imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n\t\t\tvar data = imageData.data;\n\t\t\tvar p, r, g, b, a;\n\t\t\tfor (p = 0; p < data.length; p += 4) {\n\t\t\t\tvar _x3 = ~~(p / 4 % size / scale);\n\t\t\t\tvar _y = ~~(~~(p / 4 / size) / scale);\n\t\t\t\tvar i = _x3 + size / scale * _y;\n\t\t\t\tif (charMap.get(_x3, _y) === -1) charMap.set(_x3, _y, data[p + 3]);\n\t\t\t}\n\n\t\t\t// Get metrics\n\t\t\tvar metrics = { left: 100, top: 100, right: 0, bottom: 0 };\n\t\t\tvar minY = 100;\n\t\t\tvar maxY = 0;\n\t\t\tvar x = void 0,\n\t\t\t    y = void 0;\n\t\t\tfor (y = 0; y < size / scale; y++) {\n\t\t\t\tfor (x = 0; x < size / scale; x++) {\n\t\t\t\t\tif (charMap.get(x, y) > alphaThreshold) {\n\t\t\t\t\t\tmetrics.left = Math.min(metrics.left, x);\n\t\t\t\t\t\tmetrics.top = Math.min(metrics.top, y);\n\t\t\t\t\t\tmetrics.right = Math.max(metrics.right, x + 1);\n\t\t\t\t\t\tmetrics.bottom = Math.max(metrics.bottom, y + 1);\n\t\t\t\t\t\tminY = Math.min(minY, metrics.top);\n\t\t\t\t\t\tmaxY = Math.max(maxY, metrics.bottom);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} // Print to atlas\n\t\t\tfor (y = 0; y < size / scale; y++) {\n\t\t\t\tfor (x = 0; x < size / scale; x++) {\n\t\t\t\t\tif (charMap.get(x, y) > alphaThreshold) {\n\t\t\t\t\t\tatlasCtx.putImageData(pointImageData, n * (size / scale) + x, y);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} // Tweak metrics into atlas coords and add to lookup table\n\t\t\tmetrics.left += n * (size / scale);\n\t\t\tmetrics.right += n * (size / scale);\n\t\t\tmetrics.top = 0;\n\t\t\tmetrics.bottom = size / scale;\n\t\t\tlookupTable[c] = metrics;\n\t\t}\n\n\t\t// Space is special because it can't actually be measured\n\t\tlookupTable[\" \"] = { left: -3, top: 0, right: 0, bottom: size / scale };\n\n\t\tthis.bitmapFont = {\n\t\t\tsize: size / scale,\n\t\t\tlookup: lookupTable,\n\t\t\timage: atlas\n\t\t};\n\n\t\tthis.method = \"bitmap\";\n\t\tconsole.log(this.bitmapFont);\n\t};\n\n\t/**\r\n  * @param {*} value The string name of the font to get.\r\n  */\n\n\n\tFont.get = function get(value) {\n\n\t\tif ([\"object\", \"function\"].includes(typeof value === \"undefined\" ? \"undefined\" : _typeof(value))) if ((typeof value === \"undefined\" ? \"undefined\" : _typeof(value)) === \"object\" || typeof value === \"function\") return value;\n\n\t\tfor (var n = 0; n < Font.array.length; n++) {\n\t\t\tif (Font.array[n].name === value) return Font.array[n];\n\t\t}return null;\n\t};\n\n\treturn Font;\n}();\n\n_generator2.default.classStaticMatch(Font);\nFont.prototype.assetType = \"font\";\nFont.names = [];\nFont.array = [];\n\nexports.default = Font;\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar global = {\n\tfps: 0\n};\n\nexports.default = global;\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _generator = __webpack_require__(1);\n\nvar _generator2 = _interopRequireDefault(_generator);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n * @author Jack Oatley\r\n */\nvar Sound = function () {\n\n\t/**\r\n  * @param {string} name name for the resource.\r\n  * @param {string} source A path to an audio source, or a base64 encoded audio.\r\n  * @return {void}\r\n  */\n\tfunction Sound(name, source) {\n\t\tvar _this = this;\n\n\t\t_classCallCheck(this, Sound);\n\n\t\tthis.name = name;\n\t\tthis.instances = [new Audio(source)];\n\t\tthis.ready = false;\n\t\tthis.volume = 1.0;\n\t\tSound.names.push(name);\n\t\tSound.array.push(this);\n\t\tvar test = this.instances[0];\n\t\ttest.oncanplaythrough = function () {\n\t\t\t_this.ready = true;\n\t\t\ttest.oncanplaythrough = null;\n\t\t};\n\t}\n\n\t/**\r\n  * Returns the asset type, this can't/shouldn't be overwitten.\r\n  * @return {string}\r\n  */\n\n\n\t/**\r\n  * @param {number} number\r\n  * @return {void}\r\n  */\n\tSound.prototype.preload = function preload(number) {\n\t\tvar n = number - this.instances.length;\n\t\twhile (n-- > 0) {\n\t\t\tvar newSound = this.instances[0].cloneNode();\n\t\t\tthis.instances.push(newSound);\n\t\t}\n\t};\n\n\t/**\r\n  * @param {Object} [opts={}] object.\r\n  */\n\n\n\tSound.prototype.play = function play() {\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\t\tif (Sound.isEnabled) {\n\n\t\t\t// Find an existing sound instance to play.\n\t\t\tvar playSound = void 0;\n\t\t\tfor (var i = 0, n = this.instances.length; i < n; i++) {\n\t\t\t\tvar instance = this.instances[i];\n\t\t\t\tif (instance.paused) {\n\t\t\t\t\tplaySound = instance;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Create new instance of sound.\n\t\t\tif (!playSound) {\n\t\t\t\tplaySound = this.instances[0].cloneNode();\n\t\t\t\tthis.instances.push(playSound);\n\t\t\t\t//console.log(\"Created sound, \" + this.name + \", on demand.\");\n\t\t\t}\n\n\t\t\t//\n\t\t\tplaySound.onError = function (err) {\n\t\t\t\tconsole.error(soundName, err);\n\t\t\t};\n\n\t\t\t// Play the sound.\n\t\t\tplaySound.volume = this.volume;\n\t\t\tvar promise = playSound.play();\n\t\t\tif (promise !== undefined) {\n\t\t\t\tpromise.then(function () {\n\n\t\t\t\t\t// on end event\n\t\t\t\t\tplaySound.onended = function () {\n\n\t\t\t\t\t\t// internal event stuff\n\t\t\t\t\t\t(Number(opts.loop || false) ? _loop : _end).call(this);\n\n\t\t\t\t\t\t// and custom event, if defined\n\t\t\t\t\t\tif (opts.onEnd) opts.onEnd();\n\t\t\t\t\t};\n\t\t\t\t}).catch(function (err) {\n\t\t\t\t\tconsole.warn(err);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t//\n\t\t\treturn playSound;\n\t\t}\n\n\t\t// sound is disabled\n\t\treturn null;\n\t};\n\n\t/**\r\n  * Stop all instances of the sound from playing.\r\n  */\n\n\n\tSound.prototype.stop = function stop() {\n\t\tfor (var i = 0, n = this.instances.length; i < n; i++) {\n\t\t\tvar instance = this.instances[i];\n\t\t\tif (!instance.paused) {\n\t\t\t\t_end.call(instance);\n\t\t\t}\n\t\t}\n\t};\n\n\t/**\r\n  * @return {boolean}\r\n  */\n\n\n\tSound.readyAll = function readyAll() {\n\t\tfor (var i = 0, n = Sound.array.length; i < n; i++) {\n\t\t\tif (!Sound.array[i].ready) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t};\n\n\t/**\r\n  * @param {boolean} x\r\n  * @return {void}\r\n  */\n\n\n\tSound.enable = function enable(x) {\n\t\tSound.isEnabled = x;\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tSound.get = function get(name) {\n\t\tif ((typeof name === \"undefined\" ? \"undefined\" : _typeof(name)) === \"object\") return name;\n\t\tfor (var i = 0, n = Sound.array.length; i < n; i++) {\n\t\t\tif (Sound.array[i].name === name) {\n\t\t\t\treturn Sound.array[i];\n\t\t\t}\n\t\t}\n\t\twindow.addConsoleText(\"#F00\", \"Unknown sound: \" + name);\n\t\treturn null;\n\t};\n\n\t_createClass(Sound, [{\n\t\tkey: \"assetType\",\n\t\tget: function get() {\n\t\t\treturn \"sound\";\n\t\t}\n\t}]);\n\n\treturn Sound;\n}();\n\n_generator2.default.classStaticMatch(Sound);\nSound.isEnabled = true;\nSound.names = [];\nSound.array = [];\n\n//\nfunction _loop() {\n\tthis.currentTime = 0;\n\tthis.play();\n}\n\n//\nfunction _end() {\n\tthis.pause();\n\tthis.currentTime = 0;\n}\n\n// Export.\nexports.default = Sound;\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _room = __webpack_require__(6);\n\nvar _room2 = _interopRequireDefault(_room);\n\nvar _draw = __webpack_require__(0);\n\nvar _draw2 = _interopRequireDefault(_draw);\n\nvar _generator = __webpack_require__(1);\n\nvar _generator2 = _interopRequireDefault(_generator);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n * @author Jack Oatley\r\n */\nvar Camera = function () {\n\n\t/**\r\n  * Create a new Camera instance.\r\n  * @param {object} [opts={}]\r\n  * @param {number} [x]\r\n  * @param {number} [y]\r\n  * @param {number} [angle]\r\n  * @param {number} [width]\r\n  * @param {number} [height]\r\n  * @param {number} [follow]\r\n  * @param {number} [gridLocked]\r\n  */\n\tfunction Camera() {\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\t\t_classCallCheck(this, Camera);\n\n\t\tthis.x = 0, this.y = 0, this.angle = 0, this.width = _room2.default.current.width, this.height = _room2.default.current.height, this.follow = null, this.gridLocked = false, this.left = 0, this.right = 0, this.top = 0, this.bottom = 0;\n\t\t_extends(this, opts);\n\t\tCamera.array.push(this);\n\t}\n\n\t/**\r\n  * Update the Camera.\r\n  */\n\n\n\tCamera.prototype.update = function update() {\n\t\tif (this.follow) {\n\n\t\t\t// if single instance, put into array\n\t\t\tif (!Array.isArray(this.follow)) this.follow = [this.follow];\n\n\t\t\t//\n\t\t\tvar x = 0,\n\t\t\t    y = 0,\n\t\t\t    count = 0,\n\t\t\t    weight = 1;\n\t\t\tthis.follow.forEach(function (inst) {\n\n\t\t\t\tif (Array.isArray(inst)) {\n\t\t\t\t\tweight = inst[1] || 1;\n\t\t\t\t\tinst = inst[0];\n\t\t\t\t} else {\n\t\t\t\t\tweight = 1;\n\t\t\t\t}\n\n\t\t\t\tx += inst.x * weight;\n\t\t\t\ty += inst.y * weight;\n\t\t\t\tcount += weight;\n\t\t\t});\n\n\t\t\tthis.x = x / count;\n\t\t\tthis.y = y / count;\n\t\t}\n\n\t\t// update bounds\n\t\tthis.left = this.x - this.width * 0.5;\n\t\tthis.right = this.x + this.width * 0.5;\n\t\tthis.top = this.y - this.height * 0.5;\n\t\tthis.bottom = this.y + this.height * 0.5;\n\n\t\t// apply camera\n\t\t_draw2.default.transform.translate(-this.left, -this.top);\n\t};\n\n\treturn Camera;\n}();\n\nCamera.array = [];\n\nCamera.create = _generator2.default.functionFromConstructor(Camera);\nCamera.updateAll = _generator2.default.arrayExecute(Camera.array, Camera.prototype.update);\n\nexports.default = Camera;\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _canvas = __webpack_require__(3);\n\nvar _canvas2 = _interopRequireDefault(_canvas);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n *\r\n */\nvar App = function () {\n\tfunction App() {\n\t\t_classCallCheck(this, App);\n\t}\n\n\t/**\r\n  * Sets the cursor to use when the mouse is in the game window.\r\n  * @param {string} cursor Same as the CSS cursor property.\r\n  * See {@link https://developer.mozilla.org/en-US/docs/Web/CSS/cursor}\r\n  */\n\tApp.setCursor = function setCursor(cursor) {\n\t\t_canvas2.default.main.style.cursor = cursor;\n\t};\n\n\treturn App;\n}();\n\nexports.default = App;\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar color = {\n\n\t/**\r\n  * @param {string} hex A hex string.\r\n  */\n\thexToRgb: function hexToRgb(hex) {\n\t\tvar result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n\t\treturn result ? {\n\t\t\tr: parseInt(result[1], 16),\n\t\t\tg: parseInt(result[2], 16),\n\t\t\tb: parseInt(result[3], 16)\n\t\t} : null;\n\t},\n\n\t/**\r\n  * @param {number} c The component.\r\n  */\n\tcomponentToHex: function componentToHex(c) {\n\t\tvar hex = c.toString(16);\n\t\treturn hex.length == 1 ? \"0\" + hex : hex;\n\t},\n\n\t/**\r\n  * @param {number} r The red component.\r\n  * @param {number} g The green component.\r\n  * @param {number} b The blue component.\r\n  */\n\trgbToHex: function rgbToHex(r, g, b) {\n\t\tvar c = color.componentToHex;\n\t\treturn \"#\" + c(r) + c(g) + c(b);\n\t}\n\n\t//\n};exports.default = color;\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = Pool;\n/**\r\n * @module Pool\r\n */\n\n/**\r\n * The Pool object contains an array (the pool) called stack to which we can give objects. The Pool also maintains it's own length property, as the true length of the stack array does not change, so as to avoid garbage collection.\r\n * @param {Object} newConstructor The constructor function for this pool. During get, if no items are in the pool and no default value is provided, a new object is created from this constructor and returned.\r\n */\nfunction Pool(newConstructor) {\n  this.stack = [];\n  this.length = 0;\n  this.newConstructor = newConstructor;\n}\n\n/**\r\n * @param {Object} [def] The default object (or even value) to return if no items are found in the pool. If this is not defined, and no items are found in the pool, then a new object is created as per the Pool's newConstructor property.\r\n */\nPool.prototype.get = function (def) {\n  if (this.length) {\n    def = this.stack[--this.length];\n    this.stack[this.length] = undefined;\n  }\n  return def || new this.newConstructor();\n};\n\n/**\r\n * @param {Object} i Objec to release, adding it to the pool.\r\n */\nPool.prototype.release = function (i) {\n  this.stack[this.length++] = i;\n};\n\n/***/ }),\n/* 18 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _canvas = __webpack_require__(3);\n\nvar _canvas2 = _interopRequireDefault(_canvas);\n\nvar _room = __webpack_require__(6);\n\nvar _room2 = _interopRequireDefault(_room);\n\nvar _input = __webpack_require__(9);\n\nvar _input2 = _interopRequireDefault(_input);\n\nvar _instance = __webpack_require__(4);\n\nvar _instance2 = _interopRequireDefault(_instance);\n\nvar _global = __webpack_require__(12);\n\nvar _global2 = _interopRequireDefault(_global);\n\nvar _draw = __webpack_require__(0);\n\nvar _draw2 = _interopRequireDefault(_draw);\n\nvar _camera = __webpack_require__(14);\n\nvar _camera2 = _interopRequireDefault(_camera);\n\nvar _transition = __webpack_require__(8);\n\nvar _transition2 = _interopRequireDefault(_transition);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar lastTick = performance.now(),\n    tickLength = 1000 / 60,\n    dt = 0,\n    last = 0;\n\n//\nwindow.addConsoleText = window.addConsoleText || console.log;\nwindow._GB_stop = window._GB_stop || function () {};\n\n//\nvar main = {\n\n\t/**\r\n  *\r\n  */\n\tget dt() {\n\t\treturn dt;\n\t},\n\n\t/**\r\n  *\r\n  */\n\tstart: function start() {\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\n\t\t// Basic site-locking\n\t\tif (opts.host !== undefined && opts.host !== \"\") {\n\t\t\tvar loc = window.parent ? window.parent.location : window.location;\n\t\t\tvar host = loc.hostname;\n\t\t\tvar arr = opts.host.split(\" \").join(\"\").split(\",\");\n\t\t\tif (!opts.host.includes(host)) return;\n\t\t}\n\n\t\t//\n\t\tvar canv = new _canvas2.default({\n\t\t\twidth: _room2.default.current.width,\n\t\t\theight: _room2.default.current.height,\n\t\t\tcrisp2D: true,\n\t\t\tapplication: true\n\t\t});\n\n\t\t// selectively enable input methods\n\t\tif (opts.enableMouse) _input2.default.initMouse();\n\t\tif (opts.enableKeyboard) _input2.default.initKeyboard();\n\t\tif (opts.enableTouch) _input2.default.initTouch();\n\t\tif (opts.hideCursor) canv.domElement.style.cursor = \"none\";\n\n\t\t//\n\t\t_room2.default.enter(_room2.default.current);\n\t\ttick(performance.now());\n\t},\n\n\t/**\r\n  *\r\n  */\n\tsetGameSpeed: function setGameSpeed(speed) {\n\t\ttickLength = 1000 / speed;\n\t}\n\n\t/**\r\n  *\r\n  */\n};function tick(timestamp) {\n\n\ttry {\n\n\t\t// exit game with Esc key\n\t\tif (window._GB_stop && _input2.default.triggerEvents.includes(\"EscapePressed\")) window._GB_stop();\n\n\t\t// request the next frame\n\t\twindow.requestAnimationFrame(tick);\n\t\tvar nextTick = lastTick + tickLength;\n\t\tvar numTicks = 0;\n\t\t_global2.default.fps = 1000 / (timestamp - last);\n\t\t_global2.default.dt = timestamp - last;\n\t\tlast = timestamp;\n\n\t\t//\n\t\tif (timestamp > nextTick) {\n\t\t\tvar timeSinceTick = timestamp - lastTick;\n\t\t\tvar maxTicks = Math.floor(timeSinceTick / tickLength);\n\t\t\tlastTick = lastTick + tickLength * maxTicks;\n\t\t\tnumTicks = Math.min(maxTicks, 60);\n\t\t}\n\n\t\t//\n\t\t_input2.default.getTriggerEvents();\n\t\tqueueUpdates(numTicks);\n\t\tgameDraw();\n\n\t\t//\n\t\tif (numTicks) {\n\t\t\t_input2.default.update();\n\t\t}\n\t} catch (err) {\n\t\tconsole.error(err);\n\t\twindow.addConsoleText(\"#F00\", \"Error: \" + err);\n\t\twindow._GB_stop();\n\t}\n}\n\n/*******************************************************************************\r\n * @param {number} ticks\r\n * @return {void}\r\n */\nfunction queueUpdates(ticks) {\n\twhile (ticks--) {\n\t\tgameUpdate();\n\t}\n}\n\n/*******************************************************************************\r\n * Update sequence.\r\n * @return {void}\r\n */\nfunction gameUpdate() {\n\t_instance2.default.stepAll();\n\t_transition2.default.updateAll();\n}\n\n/**\r\n *\r\n */\nfunction gameDraw() {\n\t_draw2.default.reset();\n\t_canvas2.default.main.fill(\"#000000\");\n\t_room2.default.draw(_room2.default.current);\n\t_camera2.default.updateAll();\n\t_instance2.default.drawAll();\n\t_draw2.default.reset();\n\t_instance2.default.drawGuiAll();\n\t_transition2.default.drawAll();\n}\n\n/**\r\n *\r\n */\nfunction handleResizeEvent() {\n\t_instance2.default.executeEventAll(\"resize\");\n}\n\n// attach event listerners\nwindow.addEventListener(\"resize\", handleResizeEvent);\n\n//\nexports.default = main;\n\n/***/ }),\n/* 19 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n/**\r\n * @module keyvalues\r\n */\n\nvar values = [\"ArrowUp\", \"ArrowDown\", \"ArrowLeft\", \"ArrowRight\", \"Enter\", \"Space\", \"Backspace\", \"Escape\", \"ShiftLeft\", \"ShiftRight\", \"ControlLeft\", \"ControlRight\", \"AltLeft\", \"AltRight\", \"KeyA\", \"KeyB\", \"KeyC\", \"KeyD\", \"KeyE\", \"KeyF\", \"KeyG\", \"KeyH\", \"KeyI\", \"KeyJ\", \"KeyK\", \"KeyL\", \"KeyM\", \"KeyN\", \"KeyO\", \"KeyP\", \"KeyQ\", \"KeyR\", \"KeyS\", \"KeyT\", \"KeyU\", \"KeyV\", \"KeyW\", \"KeyX\", \"KeyY\", \"KeyZ\", \"Digit0\", \"Digit1\", \"Digit2\", \"Digit3\", \"Digit4\", \"Digit5\", \"Digit6\", \"Digit7\", \"Digit8\", \"Digit9\"];\n\nexports.default = values;\n\n/***/ }),\n/* 20 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _keyvalues = __webpack_require__(19);\n\nvar _keyvalues2 = _interopRequireDefault(_keyvalues);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//\nvar events = {\n\tcreate: \"create\",\n\troomEnter: \"roomEnter\",\n\troomLeave: \"roomLeave\",\n\tstep: \"step\",\n\tdraw: \"draw\",\n\tcollision: \"collision_\",\n\tresize: \"resize\",\n\tkeyboard: _extends({}, translate(_keyvalues2.default), {\n\t\tpressed: translate(_keyvalues2.default, \"Pressed\"),\n\t\treleased: translate(_keyvalues2.default, \"Released\")\n\t})\n\n\t/**\r\n  * @param {array} array\r\n  * @param {string} [postfix=\"\"]\r\n  */\n};function translate(array) {\n\tvar postfix = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"\";\n\n\tvar obj = {};\n\tarray.forEach(function (name) {\n\t\tobj[name] = name + postfix;\n\t});\n\treturn obj;\n}\n\n//\nexports.default = events;\n\n/***/ }),\n/* 21 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n *\r\n */\nvar Script = function Script() {\n  _classCallCheck(this, Script);\n};\n\nexports.default = Script;\n\n\nScript.names = [];\n\n/***/ }),\n/* 22 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\n//\nvar tween = {\n\n\t/**\r\n  *\r\n  */\n\tblend: function blend(n1, n2, perc) {\n\t\tvar diff = n2 - n1;\n\t\treturn n1 + diff * perc;\n\t},\n\n\n\t/**\r\n  *\r\n  */\n\tcubicBezier: function cubicBezier(x2, y2, x3, y3, i) {\n\n\t\tvar x1 = 0,\n\t\t    y1 = 0,\n\t\t    x4 = 1,\n\t\t    y4 = 1;\n\n\t\t// The Green Lines\n\t\tvar xa = tween.blend(x1, x2, i),\n\t\t    ya = tween.blend(y1, y2, i),\n\t\t    xb = tween.blend(x2, x3, i),\n\t\t    yb = tween.blend(y2, y3, i),\n\t\t    xc = tween.blend(x3, x4, i),\n\t\t    yc = tween.blend(y3, y4, i),\n\n\n\t\t// The Blue Line\n\t\txm = tween.blend(xa, xb, i),\n\t\t    ym = tween.blend(ya, yb, i),\n\t\t    xn = tween.blend(xb, xc, i),\n\t\t    yn = tween.blend(yb, yc, i),\n\n\n\t\t// The Black Dot\n\t\tx = tween.blend(xm, xn, i),\n\t\t    y = tween.blend(ym, yn, i);\n\n\t\t//\n\t\treturn y;\n\t}\n};\n\n//\nexports.default = tween;\n\n/***/ }),\n/* 23 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _draw = __webpack_require__(0);\n\nvar _draw2 = _interopRequireDefault(_draw);\n\nvar _sprite = __webpack_require__(2);\n\nvar _sprite2 = _interopRequireDefault(_sprite);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar noop = function noop() {};\n\n/** */\n\nvar Primitive = function () {\n\n\t/**\r\n  * @param {object} opts Options object.\r\n  * @param {array} opts.points Array of Point objects.\r\n  * @param {*} opts.texture Sprite object or name of sprite resource.\r\n  * @param {*} opts.color Color of the primitive.\r\n  * @param {string} opts.format Format of the points array.\r\n  * @param {function} opts.modifier Point modifier function.\r\n  * @param {number} opts.x X position to draw the primitive.\r\n  * @param {number} opts.y Y position to draw the primitive.\r\n  */\n\tfunction Primitive() {\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\t\t_classCallCheck(this, Primitive);\n\n\t\tthis.points = opts.points || [];\n\t\tthis.texture = opts.texture || null;\n\t\tthis.color = opts.color || \"#000000\";\n\t\tthis.format = opts.format || \"quads\";\n\t\tthis.modifier = opts.modifier || noop;\n\t\tthis.x = opts.x || 0;\n\t\tthis.y = opts.y || 0;\n\t}\n\n\t/** Method for drawing instantiated Primitive. */\n\n\n\tPrimitive.prototype.draw = function draw() {\n\t\tPrimitive.draw(this);\n\t};\n\n\t/**\r\n  * Alternate way to create a new Primitive instance.\r\n  * @param {object} opts See constructor.opts parameter.\r\n  */\n\n\n\tPrimitive.create = function create() {\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\t\treturn new Primitive(opts);\n\t};\n\n\t/**\r\n  * @param {object} opts See constructor.opts parameter.\r\n  */\n\n\n\tPrimitive.draw = function draw() {\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\t\tif (opts.texture) drawTextured(opts);else drawBasic(opts);\n\t};\n\n\treturn Primitive;\n}();\n\n/**\r\n *\r\n */\n\n\nexports.default = Primitive;\nfunction drawTextured() {\n\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\n\tvar texture = opts.texture;\n\tvar spr = _sprite2.default.get(texture);\n\tif (spr === null) {\n\t\tconsole.warn(\"No such texture: \" + texture);\n\t\treturn;\n\t}\n\n\tvar ctx = _draw2.default.context;\n\tvar frame = spr.images[0];\n\tvar img = frame.img;\n\tvar w = spr.width;\n\tvar h = spr.height;\n\tvar tris = orderTriangleList(opts);\n\n\t//\n\tvar t = void 0;\n\tvar pts = applyModifier(opts.points, opts.modifier);\n\tvar len = tris.length;\n\tfor (t = 0; t < len; t++) {\n\n\t\tvar pp = tris[t];\n\t\tvar x0 = pts[pp[0]].x,\n\t\t    x1 = pts[pp[1]].x,\n\t\t    x2 = pts[pp[2]].x;\n\t\tvar y0 = pts[pp[0]].y,\n\t\t    y1 = pts[pp[1]].y,\n\t\t    y2 = pts[pp[2]].y;\n\t\tvar u0 = pts[pp[0]].u * w,\n\t\t    u1 = pts[pp[1]].u * w,\n\t\t    u2 = pts[pp[2]].u * w;\n\t\tvar v0 = pts[pp[0]].v * h,\n\t\t    v1 = pts[pp[1]].v * h,\n\t\t    v2 = pts[pp[2]].v * h;\n\n\t\t// Set clipping area so that only pixels inside the triangle will\n\t\t// be affected by the image drawing operation\n\t\tctx.save();\n\t\tctx.beginPath();\n\t\tctx.moveTo(x0, y0);\n\t\tctx.lineTo(x1, y1);\n\t\tctx.lineTo(x2, y2);\n\t\tctx.closePath();\n\t\tctx.clip();\n\n\t\t// Compute matrix transform\n\t\tvar delta = u0 * v1 + v0 * u2 + u1 * v2 - v1 * u2 - v0 * u1 - u0 * v2;\n\t\tvar delta_a = x0 * v1 + v0 * x2 + x1 * v2 - v1 * x2 - v0 * x1 - x0 * v2;\n\t\tvar delta_b = u0 * x1 + x0 * u2 + u1 * x2 - x1 * u2 - x0 * u1 - u0 * x2;\n\t\tvar delta_c = u0 * v1 * x2 + v0 * x1 * u2 + x0 * u1 * v2 - x0 * v1 * u2 - v0 * u1 * x2 - u0 * x1 * v2;\n\t\tvar delta_d = y0 * v1 + v0 * y2 + y1 * v2 - v1 * y2 - v0 * y1 - y0 * v2;\n\t\tvar delta_e = u0 * y1 + y0 * u2 + u1 * y2 - y1 * u2 - y0 * u1 - u0 * y2;\n\t\tvar delta_f = u0 * v1 * y2 + v0 * y1 * u2 + y0 * u1 * v2 - y0 * v1 * u2 - v0 * u1 * y2 - u0 * y1 * v2;\n\n\t\t// Draw the transformed image\n\t\tctx.transform(delta_a / delta, delta_d / delta, delta_b / delta, delta_e / delta, delta_c / delta, delta_f / delta);\n\t\tctx.drawImage(img, 0, 0);\n\t\tctx.restore();\n\t}\n}\n\n/**\r\n *\r\n */\nfunction drawBasic() {\n\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\tvar points = applyModifier(opts.points, opts.modifier);\n\tvar length = points.length;\n\tif (length > 0) {\n\t\tvar tris = orderQuadList(opts);\n\t\tvar i = void 0,\n\t\t    ctx = _draw2.default.context;\n\t\tctx.fillStyle = opts.color || _draw2.default.color;\n\t\tfor (i = 0; i < tris.length; i++) {\n\t\t\tvar tri = tris[i];\n\t\t\tvar n = void 0,\n\t\t\t    p = points[tri[0]];\n\t\t\tctx.beginPath();\n\t\t\tctx.moveTo(p.x, p.y);\n\t\t\tfor (n = 1; n < tri.length; n++) {\n\t\t\t\tp = points[tri[n]];\n\t\t\t\tctx.lineTo(p.x, p.y);\n\t\t\t}\n\t\t\tctx.closePath();\n\t\t\tctx.fill();\n\t\t}\n\t}\n}\n\n/**\r\n *\r\n */\nfunction applyModifier(points, modifier) {\n\tvar newPoints = [];\n\tpoints.forEach(function (p) {\n\t\tvar newP = _extends({}, p, modifier.call(p));\n\t\tnewPoints.push(newP);\n\t});\n\treturn newPoints;\n}\n\n/**\r\n * @param {object} opts\r\n */\nfunction orderTriangleList() {\n\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\tvar tris = [];\n\tif (opts.format === \"quads\") {\n\t\tvar length = Math.floor(opts.points.length / 4);\n\t\tvar n = void 0,\n\t\t    o = 0;\n\t\tfor (n = 0; n < length; n++) {\n\t\t\ttris.push([o + 0, o + 1, o + 2], [o + 2, o + 3, o + 0]);\n\t\t\to += 4;\n\t\t}\n\t}\n\treturn tris;\n}\n\n/**\r\n * @param {object} opts\r\n */\nfunction orderQuadList() {\n\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\tvar tris = [];\n\tvar length = Math.floor(opts.points.length / 4);\n\tvar n = void 0,\n\t    o = 0;\n\tfor (n = 0; n < length; n++, o += 4) {\n\t\ttris.push([o + 0, o + 1, o + 2, o + 3]);\n\t}\n\treturn tris;\n}\n\n/***/ }),\n/* 24 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _generator = __webpack_require__(1);\n\nvar _generator2 = _interopRequireDefault(_generator);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n * @author Jack Oatley\r\n */\nvar Vector2 = function () {\n\n\t/**\r\n  * @param {number} x\r\n  * @param {number} y\r\n  */\n\tfunction Vector2(x, y) {\n\t\t_classCallCheck(this, Vector2);\n\n\t\tthis.set(x, y);\n\t}\n\n\t/**\r\n  *\r\n  */\n\n\n\tVector2.prototype.set = function set(x, y) {\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tVector2.prototype.copy = function copy(v) {\n\t\tthis.x = v.x;\n\t\tthis.y = v.y;\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tVector2.prototype.add = function add(v) {\n\t\tthis.x += v.x;\n\t\tthis.y += v.y;\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tVector2.prototype.mul = function mul(v) {\n\t\tthis.x *= v.x;\n\t\tthis.y *= v.y;\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tVector2.prototype.div = function div(v) {\n\t\tthis.x /= v.x;\n\t\tthis.y /= v.y;\n\t};\n\n\treturn Vector2;\n}();\n\n_generator2.default.classStaticMatch(Vector2);\n\nexports.default = Vector2;\n\n/***/ }),\n/* 25 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\nexports.Vector2 = exports.Grid = exports.Font = exports.Transition = exports.tween = exports.math = exports.draw = exports.instance = exports.action = exports.event = exports.object = exports.Script = exports.Sound = exports.sprite = exports.input = exports.Room = exports.Camera = exports.canvas = exports.main = exports.App = undefined;\n\nvar _App = __webpack_require__(15);\n\nvar _App2 = _interopRequireDefault(_App);\n\nvar _main = __webpack_require__(18);\n\nvar _main2 = _interopRequireDefault(_main);\n\nvar _canvas = __webpack_require__(3);\n\nvar _canvas2 = _interopRequireDefault(_canvas);\n\nvar _camera = __webpack_require__(14);\n\nvar _camera2 = _interopRequireDefault(_camera);\n\nvar _room = __webpack_require__(6);\n\nvar _room2 = _interopRequireDefault(_room);\n\nvar _input = __webpack_require__(9);\n\nvar _input2 = _interopRequireDefault(_input);\n\nvar _Script = __webpack_require__(21);\n\nvar _Script2 = _interopRequireDefault(_Script);\n\nvar _sprite = __webpack_require__(2);\n\nvar _sprite2 = _interopRequireDefault(_sprite);\n\nvar _Sound = __webpack_require__(13);\n\nvar _Sound2 = _interopRequireDefault(_Sound);\n\nvar _object = __webpack_require__(10);\n\nvar _object2 = _interopRequireDefault(_object);\n\nvar _event = __webpack_require__(20);\n\nvar _event2 = _interopRequireDefault(_event);\n\nvar _action = __webpack_require__(29);\n\nvar action = _interopRequireWildcard(_action);\n\nvar _instance = __webpack_require__(4);\n\nvar _instance2 = _interopRequireDefault(_instance);\n\nvar _draw = __webpack_require__(0);\n\nvar _draw2 = _interopRequireDefault(_draw);\n\nvar _math = __webpack_require__(5);\n\nvar _math2 = _interopRequireDefault(_math);\n\nvar _tween = __webpack_require__(22);\n\nvar _tween2 = _interopRequireDefault(_tween);\n\nvar _transition = __webpack_require__(8);\n\nvar _transition2 = _interopRequireDefault(_transition);\n\nvar _primitive = __webpack_require__(23);\n\nvar _primitive2 = _interopRequireDefault(_primitive);\n\nvar _font = __webpack_require__(11);\n\nvar _font2 = _interopRequireDefault(_font);\n\nvar _grid = __webpack_require__(7);\n\nvar _grid2 = _interopRequireDefault(_grid);\n\nvar _Vector = __webpack_require__(24);\n\nvar _Vector2 = _interopRequireDefault(_Vector);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.App = _App2.default;\nexports.main = _main2.default;\nexports.canvas = _canvas2.default;\nexports.Camera = _camera2.default;\nexports.Room = _room2.default;\nexports.input = _input2.default;\nexports.sprite = _sprite2.default;\nexports.Sound = _Sound2.default;\nexports.Script = _Script2.default;\nexports.object = _object2.default;\nexports.event = _event2.default;\nexports.action = action;\nexports.instance = _instance2.default;\nexports.draw = _draw2.default;\nexports.math = _math2.default;\nexports.tween = _tween2.default;\nexports.Transition = _transition2.default;\nexports.Font = _font2.default;\nexports.Grid = _grid2.default;\nexports.Vector2 = _Vector2.default;\n\n/***/ }),\n/* 26 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = function () {};\n\n/***/ }),\n/* 27 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _math = __webpack_require__(5);\n\nvar _math2 = _interopRequireDefault(_math);\n\nvar _instance = __webpack_require__(4);\n\nvar _instance2 = _interopRequireDefault(_instance);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//\nvar basic = JSON.stringify({\n\tsprite: null,\n\tindex: 0,\n\timageSpeed: 1,\n\tanimationBehavior: \"loop\",\n\tvisible: true,\n\tsolid: false,\n\texists: true,\n\tscaleX: 1,\n\tscaleY: 1,\n\trotation: 0,\n\tterminal: 100,\n\tgravity: 0,\n\tgravityDirection: 0,\n\tspeedX: 0,\n\tspeedY: 0,\n\tboxTop: 0,\n\tboxBottom: 0,\n\tboxLeft: 0,\n\tboxRight: 0,\n\tbehaviours: [],\n\tlisteners: [],\n\tevents: {},\n\tboxCollision: {\n\t\tx: 0,\n\t\ty: 0,\n\t\twidth: 0,\n\t\theight: 0,\n\t\ttop: 0,\n\t\tbottom: 0,\n\t\tleft: 0,\n\t\tright: 0\n\t},\n\t_depth: 0\n});\n\n//\nvar objectVars = {\n\n\t/**\r\n  *\r\n  */\n\tset: function set(proto) {\n\t\t_extends(proto, JSON.parse(basic));\n\n\t\tproto.destroy = function () {\n\t\t\t_instance2.default.destroy(this);\n\t\t};\n\n\t\tObject.defineProperty(proto, \"depth\", {\n\t\t\tset: function set(x) {\n\t\t\t\tif (this._depth !== x) {\n\t\t\t\t\tthis._depth = x;\n\t\t\t\t\t_instance2.default.doDepthSort = true;\n\t\t\t\t}\n\t\t\t},\n\t\t\tget: function get() {\n\t\t\t\treturn this._depth;\n\t\t\t}\n\t\t});\n\n\t\tObject.defineProperty(proto, \"speed\", {\n\t\t\tset: function set(x) {\n\t\t\t\tvar y = this.direction * _math2.default.DEGTORAD;\n\t\t\t\tthis.speedX = Math.cos(y) * x;\n\t\t\t\tthis.speedY = Math.sin(y) * x;\n\t\t\t},\n\t\t\tget: function get(x) {\n\t\t\t\treturn _math2.default.pointDistance(0, 0, this.speedX, this.speedY);\n\t\t\t}\n\t\t});\n\n\t\tObject.defineProperty(proto, \"direction\", {\n\t\t\tset: function set(x) {\n\t\t\t\tvar y = this.speed;\n\t\t\t\tthis.speedX = Math.cos(x * _math2.default.DEGTORAD) * y;\n\t\t\t\tthis.speedY = Math.sin(x * _math2.default.DEGTORAD) * y;\n\t\t\t},\n\t\t\tget: function get(x) {\n\t\t\t\treturn _math2.default.pointDirection(0, 0, this.speedX, this.speedY);\n\t\t\t}\n\t\t});\n\t}\n\n\t//\n};exports.default = objectVars;\n\n/***/ }),\n/* 28 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _font = __webpack_require__(11);\n\nvar _font2 = _interopRequireDefault(_font);\n\nvar _global = __webpack_require__(12);\n\nvar _global2 = _interopRequireDefault(_global);\n\nvar _object = __webpack_require__(10);\n\nvar _object2 = _interopRequireDefault(_object);\n\nvar _room = __webpack_require__(6);\n\nvar _room2 = _interopRequireDefault(_room);\n\nvar _Script = __webpack_require__(21);\n\nvar _Script2 = _interopRequireDefault(_Script);\n\nvar _Sound = __webpack_require__(13);\n\nvar _Sound2 = _interopRequireDefault(_Sound);\n\nvar _sprite = __webpack_require__(2);\n\nvar _sprite2 = _interopRequireDefault(_sprite);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n * @author Jack Oatley\r\n */\nvar Compiler = function () {\n\tfunction Compiler() {\n\t\t_classCallCheck(this, Compiler);\n\t}\n\n\t/***************************************************************************\r\n  * @param {string} exp\r\n  * @return {*}\r\n  */\n\tCompiler.actionExpressionEval = function actionExpressionEval(exp) {\n\n\t\tvar isActionParam = false;\n\t\tif (exp instanceof String) {\n\t\t\tisActionParam = true;\n\t\t\texp = String(exp);\n\t\t}\n\n\t\tif (exp === \"self\") return this;\n\t\tif (exp === \"other\") return window.other;\n\n\t\tif (!isNaN(Number(exp))) return Number(exp);\n\n\t\tif (Compiler.isBoolean(exp)) return exp === true || exp === \"true\";\n\n\t\tif (Compiler.isFunction(exp) || Compiler.isOperator(exp) || Compiler.isResource(exp) || Compiler.isCss(exp) || !isActionParam && typeof exp === \"string\") {\n\t\t\treturn exp;\n\t\t}\n\n\t\tif (typeof exp === \"string\") {\n\t\t\tvar words = Compiler.getWords(exp);\n\t\t\tvar expression = Compiler.joinWords(words);\n\t\t\treturn eval(expression);\n\t\t}\n\n\t\treturn exp;\n\t};\n\n\t/***************************************************************************\r\n  * @param {string} exp\r\n  * @return {*}\r\n  */\n\n\n\tCompiler.actionExpression = function actionExpression(exp) {\n\n\t\tvar isActionParam = false;\n\t\tif (exp instanceof String) {\n\t\t\tisActionParam = true;\n\t\t\texp = String(exp);\n\t\t}\n\n\t\tif (exp === \"self\") return \"this\";\n\t\tif (exp === \"other\") return \"window.other\";\n\n\t\tif (!isNaN(Number(exp))) return Number(exp);\n\n\t\tif (Compiler.isBoolean(exp)) return exp === true || exp === \"true\"; // ? \"true\" : \"false\";\n\n\t\tif (Compiler.isOperator(exp) || Compiler.isCss(exp)) return \"'\" + exp + \"'\";\n\n\t\tif (Compiler.isFunction(exp) || Compiler.isResource(exp) || !isActionParam && typeof exp === \"string\") {\n\t\t\treturn exp;\n\t\t}\n\n\t\tif (typeof exp === \"string\") {\n\t\t\tvar words = Compiler.getWords(exp);\n\t\t\tvar expression = Compiler.joinWords(words);\n\t\t\treturn expression;\n\t\t}\n\n\t\treturn exp;\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tCompiler.getWords = function getWords(exp) {\n\t\tvar n = void 0;\n\t\tvar string = \"\";\n\t\tvar sIndex = -1;\n\t\tvar sType = \"\";\n\t\tvar newArr = [];\n\n\t\tfor (n = 0; n < exp.length; n++) {\n\n\t\t\tvar c = exp.charAt(n);\n\n\t\t\tif (c === \"'\" || c === \"\\\"\") {\n\t\t\t\tif (sIndex === -1) {\n\t\t\t\t\tsType = c;\n\t\t\t\t\tsIndex = n + 1;\n\t\t\t\t} else if (sType === c) {\n\t\t\t\t\tnewArr.push(\"'\" + exp.slice(sIndex, n) + \"'\");\n\t\t\t\t\tsIndex = -1;\n\t\t\t\t}\n\t\t\t} else if (sIndex === -1) {\n\t\t\t\tif (c !== \" \") {\n\t\t\t\t\tif (Compiler.splitCharacters.includes(c)) {\n\t\t\t\t\t\tif (string !== \"\") {\n\t\t\t\t\t\t\tnewArr.push(string);\n\t\t\t\t\t\t\tstring = \"\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnewArr.push(c);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstring += c;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tstring += c;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (string !== \"\") {\n\t\t\tnewArr.push(string);\n\t\t\tstring = \"\";\n\t\t}\n\n\t\treturn newArr;\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tCompiler.joinWords = function joinWords(words) {\n\t\tvar y = \"\";\n\t\twords.forEach(function (word) {\n\t\t\tvar num = parseInt(word);\n\t\t\tif (isNaN(num)) {\n\t\t\t\tvar c = word.charAt(0);\n\t\t\t\tif (c === \"'\" || c === \" \") {\n\t\t\t\t\ty += word;\n\t\t\t\t} else if (Compiler.splitCharacters.includes(c)) {\n\t\t\t\t\ty += word;\n\t\t\t\t} else {\n\t\t\t\t\tif (word === \"fps\") y += _global2.default.fps;else {\n\t\t\t\t\t\tif (!Compiler.isResource(word) && Compiler.isSingleWord(word) && !Compiler.isString(word) && !Compiler.isArray(word) && word !== \"this\") {\n\t\t\t\t\t\t\ty += \"this.\" + word;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ty += word;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\ty += word;\n\t\t\t}\n\t\t});\n\t\treturn y;\n\t};\n\n\t/** */\n\n\n\tCompiler.isResource = function isResource(x) {\n\t\treturn _object2.default.names.includes(x) || _sprite2.default.names.includes(x) || _Sound2.default.names.includes(x) || _room2.default.names.includes(x) || _font2.default.names.includes(x) || _Script2.default.names.includes(x);\n\t};\n\n\t/** */\n\n\n\tCompiler.isArray = function isArray(x) {\n\t\treturn x.charAt(0) === \"[\";\n\t};\n\n\t/** */\n\n\n\tCompiler.isString = function isString(x) {\n\t\treturn x.charAt(0) === \"\\\"\" && x.charAt(x.length - 1) === \"\\\"\" || x.charAt(0) === \"'\" && x.charAt(x.length - 1) === \"'\";\n\t};\n\n\t/** */\n\n\n\tCompiler.isSingleWord = function isSingleWord(x) {\n\t\treturn !x.includes(\".\");\n\t};\n\n\t/** */\n\n\n\tCompiler.isFunction = function isFunction(x) {\n\t\treturn typeof x === \"function\";\n\t};\n\n\t/** */\n\n\n\tCompiler.isBoolean = function isBoolean(x) {\n\t\treturn Compiler.booleans.includes(x);\n\t};\n\n\t/** */\n\n\n\tCompiler.isOperator = function isOperator(x) {\n\t\treturn Compiler.assignmentOperators.includes(x);\n\t};\n\n\t/** */\n\n\n\tCompiler.isCss = function isCss(x) {\n\t\treturn x.charAt(0) === \"#\";\n\t};\n\n\treturn Compiler;\n}();\n\nexports.default = Compiler;\n\n\nCompiler.keywords = [\"self\", \"other\"];\nCompiler.booleans = [true, false, \"true\", \"false\"];\nCompiler.assignmentOperators = [\"<\", \">\", \"<=\", \">=\", \"==\", \"===\", \"!=\", \"!==\"];\nCompiler.splitCharacters = [\"+\", \"-\", \"=\", \"!\"];\n\n/***/ }),\n/* 29 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\nexports.GAME = exports.confirm = exports.alert = exports.message = exports.code = exports.script = exports.func = exports.confine = exports.wrap = exports.actionConfine = exports.actionWrap = exports.moveReverseY = exports.moveReverseX = exports.moveSpeedY = exports.moveSpeedX = exports.moveDirect = exports.moveFree = exports.jumpRandom = exports.jump = exports.setGravity = exports.test = exports.get = exports.set = exports.exitEvent = exports.blockEnd = exports.blockBegin = exports.roomPrevious = exports.roomNext = exports.roomEnter = exports.drawSprite = exports.instanceDrawSelf = exports.drawSelf = exports.drawText = exports.drawSetFontSize = exports.drawSetFont = exports.drawSetColor = exports.soundStop = exports.soundPlay = exports.instanceChangeSprite = exports.changeSprite = exports.instanceSetDirection = exports.instanceSetRotation = exports.instanceDestroy = exports.instanceCreateMoving = exports.instanceCreate = undefined;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _room = __webpack_require__(6);\n\nvar _room2 = _interopRequireDefault(_room);\n\nvar _Sound = __webpack_require__(13);\n\nvar _Sound2 = _interopRequireDefault(_Sound);\n\nvar _draw = __webpack_require__(0);\n\nvar _draw2 = _interopRequireDefault(_draw);\n\nvar _instance = __webpack_require__(4);\n\nvar _instance2 = _interopRequireDefault(_instance);\n\nvar _input = __webpack_require__(9);\n\nvar _input2 = _interopRequireDefault(_input);\n\nvar _math = __webpack_require__(5);\n\nvar _math2 = _interopRequireDefault(_math);\n\nvar _sprite = __webpack_require__(2);\n\nvar _sprite2 = _interopRequireDefault(_sprite);\n\nvar _canvas = __webpack_require__(3);\n\nvar _canvas2 = _interopRequireDefault(_canvas);\n\nvar _color = __webpack_require__(16);\n\nvar _color2 = _interopRequireDefault(_color);\n\nvar _main = __webpack_require__(18);\n\nvar _main2 = _interopRequireDefault(_main);\n\nvar _camera = __webpack_require__(14);\n\nvar _camera2 = _interopRequireDefault(_camera);\n\nvar _App = __webpack_require__(15);\n\nvar _App2 = _interopRequireDefault(_App);\n\nvar _grid = __webpack_require__(7);\n\nvar _grid2 = _interopRequireDefault(_grid);\n\nvar _tilemap = __webpack_require__(30);\n\nvar _tilemap2 = _interopRequireDefault(_tilemap);\n\nvar _tween = __webpack_require__(22);\n\nvar _tween2 = _interopRequireDefault(_tween);\n\nvar _transition = __webpack_require__(8);\n\nvar _transition2 = _interopRequireDefault(_transition);\n\nvar _object = __webpack_require__(10);\n\nvar _object2 = _interopRequireDefault(_object);\n\nvar _primitive = __webpack_require__(23);\n\nvar _primitive2 = _interopRequireDefault(_primitive);\n\nvar _Vector = __webpack_require__(24);\n\nvar _Vector2 = _interopRequireDefault(_Vector);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\r\n * Set the variable with the given name.\r\n * @param {string} varName\r\n * @param {*} value\r\n * @param {boolean} relative\r\n * @param {boolean} global\r\n * @return {void}\r\n */\nfunction set(varName, value, relative, global) {\n\tvar target = global ? window.global : this;\n\tif (relative) {\n\t\ttarget[varName] += value;\n\t} else {\n\t\ttarget[varName] = value;\n\t}\n}\n\n/**\r\n * @param {string} varName\r\n * @param {string} op Operation.\r\n * @param {value} value Value to check against.\r\n * @param {boolean} global\r\n * @return {boolean}\r\n */\nfunction test(varName, op, value, global) {\n\tvar target = global ? window.global : this;\n\tswitch (op) {\n\t\tcase \"!==\":\n\t\t\treturn target[varName] !== value;\n\t\tcase \"===\":\n\t\t\treturn target[varName] === value;\n\t\tcase \"!=\":\n\t\t\treturn target[varName] != value;\n\t\tcase \"==\":\n\t\t\treturn target[varName] == value;\n\t\tcase \"<\":\n\t\t\treturn target[varName] < value;\n\t\tcase \">\":\n\t\t\treturn target[varName] > value;\n\t\tcase \"<=\":\n\t\t\treturn target[varName] <= value;\n\t\tcase \">=\":\n\t\t\treturn target[varName] >= value;\n\t\tdefault:\n\t\t\treturn false;\n\t}\n}\n\n/**\r\n * Sets the instance's gravity to the given value.\r\n * @param {number} value The gravity strength.\r\n * @return {void}\r\n */\nfunction setGravity(value) {\n\tthis.gravity = value;\n}\n\n/**\r\n * Instantly sets the instance's x and y values to a random position within\r\n * the current room.\r\n * @param {number} x\r\n * @param {number} y\r\n * @param {boolean} relative\r\n * @return {void}\r\n */\nfunction jump(x, y, relative) {\n\tif (relative) {\n\t\tthis.x += Number(x);\n\t\tthis.y += Number(y);\n\t} else {\n\t\tthis.x = Number(x);\n\t\tthis.y = Number(y);\n\t}\n}\n\n/**\r\n * Instantly sets the instance's x and y values to a random position within\r\n * the current room.\r\n * @return {void}\r\n */\nfunction jumpRandom() {\n\tvar x1 = 0,\n\t    y1 = 0,\n\t    x2 = 640,\n\t    y2 = 480;\n\tthis.x = Math.floor(Math.random() * (x2 - x1 + 1)) + x1;\n\tthis.y = Math.floor(Math.random() * (y2 - y1 + 1)) + y1;\n}\n\n/**\r\n *\r\n */\nfunction moveFree(speed, direction) {\n\tthis.speed = speed;\n\tthis.direction = direction;\n}\n\n/**\r\n * Instantly sets the instance's x and y values to a random position within\r\n * the current room.\r\n * @param {number} x\r\n * @param {number} y\r\n */\nfunction moveDirect(x, y) {\n\tthis.x += x * _main2.default.dt;\n\tthis.y += y * _main2.default.dt;\n}\n\n/**\r\n *\r\n */\nfunction moveSpeedX(speed) {\n\tthis.speedX = Number(speed);\n}\nfunction moveSpeedY(speed) {\n\tthis.speedY = Number(speed);\n}\nfunction moveReverseX() {\n\tthis.speedX = -this.speedX;\n}\nfunction moveReverseY() {\n\tthis.speedY = -this.speedY;\n}\n\n/**\r\n * Wraps the instance back into the room when it leaves.\r\n */\nfunction actionWrap() {\n\tvar width = this.boxRight - this.boxLeft;\n\tvar height = this.boxBottom - this.boxTop;\n\tvar thisRoom = _room2.default.current;\n\tvar roomW = thisRoom.width;\n\tvar roomH = thisRoom.height;\n\tif (this.boxRight < 0) this.x += roomW + width;\n\tif (this.boxBottom < 0) this.y += roomH + height;\n\tif (this.boxLeft > roomW) this.x -= roomW + width;\n\tif (this.boxTop > roomH) this.y -= roomH + height;\n}\n\n/**\r\n * Wraps the instance back into the room when it leaves.\r\n */\nfunction actionConfine() {\n\tvar width = this.boxRight - this.boxLeft;\n\tvar height = this.boxBottom - this.boxTop;\n\tvar thisRoom = _room2.default.current;\n\tvar roomW = thisRoom.width;\n\tvar roomH = thisRoom.height;\n\tif (this.boxLeft < 0) this.x = 0;\n\tif (this.boxTop < 0) this.y = 0;\n\tif (this.boxRight > roomW) this.x = roomW - width;\n\tif (this.boxBottom > roomH) this.y = roomH - height;\n}\n\n/**\r\n * Executes the given function with variable arguments on the instance.\r\n * @param {function} func\r\n * @param {...*} args\r\n */\nfunction actionFunc(func) {\n\tfor (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n\t\targs[_key - 1] = arguments[_key];\n\t}\n\n\tfunc.apply(this, args);\n}\n\n/**\r\n * Executes the given Script with an array of arguments.\r\n * @param {script} func\r\n * @param {array} args\r\n */\nfunction script(s, args) {\n\tconsole.log(window[s], args);\n\twindow[s].apply(this, args);\n}\n\n/**\r\n * Executes the given function with variable arguments on the instance.\r\n * @param {string} code\r\n */\nfunction code(code) {\n\tif (typeof code === \"string\") {\n\t\ttry {\n\t\t\teval(code);\n\t\t} catch (err) {\n\t\t\tconsole.error(err.message);\n\t\t}\n\t} else {\n\t\tconsole.error(\"runCode(code); code must be a string!\");\n\t}\n}\n\n/**\r\n * Shows the value of the given variable of the instance, in the console.\r\n * @param {...*} args\r\n */\nfunction get() {\n\tfor (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n\t\targs[_key2] = arguments[_key2];\n\t}\n\n\tconsole.log(this[args].toFixed(2));\n}\n\n// Fucntions for use in code.\nvar GAME = {\n\tmain: {\n\t\tsetGameSpeed: _main2.default.setGameSpeed\n\t},\n\tinstance: {\n\t\tcreate: _instance2.default.create,\n\t\tcreateMoving: _instance2.default.createMoving,\n\t\tdestroy: _instance2.default.destroy,\n\t\tfind: _instance2.default.find,\n\t\tfindRandom: _instance2.default.findRandom,\n\t\tcount: _instance2.default.count,\n\t\tmouseOn: _instance2.default.mouseOn\n\t},\n\tdraw: _extends(_draw2.default, {\n\t\tself: _instance2.default.drawSelf,\n\t\tdebug: _instance2.default.drawDebug\n\t}),\n\tCanvas: _canvas2.default,\n\tcolor: _color2.default,\n\tsprite: _sprite2.default,\n\tSound: _Sound2.default,\n\tRoom: _room2.default,\n\tinput: {\n\t\tkeyboard: _input2.default.keyboard,\n\t\tmouse: _input2.default.mouse,\n\t\ttouch: _input2.default.touch\n\t},\n\tmath: _math2.default,\n\tCamera: _camera2.default,\n\tApp: _App2.default,\n\tGrid: _grid2.default,\n\tTilemap: _tilemap2.default,\n\ttween: _tween2.default,\n\tTransition: _transition2.default,\n\tObject: _object2.default,\n\tPrimitive: _primitive2.default,\n\tVector2: _Vector2.default\n\n\t//\n};var blockBegin = \"blockBegin\",\n    blockEnd = \"blockEnd\",\n    exitEvent = \"exitEvent\",\n    roomEnter = _room2.default.enter,\n    roomNext = _room2.default.next,\n    roomPrevious = _room2.default.previous,\n    instanceCreate = _instance2.default.create,\n    instanceCreateMoving = _instance2.default.createMoving,\n    instanceDestroy = _instance2.default.destroy,\n    changeSprite = _instance2.default.changeSprite,\n    instanceSetRotation = _instance2.default.setRotation,\n    instanceSetDirection = _instance2.default.setDirection,\n    message = function message(args) {\n\treturn console.log(args);\n},\n    alert = function alert(m) {\n\twindow.alert(m);\n},\n    confirm = function confirm(m) {\n\treturn window.confirm(m);\n},\n    drawSetColor = _draw2.default.setColor,\n    drawSetFont = _draw2.default.setFont,\n    drawSetFontSize = _draw2.default.setFontSize,\n    drawText = _draw2.default.text,\n    drawSelf = _instance2.default.drawSelf,\n    drawSprite = _draw2.default.sprite,\n    soundPlay = function soundPlay(snd, loop) {\n\t_Sound2.default.play(snd, { loop: loop });\n},\n    soundStop = _Sound2.default.stop;\n\n//\nexports.instanceCreate = instanceCreate;\nexports.instanceCreateMoving = instanceCreateMoving;\nexports.instanceDestroy = instanceDestroy;\nexports.instanceSetRotation = instanceSetRotation;\nexports.instanceSetDirection = instanceSetDirection;\nexports.changeSprite = changeSprite;\nexports.instanceChangeSprite = changeSprite;\nexports.soundPlay = soundPlay;\nexports.soundStop = soundStop;\nexports.drawSetColor = drawSetColor;\nexports.drawSetFont = drawSetFont;\nexports.drawSetFontSize = drawSetFontSize;\nexports.drawText = drawText;\nexports.drawSelf = drawSelf;\nexports.instanceDrawSelf = drawSelf;\nexports.drawSprite = drawSprite;\nexports.roomEnter = roomEnter;\nexports.roomNext = roomNext;\nexports.roomPrevious = roomPrevious;\nexports.blockBegin = blockBegin;\nexports.blockEnd = blockEnd;\nexports.exitEvent = exitEvent;\nexports.set = set;\nexports.get = get;\nexports.test = test;\nexports.setGravity = setGravity;\nexports.jump = jump;\nexports.jumpRandom = jumpRandom;\nexports.moveFree = moveFree;\nexports.moveDirect = moveDirect;\nexports.moveSpeedX = moveSpeedX;\nexports.moveSpeedY = moveSpeedY;\nexports.moveReverseX = moveReverseX;\nexports.moveReverseY = moveReverseY;\nexports.actionWrap = actionWrap;\nexports.actionConfine = actionConfine;\nexports.wrap = actionWrap;\nexports.confine = actionConfine;\nexports.func = actionFunc;\nexports.script = script;\nexports.code = code;\nexports.message = message;\nexports.alert = alert;\nexports.confirm = confirm;\nexports.GAME = GAME;\n\n/***/ }),\n/* 30 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _generator = __webpack_require__(1);\n\nvar _generator2 = _interopRequireDefault(_generator);\n\nvar _grid = __webpack_require__(7);\n\nvar _grid2 = _interopRequireDefault(_grid);\n\nvar _draw2 = __webpack_require__(0);\n\nvar _draw3 = _interopRequireDefault(_draw2);\n\nvar _sprite = __webpack_require__(2);\n\nvar _sprite2 = _interopRequireDefault(_sprite);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n * @author Jack Oatley\r\n */\nvar Tilemap = function () {\n\n\t/**\r\n  * @param {object} [opts={}] Options object to define the Tilemap.\r\n  * @param {sprite} [opts.atlas]\r\n  * @param {number} [opts.tileWidth]\r\n  * @param {number} [opts.tileHeight]\r\n  * @param {number} [opts.tileSpacing]\r\n  * @param {number} [opts.tileOverlay]\r\n  * @param {number} [opts.tilesWide]\r\n  * @param {number} [opts.mapWidth]\r\n  * @param {number} [opts.mapHeight]\r\n  */\n\tfunction Tilemap() {\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\t\t_classCallCheck(this, Tilemap);\n\n\t\tthis.textureAtlas = opts.atlas || null;\n\t\tthis.tileWidth = opts.tileWidth || 16;\n\t\tthis.tileHeight = opts.tileHeight || 16;\n\t\tthis.tileSpacing = opts.tileSpacing || 0;\n\t\tthis.tileOverlay = opts.tileOverlay || 0;\n\t\tthis.tilesWide = opts.tilesWide || 16;\n\t\tthis.mapWidth = opts.mapWidth || 16;\n\t\tthis.mapHeight = opts.mapHeight || 16;\n\t\tthis.layers = {};\n\n\t\tthis.__gap = this.tileSpacing + this.tileOverlay;\n\t\tif (this.textureAtlas) this.__atlas = _sprite2.default.get(this.textureAtlas).images[0].img;\n\t}\n\n\t/**\r\n  * @param {string} layer Name of the player in which to place the tile.\r\n  * @param {number} x The X grid position to place this tile.\r\n  * @param {number} y The Y grid position to place this tile.\r\n  * @param {number} index The tile index.\r\n  */\n\n\n\tTilemap.prototype.set = function set(layer, x, y, index) {\n\t\tif (!this.layers[layer]) {\n\t\t\tthis.layers[layer] = new _grid2.default(this.mapWidth, this.mapHeight);\n\t\t}\n\t\tthis.layers[layer].set(x, y, index);\n\t};\n\n\t/**\r\n  * @param {object} [opts={}]\r\n  * @param {array} [opts.order]\r\n  * @param {number} [opts.left]\r\n  * @param {number} [opts.top]\r\n  * @param {number} [opts.right]\r\n  * @param {number} [opts.bottom]\r\n  */\n\n\n\tTilemap.prototype.draw = function draw(opts) {\n\t\tvar atlas = this.__atlas;\n\t\tvar tw = this.tileWidth;\n\t\tvar th = this.tileHeight;\n\t\tvar tsw = this.tilesWide;\n\t\tvar gap = this.__gap;\n\t\tvar overlay = this.tileOverlay;\n\t\tvar renderWidth = tw + overlay * 2;\n\t\tvar renderHeight = th + overlay * 2;\n\t\tvar order = opts.order || Object.keys(this.layers);\n\t\tvar startX = ~~Math.max(0, (opts.left || 0) / tw);\n\t\tvar startY = ~~Math.max(0, (opts.top || 0) / th);\n\t\tvar endX = Math.ceil(Math.min(this.mapWidth, (opts.right || 0) / tw));\n\t\tvar endY = Math.ceil(Math.min(this.mapHeight, (opts.bottom || 0) / th));\n\t\tvar x = void 0,\n\t\t    y = void 0,\n\t\t    n = void 0,\n\t\t    layer = void 0,\n\t\t    tile = void 0,\n\t\t    iX = void 0,\n\t\t    iY = void 0;\n\t\tfor (n = 0; n < order.length; n++) {\n\t\t\tlayer = this.layers[order[n]];\n\t\t\tfor (x = startX; x < endX; x++) {\n\t\t\t\tfor (y = startY; y < endY; y++) {\n\t\t\t\t\ttile = layer.get(x, y) - 1;\n\t\t\t\t\tif (tile >= 0) {\n\t\t\t\t\t\tiX = tile % tsw * (tw + gap * 2) + gap;;\n\t\t\t\t\t\tiY = ~~(tile / tsw) * (th + gap * 2) + gap;\n\t\t\t\t\t\t_draw3.default.context.drawImage(atlas, iX - overlay, iY - overlay, renderWidth, renderHeight, x * tw - overlay, // target x\n\t\t\t\t\t\ty * th - overlay, // target y\n\t\t\t\t\t\trenderWidth, renderHeight);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\treturn Tilemap;\n}();\n\n// Static methods, created via the Generator class\n\n\n_generator2.default.classStaticMatch(Tilemap);\nTilemap.prototype.assetType = \"tilemap\";\n\nexports.default = Tilemap;\n\n/***/ })\n/******/ ]);\n});\n\n\n// WEBPACK FOOTER //\n// GameBeans.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 25);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap dd8871391537333c7b29","import math from \"./math\";\r\nimport sprite from \"./sprite\";\r\nimport canvas from \"./canvas\";\r\nimport Font from \"./font\";\r\n\r\n//\r\nlet draw = {\r\n\r\n\t//\r\n\tcolor: \"#FFFFFF\",\r\n\tfont: \"Arial\",\r\n\tfontSize: 30,\r\n\ttextAlign: \"start\",\r\n\ttextBaseline: \"alphabetic\",\r\n\ttarget: null,\r\n\tcontext: null,\r\n\tdefaultTransform: [1, 0, 0, 1, 0, 0],\r\n\ttargetStack: [],\r\n\timageSmoothing: false,\r\n\toffsetX: 0,\r\n\toffsetY: 0,\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tsetTarget: function(target) {\r\n\t\tdraw.targetStack.push(draw.target);\r\n\t\tdraw.target = target;\r\n\t\tdraw.context = target.domElement.getContext(\"2d\");\r\n\t},\r\n\r\n\t/** */\r\n\tresetTarget: function() {\r\n\t\tlet target = draw.targetStack.pop();\r\n\t\tdraw.target = target;\r\n\t\tdraw.context = target.domElement.getContext( \"2d\" );\r\n\t},\r\n\r\n\t/** */\r\n\tgetTarget: function() {\r\n\t\treturn draw.target;\r\n\t},\r\n\r\n\t/** */\r\n\tclear: function(col) {\r\n\t\tcanvas.fill(draw.target, col);\r\n\t},\r\n\r\n\t/** */\r\n\tsave: function() {\r\n\t\tdraw.context.save();\r\n\t},\r\n\r\n\t/** */\r\n\trestore: function() {\r\n\t\tdraw.context.restore();\r\n\t},\r\n\r\n\t/** */\r\n\treset: function() {\r\n\t\tdraw.context.imageSmoothingEnabled = draw.imageSmoothing;\r\n\t\tdraw.context.setTransform(...draw.defaultTransform);\r\n\t\tdraw.context.globalAlpha = 1;\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tsetImageSmoothing: function(enable) {\r\n\t\tdraw.imageSmoothing = enable;\r\n\t},\r\n\r\n\t//\r\n\ttransform: {\r\n\r\n\t\tscale: function(x, y) {\r\n\t\t\tdraw.context.scale(x, y);\r\n\t\t},\r\n\r\n\t\trotate: function(rot) {\r\n\t\t\tdraw.context.rotate(rot * math.DEGTORAD);\r\n\t\t},\r\n\r\n\t\ttranslate: function(x, y) {\r\n\t\t\tdraw.offsetX = x;\r\n\t\t\tdraw.offsetY = y;\r\n\t\t\tdraw.context.translate(x, y);\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * @param {object} [opts={}]\r\n\t\t */\r\n\t\tsetDefault: function( opts = {} ) {\r\n\t\t\tlet trans = draw.defaultTransform;\r\n\t\t\tif (opts.scaleX) trans[0] = opts.scaleX;\r\n\t\t\tif (opts.skewX) trans[1] = opts.skewX;\r\n\t\t\tif (opts.skewY) trans[2] = opts.skewY;\r\n\t\t\tif (opts.scaleY) trans[3] = opts.scaleY;\r\n\t\t\tif (opts.moveX) trans[4] = opts.moveX;\r\n\t\t\tif (opts.moveY) trans[5] = opts.moveY;\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * @param {color} c Can be a number, a hex-value or an object containing R, G, B and optionally A properties or H, S, L and optionally A properties.\r\n\t */\r\n\tsetColor: function( c ) {\r\n\r\n\t\t// quick exit if c is already a CSS color value\r\n\t\tif ( typeof c === \"string\" ) {\r\n\t\t\tdraw.color = c;\r\n\t\t}\r\n\r\n\t\t// c is an object\r\n\t\telse {\r\n\r\n\t\t\t// RGB / RGBA\r\n\t\t\tif (\"r\" in c && \"g\" in c && \"b\" in c) {\r\n\t\t\t\tdraw.color = (\"a\" in c)\r\n\t\t\t\t\t? \"rgba(\"+c.r+\",\"+c.g+\",\"+c.b+\",\"+c.a+\")\"\r\n\t\t\t\t\t: \"rgb(\"+c.r+\",\"+c.g+\",\"+c.b+\")\";\r\n\t\t\t}\r\n\r\n\t\t\t// HSL / HSLA\r\n\t\t\telse if (\"h\" in c && \"s\" in c && \"l\" in c) {\r\n\t\t\t\tdraw.color = (\"a\" in c)\r\n\t\t\t\t\t? \"hsla(\"+c.h+\",\"+c.s+\"%,\"+c.l+\"%,\"+c.a+\")\"\r\n\t\t\t\t\t: \"hsl(\"+c.h+\",\"+c.s+\"%,\"+c.l+\"%)\";\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t/**\r\n\t * Draws the sprite at the given x, y position.\r\n\t * @param {Object} sprite\r\n\t * @param {number} index\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @param {number} scaleX\r\n\t * @param {number} scaleY\r\n\t * @param {number} rotation\r\n\t * @param {Object} [opts={}]\r\n\t * @param {number} [originX] Overrides sprite's originX property.\r\n\t * @param {number} [originY] Overrides sprite's originY property.\r\n\t */\r\n\tsprite: function(spr, index, x, y, scaleX, scaleY, rotation, opts = {}) {\r\n\r\n\t\tspr = sprite.get(spr);\r\n\r\n\t\t//\r\n\t\tconst ctx = draw.context;\r\n\t\tlet ox = spr.originX;\r\n\t\tlet oy = spr.originY;\r\n\t\tif (opts.originX !== undefined) ox = opts.originX;\r\n\t\tif (opts.originY !== undefined) oy = opts.originY;\r\n\r\n\t\t//\r\n\t\tctx.save();\r\n\t\tctx.translate( x, y );\r\n\t\tctx.rotate( rotation * math.DEGTORAD );\r\n\t\tctx.scale( scaleX, scaleY );\r\n\r\n\t\t//\r\n\t\tindex = Math.floor(index || 0) % spr.images.length;\r\n\r\n\t\t//\r\n\t\tlet frame = spr.images[index];\r\n\t\tlet img = frame.img;\r\n\t\tctx.drawImage(\r\n\t\t\timg, frame.clip.x, frame.clip.y,\r\n\t\t\tframe.clip.w, frame.clip.h,\r\n\t\t\t-ox, -oy,\r\n\t\t\tspr.width, spr.height\r\n\t\t);\r\n\r\n\t\t//\r\n\t\tctx.restore();\r\n\t},\r\n\r\n\t/**\r\n\t * Draws the sprite at the given x, y position.\r\n\t * @param {sprite} sprite\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @param {number} w\r\n\t * @param {number} h\r\n\t */\r\n\tspriteTiled: function(spr, index, x, y, w, h) {\r\n\t\tspr = sprite.get(spr);\r\n\t\tlet dx, dy, rx, ry;\r\n\t\tfor (rx=0, dx=x; rx<w; rx++, dx+=spr.width)\r\n\t\tfor (ry=0, dy=y; ry<h; ry++, dy+=spr.height) {\r\n\t\t\tdrawSprite(spr, index, dx, dy, 1, 1, 0);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Draws a canvas at the given position.\r\n\t * @param {canvas} canvas The canvas to draw.\r\n\t * @param {number} x The X position to draw at.\r\n\t * @param {number} y The Y position to draw at.\r\n\t */\r\n\tcanvas: function(canv, x, y) {\r\n\t\tdraw.context.drawImage(canv.domElement, x, y);\r\n\t},\r\n\r\n\t/**\r\n\t * @param {string} font\r\n\t * @param {number} size\r\n\t * @param {string} align Horizontal alignment.\r\n\t * @param {string} baseline Vertical alignment.\r\n\t */\r\n\tsetFont: function(font, size, align, baseline) {\r\n\t\tfont = typeof font === \"string\" ? font : font.name;\r\n\t\tdraw.font = font;\r\n\t\tdraw.fontSize = size;\r\n\t\tdraw.textAlign = align;\r\n\t\tdraw.textBaseline = baseline;\r\n\t\tconst ctx = draw.context;\r\n\t\tctx.font = size + \"px \" + font;\r\n\t\tctx.textAlign = align;\r\n\t\tctx.textBaseline = baseline;\r\n\t},\r\n\r\n\t/**\r\n\t * @param {string} text\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t */\r\n\ttext: function(text, x, y, opts = {}) {\r\n\r\n\t\tx = Number(x);\r\n\t\ty = Number(y);\r\n\r\n\t\tlet bitmap, lookup, scale, useBitmap = false;\r\n\t\tlet font = Font.get(draw.font);\r\n\t\tif (font && font.method === \"bitmap\") {\r\n\t\t\tuseBitmap = true;\r\n\t\t\tlookup = font.bitmapFont.lookup\r\n\t\t\tbitmap = font.bitmapFont.image;\r\n\t\t\tscale = draw.fontSize / font.bitmapFont.size;\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tlet ctx = draw.context;\r\n\t\tlet drawMethod = \"fillText\";\r\n\t\tif (opts.stroke) {\r\n\t\t\tctx.strokeStyle = opts.strokeColor || draw.color;\r\n\t\t\tctx.lineWidth = opts.lineWidth || 2;\r\n\t\t\tdrawMethod = \"strokeText\";\r\n\t\t} else {\r\n\t\t\tctx.fillStyle = draw.color;\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tlet lineLength;\r\n\t\tlet drawX = x;\r\n\t\tlet startN = 0;\r\n\t\t//console.log(text);\r\n\t\tlet endN = text.toString().length;\r\n\t\tif (opts.pattern) {\r\n\t\t\tstartN = opts.pattern.start;\r\n\t\t\tendN = opts.pattern.end;\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tlet lineHeight = ctx.measureText(\"M\").width * 1.2;\r\n\t\tlet lines = text.toString().split(\"#\");\r\n\t\tfor (var i=0; i<lines.length; i++) {\r\n\r\n\t\t\tif (opts.maxWidth) {\r\n\t\t\t\tvar words = lines[i].split(' ');\r\n\t\t\t\tvar line = '';\r\n\r\n\t\t\t\tfor(var n=0; n<words.length; n++) {\r\n\r\n\t\t\t\t\tvar testLine = line + words[n] + ' ';\r\n\t\t\t\t\tvar metrics = ctx.measureText(testLine);\r\n\t\t\t\t\tvar testWidth = metrics.width;\r\n\t\t\t\t\tif (testWidth > opts.maxWidth && n > 0) {\r\n\r\n\t\t\t\t\t\tlet a = line.slice(0, startN);\r\n\t\t\t\t\t\tlet b = line.slice(startN, endN);\r\n\t\t\t\t\t\t//drawX += Draw.measureText(a).width;\r\n\t\t\t\t\t\tdrawX += ctx.measureText(a).width;\r\n\t\t\t\t\t\tif ( 0 < endN ) {\r\n\t\t\t\t\t\t\t_drawWord(drawX, y, b, lookup, ctx, useBitmap, bitmap, scale, drawMethod);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tlineLength = testLine.length;\r\n\t\t\t\t\t\tstartN -= lineLength;\r\n\t\t\t\t\t\tendN -= lineLength;\r\n\r\n\r\n\t\t\t\t\t\tline = words[n] + ' ';\r\n\t\t\t\t\t\ty += lineHeight;\r\n\t\t\t\t\t\tdrawX = x;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tline = testLine;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet a = line.slice(0, startN);\r\n\t\t\t\tlet b = line.slice(startN, endN);\r\n\t\t\t\tdrawX += ctx.measureText(a).width;\r\n\t\t\t\t_drawWord(drawX, y, b, lookup, ctx, useBitmap, bitmap, scale, drawMethod);\r\n\t\t\t\tlineLength = line.length;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tlet a = lines[i].slice(0, startN);\r\n\t\t\t\tlet b = lines[i].slice(startN, endN);\r\n\t\t\t\t//console.log(b);\r\n\t\t\t\tdrawX += ctx.measureText(a).width;\r\n\t\t\t\t_drawWord(~~drawX, y, b, lookup, ctx, useBitmap, bitmap, scale, drawMethod);\r\n\t\t\t\tlineLength = lines[i].length;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tdrawX = x;\r\n\t\t\ty += lineHeight;\r\n\t\t\tstartN -= lineLength;\r\n\t\t\tendN -= lineLength;\r\n\r\n\t\t}\r\n\r\n\r\n\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tshape: {\r\n\r\n\t\t/**\r\n\t\t * @param {number} x1\r\n\t\t * @param {number} y1\r\n\t\t * @param {number} x2\r\n\t\t * @param {number} y2\r\n\t\t * @param {object} [opts={}]\r\n\t\t */\r\n\t\tline: function(x1, y1, x2, y2, opts = {}) {\r\n\t\t\tlet ctx = draw.context;\r\n\t\t\tctx.strokeStyle = opts.color || draw.color;\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.moveTo(x1, y1);\r\n\t\t\tctx.lineTo(x2, y2);\r\n\t\t\tctx.stroke();\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * @param {number} x1\r\n\t\t * @param {number} y1\r\n\t\t * @param {number} x2\r\n\t\t * @param {number} y2\r\n\t\t * @param {object} [opts={}]\r\n\t\t */\r\n\t\tellipse: function(x, y, xr, yr, opts = {}) {\r\n\r\n\t\t\t//\r\n\t\t\tlet ctx = draw.context;\r\n\t\t\tctx.save();\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.translate(x-xr, y-yr);\r\n\t\t\tctx.scale(xr, yr);\r\n\t\t\tctx.arc(1, 1, 1, 0, 2 * Math.PI, false);\r\n\t\t\tctx.restore();\r\n\r\n\t\t\t//\r\n\t\t\tlet style;\r\n\t\t\tif (opts.healthbar) {\r\n\t\t\t\tlet amount = opts.healthbar.amount || 1;\r\n\t\t\t\tlet color = opts.healthbar.color || \"#0F0\";\r\n\t\t\t\tlet background = opts.healthbar.background || \"#F00\";\r\n\t\t\t\tstyle = ctx.createLinearGradient( x-xr, 0, x+xr, 0 );\r\n\t\t\t\tstyle.addColorStop( 0, color );\r\n\t\t\t\tstyle.addColorStop( amount, color );\r\n\t\t\t\tstyle.addColorStop( amount, background );\r\n\t\t\t\tstyle.addColorStop( 1, background );\r\n\t\t\t} else {\r\n\t\t\t\tstyle = opts.color || draw.color;\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\t\t\tif (!opts.fill && !opts.stroke)\r\n\t\t\t\topts.fill = true;\r\n\r\n\t\t\t//\r\n\t\t\tif (opts.fill) {\r\n\t\t\t\tctx.fillStyle = style;\r\n\t\t\t\tctx.fill();\r\n\t\t\t}\r\n\r\n\t\t\tif (opts.stroke) {\r\n\t\t\t\tctx.strokeStyle = style\r\n\t\t\t\tctx.lineWidth = opts.lineWidth || 1;\r\n\t\t\t\tctx.stroke();\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * @param {number} x\r\n\t\t * @param {number} y\r\n\t\t * @param {number} w\r\n\t\t * @param {number} h\r\n\t\t * @param {object} [opts={}]\r\n\t\t */\r\n\t\trectangle: function(x, y, w, h, opts = {}) {\r\n\r\n\t\t\t//\r\n\t\t\tlet ctx = draw.context;\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.rect(x, y, w, h);\r\n\r\n\t\t\t//\r\n\t\t\tlet style;\r\n\t\t\tif ( opts.healthbar ) {\r\n\t\t\t\tlet amount = opts.healthbar.amount || 1;\r\n\t\t\t\tlet color = opts.healthbar.color || \"#0F0\";\r\n\t\t\t\tlet background = opts.healthbar.background || \"#F00\";\r\n\t\t\t\tstyle = ctx.createLinearGradient(x, 0, x+w, 0);\r\n\t\t\t\tstyle.addColorStop(0, color);\r\n\t\t\t\tstyle.addColorStop(amount, color);\r\n\t\t\t\tstyle.addColorStop(amount, background);\r\n\t\t\t\tstyle.addColorStop(1, background);\r\n\t\t\t} else {\r\n\t\t\t\tstyle = opts.color || draw.color;\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\t\t\tif (!opts.fill && !opts.stroke)\r\n\t\t\t\topts.fill = true;\r\n\r\n\t\t\t//\r\n\t\t\tif (opts.fill) {\r\n\t\t\t\tctx.fillStyle = style;\r\n\t\t\t\tctx.fill();\r\n\t\t\t}\r\n\r\n\t\t\tif (opts.stroke) {\r\n\t\t\t\tctx.strokeStyle = style;\r\n\t\t\t\tctx.lineWidth = opts.lineWidth || 1;\r\n\t\t\t\tctx.stroke();\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n *\r\n */\r\nfunction _drawWord(drawX, drawY, word, lookup, ctx, useBitmap, bitmap, scale, drawMethod) {\r\n\tif (useBitmap) {\r\n\t\tlet dx = ~~drawX;\r\n\t\tfor (var cn=0; cn<word.length; cn++) {\r\n\t\t\tlet metrics = lookup[word[cn]];\r\n\t\t\tlet sx = metrics.left;\r\n\t\t\tlet sy = metrics.top;\r\n\t\t\tlet sw = metrics.right - metrics.left;\r\n\t\t\tlet sh = metrics.bottom - metrics.top;\r\n\t\t\tctx.drawImage(bitmap, sx, sy, sw, sh, dx, drawY, sw*scale, sh*scale);\r\n\t\t\tdx += (sw + 1) * scale;\r\n\t\t}\r\n\t} else {\r\n\t\tctx[drawMethod](word, drawX, drawY);\r\n\t}\r\n}\r\n\r\n//\r\nexport default draw;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/draw.js","/**\r\n * @author Jack Oatley\r\n */\r\nexport default class Generator {\r\n\t\r\n\t/**\r\n\t * If class has a static \"get\" method it is used in functions created from\r\n\t * prototype methods. If there is a \"get\" method on the prototype it is not\r\n\t * used in the created functions, however it will overide the static \"get\"\r\n\t * method. If there is both a static \"get\" method and a \"get\" method on the\r\n\t * prototype, the static one is used in created functions and remains so,\r\n\t * but the static method on the class is still overwritten.\r\n\t * @param {function} c Constructor function.\r\n\t */\r\n\tstatic classStaticMatch(c) {\r\n\t\tc.create = Generator.functionFromConstructor(c);\r\n\t\tconst get = c.get;\r\n\t\tfor (var m in c.prototype) {\r\n\t\t\tc[m] = Generator.functionFromMethod(c.prototype[m], get);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {function} c Constructor function.\r\n\t */\r\n\tstatic functionFromConstructor(c) {\r\n\t\treturn (...a) => new c(...a);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {function} m Prototype method.\r\n\t * @param {function} [get] Optional get function (static on the constructor.)\r\n\t */\r\n\tstatic functionFromMethod(m, get) {\r\n\t\tif (get)\r\n\t\t\treturn (s, ...a) => m.call(get(s), ...a);\r\n\t\telse\r\n\t\t\treturn (...a) => m.call(...a);\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {array} a An array of instances of constructor with the following method.\r\n\t * @param {function} m The method to execute for each instance in the array.\r\n\t */\r\n\tstatic arrayExecute(a, m) {\r\n\t\treturn (...p) => a.forEach(i => m.call(i, ...p));\r\n\t}\r\n\t\r\n}\n\n\n// WEBPACK FOOTER //\n// ./core/js/generator.js","import Generator from \"./generator\";\r\nimport Color from \"./color\";\r\n\r\n/**\r\n *\r\n */\r\nclass Sprite {\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tconstructor(opts = {}) {\r\n\r\n\t\t//\r\n\t\tlet atlas, atlasIndex;\r\n\t\tif (opts.atlas) {\r\n\t\t\tatlasIndex = opts.atlasIndex || 0;\r\n\t\t\tatlas = opts.atlas.images[atlasIndex];\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tthis.assetType = \"sprite\";\r\n\t\tthis.name = opts.name || newSpriteName();\r\n\t\tthis.originX = opts.originX || 0;\r\n\t\tthis.originY = opts.originY || 0;\r\n\t\tthis.width = 0;\r\n\t\tthis.height = 0;\r\n\t\tthis.images = [];\r\n\r\n\t\t//\r\n\t\tif (opts.frames) {\r\n\t\t\topts.frames.forEach((frame) => {\r\n\t\t\t\tthis.addFrame({\r\n\t\t\t\t\tsource: frame.src\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tlet length = Sprite.array.length;\r\n\t\tSprite.names[length] = this.name;\r\n\t\tSprite.array[length++] = this;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\taddFrame(opts = {}) {\r\n\r\n\t\t//\r\n\t\tlet atlas;\r\n\t\tif (opts.atlas) {\r\n\t\t\tatlas = Sprite.get(opts.atlas).images[0].img;\r\n\t\t}\r\n\r\n\t\tlet image = {\r\n\t\t\timg: atlas || new Image(),\r\n\t\t\tclip: null,\r\n\t\t\tready: false\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tif (opts.source) {\r\n\r\n\t\t\timage.img.onload = () => {\r\n\r\n\t\t\t\t//\r\n\t\t\t\timage.clip = {\r\n\t\t\t\t\tx: 0,\r\n\t\t\t\t\ty: 0,\r\n\t\t\t\t\tw: image.img.width,\r\n\t\t\t\t\th: image.img.height\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//\r\n\t\t\t\tif (this.width * this.height === 0 ) {\r\n\t\t\t\t\tthis.width = image.clip.w;\r\n\t\t\t\t\tthis.height = image.clip.h;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//\r\n\t\t\t\timage.ready = true;\r\n\r\n\t\t\t}\r\n\t\t\timage.img.src = opts.source || \"\";\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tif (atlas && opts.clip) {\r\n\r\n\t\t\t//\r\n\t\t\timage.clip = opts.clip;\r\n\r\n\t\t\t//\r\n\t\t\tif (this.width * this.height === 0) {\r\n\t\t\t\tthis.width = image.clip.w;\r\n\t\t\t\tthis.height = image.clip.h;\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\t\t\timage.ready = true;\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tthis.images.push(image);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tcache(opts = {}) {\r\n\r\n\t\t//\r\n\t\tthis.images.forEach((frame) => {\r\n\t\t\tlet canvas = document.createElement(\"CANVAS\");\r\n\t\t\tcanvas.width = opts.width || frame.img.width;\r\n\t\t\tcanvas.height = opts.height || frame.img.height;\r\n\t\t\tlet ctx = canvas.getContext(\"2d\");\r\n\t\t\tctx.drawImage(frame.img, 0, 0, canvas.width+1, canvas.height+1);\r\n\t\t\tframe.__orig = Object.assign({}, frame);\r\n\t\t\tframe.clip.x = 0;\r\n\t\t\tframe.clip.y = 0;\r\n\t\t\tframe.clip.w = canvas.width;\r\n\t\t\tframe.clip.h = canvas.height;\r\n\t\t\tframe.img = canvas;\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\trestore(options = {}) {\r\n\t\tthis.images.forEach((frame) => {\r\n\t\t\tif (frame.__orig) frame = frame._orig;\r\n\t\t\tif (frame.__origSrc) frame.img.src = frame.__origSrc;\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @return {void}\r\n\t */\r\n\tsetOrigin(x, y) {\r\n\t\tthis.originX = Number(x);\r\n\t\tthis.originY = Number(y);\r\n\t}\r\n\r\n\t/**\r\n\t * Tints the sprite to the given color. Effects all frames.\r\n\t * @param {string} col A CSS color value.\r\n\t * @return {void}\r\n\t */\r\n\ttint(col) {\r\n\r\n\t\t//\r\n\t\tthis.images.forEach((frame) => {\r\n\r\n\t\t\t// create canvas, draw image\r\n\t\t\tlet canvas = document.createElement(\"CANVAS\");\r\n\t\t\tlet ctx = canvas.getContext(\"2d\");\r\n\t\t\tcanvas.width = this.width;\r\n\t\t\tcanvas.height = this.height;\r\n\t\t\tframe.img = frame.__orig || frame.img;\r\n\t\t\tctx.drawImage(frame.img, 0, 0);\r\n\r\n\t\t\t// get data, do thing, put data back\r\n\t\t\tlet imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\r\n\t\t\tlet color = (typeof col === \"object\") ? col : Color.hexToRgb(col);\r\n\t\t\tpixelDataTint(imageData.data, color);\r\n\t\t\tctx.putImageData(imageData, 0, 0);\r\n\r\n\t\t\t//\r\n\t\t\tframe.__orig = frame.img;\r\n\t\t\tframe.__origSrc = frame.img.src;\r\n\t\t\tframe.img = canvas;\r\n\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @return {boolean}\r\n\t */\r\n\tstatic readyAll() {\r\n\r\n\t\tfor (var n=0; n<Sprite.array.length; n++) {\r\n\t\t\tlet spr = Sprite.array[n];\r\n\t\t\tfor (var i=0; i<spr.images.length; i++) {\r\n\t\t\t\tlet image = spr.images[i];\r\n\t\t\t\tif (!image.ready) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @param {*} name String or Object.\r\n\t * @return {Object}\r\n\t */\r\n\tstatic get(name) {\r\n\r\n\t\tif (typeof name === \"object\")\r\n\t\t\treturn name;\r\n\r\n\t\tfor (var n = 0; n < Sprite.array.length; n++)\r\n\t\t\tif (Sprite.array[n].name === name)\r\n\t\t\t\treturn Sprite.array[n];\r\n\r\n\t\treturn null;\r\n\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n *\r\n */\r\nfunction newSpriteName() {\r\n\treturn \"Sprite_\" + Sprite.array.length;\r\n}\r\n\r\n/**\r\n *\r\n */\r\nfunction pixelDataTint(data, rgb) {\r\n\r\n\t// cache as much as possible, there could be a lot of pixels\r\n\tlet l = data.length,\r\n\t\tr = rgb.r / 255,\r\n\t\tg = rgb.g / 255,\r\n\t\tb = rgb.b / 255;\r\n\r\n\t//\r\n\tfor (var i = 0; i < l; i += 4) {\r\n\t\tdata[i]     = r * data[i]     >> 0;\r\n\t\tdata[i + 1] = g * data[i + 1] >> 0;\r\n\t\tdata[i + 2] = b * data[i + 2] >> 0;\r\n\t}\r\n\r\n}\r\n\r\n//\r\nGenerator.classStaticMatch(Sprite);\r\nSprite.names = [];\r\nSprite.array = [];\r\n\r\n//\r\nexport default Sprite;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/sprite.js","import draw from \"./draw\";\r\nimport Generator from \"./generator\";\r\n\r\n/**\r\n *\r\n */\r\nclass Canvas {\r\n\r\n\t/**\r\n\t * @param {Object} [opts={}]\r\n\t * @param {Number} [opts.width=300]\r\n\t * @param {Number} [opts.height=150]\r\n\t * @param {Number} [opts.scale=1]\r\n\t * @param {Boolean} [opts.application=false]\r\n\t * @param {Boolean} [opts.script2D=false]\r\n\t */\r\n\tconstructor(opts = {}) {\r\n\t\tconst c = document.createElement(\"CANVAS\");\r\n\t\tconst ctx = c.getContext(\"2d\");\r\n\t\tthis.domElement = c;\r\n\t\tthis.context = ctx;\r\n\t\tthis.width = opts.width || 300;\r\n\t\tthis.height = opts.height || 150;\r\n\t\t\r\n\t\t//\r\n\t\tc.scale = opts.scale || 1;\r\n\t\tc.application = opts.application || false;\r\n\t\t\r\n\t\t//\r\n\t\tif (opts.crisp2D) {\r\n\t\t\tctx.imageSmoothingEnabled = false;\r\n\t\t}\r\n\t\t\r\n\t\t//\r\n\t\tif (c.application) {\r\n\t\t\tdraw.setTarget(this);\r\n\t\t\tCanvas.setMain(this);\r\n\t\t}\r\n\t\t\r\n\t\t//\r\n\t\tc.oncontextmenu = (e) => e.preventDefault();\r\n\t\t\r\n\t\t//\r\n\t\tCanvas.array.push(this);\r\n\t}\r\n\t\r\n\tget width() {\r\n\t\treturn this._width;\r\n\t}\r\n\t\r\n\tset width(x) {\r\n\t\tthis._width = x;\r\n\t\tthis.domElement.width = x;\r\n\t}\r\n\t\r\n\tget height() {\r\n\t\treturn this._height;\r\n\t}\r\n\t\r\n\tset height(x) {\r\n\t\tthis._height = x;\r\n\t\tthis.domElement.height = x;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Sets the canvas as the main canvas for the game.\r\n\t */\r\n\tsetMain() {\r\n\t\tlet c = this.domElement;\r\n\t\tCanvas.main = this;\r\n\t\tif (Canvas.dom === null) {\r\n\t\t\tCanvas.dom = c;\r\n\t\t\tvar el = document.getElementById(\"gbgamebox\") || document.body;\r\n\t\t\tel.appendChild(c);\r\n\t\t}\r\n\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets the canvas that is currently set as the main game canvas.\r\n\t */\r\n\tstatic getMain() {\r\n\t\treturn Canvas.main;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {String} color=\"#000000\" CSS value as a string.\r\n\t */\r\n\tfill(color) {\r\n\t\tlet c = this.domElement;\r\n\t\tvar ctx = this.context;\r\n\t\tctx.fillStyle = color || \"#000000\";\r\n\t\tctx.fillRect(0, 0, c.width / c.scale, c.height / c.scale);\r\n\t}\r\n\r\n\t/**\r\n\t * Clears the canvas.\r\n\t */\r\n\tclear() {\r\n\t\tvar c = this.domElement;\r\n\t\tvar ctx = this.context;\r\n\t\tctx.clearRect(0, 0, c.width / c.scale, c.height / c.scale);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Returns the RGBA components of a pixel on the canvas as an ArrayBuffer.\r\n\t * @param {Number} x X position of the pixel, must be an integer.\r\n\t * @param {Number} y Y position of the pixel, must be an integer.\r\n\t * @returns {ArrayBuffer} An ArrayBuffer with 4 values (for R, G, B, A).\r\n\t */\r\n\tgetPixel(x, y) {\r\n\t\tconst data = this.context.getImageData(x, y, 1, 1).data;\r\n\t\treturn data;\r\n\t}\r\n\r\n}\r\n\r\nGenerator.classStaticMatch(Canvas);\r\nCanvas.array = [];\r\nCanvas.main = null;\r\nCanvas.dom = null;\r\n\r\nexport default Canvas;\n\n\n// WEBPACK FOOTER //\n// ./core/js/canvas.js","import math from \"./math\";\r\nimport input from \"./input\";\r\nimport object from \"./object\";\r\nimport sprite from \"./sprite\";\r\nimport Draw from \"./draw\";\r\nimport Compiler from \"./compile\";\r\nimport global from \"./global\";\r\n\r\n//\r\nwindow.global = global;\r\n\r\n//\r\nlet instance = (function() {\r\n\r\n\t//\r\n\tlet uniqueId = 1;\r\n\tlet instanceArray = [];\r\n\tlet instanceHardLimit = 1000;\r\n\tlet doDepthSort = false;\r\n\tlet otherStack = [];\r\n\tlet currentEvent = \"\";\r\n\r\n\t/***************************************************************************\r\n\t * Create a new instance of an object.\r\n\t * @param {Object} obj\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @return {Object}\r\n\t */\r\n\tfunction create(obj, x, y) {\r\n\r\n\t\t//\r\n\t\tlet o = object.get(obj);\r\n\t\tif (o === null) {\r\n\t\t\twindow.addConsoleText(\"#F00\", \"No such object as \" + obj);\r\n\t\t\twindow._GB_stop();\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\t//\r\n\t\treturn new o(x, y);\r\n\r\n\t}\r\n\r\n\t/***************************************************************************\r\n\t *\r\n\t */\r\n\tfunction setup(inst, o, x, y) {\r\n\r\n\t\tinst.id = uniqueId++;\r\n\t\tinst.exists = true;\r\n\t\tinst.speed = 0;\r\n\t\tinst.object = o;\r\n\t\tinst.objectName = o.objectName;\r\n\t\tinst.assetType = \"instance\";\r\n\t\tinst.x = Number(x);\r\n\t\tinst.y = Number(y);\r\n\t\tinst.startX = inst.x;\r\n\t\tinst.startY = inst.y;\r\n\t\tinst.previousX = inst.x;\r\n\t\tinst.previousY = inst.y;\r\n\t\tinst.boxCollision = {};\r\n\r\n\t\t//\r\n\t\tlet spr = sprite.get(inst.sprite);\r\n\t\tif (spr) {\r\n\t\t\tinst.boxCollision.x = spr.originX;\r\n\t\t\tinst.boxCollision.y = spr.originY;\r\n\t\t\tinst.boxCollision.width = spr.width;\r\n\t\t\tinst.boxCollision.height = spr.height;\r\n\t\t}\r\n\r\n\t\t//\r\n\t\taddToArray(inst);\r\n\t\tupdateBoundingBox(inst);\r\n\t\tupdateCollisionBox(inst);\r\n\t\texecuteEvent(inst, \"create\");\r\n\t}\r\n\r\n\t/***************************************************************************\r\n\t * @param {Object} inst\r\n\t * @return {void}\r\n\t */\r\n\tfunction addToArray(inst) {\r\n\t\tlet i = instanceArray.length;\r\n\t\twhile (i--) {\r\n\t\t\tif (inst.depth <= instanceArray[i].depth) {\r\n\t\t\t\tinstanceArray.splice(i, 0, inst);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\tinstanceArray.push(inst);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {object} obj\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @param {number} speed\r\n\t * @param {number} direction\r\n\t */\r\n\tfunction createMoving(obj, x, y, speed, direction) {\r\n\r\n\t\tif (instanceArray.length >= instanceHardLimit) {\r\n\t\t\tconsole.warn(\"instance number hard limit reached:\", instanceHardLimit);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet newInst = create(obj, x, y);\r\n\t\tnewInst.speed = speed;\r\n\t\tnewInst.direction = direction;\r\n\t\treturn newInst;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tfunction find(obj, n) {\r\n\t\tif (typeof obj === \"function\") obj = obj.objectName;\r\n\t\tlet i, c=0, inst;\r\n\t\tfor (i=0; i<instanceArray.length; i++) {\r\n\t\t\tinst = instanceArray[i];\r\n\t\t\tif (inst.objectName === obj) {\r\n\t\t\t\tif (c++ === n)\r\n\t\t\t\t\treturn inst;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tfunction findRandom(obj) {\r\n\t\tif (typeof obj === \"function\") obj = obj.objectName;\r\n\t\tlet n = math.randomInt(0, count(obj) - 1);\r\n\t\treturn find(obj, n);\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tfunction count(objectName) {\r\n\t\tlet c=0;\r\n\t\tinstanceArray.forEach((inst) => {\r\n\t\t\tc += (inst.objectName === objectName);\r\n\t\t});\r\n\t\treturn c;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} rotation\r\n\t * @param {boolean} relative\r\n\t */\r\n\tfunction setRotation(rotation, relative) {\r\n\t\tthis.rotation = (relative) ? this.rotation + rotation : rotation;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} rotation\r\n\t * @param {boolean} relative\r\n\t */\r\n\tfunction setDirection(direction, relative) {\r\n\t\tthis.direction = (relative) ? this.direction + direction : direction;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {object} inst Check the mouse is over this instance.\r\n\t */\r\n\tfunction mouseOn(inst) {\r\n\t\treturn !(inst.boxTop > input.mouse.y/2 - Draw.offsetY\r\n\t\t|| inst.boxBottom < input.mouse.y/2 - Draw.offsetY\r\n\t\t|| inst.boxLeft > input.mouse.x/2 - Draw.offsetX\r\n\t\t|| inst.boxRight < input.mouse.x/2 - Draw.offsetX);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {instance} inst Instance to execute step event of.\r\n\t */\r\n\tfunction step(inst) {\r\n\r\n\t\t// step events\r\n\t\texecuteEvent(inst, \"step\");\r\n\t\tupdateAnimation(inst);\r\n\t\tupdatePosition(inst);\r\n\t\tupdateBoundingBox(inst);\r\n\t\tupdateCollisionBox(inst);\r\n\r\n\t\t// collision events\r\n\t\tinstanceExecuteListeners(inst);\r\n\r\n\t\t// input events\r\n\t\tinput.triggerEvents.forEach((event) => {\r\n\t\t\texecuteEvent(inst, event);\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tfunction updateAnimation(inst) {\r\n\r\n\t\tinst.index += inst.imageSpeed;\r\n\t\tlet spr = sprite.get(inst.sprite);\r\n\t\tif (spr) {\r\n\t\t\tlet length = spr.images.length;\r\n\t\t\tif (inst.index >= length) {\r\n\r\n\t\t\t\tlet behavior = inst.animationBehavior;\r\n\t\t\t\tlet type = typeof behavior;\r\n\r\n\t\t\t\t//\r\n\t\t\t\tif ( type === \"string\" ) {\r\n\r\n\t\t\t\t\t//\r\n\t\t\t\t\tif ( behavior === \"loop\" ) {\r\n\t\t\t\t\t\tinst.index -= length;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//\r\n\t\t\t\t\telse if ( behavior === \"stop\" ) {\r\n\t\t\t\t\t\tinst.index = length - 1;\r\n\t\t\t\t\t\tinst.imageSpeed = 0;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//\r\n\t\t\t\telse if ( type === \"function\" ) {\r\n\t\t\t\t\tbehavior.call( inst );\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tfunction updatePosition(inst) {\r\n\r\n\t\t// if the instance is already falling at terminal velocity then we no longer apply gravity\r\n\t\tlet gravVector = {\r\n\t\t\tx: math.lengthDirX( inst.terminal, inst.gravityDirection ),\r\n\t\t\ty: math.lengthDirY( inst.terminal, inst.gravityDirection )\r\n\t\t};\r\n\r\n\t\tif ( gravVector.x > 0 && inst.speedX <= gravVector.x\r\n\t\t||   gravVector.x < 0 && inst.speedX >= gravVector.x ) {\r\n\t\t\tinst.speedX += math.lengthDirX( inst.gravity, inst.gravityDirection );\r\n\t\t}\r\n\r\n\t\tif ( gravVector.y > 0 && inst.speedY <= gravVector.y\r\n\t\t||   gravVector.y < 0 && inst.speedY >= gravVector.y ) {\r\n\t\t\tinst.speedY += math.lengthDirY( inst.gravity, inst.gravityDirection );\r\n\t\t}\r\n\r\n\t\t// move instance\r\n\t\tinst.x += inst.speedX;\r\n\t\tinst.y += inst.speedY;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @param {object} i Instance whos bounding box to update.\r\n\t */\r\n\tfunction updateBoundingBox(i) {\r\n\t\tlet spr = sprite.get(i.sprite);\r\n\t\tif (spr === null) return;\r\n\t\ti.boxTop = i.y - spr.originY * i.scaleY;\r\n\t\ti.boxLeft = i.x - spr.originX * i.scaleX;\r\n\t\ti.boxBottom = i.boxTop + spr.height * i.scaleY;\r\n\t\ti.boxRight = i.boxLeft + spr.width * i.scaleX;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {object} i Instance.\r\n\t */\r\n\tfunction updateCollisionBox(i) {\r\n\t\tlet box = i.boxCollision;\r\n\t\tbox.top = i.y - box.y * i.scaleY;\r\n\t\tbox.left = i.x - box.x * i.scaleX;\r\n\t\tbox.bottom = box.top + box.height * i.scaleY;\r\n\t\tbox.right = box.left + box.width * i.scaleX;\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tfunction destroy(inst) {\r\n\t\texecuteEvent(inst, \"destroy\");\r\n\t\tinst.exists = false;\r\n\t\tlet index = inst.object.instances.indexOf(inst);\r\n\t\tinst.object.instances.splice(index, 1);\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tfunction draw(inst) {\r\n\t\tif (!inst.visible) return;\r\n\t\tif (inst.events[\"draw\"]) {\r\n\t\t\texecuteEvent(inst, \"draw\")\r\n\t\t} else {\r\n\t\t\tdrawSelf(inst);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {Object} inst Instance to draw.\r\n\t * @param {Object} [opts] Options object.\r\n\t */\r\n\tfunction drawSelf(inst, opts) {\r\n\t\tif (inst.sprite === null) return;\r\n\t\tDraw.sprite(\r\n\t\t\tinst.sprite,\r\n\t\t\tinst.index,\r\n\t\t\tinst.x, inst.y,\r\n\t\t\tinst.scaleX, inst.scaleY,\r\n\t\t\tinst.rotation,\r\n\t\t\topts\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tfunction drawDebug(inst) {\r\n\t\tlet box = inst.boxCollision;\r\n\t\tDraw.shape.rectangle(\r\n\t\t\tbox.left,\r\n\t\t\tbox.top,\r\n\t\t\tbox.right - box.left,\r\n\t\t\tbox.bottom - box.top, {\r\n\t\t\t\tcolor: \"#FF000055\"\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {object} sprite\r\n\t */\r\n\tfunction changeSprite(sprite) {\r\n\t\tthis.sprite = sprite;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {object} inst\r\n\t */\r\n\tfunction instanceExecuteListeners(inst) {\r\n\r\n\t\tinst.listeners.forEach((listener) => {\r\n\t\t\tswitch (listener.type) {\r\n\r\n\t\t\t\tcase (\"collision\"):\r\n\t\t\t\t\tinstanceCollisionInstance(inst, listener.target);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tfunction instanceCollisionInstance(inst, target) {\r\n\r\n\t\t//\r\n\t\tlet arr;\r\n\t\tif (target === \"solid\") {\r\n\t\t\tarr = getAllSolid(target);\r\n\t\t} else {\r\n\t\t\tarr = object.getAllInstances(target);\r\n\t\t}\r\n\r\n\t\tlet box1 = inst.boxCollision;\r\n\t\tarr.forEach(function(targ) {\r\n\r\n\t\t\t// same instance\r\n\t\t\tif (inst === targ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// no collision\r\n\t\t\tlet box2 = targ.boxCollision;\r\n\t\t\tif (box1.left > box2.right\r\n\t\t\t|| box1.right < box2.left\r\n\t\t\t|| box1.top > box2.bottom\r\n\t\t\t|| box1.bottom < box2.top) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// execute collision event\r\n\t\t\texecuteEvent(inst, \"collision_\" + target, targ);\r\n\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t/***************************************************************************\r\n\t * Execute a particular event for all current instances.\r\n\t * @param {string} event The event to execute.\r\n\t * @param {Object} otherInst\r\n\t * @return {void}\r\n\t */\r\n\tfunction executeEventAll(event, otherInst) {\r\n\t\tvar n = instanceArray.length;\r\n\t\twhile (n--) {\r\n\t\t\texecuteEvent(instanceArray[n], event, otherInst);\r\n\t\t}\r\n\t}\r\n\r\n\t/***************************************************************************\r\n\t * Execute an event for the given instance only.\r\n\t * @param {Object} inst\r\n\t * @param {event} event\r\n\t * @param {Object} otherInst The other instance, in collisions for example.\r\n\t * @return {void}\r\n\t */\r\n\tfunction executeEvent(inst, event, otherInst) {\r\n\r\n\t\t// Set the current \"other\" instance.\r\n\t\totherStack.push(window.other);\r\n\t\twindow.other = otherInst;\r\n\t\tcurrentEvent = event;\r\n\r\n\t\t//\r\n\t\ttry {\r\n\t\t\tif (inst.exists) {\r\n\t\t\t\tlet actions = inst.events[event];\r\n\t\t\t\tif (actions) {\r\n\t\t\t\t\texecuteActions(inst, actions, otherInst);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tcatch (err) {\r\n\t\t\tconsole.error(err);\r\n\t\t\twindow.addConsoleText(\"#F00\", \"Failed to execute event [\" + event + \"]\" + \" of object [\" + inst.objectName + \"]\" + \" with error: \" + err);\r\n\t\t\twindow._GB_stop();\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// Restore previous \"other\" instance.\r\n\t\twindow.other = otherStack.pop();\r\n\r\n\t}\r\n\r\n\t/***************************************************************************\r\n\t * @param {Object} inst\r\n\t * @param {Array} actions\r\n\t * @param {Object} otherInst\r\n\t */\r\n\tfunction executeActions(inst, actions, otherInst) {\r\n\t\tconst steps = [];\r\n\t\tlet condition = true;\r\n\t\tlet scope = 0;\r\n\r\n\t\tfor (let a=0; a<actions.length; a++) {\r\n\r\n\t\t\tlet action = actions[a];\r\n\t\t\tswitch (action.flow) {\r\n\r\n\t\t\t\t// regular action\r\n\t\t\t\tcase (\"\"):\r\n\r\n\t\t\t\t\tif (!condition)\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tif (!action.cache) {\r\n\r\n\t\t\t\t\t\tconst args = action.args;\r\n\t\t\t\t\t\tlet n, newArgs = [];\r\n\t\t\t\t\t\tfor (n = 0; n < args.length; n++) {\r\n\t\t\t\t\t\t\tif (typeof args[n] === \"function\") {\r\n\t\t\t\t\t\t\t\tnewArgs[n] = args[n];\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tswitch (args[n]) {\r\n\t\t\t\t\t\t\t\t\tcase (\"self\"): newArgs[n] = inst; break;\r\n\t\t\t\t\t\t\t\t\tcase (\"other\"): newArgs[n] = otherInst; break;\r\n\t\t\t\t\t\t\t\t\tdefault: newArgs[n] = Compiler.actionExpression.call(inst, args[n]); break\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Catch any undefined arguments.\r\n\t\t\t\t\t\tif (newArgs.includes(undefined)) {\r\n\t\t\t\t\t\t\twindow.addConsoleText(\"#F00\",\r\n\t\t\t\t\t\t\t\t\"[\" + inst.objectName + \"]\"\r\n\t\t\t\t\t\t\t\t+ \" > [\" + currentEvent + \"]\"\r\n\t\t\t\t\t\t\t\t+ \" > [\" + action.action.name + \"]\"\r\n\t\t\t\t\t\t\t\t+ \" Action contains undefined values!\");\r\n\t\t\t\t\t\t\twindow._GB_stop();\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t//*\r\n\t\t\t\t\t\taction.cache = (function() {\r\n\t\t\t\t\t\t\tif (typeof newArgs[0] === \"function\") {\r\n\t\t\t\t\t\t\t\treturn newArgs[0];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tlet t = inst;\r\n\t\t\t\t\t\t\tlet f = action.action;\r\n\t\t\t\t\t\t\treturn eval(`\r\n\t\t\t\t\t\t\t\t(function() {\r\n\t\t\t\t\t\t\t\t\treturn f.call(this, ` + newArgs.join(\",\") + `);\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t`);\r\n\t\t\t\t\t\t})();\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tcondition = action.cache.call(inst);\r\n\t\t\t\t\t(condition === undefined)\r\n\t\t\t\t\t\t? condition = true\r\n\t\t\t\t\t\t: steps[scope] = 0;\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t// control actions\r\n\t\t\t\tcase (\"blockBegin\"): scope++; break;\r\n\t\t\t\tcase (\"blockEnd\"): scope--; break;\r\n\t\t\t\tcase (\"exitEvent\"): if (condition) return false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// exit from a single statement after an expression not contained in a block\r\n\t\t\tif (steps[scope]++ === 1) {\r\n\t\t\t\tcondition = true;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tfunction newStep() {\r\n\t\tlet arr = instanceArray.slice();\r\n\t\tarr.forEach((i) => {\r\n\t\t\ti.previousX = i.x;\r\n\t\t\ti.previousY = i.y;\r\n\t\t});\r\n\t}\r\n\r\n\t/***************************************************************************\r\n\t * @return {void}\r\n\t */\r\n\tfunction stepAll() {\r\n\t\tnewStep();\r\n\t\tlet arr = instanceArray.slice();\r\n\t\tarr.forEach(function(inst) { executeEvent(inst, \"stepBegin\"); });\r\n\t\tarr.forEach(step);\r\n\t\tarr.forEach(function(inst) { executeEvent(inst, \"stepEnd\"); });\r\n\t\tclearDestroyed();\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tfunction drawAll() {\r\n\t\tif (doDepthSort) {\r\n\t\t\tinstanceArray.sort(sortFunction);\r\n\t\t}\r\n\t\tinstanceArray.forEach(draw);\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tfunction drawGuiAll() {\r\n\t\tinstanceArray.forEach(function(inst) {\r\n\t\t\texecuteEvent(inst, \"drawGUI\");\r\n\t\t});\r\n\t}\r\n\r\n\t/***************************************************************************\r\n\t * The function used for instance depth ordering.\r\n\t * @param {Object} a Instance.\r\n\t * @param {Object} b Instance.\r\n\t * @return {number} 0, -1 or 1.\r\n\t */\r\n\tfunction sortFunction(a, b) {\r\n \t\treturn (a.depth === b.depth)\r\n \t\t\t? a.id - b.id\r\n \t\t\t: a.depth - b.depth;\r\n \t}\r\n\r\n\t/***************************************************************************\r\n\t * Remove isntances that have been requested to be destroyed.\r\n\t * @return {void}\r\n\t */\r\n\tfunction clearDestroyed() {\r\n\t\tlet l = instanceArray.length;\r\n\t\tlet n = l;\r\n\t\tlet i;\r\n\t\twhile (i = instanceArray[--n]) {\r\n\t\t\tif (!i.exists) {\r\n\t\t\t\ti.object.pool.release(i);\r\n\t\t\t\tinstanceArray[n] = instanceArray[--l];\r\n\t\t\t}\r\n\t\t}\r\n\t\tinstanceArray.length = l;\r\n\t}\r\n\r\n\t/***************************************************************************\r\n\t * Returns all instances set as \"solid\".\r\n\t * @return {Array}\r\n\t */\r\n\tfunction getAllSolid() {\r\n\t\tlet arr = [];\r\n\t\tlet n = instanceArray.length;\r\n\t\tlet i;\r\n\t\twhile (i = instanceArray[--n]) {\r\n\t\t\tif (i.solid) {\r\n\t\t\t\tarr.push(i);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\r\n\treturn {\r\n\t\tget instanceArray() { return instanceArray; },\r\n\t\tset doDepthSort(x) { doDepthSort = x; },\r\n\t\tcreate: create,\r\n\t\tsetup: setup,\r\n\t\tstepAll: stepAll,\r\n\t\tdrawAll: drawAll,\r\n\t\tdrawGuiAll: drawGuiAll,\r\n\t\texecuteEventAll: executeEventAll,\r\n\t\tchangeSprite: changeSprite,\r\n\t\tcreateMoving: createMoving,\r\n\t\tdestroy: destroy,\r\n\t\tdrawSelf: drawSelf,\r\n\t\tsetDirection: setDirection,\r\n\t\tsetRotation: setRotation\r\n\t}\r\n\r\n})();\r\n\r\nexport default instance;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/instance.js","/**\r\n * @module math\r\n */\r\n\r\nlet math = {\r\n \r\n\t// constances\r\n\tPI: Math.PI,\r\n\tRADTODEG: 180 / Math.PI,\r\n\tDEGTORAD: Math.PI / 180,\r\n\t\t\r\n\t// copied functions\r\n\tcos: Math.cos,\r\n\tsin: Math.sin,\r\n\tsign: Math.sign,\r\n\t\t\r\n\t/**\r\n\t *\r\n\t */\r\n\trandomInt: function( min, max ) {\r\n\t\tmin = Math.ceil( min );\r\n\t\tmax = Math.floor( max );\r\n\t\treturn Math.floor( Math.random() * ( max - min + 1 ) ) + min;\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tchoose: function( ...value ) {\r\n\t\treturn value[Math.floor( Math.random() * value.length )];\r\n\t},\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tlengthDir: (l, d) => {\r\n\t\td *= math.DEGTORAD;\r\n\t\treturn [Math.cos(d) * l, Math.sin(d) * l];\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tlengthDirX: function(l, d) {\r\n\t\treturn Math.cos(d * math.DEGTORAD) * l;\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tlengthDirY: function(l, d) {\r\n\t\treturn Math.sin(d * math.DEGTORAD) * l;\r\n\t},\r\n\t \r\n\t/**\r\n\t * @param {number} x1\r\n\t * @param {number} y1\r\n\t * @param {number} x2\r\n\t * @param {number} y2\r\n\t */\r\n\tpointDistance: function(x1, y1, x2, y2) {\r\n\t\tconst a = x1 - x2;\r\n\t\tconst b = y1 - y2;\r\n\t\treturn Math.sqrt(a*a + b*b);\r\n\t},\r\n\r\n\t/**\r\n\t * @param {number} x1\r\n\t * @param {number} y1\r\n\t * @param {number} x2\r\n\t * @param {number} y2\r\n\t */\r\n\tpointDirection: function( x1, y1, x2, y2 ) {\r\n\t\treturn ( ( Math.atan2( y2 - y1, x2 - x1 ) * math.RADTODEG ) + 360 ) % 360;\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tangleDifference: function( angle1, angle2 ) {\r\n\t\t\r\n\t\tlet diff = ( angle2 - angle1 ) % 360;\r\n\t\t\r\n\t\tif ( diff <= -180 ) {\r\n\t\t\tdiff += 360;\r\n\t\t} else if ( diff > 180 ) {\r\n\t\t\tdiff -= 360;\r\n\t\t}\r\n\t\t\r\n\t\treturn diff;\r\n\t\t\r\n\t}\r\n\t\r\n}\r\n\r\n//\r\nexport default math;\n\n\n// WEBPACK FOOTER //\n// ./core/js/math.js","import Generator from \"./generator.js\";\r\nimport Transition from \"./transition.js\";\r\nimport instance from \"./instance.js\";\r\nimport Sprite from \"./sprite.js\";\r\nimport draw from \"./draw.js\";\r\n\r\n/**\r\n * @author Jack Oatley\r\n */\r\nclass Room {\r\n\r\n\t/**\r\n\t * @param {string} name\r\n\t * @param {number} width\r\n\t * @param {number} height\r\n\t */\r\n\tconstructor(name, width, height) {\r\n\t\tthis.name = name;\r\n\t\tthis.width = Number(width);\r\n\t\tthis.height = Number(height);\r\n\t\tthis.background = null;\r\n\t\tthis.backgroundMethod = \"no-repeat\";\r\n\t\tthis.backgroundColor = \"#FF0000\";\r\n\t\tthis.instances = [];\r\n\t\tRoom.names.push(name);\r\n\t\tRoom.array.push(this);\r\n\t\tif (Room.current === null)\r\n\t\t\tRoom.current = this;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} spr\r\n\t */\r\n\tsetBackground(spr) {\r\n\t\tthis.background = spr;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} inst Name of the instance to add.\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t */\r\n\taddInstance(inst, x, y) {\r\n\t\tif (typeof inst === \"object\") inst = inst.objectName;\r\n\t\tthis.instances.push({\r\n\t\t\tname: inst, x: x, y: y\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * @param {object} [opts={}]\r\n\t */\r\n\tenter(opts = {}) {\r\n\r\n\t\tif (opts.transition) {\r\n\t\t\tnew Transition({\r\n\t\t\t\tprefab: opts.transition,\r\n\t\t\t\tcallback: Room.enter.bind(null, this)\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// leave room event\r\n\t\tinstance.executeEventAll(\"roomleave\");\r\n\r\n\t\t// clear current instances\r\n\t\tinstance.instanceArray.forEach(function(i) {\r\n\t\t\tinstance.destroy(i, false);\r\n\t\t});\r\n\r\n\t\t// goto new room and create new instances\r\n\t\tRoom.current = this;\r\n\t\tthis.instances.forEach(function(inst) {\r\n\t\t\tinstance.create(inst.name, inst.x, inst.y);\r\n\t\t});\r\n\r\n\t\t// enter room event\r\n\t\tinstance.executeEventAll(\"roomenter\");\r\n\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tdraw() {\r\n\t\tvar canvas = draw.target.domElement;\r\n\t\tvar ctx = draw.context;\r\n\t\tdraw.clear(this.backgroundColor);\r\n\t\tlet spr = Sprite.get(this.background);\r\n\t\tif (spr !== null) {\r\n\t\t\tlet image = spr.images[0].img;\r\n\t\t\tif (this.backgroundMethod === \"stretch\") {\r\n\t\t\t\tctx.drawImage(image, 0, 0, canvas.width, canvas.height);\r\n\t\t\t} else {\r\n\t\t\t\tlet ptrn = ctx.createPattern(image, this.backgroundMethod);\r\n\t\t\t\tctx.fillStyle = ptrn;\r\n\t\t\t\tctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/** */\r\n\tstatic next() {\r\n\t\tconst index = Room.array.indexOf(Room.current);\r\n\t\tRoom.enter(Room.array[index+1]);\r\n\t}\r\n\r\n\t/** */\r\n\tstatic previous() {\r\n\t\tconst index = Room.array.indexOf(Room.current);\r\n\t\tRoom.enter(Room.array[index-1]);\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tstatic get(name) {\r\n\t\tif (typeof name === \"object\") return name;\r\n\t\tfor (var n=0; n<Room.array.length; n++) {\r\n\t\t\tif ( Room.array[n][\"name\"] === name ) {\r\n\t\t\t\treturn Room.array[n];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n}\r\n\r\nRoom.prototype.assetType = \"room\";\r\nRoom.names = [];\r\nRoom.array = [];\r\nRoom.current = null;\r\nGenerator.classStaticMatch(Room);\r\n\r\nexport default Room;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/room.js","import Pool from \"../utils/pool.js\";\r\nimport Generator from \"../generator.js\";\r\n\r\n/**\r\n * @author Jack Oatley\r\n */\r\nexport default class Grid {\r\n\r\n\t/**\r\n\t * @param {number} Initial width of the grid.\r\n\t * @param {number} Initial height of the grid\r\n\t * @param {object} [opts={}] Options object.\r\n\t * @param {*} [opts.value=0] Initial value for each cell of the grid.\r\n\t */\r\n\tconstructor(width, height, opts = {}) {\r\n\t\tlet myGrid = Grid.pool.get(this);\r\n\t\tmyGrid.size = width * height;\r\n\t\tmyGrid.data = (myGrid === this) ? [] : myGrid.data;\r\n\t\tmyGrid.data.length = myGrid.size;\r\n\t\tmyGrid.width = width;\r\n\t\tmyGrid.height = height;\r\n\t\tmyGrid.clear(opts.value || 0);\r\n\t\treturn myGrid;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tget(x, y) {\r\n\t\treturn this.data[x + y * this.width];\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tset(x, y, value) {\r\n\t\tthis.data[x + y * this.width] = value;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tadd(x, y, value) {\r\n\t\tthis.data[x + y * this.width] += value;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tmultiply(x, y, value) {\r\n\t\tthis.data[x + y * this.width] *= value;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Clears all cells in the grid to the given value.\r\n\t * @param {*} value Value to clear the grid to.\r\n\t */\r\n\tclear(value) {\r\n\t\tthis.data.fill(value);\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tdestroy() {\r\n\t\tGrid.pool.release(this);\r\n\t}\r\n\r\n}\r\n\r\n//\r\nGrid.pool = new Pool(Grid);\r\nGenerator.classStaticMatch(Grid);\n\n\n// WEBPACK FOOTER //\n// ./core/js/data/grid.js","import draw from \"./draw\";\r\nimport noop from \"./utils/noop\";\r\n\r\n/**\r\n *\r\n */\r\nclass Transition {\r\n\r\n\t/**\r\n\t* @param {object} opts Options.\r\n\t* @param {string} opts.type\r\n\t* @param {string} opts.time Time in steps the tranistion will last per stage (in/out).\r\n\t* @param {string} opts.color Color of the transition.\r\n\t* @param {string} opts.callback Function to execute mid-transition.\r\n\t*/\r\n\tconstructor(opts = {}) {\r\n\t\tthis.type = opts.type || \"fade\";\r\n\t\tthis.time = opts.time || 60;\r\n\t\tthis.color = opts.color || \"#000000\";\r\n\t\tthis.callback = opts.callback || noop;\r\n\t\tif (opts.prefab) Object.assign(this, opts.prefab);\r\n\t\tthis.direction = 1;\r\n\t\tthis.alpha = 0;\r\n\t\tthis.delta = 1/this.time;\r\n\t\tTransition.allInstances.push(this);\r\n\r\n\t\t// Check transition type exists and log warning otherwise\r\n\t\tif (!Transition.prefabs.hasOwnProperty(this.type)) {\r\n\t\t\twindow.addConsoleText(\"#F00\", \"Unknown transition type: \" + this.type);\r\n\t\t\tthis.type = \"fade\";\r\n\t\t}\r\n\t}\r\n\r\n\t/** */\r\n\tupdate() {\r\n\t\tif (Transition.prefabs.hasOwnProperty(this.type))\r\n\t\t\tTransition.prefabs[this.type].update.call(this);\r\n\t}\r\n\r\n\t/** */\r\n\tdraw() {\r\n\t\tif (Transition.prefabs.hasOwnProperty(this.type))\r\n\t\t\tTransition.prefabs[this.type].draw.call(this);\r\n\t}\r\n\r\n\t/** */\r\n\tdestroy() {\r\n\t\tlet x = Transition.allInstances.indexOf(this);\r\n\t\tTransition.allInstances.splice(x, 1);\r\n\t}\r\n\r\n\t/** */\r\n\tstatic create(opts) {\r\n\t\treturn new Transition(opts);\r\n\t}\r\n\r\n\t/** */\r\n\tstatic updateAll() {\r\n\t\tTransition.allInstances.forEach((t) => {\r\n\t\t\tt.update();\r\n\t\t});\r\n\t}\r\n\r\n\t/** */\r\n\tstatic drawAll() {\r\n\t\tTransition.allInstances.forEach((t) => {\r\n\t\t\tt.draw();\r\n\t\t});\r\n\t}\r\n\r\n}\r\n\r\n//\r\nTransition.allInstances = [];\r\n\r\n/**\r\n * @namespace\r\n */\r\nTransition.prefabs = {\r\n\r\n\t\"fade\": {\r\n\t\tupdate: function() {\r\n\t\t\tthis.alpha += this.direction ? this.delta : -this.delta;\r\n\t\t\tif (this.alpha >= 1) {\r\n\t\t\t\tthis.callback();\r\n\t\t\t\tthis.direction = 0;\r\n\t\t\t} else if (this.alpha <= 0) {\r\n\t\t\t\tthis.destroy();\r\n\t\t\t}\r\n\t\t},\r\n\t\tdraw: function() {\r\n\t\t\tvar ctx = draw.context;\r\n\t\t\tctx.globalAlpha = this.alpha;\r\n\t\t\tctx.fillStyle = this.color;\r\n\t\t\tctx.fillRect(0, 0, 9999999, 9999999);\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\nexport default Transition;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/transition.js","import Canvas from \"./canvas\";\r\nimport keyValues from \"./keyvalues\";\r\n\r\n// Mouse object\r\nlet __mouse = {\r\n\tpressed: [false, false, false],\r\n\tdown: [false, false, false],\r\n\treleased: [false, false, false],\r\n\twheelUp: false,\r\n\twheelDown: false,\r\n\trawX: 0,\r\n\trawY: 0,\r\n\tx: 0,\r\n\ty: 0\r\n}\r\n\r\n// Keyboard object\r\nlet __keyboard = {\r\n\tpressed: {},\r\n\tdown: {},\r\n\treleased: {}\r\n}\r\n\r\n// Touch object\r\nlet __touch = {\r\n\tstart: [],\r\n\theld: [],\r\n\tmove: [],\r\n\tend: [],\r\n\tcancel: [],\r\n\tx: [],\r\n\ty: []\r\n}\r\n\r\n/**\r\n * @author Jack Oatley\r\n */\r\nclass Input {\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tstatic init() {\r\n\t\tInput.initMouse();\r\n\t\tInput.initKeyboard();\r\n\t\tInput.initTouch();\r\n\t\tInput.element.addEventListener(\"contextmenu\", function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tstatic initMouse() {\r\n\r\n\t\tconst handleMouseDown = (e) => {\r\n\t\t\te.preventDefault();\r\n\t\t\tif (!__mouse.pressed[e.button]) window.focus();\r\n\t\t\t__mouse.pressed[e.button] = true;\r\n\t\t\t__mouse.down[e.button] = true;\r\n\t\t}\r\n\r\n\t\tconst handleMouseUp = (e) => {\r\n\t\t\te.preventDefault();\r\n\t\t\t__mouse.pressed[e.button] = false;\r\n\t\t\t__mouse.released[e.button] = true;\r\n\t\t\t__mouse.down[e.button] = false;\r\n\t\t}\r\n\r\n\t\tconst handleMouseMove = (e) => {\r\n\t\t\tconst canv = Canvas.main.domElement;\r\n\t\t\tconst rect = canv.getBoundingClientRect();\r\n\t\t\tconst hs = canv.width / rect.width;\r\n\t\t\tconst vs = canv.height / rect.height;\r\n\t\t\t__mouse.rawX = e.clientX - rect.left;\r\n\t\t\t__mouse.rawY = e.clientY - rect.top;\r\n\t\t\t__mouse.x = ~~__mouse.rawX * hs;\r\n\t\t\t__mouse.y = ~~__mouse.rawY * vs;\r\n\t\t}\r\n\r\n\t\tconst handleMouseWheel = (e) => {\r\n\t\t\te.preventDefault();\r\n\t\t\tconst delta = Math.max(-1, Math.min(1, e.wheelDelta));\r\n\t\t\t__mouse.wheelUp = delta > 0;\r\n\t\t\t__mouse.wheelDown = delta < 0;\r\n\t\t}\r\n\r\n\t\tInput.element.addEventListener(\"mousedown\", handleMouseDown);\r\n\t\tInput.element.addEventListener(\"mouseup\", handleMouseUp);\r\n\t\tInput.element.addEventListener(\"mousemove\", handleMouseMove);\r\n\t\tInput.element.addEventListener(\"mousewheel\", handleMouseWheel);\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tstatic initKeyboard() {\r\n\r\n\t\t//\r\n\t\tkeyValues.forEach((key) => {\r\n\t\t\t__keyboard.pressed[key] = false;\r\n\t\t\t__keyboard.down[key] = false;\r\n\t\t\t__keyboard.released[key] = false;\r\n\t\t});\r\n\r\n\t\t//\r\n\t\tlet handleKeyDown = (e) => {\r\n\t\t\te.preventDefault();\r\n\t\t\tconst code = e.code || e.key;\r\n\t\t\tif (!__keyboard.down[code]) {\r\n\t\t\t\t__keyboard.pressed[code] = true;\r\n\t\t\t\t__keyboard.down[code] = true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tlet handleKeyUp = (e) => {\r\n\t\t\te.preventDefault();\r\n\t\t\tconst code = e.code || e.key;\r\n\t\t\t__keyboard.released[code] = true;\r\n\t\t\t__keyboard.down[code] = false;\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tInput.element.addEventListener(\"keydown\", handleKeyDown);\r\n\t\tInput.element.addEventListener(\"keyup\", handleKeyUp);\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tstatic initTouch() {\r\n\r\n\t\t//\r\n\t\tlet handleTouchStart = (e) => {\r\n\t\t\te.preventDefault();\r\n\t\t\t(!__touch.start[0]) && window.focus();\r\n\t\t\t__touch.start[0] = true;\r\n\t\t\t__touch.held[0] = true;\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tlet handleTouchEnd = (e) => {\r\n\t\t\te.preventDefault();\r\n\t\t\t__touch.start[0] = false;\r\n\t\t\t__touch.end[0] = true;\r\n\t\t\t__touch.held[0] = false;\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tlet handleTouchMove = (e) => {\r\n\t\t\te.preventDefault();\r\n\t\t\tlet touches = e.changedTouches;\r\n\t\t\t__touch.x[0] = touches[0].pageX;\r\n\t\t\t__touch.y[0] = touches[0].pageY;\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tInput.element.addEventListener(\"touchstart\", handleTouchStart);\r\n\t\tInput.element.addEventListener(\"touchend\", handleTouchEnd);\r\n\t\tInput.element.addEventListener(\"touchcancel\", handleTouchEnd);\r\n\t\tInput.element.addEventListener(\"touchmove\", handleTouchMove);\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tstatic getTriggerEvents() {\r\n\t\tlet triggers = Input.triggerEvents;\r\n\t\ttriggers.length = 0;\r\n\t\tObject.keys(__keyboard.down).forEach((key) => {\r\n\t\t\tif (keyValues.includes(key)) {\r\n\t\t\t\tif (__keyboard.down[key]) triggers.push(key);\r\n\t\t\t\tif (__keyboard.pressed[key]) triggers.push(key + \"Pressed\");\r\n\t\t\t\tif (__keyboard.released[key]) triggers.push(key + \"Released\");\r\n\t\t\t} else {\r\n\t\t\t\tconsole.warn( \"input key not supported: \", key );\r\n\t\t\t\tdelete __keyboard.down[key];\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// mouse events\r\n\t\tlet mouseMap = [\"Left\", \"Middle\", \"Right\"];\r\n\t\tfor(var n=0; n<3; n++) {\r\n\t\t\tif (__mouse.down[n]) triggers.push(mouseMap[n] + \"Down\");\r\n\t\t\tif (__mouse.pressed[n]) triggers.push(mouseMap[n] + \"Pressed\");\r\n\t\t\tif (__mouse.released[n]) triggers.push(mouseMap[n] + \"Released\");\r\n\t\t}\r\n\r\n\t\tif (__mouse.wheelUp) triggers.push(\"WheelUp\");\r\n\t\tif (__mouse.wheelDown) triggers.push(\"WheelDown\");\r\n\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tstatic update() {\r\n\r\n\t\tObject.keys(__keyboard.down).forEach((key) => {\r\n\t\t\t__keyboard.pressed[key] = false;\r\n\t\t\t__keyboard.released[key] = false;\r\n\t\t});\r\n\r\n\t\tObject.keys(__mouse.down).forEach((button) => {\r\n\t\t\t__mouse.pressed[button] = false;\r\n\t\t\t__mouse.released[button] = false;\r\n\t\t});\r\n\r\n\t\tObject.keys(__touch.held).forEach((button) => {\r\n\t\t\t__touch.start[button] = false;\r\n\t\t\t__touch.end[button] = false;\r\n\t\t\t__touch.held[button] = false;\r\n\t\t});\r\n\r\n\t\t__mouse.wheelUp = false;\r\n\t\t__mouse.wheelDown = false;\r\n\r\n\t}\r\n\r\n}\r\n\r\nInput.element = document;\r\nInput.triggerEvents = [];\r\nInput.mouse = __mouse;\r\nInput.keyboard = __keyboard;\r\nInput.touch = __touch;\r\n\r\nexport default Input;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/input.js","import event from \"./event\";\r\nimport instance from \"./instance\";\r\nimport objectVars from \"./objectVars\";\r\nimport Pool from \"./utils/pool\";\r\nimport Generator from \"./generator\"\r\n\r\n/**\r\n *\r\n */\r\nclass GameObject {\r\n\r\n\t/**\r\n\t * @param {string} name\r\n\t * @param {number} sprite\r\n\t */\r\n\tconstructor(name, sprite) {\r\n\t\tlet obj = function(x, y) {\r\n\t\t\tlet inst = obj.pool.get(this);\r\n\t\t\tinstance.setup(inst, obj, x, y);\r\n\t\t\tobj.instances.push(inst);\r\n\t\t\treturn inst;\r\n\t\t};\r\n\t\tObject.assign(obj, GameObject.prototype);\r\n\t\tobjectVars.set(obj.prototype);\r\n\t\tobj.objectName = name || \"object_\" + obj.id;\r\n\t\tobj.prototype.sprite = sprite || null;\r\n\t\tobj.pool = new Pool(obj);\r\n\t\tobj.instances = [];\r\n\t\tGameObject.names.push(obj.objectName);\r\n\t\tGameObject.array.push(obj);\r\n\t\treturn obj;\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tset(property, value) {\r\n\t\tthis.prototype[property] = value;\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\texecuteScript() {\r\n\t\tconst closure = function() {\r\n\t\t\teval(this.objectScript);\r\n\t\t}.call(this);\r\n\t}\r\n\r\n\t/**\r\n\t * Add an action with variable parameters to an event of an object.\r\n\t * @param {*} object Can be an object constructor or integer ID.\r\n\t * @param {*} event\r\n\t * @param {*} action\r\n\t * @param {...*} args\r\n\t * @return {void}\r\n\t */\r\n\teventAddAction(event, action, ...args) {\r\n\r\n\t\t//console.log(event, action);\r\n\r\n\t\tif (typeof event === \"object\") {\r\n\t\t\tObject.keys(event).forEach((key) => {\r\n\t\t\t\tevent[key].forEach((params) => {\r\n\t\t\t\t\tGameObject.eventAddAction(this, key, ...params);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (action !== undefined) {\r\n\r\n\t\t\t// if flow action, get flow tag\r\n\t\t\tlet flow = \"\";\r\n\t\t\tif (typeof action === \"string\")\r\n\t\t\t\tflow = action;\r\n\r\n\t\t\t// create a new event if not yet defined\r\n\t\t\tif (!this.prototype.events[event]) {\r\n\t\t\t\tthis.prototype.events[event] = [];\r\n\t\t\t\tif (event.includes(\"collision_\")) {\r\n\t\t\t\t\tlet index = event.indexOf(\"_\") + 1;\r\n\t\t\t\t\tlet name = event.slice(index, 200);\r\n\t\t\t\t\tGameObject.addCollisionListener(this, name);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// add action data to event\r\n\t\t\tthis.prototype.events[event].push({\r\n\t\t\t\tflow: flow,\r\n\t\t\t\taction: action,\r\n\t\t\t\targs: args\r\n\t\t\t});\r\n\r\n\t\t} else {\r\n\t\t\tconsole.warn(\"tried to add an undefined action to an event!\");\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\taddCollisionListener(target) {\r\n\t\tthis.prototype.listeners.push({\r\n\t\t\ttype: \"collision\",\r\n\t\t\ttarget: target\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tgetAllInstances() {\r\n\t\tlet arr = [];\r\n\t\tinstance.instanceArray.forEach(inst => {\r\n\t\t\tlet name = inst.constructor.objectName;\r\n\t\t\tif (name === this.objectName)\r\n\t\t\t\tarr.push(inst);\r\n\t\t});\r\n\t\treturn arr;\r\n\t}\r\n\r\n\t/***************************************************************************\r\n\t * @param {*} obj\r\n\t * @return {Object} THe found object, or null if not found.\r\n\t */\r\n\tstatic get(obj) {\r\n\r\n\t\t// If obj is already an object/constructor.\r\n\t\tif (typeof obj === \"object\" || typeof obj === \"function\")\r\n\t\t\treturn obj;\r\n\r\n\t\t// Iterate all objects to find the one we want.\r\n\t\tvar n = GameObject.array.length;\r\n\t\twhile (n--) {\r\n\t\t\tif (GameObject.array[n].objectName === obj) {\r\n\t\t\t\treturn GameObject.array[n];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Failed to find an object.\r\n\t\treturn null;\r\n\r\n\t}\r\n\r\n}\r\n\r\nGenerator.classStaticMatch(GameObject);\r\nGameObject.prototype.assetType = \"object\";\r\nGameObject.names = [];\r\nGameObject.array = [];\r\n\r\nexport default GameObject;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/object.js","import Generator from \"./generator\";\r\nimport Grid from \"./data/grid\";\r\n\r\n/**\r\n * @author Jack Oatley\r\n */\r\nclass Font {\r\n\r\n\t/**\r\n\t * @param {object} [opts={}] Options.\r\n\t * @param {string} [opts.name=\"_UNNAMEDFONT\"] Name of the font.\r\n\t * @param {string} [opts.src=\"\"] Source of the font.\r\n\t * @param {image} [opts.bitmap=null] An existing bitmap.\r\n\t * @param {string} [opts.method=\"normal\"] Initial drawing method.\r\n\t * @param {boolean} [opts.apply] Apply the font in CSS,\r\n\t */\r\n\tconstructor(opts = {}) {\r\n\t\tthis.name = opts.name || \"_UNNAMEDFONT\";\r\n\t\tthis.source = opts.src || \"\";\r\n\t\tthis.hasFontFace = false;\r\n\t\tthis.bitmapFont = opts.bitmap || null;\r\n\t\tthis.hasBitmapFont = this.bitmap !== null;\r\n\t\tthis.method = opts.method || \"normal\";\r\n\t\tif (opts.apply) this.applyCss();\r\n\t\tFont.names.push(this.name);\r\n\t\tFont.array.push(this);\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the CSS code that's needed to be applied to the page to use this font in the DOM or on the canvas.\r\n\t */\r\n\tgetCss() {\r\n\t\treturn \"@font-face {\\\r\n\t\t\tfont-family: \" + this.name + \";\\\r\n\t\t\tsrc: url('\" + this.source + \"') format('truetype');\\\r\n\t\t}\";\r\n\t}\r\n\r\n\t/**\r\n\t * Applies the CSS code.\r\n\t */\r\n\tapplyCss() {\r\n\t\tlet style = document.createElement(\"STYLE\");\r\n\t\tstyle.textContent = this.getCss()\r\n\t\tdocument.head.appendChild(style);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {object} [opts={}] Options object.\r\n\t * @param {number} [opts.size=8] Size of the font.\r\n\t * @param {string} [opts.map] A string of all the characters to include in the bitmap font.\r\n\t * @param {int} [opts.alphaThreshold=150] Threshold that dertmines which pixels shall be visible.\r\n\t * @param {array} [opts.color=[0,0,0,255]] An array containing the RGBA channels respectively.\r\n\t */\r\n\tconvertToBitmapFont(opts = {}) {\r\n\r\n\t\tconst scale = 3;\r\n\t\tconst size = (opts.size || 8) * scale;\r\n\t\tconst map = opts.map || \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\r\n\t\tconst cx = size * 0.5;\r\n\t\tconst cy = cx;\r\n\t\tconst alphaThreshold = opts.alphaThreshold || 150;\r\n\t\tconst color = opts.color || [0, 0, 0, 255];\r\n\r\n\t\tconst atlas = document.createElement(\"CANVAS\");\r\n\t\tatlas.width = (size /scale) * map.length;\r\n\t\tatlas.height = (size / scale);\r\n\t\tconst atlasCtx = atlas.getContext(\"2d\");\r\n\t\tconst pointImageData = atlasCtx.createImageData(1, 1);\r\n\t\tpointImageData.data.set(color, 0);\r\n\r\n\t\tconst canvas = document.createElement(\"CANVAS\");\r\n\t\tcanvas.width = canvas.height = size;\r\n\r\n\t\tlet ctx = canvas.getContext(\"2d\");\r\n\t\tctx.font = size + \"px \" + this.name;\r\n\t\tconsole.log(ctx.font);\r\n\t\tctx.textAlign = \"center\";\r\n\t\tctx.textBaseline = \"middle\";\r\n\r\n\t\tlet charMap = new Grid(size/scale, size/scale);\r\n\t\tlet lookupTable = {};\r\n\t\tfor (var n=0; n<map.length; n++) {\r\n\r\n\t\t\tctx.clearRect(0, 0, size, size);\r\n\t\t\tcharMap.clear(-1);\r\n\r\n\t\t\tlet c = map[n];\r\n\t\t\tctx.fillStyle = \"#000000\";\r\n\t\t\tctx.fillText(c, cx, cy);\r\n\r\n\t\t\tlet imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\r\n\t\t\tlet data = imageData.data;\r\n\t\t\tvar p, r, g, b, a;\r\n\t\t\tfor (p=0; p<data.length; p+=4) {\r\n\t\t\t\tlet x = ~~(((p/4) % size) / scale);\r\n\t\t\t\tlet y = ~~((~~((p/4) / size)) / scale);\r\n\t\t\t\tlet i = x+(size/scale)*y;\r\n\t\t\t\tif (charMap.get(x, y) === -1) charMap.set(x, y, data[p+3]);\r\n\t\t\t}\r\n\r\n\t\t\t// Get metrics\r\n\t\t\tlet metrics = { left: 100, top: 100, right: 0, bottom: 0 };\r\n\t\t\tlet minY = 100;\r\n\t\t\tlet maxY = 0;\r\n\t\t\tlet x, y;\r\n\t\t\tfor (y=0; y<size/scale; y++)\r\n\t\t\tfor (x=0; x<size/scale; x++) {\r\n\t\t\t\tif (charMap.get(x, y) > alphaThreshold) {\r\n\t\t\t\t\tmetrics.left = Math.min(metrics.left, x);\r\n\t\t\t\t\tmetrics.top = Math.min(metrics.top, y);\r\n\t\t\t\t\tmetrics.right = Math.max(metrics.right, x+1);\r\n\t\t\t\t\tmetrics.bottom = Math.max(metrics.bottom, y+1);\r\n\t\t\t\t\tminY = Math.min(minY, metrics.top);\r\n\t\t\t\t\tmaxY = Math.max(maxY, metrics.bottom);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Print to atlas\r\n\t\t\tfor (y=0; y<size/scale; y++)\r\n\t\t\tfor (x=0; x<size/scale; x++) {\r\n\t\t\t\tif (charMap.get(x, y) > alphaThreshold) {\r\n\t\t\t\t\tatlasCtx.putImageData(pointImageData, n*(size/scale)+x, y);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Tweak metrics into atlas coords and add to lookup table\r\n\t\t\tmetrics.left += n*(size/scale);\r\n\t\t\tmetrics.right += n*(size/scale);\r\n\t\t\tmetrics.top = 0;\r\n\t\t\tmetrics.bottom = size/scale;\r\n\t\t\tlookupTable[c] = metrics;\r\n\t\t}\r\n\r\n\t\t// Space is special because it can't actually be measured\r\n\t\tlookupTable[\" \"] = {left: -3, top: 0, right: 0, bottom: size/scale}\r\n\r\n\t\tthis.bitmapFont = {\r\n\t\t\tsize: size/scale,\r\n\t\t\tlookup: lookupTable,\r\n\t\t\timage: atlas\r\n\t\t}\r\n\r\n\t\tthis.method = \"bitmap\";\r\n\t\tconsole.log(this.bitmapFont);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @param {*} value The string name of the font to get.\r\n\t */\r\n\tstatic get(value) {\r\n\r\n\t\tif ([\"object\", \"function\"].includes(typeof value))\r\n\t\tif (typeof value === \"object\" || typeof value === \"function\")\r\n\t\t\treturn value;\r\n\r\n\t\tfor (var n = 0; n < Font.array.length; n++)\r\n\t\t\tif (Font.array[n].name === value)\r\n\t\t\t\treturn Font.array[n];\r\n\r\n\t\treturn null;\r\n\r\n\t}\r\n\r\n}\r\n\r\nGenerator.classStaticMatch(Font);\r\nFont.prototype.assetType = \"font\";\r\nFont.names = [];\r\nFont.array = [];\r\n\r\nexport default Font;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/font.js","\r\nlet global = {\r\n\tfps: 0\r\n}\r\n\r\nexport default global;\n\n\n// WEBPACK FOOTER //\n// ./core/js/global.js","import Generator from \"./generator\";\r\n\r\n/**\r\n * @author Jack Oatley\r\n */\r\nclass Sound {\r\n\r\n\t/**\r\n\t * @param {string} name name for the resource.\r\n\t * @param {string} source A path to an audio source, or a base64 encoded audio.\r\n\t * @return {void}\r\n\t */\r\n\tconstructor(name, source) {\r\n\t\tthis.name = name;\r\n\t\tthis.instances = [new Audio(source)];\r\n\t\tthis.ready = false;\r\n\t\tthis.volume = 1.0;\r\n\t\tSound.names.push(name);\r\n\t\tSound.array.push(this);\r\n\t\tlet test = this.instances[0];\r\n\t\ttest.oncanplaythrough = () => {\r\n\t\t\tthis.ready = true;\r\n\t\t\ttest.oncanplaythrough = null;\r\n\t\t}\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Returns the asset type, this can't/shouldn't be overwitten.\r\n\t * @return {string}\r\n\t */\r\n\tget assetType() {\r\n\t\treturn \"sound\";\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} number\r\n\t * @return {void}\r\n\t */\r\n\tpreload(number) {\r\n\t\tlet n = number - this.instances.length;\r\n\t\twhile (n-- > 0) {\r\n\t\t\tlet newSound = this.instances[0].cloneNode();\r\n\t\t\tthis.instances.push(newSound);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {Object} [opts={}] object.\r\n\t */\r\n\tplay(opts = {}) {\r\n\t\tif (Sound.isEnabled) {\r\n\r\n\t\t\t// Find an existing sound instance to play.\r\n\t\t\tlet playSound;\r\n\t\t\tfor (var i=0, n=this.instances.length; i<n; i++) {\r\n\t\t\t\tlet instance = this.instances[i];\r\n\t\t\t\tif (instance.paused) {\r\n\t\t\t\t\tplaySound = instance;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Create new instance of sound.\r\n\t\t\tif (!playSound) {\r\n\t\t\t\tplaySound = this.instances[0].cloneNode();\r\n\t\t\t\tthis.instances.push(playSound);\r\n\t\t\t\t//console.log(\"Created sound, \" + this.name + \", on demand.\");\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\t\t\tplaySound.onError = (err) => {\r\n\t\t\t\tconsole.error(soundName, err);\r\n\t\t\t}\r\n\r\n\t\t\t// Play the sound.\r\n\t\t\tplaySound.volume = this.volume;\r\n\t\t\tlet promise = playSound.play();\r\n\t\t\tif ( promise !== undefined ) {\r\n\t\t\t\tpromise.then( function() {\r\n\r\n\t\t\t\t\t// on end event\r\n\t\t\t\t\tplaySound.onended = function() {\r\n\r\n\t\t\t\t\t\t// internal event stuff\r\n\t\t\t\t\t\t((Number(opts.loop || false))\r\n\t\t\t\t\t\t\t? _loop : _end).call(this);\r\n\r\n\t\t\t\t\t\t// and custom event, if defined\r\n\t\t\t\t\t\tif (opts.onEnd) opts.onEnd();\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}).catch((err) => {\r\n\t\t\t\t\tconsole.warn(err);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\t\t\treturn playSound;\r\n\t\t}\r\n\r\n\t\t// sound is disabled\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * Stop all instances of the sound from playing.\r\n\t */\r\n\tstop() {\r\n\t\tfor (var i=0, n=this.instances.length; i<n; i++) {\r\n\t\t\tlet instance = this.instances[i];\r\n\t\t\tif (!instance.paused) {\r\n\t\t\t\t_end.call(instance);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @return {boolean}\r\n\t */\r\n\tstatic readyAll() {\r\n\t\tfor (var i=0, n=Sound.array.length; i<n; i++) {\r\n\t\t\tif (!Sound.array[i].ready) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {boolean} x\r\n\t * @return {void}\r\n\t */\r\n\tstatic enable(x) {\r\n\t\tSound.isEnabled = x;\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tstatic get(name) {\r\n\t\tif (typeof name === \"object\") return name;\r\n\t\tfor (var i=0, n=Sound.array.length; i<n; i++) {\r\n\t\t\tif (Sound.array[i].name === name) {\r\n\t\t\t\treturn Sound.array[i];\r\n\t\t\t}\r\n\t\t}\r\n\t\twindow.addConsoleText(\"#F00\", \"Unknown sound: \"+ name);\r\n\t\treturn null;\r\n\t}\r\n\r\n}\r\n\r\nGenerator.classStaticMatch(Sound);\r\nSound.isEnabled = true;\r\nSound.names = [];\r\nSound.array = [];\r\n\r\n//\r\nfunction _loop() {\r\n\tthis.currentTime = 0;\r\n\tthis.play();\r\n}\r\n\r\n//\r\nfunction _end() {\r\n\tthis.pause();\r\n\tthis.currentTime = 0;\r\n}\r\n\r\n// Export.\r\nexport default Sound;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/Sound.js","import room from \"./room.js\";\r\nimport draw from \"./draw.js\";\r\nimport Generator from \"./generator.js\";\r\n\r\n/**\r\n * @author Jack Oatley\r\n */\r\nclass Camera {\r\n\r\n\t/**\r\n\t * Create a new Camera instance.\r\n\t * @param {object} [opts={}]\r\n\t * @param {number} [x]\r\n\t * @param {number} [y]\r\n\t * @param {number} [angle]\r\n\t * @param {number} [width]\r\n\t * @param {number} [height]\r\n\t * @param {number} [follow]\r\n\t * @param {number} [gridLocked]\r\n\t */\r\n\tconstructor(opts = {}) {\r\n\t\tthis.x = 0,\r\n\t\tthis.y = 0,\r\n\t\tthis.angle = 0,\r\n\t\tthis.width = room.current.width,\r\n\t\tthis.height = room.current.height,\r\n\t\tthis.follow = null,\r\n\t\tthis.gridLocked = false,\r\n\t\tthis.left = 0,\r\n\t\tthis.right = 0,\r\n\t\tthis.top = 0,\r\n\t\tthis.bottom = 0\r\n\t\tObject.assign(this, opts);\r\n\t\tCamera.array.push(this);\r\n\t}\r\n\r\n\t/**\r\n\t * Update the Camera.\r\n\t */\r\n\tupdate() {\r\n\t\tif (this.follow) {\r\n\r\n\t\t\t// if single instance, put into array\r\n\t\t\tif (!Array.isArray(this.follow))\r\n\t\t\t\tthis.follow = [this.follow];\r\n\r\n\t\t\t//\r\n\t\t\tlet x = 0, y = 0, count = 0, weight = 1;\r\n\t\t\tthis.follow.forEach((inst) => {\r\n\r\n\t\t\t\tif (Array.isArray(inst)) {\r\n\t\t\t\t\tweight = inst[1] || 1;\r\n\t\t\t\t\tinst = inst[0];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tweight = 1;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tx += inst.x * weight;\r\n\t\t\t\ty += inst.y * weight;\r\n\t\t\t\tcount += weight;\r\n\r\n\t\t\t});\r\n\r\n\t\t\tthis.x = x / count;\r\n\t\t\tthis.y = y / count;\r\n\t\t}\r\n\r\n\t\t// update bounds\r\n\t\tthis.left = this.x - this.width * 0.5;\r\n\t\tthis.right = this.x + this.width * 0.5;\r\n\t\tthis.top = this.y - this.height * 0.5;\r\n\t\tthis.bottom = this.y + this.height * 0.5;\r\n\r\n\t\t// apply camera\r\n\t\tdraw.transform.translate(-this.left, -this.top);\r\n\t}\r\n\r\n}\r\n\r\nCamera.array = [];\r\n\r\nCamera.create = Generator.functionFromConstructor(Camera);\r\nCamera.updateAll = Generator.arrayExecute(Camera.array, Camera.prototype.update);\r\n\r\nexport default Camera;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/camera.js","import canvas from \"./canvas.js\";\r\n \r\n/**\r\n *\r\n */\r\nexport default class App {\r\n\t\r\n\t/**\r\n\t * Sets the cursor to use when the mouse is in the game window.\r\n\t * @param {string} cursor Same as the CSS cursor property.\r\n\t * See {@link https://developer.mozilla.org/en-US/docs/Web/CSS/cursor}\r\n\t */\r\n\tstatic setCursor(cursor) {\r\n\t\tcanvas.main.style.cursor = cursor;\r\n\t}\r\n\t\r\n}\n\n\n// WEBPACK FOOTER //\n// ./core/js/App.js","\r\nlet color = {\r\n\r\n\t/**\r\n\t * @param {string} hex A hex string.\r\n\t */\r\n\thexToRgb: function(hex) {\r\n\t\tvar result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n\t\treturn result ? {\r\n\t\t\tr: parseInt(result[1], 16),\r\n\t\t\tg: parseInt(result[2], 16),\r\n\t\t\tb: parseInt(result[3], 16)\r\n\t\t} : null;\r\n\t},\r\n\t\r\n\t/**\r\n\t * @param {number} c The component.\r\n\t */\r\n\tcomponentToHex: function(c) {\r\n\t\tvar hex = c.toString(16);\r\n\t\treturn hex.length == 1 ? \"0\" + hex : hex;\r\n\t},\r\n\r\n\t/**\r\n\t * @param {number} r The red component.\r\n\t * @param {number} g The green component.\r\n\t * @param {number} b The blue component.\r\n\t */\r\n\trgbToHex: function(r, g, b) {\r\n\t\tlet c = color.componentToHex;\r\n\t\treturn \"#\" + c(r) + c(g) + c(b);\r\n\t}\r\n\t\r\n}\r\n\r\n//\r\nexport default color;\n\n\n// WEBPACK FOOTER //\n// ./core/js/color.js","/**\r\n * @module Pool\r\n */\r\n\r\n/**\r\n * The Pool object contains an array (the pool) called stack to which we can give objects. The Pool also maintains it's own length property, as the true length of the stack array does not change, so as to avoid garbage collection.\r\n * @param {Object} newConstructor The constructor function for this pool. During get, if no items are in the pool and no default value is provided, a new object is created from this constructor and returned.\r\n */\r\nexport default function Pool(newConstructor) {\r\n\tthis.stack = [];\r\n\tthis.length = 0;\r\n\tthis.newConstructor = newConstructor;\r\n}\r\n\r\n/**\r\n * @param {Object} [def] The default object (or even value) to return if no items are found in the pool. If this is not defined, and no items are found in the pool, then a new object is created as per the Pool's newConstructor property.\r\n */\r\nPool.prototype.get = function(def) {\r\n\tif (this.length) {\r\n\t\tdef = this.stack[--this.length];\r\n\t\tthis.stack[this.length] = undefined;\r\n\t}\r\n\treturn def || new this.newConstructor();\r\n}\r\n\r\n/**\r\n * @param {Object} i Objec to release, adding it to the pool.\r\n */\r\nPool.prototype.release = function(i) {\r\n\tthis.stack[this.length++] = i;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/utils/pool.js","import Canvas from \"./canvas\";\r\nimport room from \"./room\";\r\nimport input from \"./input\";\r\nimport Instance from \"./instance\";\r\nimport global from \"./global\";\r\nimport draw from \"./draw\";\r\nimport Camera from \"./camera\";\r\nimport Transition from \"./transition\";\r\n\r\nlet lastTick = performance.now(),\r\n\ttickLength = 1000 / 60,\r\n\tdt = 0,\r\n\tlast = 0;\r\n\r\n//\r\nwindow.addConsoleText = window.addConsoleText || console.log;\r\nwindow._GB_stop = window._GB_stop || (() => {});\r\n\r\n//\r\nlet main = {\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tget dt() {\r\n\t\treturn dt;\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tstart: function(opts = {}) {\r\n\r\n\t\t// Basic site-locking\r\n\t\tif (opts.host !== undefined && opts.host !== \"\") {\r\n\t\t\tlet loc = (window.parent) ? window.parent.location : window.location;\r\n\t\t\tlet host = loc.hostname;\r\n\t\t\tlet arr = opts.host.split(\" \").join(\"\").split(\",\");\r\n\t\t\tif (!opts.host.includes(host))\r\n\t\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tlet canv = new Canvas({\r\n\t\t\twidth: room.current.width,\r\n\t\t\theight: room.current.height,\r\n\t\t\tcrisp2D: true,\r\n\t\t\tapplication: true\r\n\t\t});\r\n\r\n\t\t// selectively enable input methods\r\n\t\tif (opts.enableMouse) input.initMouse();\r\n\t\tif (opts.enableKeyboard) input.initKeyboard();\r\n\t\tif (opts.enableTouch) input.initTouch();\r\n\t\tif (opts.hideCursor) canv.domElement.style.cursor = \"none\";\r\n\r\n\t\t//\r\n\t\troom.enter(room.current);\r\n\t\ttick(performance.now());\r\n\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tsetGameSpeed: function(speed) {\r\n\t\ttickLength = 1000 / speed;\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n *\r\n */\r\nfunction tick(timestamp) {\r\n\r\n\ttry {\r\n\r\n\t\t// exit game with Esc key\r\n\t\tif (window._GB_stop && input.triggerEvents.includes(\"EscapePressed\"))\r\n\t\t\twindow._GB_stop();\r\n\r\n\t\t// request the next frame\r\n\t\twindow.requestAnimationFrame(tick);\r\n\t\tlet nextTick = lastTick + tickLength;\r\n\t\tlet numTicks = 0;\r\n\t\tglobal.fps = 1000 / (timestamp - last);\r\n\t\tglobal.dt = timestamp - last;\r\n\t\tlast = timestamp;\r\n\r\n\t\t//\r\n\t\tif ( timestamp > nextTick ) {\r\n\t\t\tlet timeSinceTick = timestamp - lastTick;\r\n\t\t\tlet maxTicks = Math.floor(timeSinceTick / tickLength);\r\n\t\t\tlastTick = lastTick + tickLength * maxTicks;\r\n\t\t\tnumTicks = Math.min(maxTicks, 60);\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tinput.getTriggerEvents();\r\n\t\tqueueUpdates(numTicks);\r\n\t\tgameDraw();\r\n\r\n\t\t//\r\n\t\tif (numTicks) {\r\n\t\t\tinput.update();\r\n\t\t}\r\n\r\n\t} catch (err) {\r\n\t\tconsole.error(err);\r\n\t\twindow.addConsoleText(\"#F00\", \"Error: \" + err);\r\n\t\twindow._GB_stop();\r\n\t}\r\n\r\n}\r\n\r\n/*******************************************************************************\r\n * @param {number} ticks\r\n * @return {void}\r\n */\r\nfunction queueUpdates(ticks) {\r\n\twhile (ticks--) {\r\n\t\tgameUpdate();\r\n\t}\r\n}\r\n\r\n/*******************************************************************************\r\n * Update sequence.\r\n * @return {void}\r\n */\r\nfunction gameUpdate() {\r\n\tInstance.stepAll();\r\n\tTransition.updateAll();\r\n}\r\n\r\n/**\r\n *\r\n */\r\nfunction gameDraw() {\r\n\tdraw.reset();\r\n\tCanvas.main.fill(\"#000000\");\r\n\troom.draw(room.current);\r\n\tCamera.updateAll();\r\n\tInstance.drawAll();\r\n\tdraw.reset();\r\n\tInstance.drawGuiAll();\r\n\tTransition.drawAll();\r\n}\r\n\r\n/**\r\n *\r\n */\r\nfunction handleResizeEvent() {\r\n\tInstance.executeEventAll(\"resize\");\r\n}\r\n\r\n// attach event listerners\r\nwindow.addEventListener(\"resize\", handleResizeEvent);\r\n\r\n//\r\nexport default main;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/main.js","/**\r\n * @module keyvalues\r\n */\r\n \r\nlet values = [\r\n\t\"ArrowUp\",\r\n\t\"ArrowDown\",\r\n\t\"ArrowLeft\",\r\n\t\"ArrowRight\",\r\n\t\"Enter\",\r\n\t\"Space\",\r\n\t\"Backspace\",\r\n\t\"Escape\",\r\n\t\"ShiftLeft\",\r\n\t\"ShiftRight\",\r\n\t\"ControlLeft\",\r\n\t\"ControlRight\",\r\n\t\"AltLeft\",\r\n\t\"AltRight\",\r\n\t\"KeyA\",\r\n\t\"KeyB\",\r\n\t\"KeyC\",\r\n\t\"KeyD\",\r\n\t\"KeyE\",\r\n\t\"KeyF\",\r\n\t\"KeyG\",\r\n\t\"KeyH\",\r\n\t\"KeyI\",\r\n\t\"KeyJ\",\r\n\t\"KeyK\",\r\n\t\"KeyL\",\r\n\t\"KeyM\",\r\n\t\"KeyN\",\r\n\t\"KeyO\",\r\n\t\"KeyP\",\r\n\t\"KeyQ\",\r\n\t\"KeyR\",\r\n\t\"KeyS\",\r\n\t\"KeyT\",\r\n\t\"KeyU\",\r\n\t\"KeyV\",\r\n\t\"KeyW\",\r\n\t\"KeyX\",\r\n\t\"KeyY\",\r\n\t\"KeyZ\",\r\n\t\"Digit0\",\r\n\t\"Digit1\",\r\n\t\"Digit2\",\r\n\t\"Digit3\",\r\n\t\"Digit4\",\r\n\t\"Digit5\",\r\n\t\"Digit6\",\r\n\t\"Digit7\",\r\n\t\"Digit8\",\r\n\t\"Digit9\"\r\n];\r\n\r\nexport default values;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/keyvalues.js","import keyValues from \"./keyvalues.js\";\r\n\r\n//\r\nlet events = {\r\n\tcreate: \"create\",\r\n\troomEnter: \"roomEnter\",\r\n\troomLeave: \"roomLeave\",\r\n\tstep: \"step\",\r\n\tdraw: \"draw\",\r\n\tcollision: \"collision_\",\r\n\tresize: \"resize\",\r\n\tkeyboard: {\r\n\t\t...translate( keyValues ),\r\n\t\tpressed: translate( keyValues, \"Pressed\" ),\r\n\t\treleased: translate( keyValues, \"Released\" )\r\n\t}\r\n}\r\n\t\r\n/**\r\n * @param {array} array\r\n * @param {string} [postfix=\"\"]\r\n */\r\nfunction translate(array, postfix = \"\") {\r\n\tlet obj = {};\r\n\tarray.forEach((name) => {\r\n\t\tobj[name] = name + postfix;\r\n\t});\r\n\treturn obj;\r\n}\r\n\r\n//\r\nexport default events;\n\n\n// WEBPACK FOOTER //\n// ./core/js/event.js","\r\n/**\r\n *\r\n */\r\nexport default class Script {\r\n}\r\n\r\nScript.names = [];\n\n\n// WEBPACK FOOTER //\n// ./core/js/Script.js","\r\n//\r\nlet tween = {\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tblend( n1 , n2 , perc ) {\r\n\t\tlet diff = n2 - n1;\r\n\t\treturn n1 + ( diff * perc );\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tcubicBezier( x2, y2, x3, y3, i ) {\r\n\t\t\r\n\t\tlet x1 = 0,\r\n\t\t\ty1 = 0,\r\n\t\t\tx4 = 1,\r\n\t\t\ty4 = 1;\r\n\t\t\r\n\t\t // The Green Lines\r\n\t\tlet xa = tween.blend( x1 , x2 , i ),\r\n\t\t\tya = tween.blend( y1 , y2 , i ),\r\n\t\t\txb = tween.blend( x2 , x3 , i ),\r\n\t\t\tyb = tween.blend( y2 , y3 , i ),\r\n\t\t\txc = tween.blend( x3 , x4 , i ),\r\n\t\t\tyc = tween.blend( y3 , y4 , i ),\r\n\r\n\t\t\t// The Blue Line\r\n\t\t\txm = tween.blend( xa , xb , i ),\r\n\t\t\tym = tween.blend( ya , yb , i ),\r\n\t\t\txn = tween.blend( xb , xc , i ),\r\n\t\t\tyn = tween.blend( yb , yc , i ),\r\n\r\n\t\t\t// The Black Dot\r\n\t\t\tx = tween.blend( xm , xn , i ),\r\n\t\t\ty = tween.blend( ym , yn , i );\r\n\t\t\r\n\t\t//\r\n\t\treturn y;\r\n\t\t\r\n\t}\r\n\t\r\n}\r\n\r\n//\r\nexport default tween;\n\n\n// WEBPACK FOOTER //\n// ./core/js/tween.js","import draw from \"./../draw.js\";\r\nimport sprite from \"./../sprite.js\";\r\n\r\nconst noop = () => {};\r\n\r\n/** */\r\nexport default class Primitive {\r\n\r\n\t/**\r\n\t * @param {object} opts Options object.\r\n\t * @param {array} opts.points Array of Point objects.\r\n\t * @param {*} opts.texture Sprite object or name of sprite resource.\r\n\t * @param {*} opts.color Color of the primitive.\r\n\t * @param {string} opts.format Format of the points array.\r\n\t * @param {function} opts.modifier Point modifier function.\r\n\t * @param {number} opts.x X position to draw the primitive.\r\n\t * @param {number} opts.y Y position to draw the primitive.\r\n\t */\r\n\tconstructor(opts = {}) {\r\n\t\tthis.points = opts.points || [];\r\n\t\tthis.texture = opts.texture || null;\r\n\t\tthis.color = opts.color || \"#000000\";\r\n\t\tthis.format = opts.format || \"quads\";\r\n\t\tthis.modifier = opts.modifier || noop;\r\n\t\tthis.x = opts.x || 0;\r\n\t\tthis.y = opts.y || 0;\r\n\t}\r\n\t\r\n\t/** Method for drawing instantiated Primitive. */\r\n\tdraw() {\r\n\t\tPrimitive.draw(this);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Alternate way to create a new Primitive instance.\r\n\t * @param {object} opts See constructor.opts parameter.\r\n\t */\r\n\tstatic create(opts = {}) {\r\n\t\treturn new Primitive(opts);\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {object} opts See constructor.opts parameter.\r\n\t */\r\n\tstatic draw(opts = {}) {\r\n\t\tif (opts.texture) drawTextured(opts);\r\n\t\telse drawBasic(opts);\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n *\r\n */\r\nfunction drawTextured(opts = {}) {\r\n\t\r\n\tlet texture = opts.texture;\r\n\tlet spr = sprite.get(texture);\r\n\tif (spr === null) {\r\n\t\tconsole.warn(\"No such texture: \" + texture);\r\n\t\treturn;\r\n\t}\r\n\t\r\n\tlet ctx = draw.context;\r\n\tlet frame = spr.images[0];\r\n\tlet img = frame.img;\r\n\tlet w = spr.width;\r\n\tlet h = spr.height;\r\n\tlet tris = orderTriangleList(opts);\r\n\t\r\n\t//\r\n\tlet t;\r\n\tlet pts = applyModifier(opts.points, opts.modifier);\r\n\tlet len = tris.length;\r\n\tfor (t=0; t<len; t++) {\r\n\t\t\r\n\t\tvar pp = tris[t];\r\n\t\tvar x0 = pts[pp[0]].x, x1 = pts[pp[1]].x, x2 = pts[pp[2]].x;\r\n\t\tvar y0 = pts[pp[0]].y, y1 = pts[pp[1]].y, y2 = pts[pp[2]].y;\r\n\t\tvar u0 = pts[pp[0]].u*w, u1 = pts[pp[1]].u*w, u2 = pts[pp[2]].u*w;\r\n\t\tvar v0 = pts[pp[0]].v*h, v1 = pts[pp[1]].v*h, v2 = pts[pp[2]].v*h;\r\n\t\t\r\n\t\t// Set clipping area so that only pixels inside the triangle will\r\n\t\t// be affected by the image drawing operation\r\n\t\tctx.save();\r\n\t\tctx.beginPath();\r\n\t\tctx.moveTo(x0, y0);\r\n\t\tctx.lineTo(x1, y1);\r\n\t\tctx.lineTo(x2, y2);\r\n\t\tctx.closePath();\r\n\t\tctx.clip();\r\n\r\n\t\t// Compute matrix transform\r\n\t\tvar delta = u0*v1 + v0*u2 + u1*v2 - v1*u2 - v0*u1 - u0*v2;\r\n\t\tvar delta_a = x0*v1 + v0*x2 + x1*v2 - v1*x2 - v0*x1 - x0*v2;\r\n\t\tvar delta_b = u0*x1 + x0*u2 + u1*x2 - x1*u2 - x0*u1 - u0*x2;\r\n\t\tvar delta_c = u0*v1*x2 + v0*x1*u2 + x0*u1*v2 - x0*v1*u2\r\n\t\t\t\t\t  - v0*u1*x2 - u0*x1*v2;\r\n\t\tvar delta_d = y0*v1 + v0*y2 + y1*v2 - v1*y2 - v0*y1 - y0*v2;\r\n\t\tvar delta_e = u0*y1 + y0*u2 + u1*y2 - y1*u2 - y0*u1 - u0*y2;\r\n\t\tvar delta_f = u0*v1*y2 + v0*y1*u2 + y0*u1*v2 - y0*v1*u2\r\n\t\t\t\t\t  - v0*u1*y2 - u0*y1*v2;\r\n\r\n\t\t// Draw the transformed image\r\n\t\tctx.transform(delta_a/delta, delta_d/delta,\r\n\t\t\t\t\t  delta_b/delta, delta_e/delta,\r\n\t\t\t\t\t  delta_c/delta, delta_f/delta);\r\n\t\tctx.drawImage(img, 0, 0);\r\n\t\tctx.restore();\r\n\t}\r\n}\r\n\r\n/**\r\n *\r\n */\r\nfunction drawBasic(opts = {}) {\r\n\tlet points = applyModifier(opts.points, opts.modifier);\r\n\tlet length = points.length;\r\n\tif (length > 0) {\r\n\t\tlet tris = orderQuadList(opts);\r\n\t\tlet i, ctx = draw.context;\r\n\t\tctx.fillStyle = opts.color || draw.color;\r\n\t\tfor (i=0; i<tris.length; i++) {\r\n\t\t\tlet tri = tris[i];\r\n\t\t\tlet n, p = points[tri[0]];\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.moveTo(p.x, p.y);\r\n\t\t\tfor (n=1; n<tri.length; n++) {\r\n\t\t\t\tp = points[tri[n]];\r\n\t\t\t\tctx.lineTo(p.x, p.y);\r\n\t\t\t}\r\n\t\t\tctx.closePath();\r\n\t\t\tctx.fill();\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n *\r\n */\r\nfunction applyModifier(points, modifier) {\r\n\tlet newPoints = [];\r\n\tpoints.forEach(function(p) {\r\n\t\tlet newP = Object.assign({}, p, modifier.call(p));\r\n\t\tnewPoints.push(newP);\r\n\t});\r\n\treturn newPoints;\r\n}\r\n\r\n/**\r\n * @param {object} opts\r\n */\r\nfunction orderTriangleList(opts = {}) {\r\n\tlet tris = [];\r\n\tif (opts.format === \"quads\") {\r\n\t\tlet length = Math.floor(opts.points.length / 4);\r\n\t\tlet n, o = 0;\r\n\t\tfor (n=0; n<length; n++) {\r\n\t\t\ttris.push([o+0, o+1, o+2], [o+2, o+3, o+0]);\r\n\t\t\to += 4;\r\n\t\t}\r\n\t}\r\n\treturn tris;\r\n}\r\n\r\n/**\r\n * @param {object} opts\r\n */\r\nfunction orderQuadList(opts = {}) {\r\n\tlet tris = [];\r\n\tlet length = Math.floor(opts.points.length / 4);\r\n\tlet n, o = 0;\r\n\tfor (n=0; n<length; n++, o+=4) {\r\n\t\ttris.push([o+0, o+1, o+2, o+3]);\r\n\t}\r\n\treturn tris;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./core/js/drawing/primitive.js","import Generator from \"./generator\";\r\n\r\n/**\r\n * @author Jack Oatley\r\n */\r\nclass Vector2 {\r\n\r\n\t/**\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t */\r\n\tconstructor(x, y) {\r\n\t\tthis.set(x, y);\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tset(x, y) {\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tcopy(v) {\r\n\t\tthis.x = v.x;\r\n\t\tthis.y = v.y;\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tadd(v) {\r\n\t\tthis.x += v.x;\r\n\t\tthis.y += v.y;\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tmul(v) {\r\n\t\tthis.x *= v.x;\r\n\t\tthis.y *= v.y;\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tdiv(v) {\r\n\t\tthis.x /= v.x;\r\n\t\tthis.y /= v.y;\r\n\t}\r\n\r\n}\r\n\r\nGenerator.classStaticMatch(Vector2);\r\n\r\nexport default Vector2;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/Vector2.js","import App from \"./App\";\r\nimport main from \"./main\";\r\nimport canvas from \"./canvas\";\r\nimport Camera from \"./camera\";\r\nimport Room from \"./room\";\r\nimport input from \"./input\";\r\nimport Script from \"./Script\";\r\nimport sprite from \"./sprite\";\r\nimport Sound from \"./Sound\";\r\nimport object from \"./object\";\r\nimport event from \"./event\";\r\nimport * as action from \"./action\";\r\nimport instance from \"./instance\";\r\nimport draw from \"./draw\";\r\nimport math from \"./math\";\r\nimport tween from \"./tween\";\r\nimport Transition from \"./transition\";\r\nimport Primitive from \"./drawing/primitive\";\r\nimport Font from \"./font\";\r\nimport Grid from \"./data/grid\";\r\nimport Vector2 from \"./Vector2\";\r\n\r\nexport {\r\n\tApp,\r\n\tmain,\r\n\tcanvas,\r\n\tCamera,\r\n\tRoom,\r\n\tinput,\r\n\tsprite,\r\n\tSound,\r\n\tScript,\r\n\tobject,\r\n\tevent,\r\n\taction,\r\n\tinstance,\r\n\tdraw,\r\n\tmath,\r\n\ttween,\r\n\tTransition,\r\n\tFont,\r\n\tGrid,\r\n\tVector2\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/core.js","import math from \"./math.js\";\r\nimport instance from \"./instance.js\";\r\n \r\n//\r\nlet basic = JSON.stringify({\r\n\tsprite: null,\r\n\tindex: 0,\r\n\timageSpeed: 1,\r\n\tanimationBehavior: \"loop\",\r\n\tvisible: true,\r\n\tsolid: false,\r\n\texists: true,\r\n\tscaleX: 1,\r\n\tscaleY: 1,\r\n\trotation: 0,\r\n\tterminal: 100,\r\n\tgravity: 0,\r\n\tgravityDirection: 0,\r\n\tspeedX: 0,\r\n\tspeedY: 0,\r\n\tboxTop: 0,\r\n\tboxBottom: 0,\r\n\tboxLeft: 0,\r\n\tboxRight: 0,\r\n\tbehaviours: [],\r\n\tlisteners: [],\r\n\tevents: {},\r\n\tboxCollision: {\r\n\t\tx: 0,\r\n\t\ty: 0,\r\n\t\twidth: 0,\r\n\t\theight: 0,\r\n\t\ttop: 0,\r\n\t\tbottom: 0,\r\n\t\tleft: 0,\r\n\t\tright: 0 \r\n\t},\r\n\t_depth: 0\r\n});\r\n \r\n//\r\nlet objectVars = {\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tset: function(proto) {\r\n\t\tObject.assign(proto, JSON.parse(basic));\r\n\t\t\r\n\t\tproto.destroy = function() {\r\n\t\t\tinstance.destroy(this);\r\n\t\t}\r\n\t\t\r\n\t\tObject.defineProperty(proto, \"depth\", {\r\n\t\t\tset: function(x) {\r\n\t\t\t\tif (this._depth !== x) {\r\n\t\t\t\t\tthis._depth = x;\r\n\t\t\t\t\tinstance.doDepthSort = true;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tget: function() { return this._depth; }\r\n\t\t});\r\n\t\t\r\n\t\tObject.defineProperty(proto, \"speed\", {\r\n\t\t\tset: function(x) {\r\n\t\t\t\tlet y = this.direction * math.DEGTORAD;\r\n\t\t\t\tthis.speedX = Math.cos(y) * x;\r\n\t\t\t\tthis.speedY = Math.sin(y) * x;\r\n\t\t\t},\r\n\t\t\tget: function( x ) {\r\n\t\t\t\treturn math.pointDistance( 0, 0, this.speedX, this.speedY );\r\n\t\t\t}\r\n\t\t} );\r\n\t\t\r\n\t\tObject.defineProperty(proto, \"direction\", {\r\n\t\t\tset: function(x) {\r\n\t\t\t\tlet y = this.speed;\r\n\t\t\t\tthis.speedX = Math.cos(x * math.DEGTORAD) * y;\r\n\t\t\t\tthis.speedY = Math.sin(x * math.DEGTORAD) * y;\r\n\t\t\t},\r\n\t\t\tget: function( x ) {\r\n\t\t\t\treturn math.pointDirection( 0, 0, this.speedX, this.speedY );\r\n\t\t\t}\r\n\t\t} );\r\n\t\t\t\r\n\t}\r\n\t\r\n}\r\n\r\n//\r\nexport default objectVars;\n\n\n// WEBPACK FOOTER //\n// ./core/js/objectVars.js","import Font from \"./font\";\r\nimport global from \"./global\";\r\nimport object from \"./object\";\r\nimport room from \"./room\";\r\nimport Script from \"./Script\";\r\nimport Sound from \"./Sound\";\r\nimport sprite from \"./sprite\";\r\n\r\n/**\r\n * @author Jack Oatley\r\n */\r\nexport default class Compiler {\r\n\r\n\t/***************************************************************************\r\n\t * @param {string} exp\r\n\t * @return {*}\r\n\t */\r\n\tstatic actionExpressionEval(exp) {\r\n\r\n\t\tlet isActionParam = false;\r\n\t\tif (exp instanceof String) {\r\n\t\t\tisActionParam = true;\r\n\t\t\texp = String(exp);\r\n\t\t}\r\n\r\n\t\tif (exp === \"self\") return this;\r\n\t\tif (exp === \"other\") return window.other;\r\n\r\n\t\tif (!isNaN(Number(exp)))\r\n\t\t\treturn Number(exp);\r\n\r\n\t\tif (Compiler.isBoolean(exp))\r\n\t\t\treturn exp === true || exp === \"true\";\r\n\r\n\t\tif (Compiler.isFunction(exp)\r\n\t\t||  Compiler.isOperator(exp)\r\n\t\t||  Compiler.isResource(exp)\r\n\t\t||  Compiler.isCss(exp)\r\n\t\t||  (!isActionParam && typeof exp === \"string\")) {\r\n\t\t\treturn exp;\r\n\t\t}\r\n\r\n\t\tif (typeof exp === \"string\") {\r\n\t\t\tlet words = Compiler.getWords(exp);\r\n\t\t\tlet expression = Compiler.joinWords(words);\r\n\t\t\treturn eval(expression);\r\n\t\t}\r\n\r\n\t\treturn exp;\r\n\r\n\t}\r\n\r\n\t/***************************************************************************\r\n\t * @param {string} exp\r\n\t * @return {*}\r\n\t */\r\n\tstatic actionExpression(exp) {\r\n\r\n\t\tlet isActionParam = false;\r\n\t\tif (exp instanceof String) {\r\n\t\t\tisActionParam = true;\r\n\t\t\texp = String(exp);\r\n\t\t}\r\n\r\n\t\tif (exp === \"self\") return \"this\";\r\n\t\tif (exp === \"other\") return \"window.other\";\r\n\r\n\t\tif (!isNaN(Number(exp)))\r\n\t\t\treturn Number(exp);\r\n\r\n\t\tif (Compiler.isBoolean(exp))\r\n\t\t\treturn (exp === true || exp === \"true\");// ? \"true\" : \"false\";\r\n\r\n\t\tif (Compiler.isOperator(exp)\r\n\t\t||  Compiler.isCss(exp))\r\n\t\t\treturn \"'\" + exp + \"'\";\r\n\r\n\t\tif (Compiler.isFunction(exp)\r\n\t\t||  Compiler.isResource(exp)\r\n\t\t||  (!isActionParam && typeof exp === \"string\")) {\r\n\t\t\treturn exp;\r\n\t\t}\r\n\r\n\t\tif (typeof exp === \"string\") {\r\n\t\t\tlet words = Compiler.getWords(exp);\r\n\t\t\tlet expression = Compiler.joinWords(words);\r\n\t\t\treturn expression;\r\n\t\t}\r\n\r\n\t\treturn exp;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tstatic getWords(exp) {\r\n\t\tlet n;\r\n\t\tlet string = \"\";\r\n\t\tlet sIndex = -1;\r\n\t\tlet sType = \"\";\r\n\t\tlet newArr = [];\r\n\r\n\t\tfor (n = 0; n < exp.length; n++) {\r\n\r\n\t\t\tlet c = exp.charAt(n);\r\n\r\n\t\t\tif (c === \"'\" || c === \"\\\"\") {\r\n\t\t\t\tif (sIndex === -1) {\r\n\t\t\t\t\tsType = c;\r\n\t\t\t\t\tsIndex = n + 1;\r\n\t\t\t\t} else if (sType === c) {\r\n\t\t\t\t\tnewArr.push(\"'\" + exp.slice(sIndex, n) + \"'\");\r\n\t\t\t\t\tsIndex = -1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\telse if (sIndex === -1) {\r\n\t\t\t\tif (c !== \" \") {\r\n\t\t\t\t\tif (Compiler.splitCharacters.includes(c)) {\r\n\t\t\t\t\t\tif (string !== \"\") {\r\n\t\t\t\t\t\t\tnewArr.push(string);\r\n\t\t\t\t\t\t\tstring = \"\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tnewArr.push(c);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tstring += c;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tstring += c;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif (string !== \"\") {\r\n\t\t\tnewArr.push(string);\r\n\t\t\tstring = \"\";\r\n\t\t}\r\n\r\n\t\treturn newArr;\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tstatic joinWords(words) {\r\n\t\tlet y = \"\";\r\n\t\twords.forEach((word) => {\r\n\t\t\tlet num = parseInt(word);\r\n\t\t\tif (isNaN(num)) {\r\n\t\t\t\tlet c = word.charAt(0);\r\n\t\t\t\tif (c === \"'\" || c === \" \") {\r\n\t\t\t\t\ty += word;\r\n\t\t\t\t} else if (Compiler.splitCharacters.includes(c)) {\r\n\t\t\t\t\ty += word;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (word === \"fps\")\r\n\t\t\t\t\t\ty += global.fps;\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tif (!Compiler.isResource(word)\r\n\t\t\t\t\t\t&&  Compiler.isSingleWord(word)\r\n\t\t\t\t\t\t&&  !Compiler.isString(word)\r\n\t\t\t\t\t\t&&  !Compiler.isArray(word)\r\n\t\t\t\t\t\t&& word !== \"this\") {\r\n\t\t\t\t\t\t\ty += \"this.\" + word;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\ty += word;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\ty += word;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn y;\r\n\t}\r\n\r\n\t/** */\r\n\tstatic isResource(x) {\r\n\t\treturn object.names.includes(x)\r\n\t\t\t|| sprite.names.includes(x)\r\n\t\t\t|| Sound.names.includes(x)\r\n\t\t\t|| room.names.includes(x)\r\n\t\t\t|| Font.names.includes(x)\r\n\t\t\t|| Script.names.includes(x);\r\n\t}\r\n\r\n\t/** */\r\n\tstatic isArray(x) {\r\n\t\treturn x.charAt(0) === \"[\";\r\n\t}\r\n\r\n\t/** */\r\n\tstatic isString(x) {\r\n\t\treturn (x.charAt(0) === \"\\\"\" && x.charAt(x.length-1) === \"\\\"\")\r\n\t\t\t|| (x.charAt(0) === \"'\" && x.charAt(x.length-1) === \"'\");\r\n\t}\r\n\r\n\t/** */\r\n\tstatic isSingleWord(x) {\r\n\t\treturn !x.includes(\".\");\r\n\t}\r\n\r\n\t/** */\r\n\tstatic isFunction(x) {\r\n\t\treturn typeof x === \"function\";\r\n\t}\r\n\r\n\t/** */\r\n\tstatic isBoolean(x) {\r\n\t\treturn Compiler.booleans.includes(x);\r\n\t}\r\n\r\n\t/** */\r\n\tstatic isOperator(x) {\r\n\t\treturn Compiler.assignmentOperators.includes(x);\r\n\t}\r\n\r\n\t/** */\r\n\tstatic isCss(x) {\r\n\t\treturn x.charAt(0) === \"#\";\r\n\t}\r\n\r\n}\r\n\r\nCompiler.keywords = [\"self\", \"other\"];\r\nCompiler.booleans = [true, false, \"true\", \"false\"];\r\nCompiler.assignmentOperators = [\"<\", \">\", \"<=\", \">=\", \"==\", \"===\", \"!=\", \"!==\"];\r\nCompiler.splitCharacters = [\"+\", \"-\", \"=\", \"!\"];\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/compile.js","import Room from \"./room\";\r\nimport Sound from \"./Sound\";\r\nimport draw from \"./draw\";\r\nimport instance from \"./instance\";\r\nimport input from \"./input\";\r\nimport math from \"./math\";\r\nimport Sprite from \"./sprite\";\r\nimport Canvas from \"./canvas\";\r\nimport color from \"./color\";\r\nimport main from \"./main\";\r\nimport Camera from \"./camera\";\r\nimport App from \"./App\";\r\nimport Grid from \"./data/grid\";\r\nimport Tilemap from \"./tilemap\";\r\nimport tween from \"./tween\";\r\nimport Transition from \"./transition\";\r\nimport GameObject from \"./object\";\r\nimport Primitive from \"./drawing/primitive\";\r\nimport Vector2 from \"./Vector2\";\r\n\r\n/**\r\n * Set the variable with the given name.\r\n * @param {string} varName\r\n * @param {*} value\r\n * @param {boolean} relative\r\n * @param {boolean} global\r\n * @return {void}\r\n */\r\nfunction set(varName, value, relative, global) {\r\n\tlet target = global ? window.global : this;\r\n\tif (relative) {\r\n\t\ttarget[varName] += value\r\n\t} else {\r\n\t\ttarget[varName] = value;\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string} varName\r\n * @param {string} op Operation.\r\n * @param {value} value Value to check against.\r\n * @param {boolean} global\r\n * @return {boolean}\r\n */\r\nfunction test(varName, op, value, global) {\r\n\tlet target = global ? window.global : this;\r\n\tswitch (op) {\r\n\t\tcase(\"!==\"): return target[varName] !== value;\r\n\t\tcase(\"===\"): return target[varName] === value;\r\n\t\tcase(\"!=\"): return target[varName] != value;\r\n\t\tcase(\"==\"): return target[varName] == value;\r\n\t\tcase(\"<\"): return target[varName] < value;\r\n\t\tcase(\">\"): return target[varName] > value;\r\n\t\tcase(\"<=\"): return target[varName] <= value;\r\n\t\tcase(\">=\"): return target[varName] >= value;\r\n\t\tdefault: return false;\r\n\t}\r\n}\r\n\r\n/**\r\n * Sets the instance's gravity to the given value.\r\n * @param {number} value The gravity strength.\r\n * @return {void}\r\n */\r\nfunction setGravity(value) {\r\n\tthis.gravity = value;\r\n}\r\n\r\n/**\r\n * Instantly sets the instance's x and y values to a random position within\r\n * the current room.\r\n * @param {number} x\r\n * @param {number} y\r\n * @param {boolean} relative\r\n * @return {void}\r\n */\r\nfunction jump(x, y, relative) {\r\n\tif (relative) {\r\n\t\tthis.x += Number(x);\r\n\t\tthis.y += Number(y);\r\n\t} else {\r\n\t\tthis.x = Number(x);\r\n\t\tthis.y = Number(y);\r\n\t}\r\n}\r\n\r\n/**\r\n * Instantly sets the instance's x and y values to a random position within\r\n * the current room.\r\n * @return {void}\r\n */\r\nfunction jumpRandom() {\r\n\tlet x1 = 0, y1 = 0, x2 = 640, y2 = 480;\r\n\tthis.x = Math.floor(Math.random() * (x2 - x1 + 1)) + x1;\r\n\tthis.y = Math.floor(Math.random() * (y2 - y1 + 1)) + y1;\r\n}\r\n\r\n/**\r\n *\r\n */\r\nfunction moveFree(speed, direction) {\r\n\tthis.speed = speed;\r\n\tthis.direction = direction;\r\n}\r\n\r\n/**\r\n * Instantly sets the instance's x and y values to a random position within\r\n * the current room.\r\n * @param {number} x\r\n * @param {number} y\r\n */\r\nfunction moveDirect(x, y) {\r\n\tthis.x += x * main.dt;\r\n\tthis.y += y * main.dt;\r\n}\r\n\r\n/**\r\n *\r\n */\r\nfunction moveSpeedX(speed) { this.speedX = Number(speed); }\r\nfunction moveSpeedY(speed) { this.speedY = Number(speed); }\r\nfunction moveReverseX() { this.speedX = -this.speedX; }\r\nfunction moveReverseY() { this.speedY = -this.speedY; }\r\n\r\n/**\r\n * Wraps the instance back into the room when it leaves.\r\n */\r\nfunction actionWrap() {\r\n\tlet width = this.boxRight - this.boxLeft;\r\n\tlet height = this.boxBottom - this.boxTop;\r\n\tlet thisRoom = Room.current;\r\n\tlet roomW = thisRoom.width;\r\n\tlet roomH = thisRoom.height;\r\n\tif (this.boxRight < 0) this.x += roomW + width;\r\n\tif (this.boxBottom < 0) this.y += roomH + height;\r\n\tif (this.boxLeft > roomW) this.x -= roomW + width;\r\n\tif (this.boxTop > roomH) this.y -= roomH + height;\r\n}\r\n\r\n/**\r\n * Wraps the instance back into the room when it leaves.\r\n */\r\nfunction actionConfine() {\r\n\tlet width = this.boxRight - this.boxLeft;\r\n\tlet height = this.boxBottom - this.boxTop;\r\n\tlet thisRoom = Room.current;\r\n\tlet roomW = thisRoom.width;\r\n\tlet roomH = thisRoom.height;\r\n\tif (this.boxLeft < 0) this.x = 0;\r\n\tif (this.boxTop < 0) this.y = 0;\r\n\tif (this.boxRight > roomW) this.x = roomW - width;\r\n\tif (this.boxBottom > roomH) this.y = roomH - height;\r\n}\r\n\r\n/**\r\n * Executes the given function with variable arguments on the instance.\r\n * @param {function} func\r\n * @param {...*} args\r\n */\r\nfunction actionFunc(func, ...args) {\r\n\tfunc.apply(this, args);\r\n}\r\n\r\n/**\r\n * Executes the given Script with an array of arguments.\r\n * @param {script} func\r\n * @param {array} args\r\n */\r\nfunction script(s, args) {\r\n\tconsole.log(window[s], args);\r\n\twindow[s].apply(this, args);\r\n}\r\n\r\n/**\r\n * Executes the given function with variable arguments on the instance.\r\n * @param {string} code\r\n */\r\nfunction code(code) {\r\n\tif (typeof code === \"string\") {\r\n\t\ttry {\r\n\t\t\teval(code);\r\n\t\t}\r\n\t\tcatch(err) {\r\n\t\t\tconsole.error(err.message);\r\n\t\t}\r\n\t} else {\r\n\t\tconsole.error(\"runCode(code); code must be a string!\");\r\n\t}\r\n}\r\n\r\n/**\r\n * Shows the value of the given variable of the instance, in the console.\r\n * @param {...*} args\r\n */\r\nfunction get(...args) {\r\n\tconsole.log(this[args].toFixed(2));\r\n}\r\n\r\n// Fucntions for use in code.\r\nlet GAME = {\r\n\tmain: {\r\n\t\tsetGameSpeed: main.setGameSpeed\r\n\t},\r\n\tinstance: {\r\n\t\tcreate: instance.create,\r\n\t\tcreateMoving: instance.createMoving,\r\n\t\tdestroy: instance.destroy,\r\n\t\tfind: instance.find,\r\n\t\tfindRandom: instance.findRandom,\r\n\t\tcount: instance.count,\r\n\t\tmouseOn: instance.mouseOn\r\n\t},\r\n\tdraw: Object.assign( draw, {\r\n\t\tself: instance.drawSelf,\r\n\t\tdebug: instance.drawDebug\r\n\t} ),\r\n\tCanvas: Canvas,\r\n\tcolor: color,\r\n\tsprite: Sprite,\r\n\tSound: Sound,\r\n\tRoom: Room,\r\n\tinput: {\r\n\t\tkeyboard: input.keyboard,\r\n\t\tmouse: input.mouse,\r\n\t\ttouch: input.touch\r\n\t},\r\n\tmath: math,\r\n\tCamera: Camera,\r\n\tApp: App,\r\n\tGrid: Grid,\r\n\tTilemap: Tilemap,\r\n\ttween: tween,\r\n\tTransition: Transition,\r\n\tObject: GameObject,\r\n\tPrimitive: Primitive,\r\n\tVector2: Vector2\r\n}\r\n\r\n//\r\nlet blockBegin            = \"blockBegin\",\r\n\tblockEnd        \t  = \"blockEnd\",\r\n\texitEvent        \t  = \"exitEvent\",\r\n\troomEnter             = Room.enter,\r\n\troomNext              = Room.next,\r\n\troomPrevious          = Room.previous,\r\n\tinstanceCreate    \t  = instance.create,\r\n\tinstanceCreateMoving  = instance.createMoving,\r\n\tinstanceDestroy       = instance.destroy,\r\n\tchangeSprite  \t\t  = instance.changeSprite,\r\n\tinstanceSetRotation   = instance.setRotation,\r\n\tinstanceSetDirection  = instance.setDirection,\r\n\tmessage               = (args) => console.log(args),\r\n\talert                 = function(m) { window.alert(m) },\r\n\tconfirm               = function(m) { return window.confirm(m) },\r\n\tdrawSetColor          = draw.setColor,\r\n\tdrawSetFont           = draw.setFont,\r\n\tdrawSetFontSize       = draw.setFontSize,\r\n\tdrawText              = draw.text,\r\n\tdrawSelf              = instance.drawSelf,\r\n\tdrawSprite            = draw.sprite,\r\n\tsoundPlay = function(snd, loop) {Sound.play(snd, {loop: loop})},\r\n\tsoundStop = Sound.stop;\r\n\r\n//\r\nexport {\r\n\tinstanceCreate,\r\n\tinstanceCreateMoving,\r\n\tinstanceDestroy,\r\n\tinstanceSetRotation,\r\n\tinstanceSetDirection,\r\n\tchangeSprite,\r\n\tchangeSprite as instanceChangeSprite,\r\n\tsoundPlay, soundStop,\r\n\tdrawSetColor,\r\n\tdrawSetFont,\r\n\tdrawSetFontSize,\r\n\tdrawText,\r\n\tdrawSelf,\r\n\tdrawSelf as instanceDrawSelf,\r\n\tdrawSprite,\r\n\troomEnter, roomNext, roomPrevious,\r\n\tblockBegin, blockEnd,\r\n\texitEvent,\r\n\tset,\r\n\tget,\r\n\ttest,\r\n\tsetGravity,\r\n\tjump,\r\n\tjumpRandom,\r\n\tmoveFree,\r\n\tmoveDirect,\r\n\tmoveSpeedX,\r\n\tmoveSpeedY,\r\n\tmoveReverseX,\r\n\tmoveReverseY,\r\n\tactionWrap,\r\n\tactionConfine,\r\n\tactionWrap       as wrap,\r\n\tactionConfine    as confine,\r\n\tactionFunc       as func,\t// DEPRECATE?\r\n\tscript,\r\n\tcode,\r\n\tmessage,\r\n\talert,\r\n\tconfirm,\r\n\tGAME\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/action.js","import Generator from \"./generator\";\r\nimport Grid from \"./data/grid\";\r\nimport draw from \"./draw\";\r\nimport Sprite from \"./sprite\";\r\n\r\n/**\r\n * @author Jack Oatley\r\n */\r\nclass Tilemap {\r\n\r\n\t/**\r\n\t * @param {object} [opts={}] Options object to define the Tilemap.\r\n\t * @param {sprite} [opts.atlas]\r\n\t * @param {number} [opts.tileWidth]\r\n\t * @param {number} [opts.tileHeight]\r\n\t * @param {number} [opts.tileSpacing]\r\n\t * @param {number} [opts.tileOverlay]\r\n\t * @param {number} [opts.tilesWide]\r\n\t * @param {number} [opts.mapWidth]\r\n\t * @param {number} [opts.mapHeight]\r\n\t */\r\n\tconstructor(opts = {}) {\r\n\t\tthis.textureAtlas = opts.atlas || null;\r\n\t\tthis.tileWidth = opts.tileWidth || 16;\r\n\t\tthis.tileHeight = opts.tileHeight || 16;\r\n\t\tthis.tileSpacing = opts.tileSpacing || 0;\r\n\t\tthis.tileOverlay = opts.tileOverlay || 0;\r\n\t\tthis.tilesWide = opts.tilesWide || 16;\r\n\t\tthis.mapWidth = opts.mapWidth || 16;\r\n\t\tthis.mapHeight = opts.mapHeight || 16;\r\n\t\tthis.layers = {};\r\n\r\n\t\tthis.__gap = this.tileSpacing + this.tileOverlay;\r\n\t\tif (this.textureAtlas)\r\n\t\t\tthis.__atlas = Sprite.get(this.textureAtlas).images[0].img;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} layer Name of the player in which to place the tile.\r\n\t * @param {number} x The X grid position to place this tile.\r\n\t * @param {number} y The Y grid position to place this tile.\r\n\t * @param {number} index The tile index.\r\n\t */\r\n\tset(layer, x, y, index) {\r\n\t\tif (!this.layers[layer]) {\r\n\t\t\tthis.layers[layer] = new Grid(this.mapWidth, this.mapHeight);\r\n\t\t}\r\n\t\tthis.layers[layer].set(x, y, index);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {object} [opts={}]\r\n\t * @param {array} [opts.order]\r\n\t * @param {number} [opts.left]\r\n\t * @param {number} [opts.top]\r\n\t * @param {number} [opts.right]\r\n\t * @param {number} [opts.bottom]\r\n\t */\r\n\tdraw(opts) {\r\n\t\tconst atlas = this.__atlas;\r\n\t\tconst tw = this.tileWidth;\r\n\t\tconst th = this.tileHeight;\r\n\t\tconst tsw = this.tilesWide;\r\n\t\tconst gap = this.__gap;\r\n\t\tconst overlay = this.tileOverlay;\r\n\t\tconst renderWidth = tw + overlay * 2;\r\n\t\tconst renderHeight = th + overlay * 2;\r\n\t\tconst order = opts.order || Object.keys(this.layers);\r\n\t\tconst startX = ~~(Math.max(0, (opts.left || 0) / tw));\r\n\t\tconst startY = ~~(Math.max(0, (opts.top || 0) / th));\r\n\t\tconst endX = Math.ceil(Math.min(this.mapWidth, (opts.right || 0) / tw));\r\n\t\tconst endY = Math.ceil(Math.min(this.mapHeight, (opts.bottom || 0) / th));\r\n\t\tlet x, y, n, layer, tile, iX, iY;\r\n\t\tfor (n=0; n<order.length; n++) {\r\n\t\t\tlayer = this.layers[order[n]];\r\n\t\t\tfor (x=startX; x<endX; x++)\r\n\t\t\tfor (y=startY; y<endY; y++) {\r\n\t\t\t\ttile = layer.get(x, y) - 1;\r\n\t\t\t\tif (tile >= 0) {\r\n\t\t\t\t\tiX = (tile % tsw) * (tw + gap*2) + gap;;\r\n\t\t\t\t\tiY = ~~(tile / tsw) * (th + gap*2) + gap;\r\n\t\t\t\t\tdraw.context.drawImage(\r\n\t\t\t\t\t\tatlas,\r\n\t\t\t\t\t\tiX - overlay, iY - overlay,\r\n\t\t\t\t\t\trenderWidth, renderHeight,\r\n\t\t\t\t\t\tx * tw - overlay, // target x\r\n\t\t\t\t\t\ty * th - overlay, // target y\r\n\t\t\t\t\t\trenderWidth, renderHeight\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\n// Static methods, created via the Generator class\r\nGenerator.classStaticMatch(Tilemap);\r\nTilemap.prototype.assetType = \"tilemap\";\r\n\r\nexport default Tilemap;\r\n\n\n\n// WEBPACK FOOTER //\n// ./core/js/tilemap.js"],"sourceRoot":""}