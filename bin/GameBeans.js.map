{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///GameBeans.js","webpack:///webpack/bootstrap fe1d84373535c8aa3df1","webpack:///./js/draw.js","webpack:///./js/sprite.js","webpack:///./js/instance.js","webpack:///./js/canvas.js","webpack:///./js/math.js","webpack:///./js/room.js","webpack:///./js/transition.js","webpack:///./js/input.js","webpack:///./js/object.js","webpack:///./js/sound.js","webpack:///./js/camera.js","webpack:///./js/main.js","webpack:///./js/color.js","webpack:///./js/keyvalues.js","webpack:///./js/event.js","webpack:///./js/utils/pool.js","webpack:///./js/global.js","webpack:///./js/data/dataGrid.js","webpack:///./js/tween.js","webpack:///./js/drawing/primitive.js","webpack:///./js/core.js","webpack:///./js/objectVars.js","webpack:///./js/compile.js","webpack:///./js/action.js","webpack:///./js/app.js","webpack:///./js/data.js","webpack:///./js/tilemap.js","webpack:///./js/generator.js"],"names":["root","factory","exports","module","define","amd","self","this","modules","__webpack_require__","moduleId","installedModules","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","_interopRequireDefault","obj","default","_toConsumableArray","arr","Array","isArray","arr2","length","from","value","_math","_math2","_sprite2","_sprite3","draw","color","font","fontSize","textAlign","textBaseline","target","context","defaultTransform","targetStack","imageSmoothing","offsetX","offsetY","setTarget","push","getContext","resetTarget","pop","getTarget","save","restore","reset","_draw$context","imageSmoothingEnabled","setTransform","apply","globalAlpha","setImageSmoothing","enable","transform","scale","x","y","rotate","rot","math","DEGTORAD","translate","setDefault","opt","arguments","undefined","trans","scaleX","skewX","skewY","scaleY","moveX","moveY","setColor","r","g","b","a","h","sprite","spr","index","rotation","ctx","Math","floor","images","frame","img","drawImage","clip","w","originX","originY","width","height","spriteTiled","dx","dy","rx","ry","drawSprite","canvas","setFont","size","align","baseline","text","opts","Number","drawMethod","stroke","strokeStyle","strokeColor","lineWidth","fillStyle","lineLength","drawX","startN","endN","toString","pattern","start","end","lineHeight","measureText","lines","split","maxWidth","words","line","testLine","slice","primitive","textureMap","texture","pts","tris","t","pp","x0","x1","x2","y0","y1","y2","u0","u","u1","u2","v0","v","v1","v2","beginPath","moveTo","lineTo","closePath","delta","delta_a","delta_b","delta_c","delta_d","delta_e","delta_f","shape","options","ellipse","xr","yr","arc","PI","style","healthbar","amount","background","createLinearGradient","addColorStop","fill","rectangle","rect","newSpriteName","aLength","pixelDataTint","data","rgb","_typeof","Symbol","iterator","constructor","_color","_color2","aSprites","names","array","create","atlasIndex","atlas","newSprite","assetType","frames","forEach","addFrame","source","src","image","Image","ready","onload","console","log","cache","document","createElement","setOrigin","readyAll","tint","col","imageData","getImageData","hexToRgb","putImageData","toDataURL","_extends","assign","key","_input","_input2","_object","_object2","_sprite","_draw","_draw2","_compile","_compile2","window","global","aInstances","otherStack","instance","instanceArray","instanceHardLimit","addConsoleText","_GB_stop","inst","pool","objectName","boxCollision","addToArray","updateBoundingBox","updateCollisionBox","executeEvent","depth","splice","createMoving","speed","direction","warn","newInst","find","instNumber","findRandom","randomInt","count","setRotation","relative","setDirection","mouseOn","boxTop","input","mouse","boxBottom","boxLeft","boxRight","step","dt","updateAnimation","updatePosition","instanceExecuteListeners","triggerEvents","event","imageSpeed","behavior","animationBehavior","type","gravVector","lengthDirX","terminal","gravityDirection","lengthDirY","speedX","gravity","speedY","box","top","left","bottom","right","destroy","exists","events","drawSelf","drawDebug","changeSprite","listeners","listener","instanceCollisionInstance","getAllInstances","box1","targ","box2","otherInst","other","actions","executeActions","err","error","executeEventAll","condition","steps","scope","action","flow","func","args","newArgs","compile","actionExpression","stepAll","drawAll","visible","clearDestroyed","release","main","dom","application","crisp2D","setMain","oncontextmenu","e","preventDefault","getElementById","body","appendChild","getMain","clear","fillRect","RADTODEG","cos","sin","sign","min","max","ceil","random","choose","_len","_key","pointDistance","sqrt","pointDirection","atan2","angleDifference","angle1","angle2","diff","_transition","_transition2","_instance","_instance2","_draw3","room","current","newRoom","backgroundMethod","instances","setBackground","rm","addInstance","enter","transition","Transition","prefab","callback","bind","ptrn","createPattern","_classCallCheck","Constructor","TypeError","noop","time","alpha","allInstances","prefabs","update","indexOf","updateAll","fade","_canvas","_canvas2","_keyvalues","_keyvalues2","element","__mouse","pressed","down","released","wheelUp","wheelDown","__keyboard","__touch","held","move","cancel","__triggerEvents","keyboard","touch","init","initMouse","initKeyboard","initTouch","handleMouseDown","button","focus","handleMouseUp","handleMouseMove","canv","getBoundingClientRect","clientX","clientY","handleMouseWheel","wheelDelta","onmousedown","onmouseup","onmousemove","onmousewheel","keyValues","handleKeyDown","code","handleKeyUp","onkeydown","onkeyup","handleTouchStart","handleTouchEnd","handleTouchMove","touches","changedTouches","pageX","pageY","ontouchstart","ontouchend","ontouchcancel","ontouchmove","getTriggerEvents","keys","includes","mouseMap","_event","_objectVars","_objectVars2","_pool","_pool2","objectVars","set","id","Pool","Function","concat","eventAddAction","_len2","_key2","params","addCollisionListener","_loop","currentTime","play","_end","pause","Sound","_this","Audio","test","oncanplaythrough","isEnabled","playSound","paused","cloneNode","onError","soundName","promise","then","onended","loop","onEnd","catch","stop","sound","_room","_room2","Camera","angle","follow","gridLocked","weight","cam","tick","timestamp","requestAnimationFrame","nextTick","lastTick","tickLength","numTicks","fps","last","timeSinceTick","queueUpdates","gameDraw","gameUpdate","camera","handleResizeEvent","_global","_global2","_camera","_camera2","performance","now","host","loc","parent","location","hostname","join","enableMouse","enableKeyboard","enableTouch","hideCursor","cursor","setGameSpeed","addEventListener","hex","result","exec","parseInt","componentToHex","rgbToHex","values","postfix","roomEnter","roomLeave","collision","resize","newConstructor","stack","def","Grid","myGrid","newGrid","_Grid$prototype$get","_Grid$prototype$set","tween","blend","n1","n2","perc","cubicBezier","x3","y3","xa","ya","xb","yb","xc","yc","xm","ym","xn","yn","drawTextured","orderTriangleList","applyModifier","points","modifier","len","drawBasic","orderQuadList","tri","newPoints","newP","format","Primitive","_main","_main2","_sound","_sound2","_event2","_action","newObj","_tween","_tween2","_primitive","basic","JSON","stringify","solid","behaviours","_depth","objectVarsModule","proto","parse","sort","Compiler","exp","isNaN","isBoolean","isFunction","isOperator","isResource","isCss","isString","string","sIndex","newArr","charAt","word","num","isSingleWord","eval","actionSet","varName","actionTest","op","actionSetGravity","actionJump","actionJumpRandom","moveFree","moveDirect","moveSpeedX","moveSpeedY","moveReverseX","moveReverseY","actionWrap","thisRoom","roomW","roomH","actionConfine","actionFunc","runCode","message","actionGet","toFixed","GAME","confirm","alert","confine","wrap","jumpRandom","jump","setGravity","exitEvent","blockEnd","blockBegin","instanceDrawSelf","drawText","drawSetFontSize","drawSetFont","drawSetColor","soundPlay","instanceChangeSprite","instanceSetDirection","instanceSetRotation","instanceDestroy","instanceCreateMoving","instanceCreate","_app","_app2","_data","_data2","_tilemap","_tilemap2","_primitive2","debug","app","Tilemap","setFontSize","snd","setCursor","_dataGrid","_dataGrid2","textureAtlas","tileWidth","tileHeight","tileSpacing","tileOverlay","tilesWide","mapWidth","mapHeight","layers","_generator","_generator2","layer","gap","startX","startY","endX","endY","order","tile","iX","iY","generator","functionFromConstructor","functionFromMethod","method"],"mappings":"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","file":"GameBeans.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"GameBeans\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"GameBeans\"] = factory();\n\telse\n\t\troot[\"GameBeans\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"GameBeans\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"GameBeans\"] = factory();\n\telse\n\t\troot[\"GameBeans\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 20);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _math = __webpack_require__(4);\n\nvar _math2 = _interopRequireDefault(_math);\n\nvar _sprite2 = __webpack_require__(1);\n\nvar _sprite3 = _interopRequireDefault(_sprite2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } } /**\r\n                                                                                                                                                                                                     * @module draw\r\n                                                                                                                                                                                                     */\n\n//\nvar draw = {\n\n\t//\n\tcolor: \"#FFFFFF\",\n\tfont: \"Arial\",\n\tfontSize: 30,\n\ttextAlign: \"start\",\n\ttextBaseline: \"alphabetic\",\n\ttarget: null,\n\tcontext: null,\n\tdefaultTransform: [1, 0, 0, 1, 0, 0],\n\ttargetStack: [],\n\timageSmoothing: false,\n\toffsetX: 0,\n\toffsetY: 0,\n\n\t/**\r\n  *\r\n  */\n\tsetTarget: function setTarget(target) {\n\t\tdraw.targetStack.push(draw.target);\n\t\tdraw.target = target;\n\t\tdraw.context = target.getContext(\"2d\");\n\t},\n\n\t/**\r\n  *\r\n  */\n\tresetTarget: function resetTarget() {\n\t\tvar target = draw.targetStack.pop();\n\t\tdraw.target = target;\n\t\tdraw.context = target.getContext(\"2d\");\n\t},\n\n\t/**\r\n  *\r\n  */\n\tgetTarget: function getTarget() {\n\t\treturn draw.target;\n\t},\n\n\t/**\r\n  *\r\n  */\n\tsave: function save() {\n\t\tdraw.context.save();\n\t},\n\n\t/**\r\n  *\r\n  */\n\trestore: function restore() {\n\t\tdraw.context.restore();\n\t},\n\n\t/**\r\n  *\r\n  */\n\treset: function reset() {\n\t\tvar _draw$context;\n\n\t\tdraw.context.imageSmoothingEnabled = draw.imageSmoothing;\n\t\t(_draw$context = draw.context).setTransform.apply(_draw$context, _toConsumableArray(draw.defaultTransform));\n\t\tdraw.context.globalAlpha = 1;\n\t},\n\n\t/**\r\n  *\r\n  */\n\tsetImageSmoothing: function setImageSmoothing(enable) {\n\t\tdraw.imageSmoothing = enable;\n\t},\n\n\t//\n\ttransform: {\n\n\t\tscale: function scale(x, y) {\n\t\t\tdraw.context.scale(x, y);\n\t\t},\n\n\t\trotate: function rotate(rot) {\n\t\t\tdraw.context.rotate(rot * _math2.default.DEGTORAD);\n\t\t},\n\n\t\ttranslate: function translate(x, y) {\n\t\t\tdraw.offsetX = x;\n\t\t\tdraw.offsetY = y;\n\t\t\tdraw.context.translate(x, y);\n\t\t},\n\n\t\t/**\r\n   * @param {object} opt\r\n   */\n\t\tsetDefault: function setDefault() {\n\t\t\tvar opt = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\n\t\t\tvar trans = draw.defaultTransform;\n\t\t\tif (opt.scaleX) trans[0] = opt.scaleX;\n\t\t\tif (opt.skewX) trans[1] = opt.skewX;\n\t\t\tif (opt.skewY) trans[2] = opt.skewY;\n\t\t\tif (opt.scaleY) trans[3] = opt.scaleY;\n\t\t\tif (opt.moveX) trans[4] = opt.moveX;\n\t\t\tif (opt.moveY) trans[5] = opt.moveY;\n\t\t}\n\n\t},\n\n\t/**\r\n  * @param {color} c Can be a number, a hex-value or an object containing R, G, B and optionally A properties or H, S, L and optionally A properties.\r\n  */\n\tsetColor: function setColor(c) {\n\n\t\t// quick exit if c is already a CSS color value\n\t\tif (typeof c === \"string\") {\n\t\t\tdraw.color = c;\n\t\t}\n\n\t\t// c is an object\n\t\telse {\n\n\t\t\t\t// RGB / RGBA\n\t\t\t\tif (\"r\" in c && \"g\" in c && \"b\" in c) {\n\t\t\t\t\tdraw.color = \"a\" in c ? \"rgba(\" + c.r + \",\" + c.g + \",\" + c.b + \",\" + c.a + \")\" : \"rgb(\" + c.r + \",\" + c.g + \",\" + c.b + \")\";\n\t\t\t\t}\n\n\t\t\t\t// HSL / HSLA\n\t\t\t\telse if (\"h\" in c && \"s\" in c && \"l\" in c) {\n\t\t\t\t\t\tdraw.color = \"a\" in c ? \"hsla(\" + c.h + \",\" + c.s + \"%,\" + c.l + \"%,\" + c.a + \")\" : \"hsl(\" + c.h + \",\" + c.s + \"%,\" + c.l + \"%)\";\n\t\t\t\t\t}\n\t\t\t}\n\t},\n\n\t/**\r\n  * Draws the sprite at the given x, y position.\r\n  * @param {sprite} sprite\r\n  * @param {number} x\r\n  * @param {number} y\r\n  */\n\tsprite: function sprite(spr, index, x, y, scaleX, scaleY, rotation) {\n\n\t\tspr = _sprite3.default.get(spr);\n\n\t\t//\n\t\tvar ctx = draw.context;\n\t\tctx.save();\n\n\t\t//\n\t\tctx.translate(x, y);\n\t\tctx.rotate(rotation * _math2.default.DEGTORAD);\n\t\tctx.scale(scaleX, scaleY);\n\n\t\t//\n\t\tindex = Math.floor(index) % spr.images.length;\n\n\t\t//\n\t\tvar frame = spr.images[index];\n\t\tvar img = frame.img;\n\t\tctx.drawImage(img, frame.clip.x, frame.clip.y, frame.clip.w, frame.clip.h, -spr.originX, -spr.originY, spr.width, spr.height);\n\n\t\t//\n\t\tctx.restore();\n\t},\n\n\t/**\r\n  * Draws the sprite at the given x, y position.\r\n  * @param {sprite} sprite\r\n  * @param {number} x\r\n  * @param {number} y\r\n  * @param {number} w\r\n  * @param {number} h\r\n  */\n\tspriteTiled: function spriteTiled(spr, index, x, y, w, h) {\n\n\t\tspr = _sprite3.default.get(spr);\n\n\t\tvar dx = void 0,\n\t\t    dy = void 0,\n\t\t    rx = void 0,\n\t\t    ry = void 0;\n\t\tfor (rx = 0, dx = x; rx < w; rx++, dx += spr.width) {\n\t\t\tfor (ry = 0, dy = y; ry < h; ry++, dy += spr.height) {\n\t\t\t\tdrawSprite(spr, index, dx, dy, 1, 1, 0);\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\r\n  * Draws a canvas at the given position.\r\n  * @param {canvas} canvas The canvas to draw.\r\n  * @param {number} x The X position to draw at.\r\n  * @param {number} y The Y position to draw at.\r\n  */\n\tcanvas: function canvas(_canvas, x, y) {\n\t\tdraw.context.drawImage(_canvas, x, y);\n\t},\n\n\t/**\r\n  * @param {string} font\r\n  * @param {number} size\r\n  * @param {string} align Horizontal alignment.\r\n  * @param {string} baseline Vertical alignment.\r\n  */\n\tsetFont: function setFont(font, size, align, baseline) {\n\n\t\tdraw.font = font;\n\t\tdraw.fontSize = size;\n\t\tdraw.textAlign = align;\n\t\tdraw.textBaseline = baseline;\n\n\t\tvar ctx = draw.context;\n\t\tctx.font = draw.fontSize + \"px \" + draw.font;\n\t\tctx.textAlign = draw.textAlign;\n\t\tctx.textBaseline = draw.textBaseline;\n\t},\n\n\t/**\r\n  * @param {string} text\r\n  * @param {number} x\r\n  * @param {number} y\r\n  */\n\ttext: function text(_text, x, y) {\n\t\tvar opts = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n\n\n\t\tx = Number(x);\n\t\ty = Number(y);\n\n\t\tvar drawMethod = \"fillText\";\n\t\tvar ctx = draw.context;\n\n\t\t//\n\t\tif (opts.stroke) {\n\t\t\tctx.strokeStyle = opts.strokeColor || draw.color;\n\t\t\tctx.lineWidth = opts.lineWidth || 2;\n\t\t\tdrawMethod = \"strokeText\";\n\t\t} else {\n\t\t\tctx.fillStyle = draw.color;\n\t\t}\n\n\t\t//\n\t\tvar lineLength = void 0;\n\t\tvar drawX = x;\n\t\tvar startN = 0;\n\t\tvar endN = _text.toString().length;\n\t\tif (opts.pattern) {\n\t\t\tstartN = opts.pattern.start;\n\t\t\tendN = opts.pattern.end;\n\t\t}\n\n\t\t//\n\t\tvar lineHeight = ctx.measureText(\"M\").width * 1.2;\n\t\tvar lines = _text.toString().split(\"#\");\n\t\tfor (var i = 0; i < lines.length; i++) {\n\n\t\t\tif (opts.maxWidth) {\n\t\t\t\tvar words = lines[i].split(' ');\n\t\t\t\tvar line = '';\n\n\t\t\t\tfor (var n = 0; n < words.length; n++) {\n\n\t\t\t\t\tvar testLine = line + words[n] + ' ';\n\t\t\t\t\tvar metrics = ctx.measureText(testLine);\n\t\t\t\t\tvar testWidth = metrics.width;\n\t\t\t\t\tif (testWidth > opts.maxWidth && n > 0) {\n\n\t\t\t\t\t\tvar _a = line.slice(0, startN);\n\t\t\t\t\t\tvar _b = line.slice(startN, endN);\n\t\t\t\t\t\tdrawX += ctx.measureText(_a).width;\n\t\t\t\t\t\tif (0 < endN) ctx[drawMethod](_b, drawX, y);\n\t\t\t\t\t\tlineLength = testLine.length;\n\t\t\t\t\t\tstartN -= lineLength;\n\t\t\t\t\t\tendN -= lineLength;\n\n\t\t\t\t\t\tline = words[n] + ' ';\n\t\t\t\t\t\ty += lineHeight;\n\t\t\t\t\t\tdrawX = x;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tline = testLine;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar a = line.slice(0, startN);\n\t\t\t\tvar b = line.slice(startN, endN);\n\t\t\t\tdrawX += ctx.measureText(a).width;\n\t\t\t\tif (0 < endN) ctx[drawMethod](b, drawX, y);\n\t\t\t\tlineLength = line.length;\n\t\t\t} else {\n\n\t\t\t\tvar _a2 = lines[i].slice(0, startN);\n\t\t\t\tvar _b2 = lines[i].slice(startN, endN);\n\t\t\t\tdrawX += ctx.measureText(_a2).width;\n\t\t\t\tctx[drawMethod](_b2, drawX, y);\n\t\t\t\tlineLength = lines[i].length;\n\t\t\t}\n\n\t\t\tdrawX = x;\n\t\t\ty += lineHeight;\n\t\t\tstartN -= lineLength;\n\t\t\tendN -= lineLength;\n\t\t}\n\t},\n\n\t/**\r\n  *\r\n  */\n\tprimitive: {\n\n\t\ttextureMap: function textureMap(texture, pts) {\n\n\t\t\tvar ctx = draw.context;\n\t\t\tvar spr = _sprite3.default.get(texture);\n\t\t\tvar frame = spr.images[0];\n\t\t\tvar img = frame.img;\n\t\t\tvar w = spr.width;\n\t\t\tvar h = spr.height;\n\n\t\t\tvar tris = [[0, 1, 2], [2, 3, 0]]; // Split in two triangles\n\t\t\tfor (var t = 0; t < 2; t++) {\n\t\t\t\tvar pp = tris[t];\n\t\t\t\tvar x0 = pts[pp[0]].x,\n\t\t\t\t    x1 = pts[pp[1]].x,\n\t\t\t\t    x2 = pts[pp[2]].x;\n\t\t\t\tvar y0 = pts[pp[0]].y,\n\t\t\t\t    y1 = pts[pp[1]].y,\n\t\t\t\t    y2 = pts[pp[2]].y;\n\t\t\t\tvar u0 = pts[pp[0]].u * w,\n\t\t\t\t    u1 = pts[pp[1]].u * w,\n\t\t\t\t    u2 = pts[pp[2]].u * w;\n\t\t\t\tvar v0 = pts[pp[0]].v * h,\n\t\t\t\t    v1 = pts[pp[1]].v * h,\n\t\t\t\t    v2 = pts[pp[2]].v * h;\n\n\t\t\t\t// Set clipping area so that only pixels inside the triangle will\n\t\t\t\t// be affected by the image drawing operation\n\t\t\t\tctx.save();\n\t\t\t\tctx.beginPath();\n\t\t\t\tctx.moveTo(x0, y0);\n\t\t\t\tctx.lineTo(x1, y1);\n\t\t\t\tctx.lineTo(x2, y2);\n\t\t\t\tctx.closePath();\n\t\t\t\tctx.clip();\n\n\t\t\t\t// Compute matrix transform\n\t\t\t\tvar delta = u0 * v1 + v0 * u2 + u1 * v2 - v1 * u2 - v0 * u1 - u0 * v2;\n\t\t\t\tvar delta_a = x0 * v1 + v0 * x2 + x1 * v2 - v1 * x2 - v0 * x1 - x0 * v2;\n\t\t\t\tvar delta_b = u0 * x1 + x0 * u2 + u1 * x2 - x1 * u2 - x0 * u1 - u0 * x2;\n\t\t\t\tvar delta_c = u0 * v1 * x2 + v0 * x1 * u2 + x0 * u1 * v2 - x0 * v1 * u2 - v0 * u1 * x2 - u0 * x1 * v2;\n\t\t\t\tvar delta_d = y0 * v1 + v0 * y2 + y1 * v2 - v1 * y2 - v0 * y1 - y0 * v2;\n\t\t\t\tvar delta_e = u0 * y1 + y0 * u2 + u1 * y2 - y1 * u2 - y0 * u1 - u0 * y2;\n\t\t\t\tvar delta_f = u0 * v1 * y2 + v0 * y1 * u2 + y0 * u1 * v2 - y0 * v1 * u2 - v0 * u1 * y2 - u0 * y1 * v2;\n\n\t\t\t\t// Draw the transformed image\n\t\t\t\tctx.transform(delta_a / delta, delta_d / delta, delta_b / delta, delta_e / delta, delta_c / delta, delta_f / delta);\n\t\t\t\tctx.drawImage(img, 0, 0);\n\t\t\t\tctx.restore();\n\t\t\t}\n\t\t}\n\n\t},\n\n\t/**\r\n  *\r\n  */\n\tshape: {\n\n\t\t/**\r\n   * @param {number} x1\r\n   * @param {number} y1\r\n   * @param {number} x2\r\n   * @param {number} y2\r\n   * @param {object} options\r\n   */\n\t\tline: function line(x1, y1, x2, y2) {\n\t\t\tvar options = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n\n\n\t\t\tvar ctx = draw.context;\n\t\t\tctx.strokeStyle = options.color || draw.color;\n\t\t\tctx.beginPath();\n\t\t\tctx.moveTo(x1, y1);\n\t\t\tctx.lineTo(x2, y2);\n\t\t\tctx.stroke();\n\t\t},\n\n\t\t/**\r\n   * @param {number} x1\r\n   * @param {number} y1\r\n   * @param {number} x2\r\n   * @param {number} y2\r\n   * @param {object} options\r\n   */\n\t\tellipse: function ellipse(x, y, xr, yr) {\n\t\t\tvar opts = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n\n\n\t\t\t//\n\t\t\tvar ctx = draw.context;\n\t\t\tctx.save();\n\t\t\tctx.beginPath();\n\t\t\tctx.translate(x - xr, y - yr);\n\t\t\tctx.scale(xr, yr);\n\t\t\tctx.arc(1, 1, 1, 0, 2 * Math.PI, false);\n\t\t\tctx.restore();\n\n\t\t\t//\n\t\t\tvar style = void 0;\n\t\t\tif (opts.healthbar) {\n\t\t\t\tvar amount = opts.healthbar.amount || 1;\n\t\t\t\tvar color = opts.healthbar.color || \"#0F0\";\n\t\t\t\tvar background = opts.healthbar.background || \"#F00\";\n\t\t\t\tstyle = ctx.createLinearGradient(x - xr, 0, x + xr, 0);\n\t\t\t\tstyle.addColorStop(0, color);\n\t\t\t\tstyle.addColorStop(amount, color);\n\t\t\t\tstyle.addColorStop(amount, background);\n\t\t\t\tstyle.addColorStop(1, background);\n\t\t\t} else {\n\t\t\t\tstyle = opts.color || draw.color;\n\t\t\t}\n\n\t\t\t//\n\t\t\tif (!opts.fill && !opts.stroke) opts.fill = true;\n\n\t\t\t//\n\t\t\tif (opts.fill) {\n\t\t\t\tctx.fillStyle = style;\n\t\t\t\tctx.fill();\n\t\t\t}\n\n\t\t\tif (opts.stroke) {\n\t\t\t\tctx.strokeStyle = style;\n\t\t\t\tctx.lineWidth = opts.lineWidth || 1;\n\t\t\t\tctx.stroke();\n\t\t\t}\n\t\t},\n\n\t\t/**\r\n   * @param {number} x\r\n   * @param {number} y\r\n   * @param {number} w\r\n   * @param {number} h\r\n   * @param {object} options\r\n   */\n\t\trectangle: function rectangle(x, y, w, h) {\n\t\t\tvar options = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n\n\n\t\t\t//\n\t\t\tvar ctx = draw.context;\n\t\t\tctx.beginPath();\n\t\t\tctx.rect(x, y, w, h);\n\n\t\t\t//\n\t\t\tvar style = void 0;\n\t\t\tif (options.healthbar) {\n\t\t\t\tvar amount = options.healthbar.amount || 1;\n\t\t\t\tvar color = options.healthbar.color || \"#0F0\";\n\t\t\t\tvar background = options.healthbar.background || \"#F00\";\n\t\t\t\tstyle = ctx.createLinearGradient(x, 0, x + w, 0);\n\t\t\t\tstyle.addColorStop(0, color);\n\t\t\t\tstyle.addColorStop(amount, color);\n\t\t\t\tstyle.addColorStop(amount, background);\n\t\t\t\tstyle.addColorStop(1, background);\n\t\t\t} else {\n\t\t\t\tstyle = options.color || draw.color;\n\t\t\t}\n\n\t\t\t//\n\t\t\tif (!opts.fill && !opts.stroke) opts.fill = true;\n\n\t\t\t//\n\t\t\tif (options.fill) {\n\t\t\t\tctx.fillStyle = style;\n\t\t\t\tctx.fill();\n\t\t\t}\n\n\t\t\tif (opts.stroke) {\n\t\t\t\tctx.strokeStyle = style;\n\t\t\t\tctx.lineWidth = options.lineWidth || 1;\n\t\t\t\tctx.stroke();\n\t\t\t}\n\t\t}\n\n\t}\n\n\t//\n};exports.default = draw;\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; /**\r\n                                                                                                                                                                                                                                                                               * @module sprite\r\n                                                                                                                                                                                                                                                                               */\n\n//\n\n\nvar _color = __webpack_require__(12);\n\nvar _color2 = _interopRequireDefault(_color);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//\nvar aSprites = [],\n    aLength = 0;\n\n/**\r\n *\r\n */\nvar sprite = {\n\n\t//\n\tnames: [],\n\tarray: aSprites,\n\n\t/**\r\n  *\r\n  */\n\tcreate: function create() {\n\t\tvar options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\n\t\t//\n\t\tvar atlas = void 0,\n\t\t    atlasIndex = void 0;\n\t\tif (options.atlas) {\n\t\t\tatlasIndex = options.atlasIndex || 0;\n\t\t\tatlas = options.atlas.images[atlasIndex];\n\t\t}\n\n\t\t//\n\t\tvar newSprite = {\n\t\t\tassetType: \"sprite\",\n\t\t\tname: options.name || newSpriteName(),\n\t\t\toriginX: options.originX || 0,\n\t\t\toriginY: options.originY || 0,\n\t\t\twidth: 0,\n\t\t\theight: 0,\n\t\t\timages: []\n\n\t\t\t//\n\t\t};if (options.frames) {\n\t\t\toptions.frames.forEach(function (frame) {\n\t\t\t\tsprite.addFrame(newSprite, {\n\t\t\t\t\tsource: frame.src\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\t//\n\t\tsprite.names[aLength] = newSprite.name;\n\t\taSprites[aLength++] = newSprite;\n\t\treturn newSprite;\n\t},\n\n\t/**\r\n  *\r\n  */\n\taddFrame: function addFrame(spr) {\n\t\tvar options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n\n\t\tspr = sprite.get(spr);\n\n\t\t//\n\t\tvar atlas = void 0;\n\t\tif (options.atlas) {\n\t\t\tatlas = sprite.get(options.atlas).images[0].img;\n\t\t}\n\n\t\tvar image = {\n\t\t\timg: atlas || new Image(),\n\t\t\tclip: null,\n\t\t\tready: false\n\n\t\t\t//\n\t\t};if (options.source) {\n\n\t\t\timage.img.onload = function () {\n\n\t\t\t\t//\n\t\t\t\timage.clip = {\n\t\t\t\t\tx: 0,\n\t\t\t\t\ty: 0,\n\t\t\t\t\tw: image.img.width,\n\t\t\t\t\th: image.img.height\n\n\t\t\t\t\t//\n\t\t\t\t};if (spr.width * spr.height === 0) {\n\t\t\t\t\tspr.width = image.clip.w;\n\t\t\t\t\tspr.height = image.clip.h;\n\t\t\t\t}\n\n\t\t\t\t//\n\t\t\t\timage.ready = true;\n\t\t\t};\n\t\t\timage.img.src = options.source || \"\";\n\t\t}\n\n\t\t//\n\t\tif (atlas && options.clip) {\n\n\t\t\t//\n\t\t\timage.clip = options.clip;\n\t\t\tconsole.log(image.clip);\n\n\t\t\t//\n\t\t\tif (spr.width * spr.height === 0) {\n\t\t\t\tspr.width = image.clip.w;\n\t\t\t\tspr.height = image.clip.h;\n\t\t\t}\n\n\t\t\t//\n\t\t\timage.ready = true;\n\t\t}\n\n\t\t//\n\t\tspr.images.push(image);\n\t},\n\n\t/**\r\n  *\r\n  */\n\tcache: function cache(spr) {\n\t\tvar options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n\n\t\tspr = sprite.get(spr);\n\t\tspr.images.forEach(function (frame) {\n\t\t\tvar canvas = document.createElement(\"CANVAS\");\n\t\t\tcanvas.width = options.width || frame.img.width;\n\t\t\tcanvas.height = options.height || frame.img.height;\n\t\t\tvar ctx = canvas.getContext(\"2d\");\n\t\t\tctx.drawImage(frame.img, 0, 0, canvas.width + 1, canvas.height + 1);\n\n\t\t\tframe.clip.x = 0;\n\t\t\tframe.clip.y = 0;\n\t\t\tframe.clip.w = canvas.width;\n\t\t\tframe.clip.h = canvas.height;\n\t\t\tframe.img = canvas;\n\t\t});\n\t},\n\n\t/**\r\n  *\r\n  */\n\tsetOrigin: function setOrigin(spr, x, y) {\n\n\t\tspr = sprite.get(spr);\n\t\tspr.originX = Number(x);\n\t\tspr.originY = Number(y);\n\t},\n\n\t/**\r\n  *\r\n  */\n\treadyAll: function readyAll() {\n\n\t\tfor (var n = 0; n < aLength; n++) {\n\t\t\tvar spr = aSprites[n];\n\t\t\tfor (var i = 0; i < spr.images.length; i++) {\n\t\t\t\tvar image = spr.images[i];\n\t\t\t\tif (!image.ready) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t},\n\n\t/**\r\n  *\r\n  */\n\ttint: function tint(spr, col) {\n\n\t\tif ((typeof spr === \"undefined\" ? \"undefined\" : _typeof(spr)) !== \"object\") spr = sprite.get(spr);\n\n\t\t//\n\t\tspr.images.forEach(function (image) {\n\n\t\t\t// create canvas, draw image\n\t\t\tvar canvas = document.createElement(\"CANVAS\");\n\t\t\tvar ctx = canvas.getContext(\"2d\");\n\t\t\tcanvas.width = spr.width;\n\t\t\tcanvas.height = spr.height;\n\t\t\tctx.drawImage(image.img, 0, 0);\n\n\t\t\t// get data, do thing, put data back\n\t\t\tvar imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n\t\t\tpixelDataTint(imageData.data, (typeof col === \"undefined\" ? \"undefined\" : _typeof(col)) === \"object\" ? col : _color2.default.hexToRgb(col));\n\t\t\tctx.putImageData(imageData, 0, 0);\n\n\t\t\t//\n\t\t\timage.img.src = canvas.toDataURL(\"image/png\");\n\t\t});\n\t},\n\n\t/**\r\n  *\r\n  */\n\tget: function get(name) {\n\n\t\tif ((typeof name === \"undefined\" ? \"undefined\" : _typeof(name)) === \"object\") return name;\n\n\t\tfor (var n = 0; n < aLength; n++) {\n\t\t\tif (aSprites[n].name === name) return aSprites[n];\n\t\t}return null;\n\t}\n\n\t/**\r\n  *\r\n  */\n};function newSpriteName() {\n\treturn \"Sprite_\" + aLength;\n}\n\n/**\r\n *\r\n */\nfunction pixelDataTint(data, rgb) {\n\n\t// cache as much as possible, there could be a lot of pixels\n\tvar l = data.length,\n\t    r = rgb.r / 255,\n\t    g = rgb.g / 255,\n\t    b = rgb.b / 255;\n\n\t//\n\tfor (var i = 0; i < l; i += 4) {\n\t\tdata[i] = r * data[i] >> 0;\n\t\tdata[i + 1] = g * data[i + 1] >> 0;\n\t\tdata[i + 2] = b * data[i + 2] >> 0;\n\t}\n}\n\n//\nexports.default = sprite;\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; /**\r\n                                                                                                                                                                                                                                                                   * @module instances\r\n                                                                                                                                                                                                                                                                   */\n\nvar _math = __webpack_require__(4);\n\nvar _math2 = _interopRequireDefault(_math);\n\nvar _input = __webpack_require__(7);\n\nvar _input2 = _interopRequireDefault(_input);\n\nvar _object = __webpack_require__(8);\n\nvar _object2 = _interopRequireDefault(_object);\n\nvar _sprite = __webpack_require__(1);\n\nvar _sprite2 = _interopRequireDefault(_sprite);\n\nvar _draw = __webpack_require__(0);\n\nvar _draw2 = _interopRequireDefault(_draw);\n\nvar _compile = __webpack_require__(22);\n\nvar _compile2 = _interopRequireDefault(_compile);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//\nwindow.global = {};\nvar aInstances = [];\nvar otherStack = [];\n\n//\nvar instance = {\n\n\t//\n\tinstanceArray: aInstances,\n\tinstanceHardLimit: 1000,\n\n\t/**\r\n  * @param {object} obj\r\n  * @param {number} x\r\n  * @param {number} y\r\n  */\n\tcreate: function create(obj, x, y) {\n\n\t\t//\n\t\tvar o = _object2.default.get(obj);\n\t\tif (o === null) {\n\t\t\twindow.addConsoleText(\"#F00\", \"No such object as \" + obj);\n\t\t\twindow._GB_stop();\n\t\t\treturn null;\n\t\t}\n\n\t\tvar inst = o.pool.get();\n\t\tinst.object = o;\n\t\tinst.objectName = o.objectName;\n\t\tinst.assetType = \"instance\";\n\t\tinst.x = Number(x);\n\t\tinst.y = Number(y);\n\t\tinst.boxCollision = _extends({}, inst.boxCollision);\n\n\t\t//\n\t\tvar spr = _sprite2.default.get(inst.sprite);\n\t\tif (spr) {\n\t\t\tinst.boxCollision.x = spr.originX;\n\t\t\tinst.boxCollision.y = spr.originY;\n\t\t\tinst.boxCollision.width = spr.width;\n\t\t\tinst.boxCollision.height = spr.height;\n\t\t}\n\n\t\t//\n\t\tinstance.addToArray(inst);\n\t\tinstance.updateBoundingBox(inst);\n\t\tinstance.updateCollisionBox(inst);\n\t\tinstance.executeEvent(inst, \"create\");\n\n\t\t//\n\t\treturn inst;\n\t},\n\n\t/**\r\n  *\r\n  */\n\taddToArray: function addToArray(inst) {\n\n\t\tfor (var i = 0; i < aInstances.length; i++) {\n\t\t\tif (inst.depth <= aInstances[i].depth) {\n\t\t\t\taInstances.splice(i, 0, inst);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\taInstances.push(inst);\n\t},\n\n\t/**\r\n  * @param {object} obj\r\n  * @param {number} x\r\n  * @param {number} y\r\n  * @param {number} speed\r\n  * @param {number} direction\r\n  */\n\tcreateMoving: function createMoving(obj, x, y, speed, direction) {\n\n\t\tif (aInstances.length >= instance.instanceHardLimit) {\n\t\t\tconsole.warn(\"instance number hard limit reached:\", instance.instanceHardLimit);\n\t\t\treturn;\n\t\t}\n\n\t\tvar newInst = instance.create(obj, x, y);\n\t\tnewInst.speed = speed;\n\t\tnewInst.direction = direction;\n\t\treturn newInst;\n\t},\n\n\t/**\r\n  *\r\n  */\n\tfind: function find(objectName, instNumber) {\n\n\t\tvar n = void 0,\n\t\t    c = 0;\n\t\tfor (n = 0; n < aInstances.length; n++) {\n\t\t\tvar inst = instance.instanceArray[n];\n\t\t\tif (inst.objectName === objectName) {\n\t\t\t\tif (c++ === instNumber) return inst;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t},\n\n\t/**\r\n  *\r\n  */\n\tfindRandom: function findRandom(name) {\n\n\t\tvar n = void 0,\n\t\t    c = 0,\n\t\t    instNumber = _math2.default.randomInt(0, count(name) - 1);\n\t\tfor (n = 0; n < instance.instanceArray.length; n++) {\n\t\t\tvar inst = instance.instanceArray[n];\n\t\t\tif (inst.objectName === name) {\n\t\t\t\tif (c++ === instNumber) return inst;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t},\n\n\t/**\r\n  *\r\n  */\n\tcount: function count(objectName) {\n\n\t\tvar n = void 0,\n\t\t    c = 0;\n\t\tinstance.instanceArray.forEach(function (inst) {\n\t\t\tc += inst.objectName === objectName;\n\t\t});\n\t\treturn c;\n\t},\n\n\t/**\r\n  * @param {number} rotation\r\n  * @param {boolean} relative\r\n  */\n\tsetRotation: function setRotation(rotation, relative) {\n\t\tthis.rotation = relative ? this.rotation + rotation : rotation;\n\t},\n\n\t/**\r\n  * @param {number} rotation\r\n  * @param {boolean} relative\r\n  */\n\tsetDirection: function setDirection(direction, relative) {\n\t\tthis.direction = relative ? this.direction + direction : direction;\n\t},\n\n\t/**\r\n  * @param {object} inst\r\n  */\n\tmouseOn: function mouseOn(inst) {\n\n\t\treturn !(inst.boxTop > _input2.default.mouse.y / 2 - _draw2.default.offsetY || inst.boxBottom < _input2.default.mouse.y / 2 - _draw2.default.offsetY || inst.boxLeft > _input2.default.mouse.x / 2 - _draw2.default.offsetX || inst.boxRight < _input2.default.mouse.x / 2 - _draw2.default.offsetX);\n\t},\n\n\t/**\r\n  * @param {instance} inst\r\n  */\n\tstep: function step(inst, dt) {\n\n\t\t// step events\n\t\tinstance.executeEvent(inst, \"step\");\n\t\tinstance.updateAnimation(inst, dt);\n\t\tinstance.updatePosition(inst, dt);\n\t\tinstance.updateBoundingBox(inst);\n\t\tinstance.updateCollisionBox(inst);\n\n\t\t// collision events\n\t\tinstance.instanceExecuteListeners(inst);\n\n\t\t// input events\n\t\t_input2.default.triggerEvents.forEach(function (event) {\n\t\t\tinstance.executeEvent(inst, event);\n\t\t});\n\t},\n\n\t/**\r\n  *\r\n  */\n\tupdateAnimation: function updateAnimation(inst, dt) {\n\n\t\tinst.index += inst.imageSpeed;\n\t\tvar spr = _sprite2.default.get(inst.sprite);\n\t\tif (spr) {\n\t\t\tvar length = spr.images.length;\n\t\t\tif (inst.index >= length) {\n\n\t\t\t\tvar behavior = inst.animationBehavior;\n\t\t\t\tvar type = typeof behavior === \"undefined\" ? \"undefined\" : _typeof(behavior);\n\n\t\t\t\t//\n\t\t\t\tif (type === \"string\") {\n\n\t\t\t\t\t//\n\t\t\t\t\tif (behavior === \"loop\") {\n\t\t\t\t\t\tinst.index -= length;\n\t\t\t\t\t}\n\n\t\t\t\t\t//\n\t\t\t\t\telse if (behavior === \"stop\") {\n\t\t\t\t\t\t\tinst.index = length - 1;\n\t\t\t\t\t\t\tinst.imageSpeed = 0;\n\t\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t//\n\t\t\t\telse if (type === \"function\") {\n\t\t\t\t\t\tbehavior.call(inst);\n\t\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\r\n  *\r\n  */\n\tupdatePosition: function updatePosition(inst, dt) {\n\n\t\t// if the instance is already falling at terminal velocity then we no longer apply gravity\n\t\tvar gravVector = {\n\t\t\tx: _math2.default.lengthDirX(inst.terminal, inst.gravityDirection),\n\t\t\ty: _math2.default.lengthDirY(inst.terminal, inst.gravityDirection)\n\t\t};\n\n\t\tif (gravVector.x > 0 && inst.speedX <= gravVector.x || gravVector.x < 0 && inst.speedX >= gravVector.x) {\n\t\t\tinst.speedX += _math2.default.lengthDirX(inst.gravity, inst.gravityDirection);\n\t\t}\n\n\t\tif (gravVector.y > 0 && inst.speedY <= gravVector.y || gravVector.y < 0 && inst.speedY >= gravVector.y) {\n\t\t\tinst.speedY += _math2.default.lengthDirY(inst.gravity, inst.gravityDirection);\n\t\t}\n\n\t\t// move instance\n\t\tinst.x += inst.speedX * dt;\n\t\tinst.y += inst.speedY * dt;\n\t},\n\n\t/**\r\n  * @param {object} inst\r\n  */\n\tupdateBoundingBox: function updateBoundingBox(inst) {\n\n\t\tvar spr = _sprite2.default.get(inst.sprite);\n\t\tif (spr !== null) {\n\t\t\tinst.boxTop = inst.y - spr.originY * inst.scaleY;\n\t\t\tinst.boxLeft = inst.x - spr.originX * inst.scaleX;\n\t\t\tinst.boxBottom = inst.boxTop + spr.height * inst.scaleY;\n\t\t\tinst.boxRight = inst.boxLeft + spr.width * inst.scaleX;\n\t\t}\n\t},\n\n\t/**\r\n  * @param {object} inst\r\n  */\n\tupdateCollisionBox: function updateCollisionBox(inst) {\n\n\t\tvar box = inst.boxCollision;\n\t\tbox.top = inst.y - box.y * inst.scaleY;\n\t\tbox.left = inst.x - box.x * inst.scaleX;\n\t\tbox.bottom = box.top + box.height * inst.scaleY;\n\t\tbox.right = box.left + box.width * inst.scaleX;\n\t},\n\n\t/**\r\n  *\r\n  */\n\tdestroy: function destroy(inst) {\n\t\tvar ev = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n\n\n\t\tinst.exists = false;\n\t},\n\n\t/**\r\n  *\r\n  */\n\tdraw: function draw(inst) {\n\t\tinst.events[\"draw\"] !== undefined ? instance.executeEvent(inst, \"draw\") : instance.drawSelf(inst);\n\t},\n\n\t/**\r\n  *\r\n  */\n\tdrawSelf: function drawSelf(inst) {\n\t\tif (inst.sprite !== null) _draw2.default.sprite(inst.sprite, inst.index, inst.x, inst.y, inst.scaleX, inst.scaleY, inst.rotation);\n\t},\n\n\t/**\r\n  *\r\n  */\n\tdrawDebug: function drawDebug(inst) {\n\t\tvar box = inst.boxCollision;\n\t\t_draw2.default.shape.rectangle(box.left, box.top, box.right - box.left, box.bottom - box.top, {\n\t\t\tcolor: \"#FF000055\"\n\t\t});\n\t},\n\n\t/**\r\n  * @param {object} sprite\r\n  */\n\tchangeSprite: function changeSprite(sprite) {\n\t\tthis.sprite = sprite;\n\t},\n\n\t/**\r\n  * @param {object} inst\r\n  */\n\tinstanceExecuteListeners: function instanceExecuteListeners(inst) {\n\n\t\tinst.listeners.forEach(function (listener) {\n\t\t\tswitch (listener.type) {\n\n\t\t\t\tcase \"collision\":\n\t\t\t\t\tinstance.instanceCollisionInstance(inst, listener.target);\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\t\t});\n\t},\n\n\t/**\r\n  *\r\n  */\n\tinstanceCollisionInstance: function instanceCollisionInstance(inst, target) {\n\n\t\tvar arr = _object2.default.getAllInstances(target);\n\t\tvar box1 = inst.boxCollision;\n\t\tarr.forEach(function (targ) {\n\n\t\t\t// same instance\n\t\t\tif (inst === targ) return;\n\n\t\t\t// no collision\n\t\t\tvar box2 = targ.boxCollision;\n\t\t\tif (box1.left > box2.right || box1.right < box2.left || box1.top > box2.bottom || box1.bottom < box2.top) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// execute collision event\n\t\t\tinstance.executeEvent(inst, \"collision_\" + target, targ);\n\t\t});\n\t},\n\n\t/**\r\n  * @param {instance} inst\r\n  * @param {event} event\r\n  * @param {instance} otherInst The other instance, in collisions for example.\r\n  */\n\texecuteEvent: function executeEvent(inst, event, otherInst) {\n\n\t\t// set the current \"other\" instance\n\t\totherStack.push(window.other);\n\t\twindow.other = otherInst;\n\n\t\t//\n\t\ttry {\n\n\t\t\tif (inst.exists) {\n\t\t\t\tvar actions = inst.events[event];\n\t\t\t\tif (actions) {\n\t\t\t\t\tinstance.executeActions(inst, actions, otherInst);\n\t\t\t\t}\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tconsole.error(err);\n\t\t\twindow.addConsoleText(\"#F00\", \"Failed to execute event [\" + event + \"]\" + \" of object [\" + inst.objectName + \"]\" + \" with error: \" + err);\n\t\t}\n\n\t\t// restore previous \"other\" instance\n\t\twindow.other = otherStack.pop();\n\t},\n\n\t/**\r\n  *\r\n  */\n\texecuteEventAll: function executeEventAll(event, otherInst) {\n\t\tfor (var n = 0; n < aInstances.length; n++) {\n\t\t\tinstance.executeEvent(aInstances[n], event, otherInst);\n\t\t}\n\t},\n\n\t/**\r\n  *\r\n  */\n\texecuteActions: function executeActions(inst, actions, otherInst) {\n\n\t\tvar condition = true,\n\t\t    steps = [],\n\t\t    scope = 0,\n\t\t    a = void 0,\n\t\t    action = void 0;\n\n\t\tfor (a = 0; a < actions.length; a++) {\n\n\t\t\taction = actions[a];\n\t\t\tswitch (action.flow) {\n\n\t\t\t\t// regular action\n\t\t\t\tcase \"\":\n\n\t\t\t\t\tif (condition) {\n\t\t\t\t\t\tvar func = action.action,\n\t\t\t\t\t\t    args = action.args,\n\t\t\t\t\t\t    n = void 0,\n\t\t\t\t\t\t    newArgs = [];\n\n\t\t\t\t\t\t//console.log(args);\n\t\t\t\t\t\tfor (n = 0; n < args.length; n++) {\n\t\t\t\t\t\t\tswitch (args[n]) {\n\t\t\t\t\t\t\t\tcase \"self\":\n\t\t\t\t\t\t\t\t\tnewArgs[n] = inst;break;\n\t\t\t\t\t\t\t\tcase \"other\":\n\t\t\t\t\t\t\t\t\tnewArgs[n] = otherInst;break;\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\tnewArgs[n] = _compile2.default.actionExpression.call(inst, args[n]);break;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcondition = func.apply(inst, newArgs);\n\t\t\t\t\t\tcondition === undefined ? condition = true : steps[scope] = 0;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\t// control actions\n\t\t\t\tcase \"blockBegin\":\n\t\t\t\t\tscope++;break;\n\t\t\t\tcase \"blockEnd\":\n\t\t\t\t\tscope--;break;\n\t\t\t\tcase \"exitEvent\":\n\t\t\t\t\tif (condition) return false;break;\n\n\t\t\t}\n\n\t\t\t// exit from a single statement after an expression not contained in a block\n\t\t\tif (steps[scope]++ === 1) condition = true;\n\t\t}\n\t},\n\n\t/**\r\n  * @param {number} dt Delta time.\r\n  */\n\tstepAll: function stepAll(dt) {\n\n\t\taInstances.forEach(function (i) {\n\t\t\tinstance.step(i, dt);\n\t\t});\n\t},\n\n\t/**\r\n  *\r\n  */\n\tdrawAll: function drawAll() {\n\n\t\taInstances.forEach(function (inst) {\n\t\t\tinst.visible && instance.draw(inst);\n\t\t});\n\t},\n\n\t/**\r\n  *\r\n  */\n\tclearDestroyed: function clearDestroyed() {\n\n\t\tfor (var n = aInstances.length - 1; n >= 0; n--) {\n\t\t\tvar i = aInstances[n];\n\t\t\tif (!i.exists) {\n\t\t\t\ti.exists = true;\n\t\t\t\ti.speedX = 0;\n\t\t\t\ti.speedY = 0;\n\t\t\t\ti.object.pool.release(i);\n\t\t\t\taInstances.splice(n, 1);\n\t\t\t}\n\t\t}\n\t}\n\n};\n\nexports.default = instance;\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _draw = __webpack_require__(0);\n\nvar _draw2 = _interopRequireDefault(_draw);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//\nvar canvas = {\n\n\t//\n\tarray: [],\n\tmain: null,\n\tdom: null,\n\n\t/**\r\n  *\r\n  */\n\tcreate: function create() {\n\t\tvar options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\n\t\t//\n\t\tvar c = document.createElement(\"CANVAS\");\n\t\tcanvas.array.push(c);\n\n\t\t//\n\t\tc.width = options.width || 300;\n\t\tc.height = options.height || 150;\n\t\tc.scale = options.scale || 1;\n\t\tc.application = options.application || false;\n\n\t\t//\n\t\tif (options.crisp2D) {\n\t\t\tvar ctx = c.getContext(\"2d\");\n\t\t\tctx.imageSmoothingEnabled = false;\n\t\t\t//ctx.scale( c.scale, c.scale );\n\t\t}\n\n\t\t//\n\t\tif (c.application) {\n\t\t\t_draw2.default.setTarget(c);\n\t\t\tcanvas.setMain(c);\n\t\t}\n\n\t\t//\n\t\tc.oncontextmenu = function (e) {\n\t\t\te.preventDefault();\n\t\t};\n\n\t\t//\n\t\treturn c;\n\t},\n\n\t/**\r\n  *\r\n  */\n\tsetMain: function setMain(c) {\n\n\t\tcanvas.main = c;\n\t\tif (canvas.dom === null) {\n\t\t\tcanvas.dom = c;\n\t\t\tvar el = document.getElementById(\"gbgamebox\") || document.body;\n\t\t\tel.appendChild(c);\n\t\t}\n\t},\n\n\t/**\r\n  *\r\n  */\n\tgetMain: function getMain() {\n\t\treturn canvas.main;\n\t},\n\n\t/**\r\n  *\r\n  */\n\tclear: function clear(c, color) {\n\t\tvar ctx = c.getContext(\"2d\");\n\t\tctx.fillStyle = color || \"#000000\";\n\t\tctx.fillRect(0, 0, c.width / c.scale, c.height / c.scale);\n\t}\n\n\t//\n}; /**\r\n    * @module canvas\r\n    */\n\n//\nexports.default = canvas;\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n/**\r\n * @module math\r\n */\n\nvar math = {\n\n\t// constances\n\tPI: Math.PI,\n\tRADTODEG: 180 / Math.PI,\n\tDEGTORAD: Math.PI / 180,\n\n\t// copied functions\n\tcos: Math.cos,\n\tsin: Math.sin,\n\tsign: Math.sign,\n\n\t/**\r\n  *\r\n  */\n\trandomInt: function randomInt(min, max) {\n\t\tmin = Math.ceil(min);\n\t\tmax = Math.floor(max);\n\t\treturn Math.floor(Math.random() * (max - min + 1)) + min;\n\t},\n\n\t/**\r\n  *\r\n  */\n\tchoose: function choose() {\n\t\tfor (var _len = arguments.length, value = Array(_len), _key = 0; _key < _len; _key++) {\n\t\t\tvalue[_key] = arguments[_key];\n\t\t}\n\n\t\treturn value[Math.floor(Math.random() * value.length)];\n\t},\n\n\t/**\r\n  *\r\n  */\n\tlengthDirX: function lengthDirX(l, d) {\n\t\treturn Math.cos(d * math.DEGTORAD) * l;\n\t},\n\n\t/**\r\n  *\r\n  */\n\tlengthDirY: function lengthDirY(l, d) {\n\t\treturn Math.sin(d * math.DEGTORAD) * l;\n\t},\n\n\t/**\r\n  * @param {number} x1\r\n  * @param {number} y1\r\n  * @param {number} x2\r\n  * @param {number} y2\r\n  */\n\tpointDistance: function pointDistance(x1, y1, x2, y2) {\n\t\tvar a = x1 - x2,\n\t\t    b = y1 - y2;\n\t\treturn Math.sqrt(a * a + b * b);\n\t},\n\n\t/**\r\n  * @param {number} x1\r\n  * @param {number} y1\r\n  * @param {number} x2\r\n  * @param {number} y2\r\n  */\n\tpointDirection: function pointDirection(x1, y1, x2, y2) {\n\t\treturn (Math.atan2(y2 - y1, x2 - x1) * math.RADTODEG + 360) % 360;\n\t},\n\n\t/**\r\n  *\r\n  */\n\tangleDifference: function angleDifference(angle1, angle2) {\n\n\t\tvar diff = (angle2 - angle1) % 360;\n\n\t\tif (diff <= -180) {\n\t\t\tdiff += 360;\n\t\t} else if (diff > 180) {\n\t\t\tdiff -= 360;\n\t\t}\n\n\t\treturn diff;\n\t}\n\n\t//\n};exports.default = math;\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; /**\r\n                                                                                                                                                                                                                                                                               * @module room\r\n                                                                                                                                                                                                                                                                               */\n\n//\n\n\nvar _transition = __webpack_require__(6);\n\nvar _transition2 = _interopRequireDefault(_transition);\n\nvar _instance = __webpack_require__(2);\n\nvar _instance2 = _interopRequireDefault(_instance);\n\nvar _sprite = __webpack_require__(1);\n\nvar _sprite2 = _interopRequireDefault(_sprite);\n\nvar _draw2 = __webpack_require__(0);\n\nvar _draw3 = _interopRequireDefault(_draw2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//\nvar room = {\n\n\tarray: [],\n\tcurrent: null,\n\n\t/**\r\n  * @param {string} name\r\n  * @param {int} width\r\n  * @param {int} height\r\n  */\n\tcreate: function create(name, width, height) {\n\n\t\tvar newRoom = {\n\t\t\tname: name,\n\t\t\tassetType: \"room\",\n\t\t\twidth: Number(width),\n\t\t\theight: Number(height),\n\t\t\tbackground: null,\n\t\t\tbackgroundMethod: \"no-repeat\",\n\t\t\tinstances: []\n\t\t};\n\n\t\tif (room.current === null) room.current = newRoom;\n\n\t\troom.array.push(newRoom);\n\t\treturn newRoom;\n\t},\n\n\t/**\r\n  *\r\n  */\n\tsetBackground: function setBackground(rm, spr) {\n\t\trm = room.get(rm);\n\t\trm.background = spr;\n\t},\n\n\t/**\r\n  *\r\n  */\n\taddInstance: function addInstance(rm, inst, x, y) {\n\t\trm = room.get(rm);\n\t\trm.instances.push({ name: inst, x: x, y: y });\n\t},\n\n\t/**\r\n  *\r\n  */\n\tenter: function enter(rm) {\n\t\tvar opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n\n\t\tif (opts.transition) {\n\t\t\tnew _transition2.default({\n\t\t\t\tprefab: opts.transition,\n\t\t\t\tcallback: room.enter.bind(null, rm)\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\t// leave room event\n\t\t_instance2.default.executeEventAll(\"roomleave\");\n\n\t\t// clear current instances\n\t\t_instance2.default.instanceArray.forEach(function (i) {\n\t\t\t_instance2.default.destroy(i, false);\n\t\t});\n\n\t\t// goto new room and create new instances\n\t\trm = room.get(rm);\n\t\troom.current = rm;\n\t\trm.instances.forEach(function (inst) {\n\t\t\t_instance2.default.create(inst.name, inst.x, inst.y);\n\t\t});\n\n\t\t// enter room event\n\t\t_instance2.default.executeEventAll(\"roomenter\");\n\t},\n\n\t/**\r\n  *\r\n  */\n\tdraw: function draw(rm) {\n\n\t\t// draw background\n\t\trm = room.get(rm);\n\t\tvar spr = _sprite2.default.get(rm.background);\n\t\tif (spr !== null) {\n\n\t\t\tvar canvas = _draw3.default.getTarget();\n\t\t\tvar ctx = canvas.getContext(\"2d\");\n\t\t\tvar image = spr.images[0].img;\n\t\t\tif (rm.backgroundMethod === \"stretch\") {\n\t\t\t\tctx.drawImage(image, 0, 0, canvas.width, canvas.height);\n\t\t\t} else {\n\t\t\t\tvar ptrn = ctx.createPattern(image, rm.backgroundMethod);\n\t\t\t\tctx.fillStyle = ptrn;\n\t\t\t\tctx.fillRect(0, 0, canvas.width, canvas.height);\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\r\n  *\r\n  */\n\tget: function get(name) {\n\n\t\tif ((typeof name === \"undefined\" ? \"undefined\" : _typeof(name)) === \"object\") return name;\n\n\t\tfor (var n = 0; n < room.array.length; n++) {\n\t\t\tif (room.array[n][\"name\"] === name) return room.array[n];\n\t\t}return null;\n\t}\n\n\t//\n};exports.default = room;\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _draw2 = __webpack_require__(0);\n\nvar _draw3 = _interopRequireDefault(_draw2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar noop = function noop() {};\n\nvar Transition = function () {\n\n\t/**\r\n * @param {object} opts Options.\r\n * @param {string} opts.type\r\n * @param {string} opts.time Time in steps the tranistion will last per stage (in/out).\r\n * @param {string} opts.color Color of the transition.\r\n * @param {string} opts.callback Function to execute mid-transition.\r\n */\n\tfunction Transition() {\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\t\t_classCallCheck(this, Transition);\n\n\t\tthis.type = opts.type || \"fade\";\n\t\tthis.time = opts.time || 60;\n\t\tthis.color = opts.color || \"#000000\";\n\t\tthis.callback = opts.callback || noop;\n\t\tif (opts.prefab) _extends(this, opts.prefab);\n\t\tthis.direction = 1;\n\t\tthis.alpha = 0;\n\t\tthis.delta = 1 / this.time;\n\t\tTransition.allInstances.push(this);\n\n\t\t// Check transition type exists and log warning otherwise\n\t\tif (!Transition.prefabs.hasOwnProperty(this.type)) {\n\t\t\twindow.addConsoleText(\"#F00\", \"Unknown transition type: \" + this.type);\n\t\t\tthis.type = \"fade\";\n\t\t}\n\t}\n\n\t/** */\n\n\n\tTransition.prototype.update = function update() {\n\t\tif (Transition.prefabs.hasOwnProperty(this.type)) Transition.prefabs[this.type].update.call(this);\n\t};\n\n\t/** */\n\n\n\tTransition.prototype.draw = function draw() {\n\t\tif (Transition.prefabs.hasOwnProperty(this.type)) Transition.prefabs[this.type].draw.call(this);\n\t};\n\n\t/** */\n\n\n\tTransition.prototype.destroy = function destroy() {\n\t\tvar x = Transition.allInstances.indexOf(this);\n\t\tTransition.allInstances.splice(x, 1);\n\t};\n\n\t/** */\n\n\n\tTransition.create = function create(opts) {\n\t\treturn new Transition(opts);\n\t};\n\n\t/** */\n\n\n\tTransition.updateAll = function updateAll() {\n\t\tTransition.allInstances.forEach(function (t) {\n\t\t\tt.update();\n\t\t});\n\t};\n\n\t/** */\n\n\n\tTransition.drawAll = function drawAll() {\n\t\tTransition.allInstances.forEach(function (t) {\n\t\t\tt.draw();\n\t\t});\n\t};\n\n\treturn Transition;\n}();\n\n//\n\n\nexports.default = Transition;\nTransition.allInstances = [];\n\n/**\r\n * @namespace\r\n */\nTransition.prefabs = {\n\n\t\"fade\": {\n\t\tupdate: function update() {\n\t\t\tthis.alpha += this.direction ? this.delta : -this.delta;\n\t\t\tif (this.alpha >= 1) {\n\t\t\t\tthis.callback();\n\t\t\t\tthis.direction = 0;\n\t\t\t} else if (this.alpha <= 0) {\n\t\t\t\tthis.destroy();\n\t\t\t\tconsole.log(\"destroy\");\n\t\t\t}\n\t\t},\n\t\tdraw: function draw() {\n\t\t\tvar canvas = _draw3.default.getTarget();\n\t\t\tvar ctx = canvas.getContext(\"2d\");\n\t\t\tctx.globalAlpha = this.alpha;\n\t\t\tctx.fillStyle = this.color;\n\t\t\tctx.fillRect(0, 0, 9999999, 9999999);\n\t\t}\n\t}\n\n};\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _canvas = __webpack_require__(3);\n\nvar _canvas2 = _interopRequireDefault(_canvas);\n\nvar _keyvalues = __webpack_require__(13);\n\nvar _keyvalues2 = _interopRequireDefault(_keyvalues);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\r\n * @module input\r\n */\n\nvar element = document;\n\n// mouse object\nvar __mouse = {\n\tpressed: [false, false, false],\n\tdown: [false, false, false],\n\treleased: [false, false, false],\n\twheelUp: false,\n\twheelDown: false,\n\tx: 0,\n\ty: 0\n\n\t// keboard object\n};var __keyboard = {\n\tpressed: {},\n\tdown: {},\n\treleased: {}\n\n\t// touch object\n};var __touch = {\n\tstart: [],\n\theld: [],\n\tmove: [],\n\tend: [],\n\tcancel: [],\n\tx: [],\n\ty: []\n\n\t//\n};var __triggerEvents = [];\n\n//\nvar input = {\n\n\ttriggerEvents: __triggerEvents,\n\tmouse: __mouse,\n\tkeyboard: __keyboard,\n\ttouch: __touch,\n\n\t/**\r\n  *\r\n  */\n\tinit: function init() {\n\n\t\t// init all input methods\n\t\tinput.initMouse();\n\t\tinput.initKeyboard();\n\t\tinput.initTouch();\n\n\t\t// disable context menu\n\t\telement.oncontextmenu = function (e) {\n\t\t\te.preventDefault();\n\t\t};\n\t},\n\n\t/**\r\n  *\r\n  */\n\tinitMouse: function initMouse() {\n\n\t\t//\n\t\tvar handleMouseDown = function handleMouseDown(e) {\n\t\t\te.preventDefault();\n\t\t\t!__mouse.pressed[e.button] && window.focus();\n\t\t\t__mouse.pressed[e.button] = true;\n\t\t\t__mouse.down[e.button] = true;\n\t\t};\n\n\t\t//\n\t\tvar handleMouseUp = function handleMouseUp(e) {\n\t\t\te.preventDefault();\n\t\t\t__mouse.pressed[e.button] = false;\n\t\t\t__mouse.released[e.button] = true;\n\t\t\t__mouse.down[e.button] = false;\n\t\t};\n\n\t\t//\n\t\tvar handleMouseMove = function handleMouseMove(e) {\n\t\t\tvar canv = _canvas2.default.main;\n\t\t\tvar rect = canv.getBoundingClientRect();\n\t\t\t__mouse.x = e.clientX - rect.left;\n\t\t\t__mouse.y = e.clientY - rect.top;\n\t\t};\n\n\t\t//\n\t\tvar handleMouseWheel = function handleMouseWheel(e) {\n\t\t\te.preventDefault();\n\t\t\tvar delta = Math.max(-1, Math.min(1, e.wheelDelta));\n\t\t\t__mouse.wheelUp = delta > 0;\n\t\t\t__mouse.wheelDown = delta < 0;\n\t\t};\n\n\t\t//\n\t\telement.onmousedown = handleMouseDown;\n\t\telement.onmouseup = handleMouseUp;\n\t\telement.onmousemove = handleMouseMove;\n\t\telement.onmousewheel = handleMouseWheel;\n\t},\n\n\t/**\r\n  *\r\n  */\n\tinitKeyboard: function initKeyboard() {\n\n\t\t//\n\t\t_keyvalues2.default.forEach(function (key) {\n\t\t\t__keyboard.pressed[key] = false;\n\t\t\t__keyboard.down[key] = false;\n\t\t\t__keyboard.released[key] = false;\n\t\t});\n\n\t\t//\n\t\tvar handleKeyDown = function handleKeyDown(e) {\n\t\t\te.preventDefault();\n\t\t\tif (!__keyboard.down[e.code]) {\n\t\t\t\t__keyboard.pressed[e.code] = true;\n\t\t\t\t__keyboard.down[e.code] = true;\n\t\t\t}\n\t\t};\n\n\t\t//\n\t\tvar handleKeyUp = function handleKeyUp(e) {\n\t\t\te.preventDefault();\n\t\t\t__keyboard.released[e.code] = true;\n\t\t\t__keyboard.down[e.code] = false;\n\t\t};\n\n\t\t//\n\t\telement.onkeydown = handleKeyDown;\n\t\telement.onkeyup = handleKeyUp;\n\t},\n\n\t/**\r\n  *\r\n  */\n\tinitTouch: function initTouch() {\n\n\t\t//\n\t\tvar handleTouchStart = function handleTouchStart(e) {\n\t\t\te.preventDefault();\n\t\t\t!__touch.start[0] && window.focus();\n\t\t\t__touch.start[0] = true;\n\t\t\t__touch.held[0] = true;\n\t\t};\n\n\t\t//\n\t\tvar handleTouchEnd = function handleTouchEnd(e) {\n\t\t\te.preventDefault();\n\t\t\t__touch.start[0] = false;\n\t\t\t__touch.end[0] = true;\n\t\t\t__touch.held[0] = false;\n\t\t};\n\n\t\t//\n\t\tvar handleTouchMove = function handleTouchMove(e) {\n\t\t\te.preventDefault();\n\t\t\tvar touches = e.changedTouches;\n\t\t\t__touch.x[0] = touches[0].pageX;\n\t\t\t__touch.y[0] = touches[0].pageY;\n\t\t};\n\n\t\t//\n\t\telement.ontouchstart = handleTouchStart;\n\t\telement.ontouchend = handleTouchEnd;\n\t\telement.ontouchcancel = handleTouchEnd;\n\t\telement.ontouchmove = handleTouchMove;\n\t},\n\n\t/**\r\n  *\r\n  */\n\tgetTriggerEvents: function getTriggerEvents() {\n\n\t\t__triggerEvents.length = 0;\n\t\tObject.keys(__keyboard.down).forEach(function (key) {\n\n\t\t\tif (_keyvalues2.default.includes(key)) {\n\n\t\t\t\tif (__keyboard.down[key]) __triggerEvents.push(key);\n\n\t\t\t\tif (__keyboard.pressed[key]) __triggerEvents.push(key + \"Pressed\");\n\n\t\t\t\tif (__keyboard.released[key]) __triggerEvents.push(key + \"Released\");\n\t\t\t} else {\n\n\t\t\t\tconsole.warn(\"input key not supported: \", key);\n\t\t\t\tdelete __keyboard.down[key];\n\t\t\t}\n\t\t});\n\n\t\t// map mouse ids to names\n\t\tvar mouseMap = [\"Left\", \"Middle\", \"Right\"];\n\n\t\t// mouse events\n\t\tfor (var n = 0; n < 3; n++) {\n\n\t\t\tif (__mouse.down[n]) __triggerEvents.push(mouseMap[n] + \"Down\");\n\n\t\t\tif (__mouse.pressed[n]) __triggerEvents.push(mouseMap[n] + \"Pressed\");\n\n\t\t\tif (__mouse.released[n]) __triggerEvents.push(mouseMap[n] + \"Released\");\n\t\t}\n\n\t\tif (__mouse.wheelUp) __triggerEvents.push(\"WheelUp\");\n\t\tif (__mouse.wheelDown) __triggerEvents.push(\"WheelDown\");\n\t},\n\n\t/**\r\n  *\r\n  */\n\tupdate: function update() {\n\n\t\tObject.keys(__keyboard.down).forEach(function (key) {\n\t\t\t__keyboard.pressed[key] = false;\n\t\t\t__keyboard.released[key] = false;\n\t\t});\n\n\t\tObject.keys(__mouse.down).forEach(function (button) {\n\t\t\t__mouse.pressed[button] = false;\n\t\t\t__mouse.released[button] = false;\n\t\t});\n\n\t\tObject.keys(__touch.held).forEach(function (button) {\n\t\t\t__touch.start[button] = false;\n\t\t\t__touch.end[button] = false;\n\t\t\t__touch.held[button] = false;\n\t\t});\n\n\t\t__mouse.wheelUp = false;\n\t\t__mouse.wheelDown = false;\n\t}\n\n\t//\n};exports.default = input;\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _event = __webpack_require__(14);\n\nvar _event2 = _interopRequireDefault(_event);\n\nvar _instance = __webpack_require__(2);\n\nvar _instance2 = _interopRequireDefault(_instance);\n\nvar _objectVars = __webpack_require__(21);\n\nvar _objectVars2 = _interopRequireDefault(_objectVars);\n\nvar _pool = __webpack_require__(15);\n\nvar _pool2 = _interopRequireDefault(_pool);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } } /**\r\n                                                                                                                                                           * @module objects\r\n                                                                                                                                                           */\n\n/**\r\n *\r\n */\nvar object = function () {\n\n\t/**\r\n  * @param {string} name\r\n  * @param {number} sprite\r\n  */\n\tfunction object(name, sprite) {\n\t\t_classCallCheck(this, object);\n\n\t\tvar obj = function obj() {};\n\t\t_objectVars2.default.set(obj.prototype);\n\t\tobj.assetType = \"object\";\n\t\tobj.objectName = name || \"object_\" + obj.id;\n\t\tobj.prototype.sprite = sprite || null;\n\t\tobj.pool = new _pool2.default(obj);\n\t\tobject.names.push(obj.objectName);\n\t\tobject.array.push(obj);\n\t\treturn obj;\n\t}\n\n\t/**\r\n  *\r\n  */\n\n\n\tobject.create = function create() {\n\t\tfor (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n\t\t\targs[_key] = arguments[_key];\n\t\t}\n\n\t\treturn new (Function.prototype.bind.apply(object, [null].concat(args)))();\n\t};\n\n\t/**\r\n  *\r\n \t*/\n\n\n\tobject.set = function set(obj, property, value) {\n\t\tobj = object.get(obj);\n\t\tobj.prototype[property] = value;\n\t};\n\n\t/**\r\n  * Add an action with variable parameters to an event of an object.\r\n  * @param object Can be an object constructor or integer ID.\r\n  * @param event\r\n  * @param action\r\n  * @param {...*} args\r\n  */\n\n\n\tobject.eventAddAction = function eventAddAction(obj, event, action) {\n\t\tfor (var _len2 = arguments.length, args = Array(_len2 > 3 ? _len2 - 3 : 0), _key2 = 3; _key2 < _len2; _key2++) {\n\t\t\targs[_key2 - 3] = arguments[_key2];\n\t\t}\n\n\t\tobj = object.get(obj);\n\n\t\tif ((typeof event === \"undefined\" ? \"undefined\" : _typeof(event)) === \"object\") {\n\t\t\tobject.keys(event).forEach(function (key) {\n\t\t\t\tevent[key].forEach(function (params) {\n\t\t\t\t\tobject.eventAddAction.apply(object, [obj, key].concat(_toConsumableArray(params)));\n\t\t\t\t});\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tif (action !== undefined) {\n\n\t\t\t// if flow action, get flow tag\n\t\t\tvar flow = \"\";\n\t\t\tif (typeof action === \"string\") flow = action;\n\n\t\t\t// create a new event if not yet defined\n\t\t\tif (obj.prototype.events[event] === undefined) {\n\n\t\t\t\tobj.prototype.events[event] = [];\n\n\t\t\t\tif (event.includes(\"collision_\")) {\n\t\t\t\t\tvar index = event.indexOf(\"_\") + 1;\n\t\t\t\t\tvar name = event.slice(index, 200);\n\t\t\t\t\tobject.addCollisionListener(obj, name);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// add action data to event\n\t\t\tobj.prototype.events[event].push({\n\t\t\t\tflow: flow,\n\t\t\t\taction: action,\n\t\t\t\targs: args\n\t\t\t});\n\t\t} else {\n\t\t\tconsole.warn(\"tried to add an undefined action to an event!\");\n\t\t}\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tobject.addCollisionListener = function addCollisionListener(obj, target) {\n\t\tobj.prototype.listeners.push({\n\t\t\ttype: \"collision\",\n\t\t\ttarget: target\n\t\t});\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tobject.getAllInstances = function getAllInstances(obj) {\n\t\tvar arr = [];\n\t\t_instance2.default.instanceArray.forEach(function (instance) {\n\t\t\tvar name = instance.constructor.objectName;\n\t\t\tif (name === obj) arr.push(instance);\n\t\t});\n\t\treturn arr;\n\t};\n\n\t/**\r\n  * @param {number}\r\n  */\n\n\n\tobject.get = function get(value) {\n\n\t\tif ((typeof value === \"undefined\" ? \"undefined\" : _typeof(value)) === \"object\" || typeof value === \"function\") return value;\n\n\t\tfor (var n = 0; n < object.array.length; n++) {\n\t\t\tif (object.array[n].objectName === value) return object.array[n];\n\t\t}console.warn(\"FAIL: \", typeof value === \"undefined\" ? \"undefined\" : _typeof(value), value);\n\t\treturn null;\n\t};\n\n\treturn object;\n}();\n\nexports.default = object;\n\n\nobject.names = [];\nobject.array = [];\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n * @module sound\r\n */\n\n/**\r\n *\r\n */\nvar Sound = function () {\n\n\t/**\r\n  *\r\n  */\n\tfunction Sound(name, source) {\n\t\tvar _this = this;\n\n\t\t_classCallCheck(this, Sound);\n\n\t\tthis.name = name;\n\t\tthis.assetType = \"sound\";\n\t\tthis.instances = [new Audio(source)];\n\t\tthis.ready = false;\n\t\tSound.names.push(name);\n\t\tSound.array.push(this);\n\t\tvar test = this.instances[0];\n\t\ttest.oncanplaythrough = function () {\n\t\t\t_this.ready = true;\n\t\t\ttest.oncanplaythrough = null;\n\t\t};\n\t}\n\n\t/**\r\n  * @param {object} opts object.\r\n  */\n\n\n\tSound.prototype.play = function play() {\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\t\tif (Sound.isEnabled) {\n\n\t\t\t// find an existing sound instance to play\n\t\t\tvar playSound = void 0;\n\t\t\tfor (var i = 0, n = this.instances.length; i < n; i++) {\n\t\t\t\tvar instance = this.instances[i];\n\t\t\t\tif (instance.paused) {\n\t\t\t\t\tplaySound = instance;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// create new instance of sound\n\t\t\tif (!playSound) {\n\t\t\t\tplaySound = this.instances[0].cloneNode();\n\t\t\t\tthis.instances.push(playSound);\n\t\t\t}\n\n\t\t\t//\n\t\t\tplaySound.onError = function (err) {\n\t\t\t\tconsole.error(soundName, err);\n\t\t\t};\n\n\t\t\t// play the sound\n\t\t\tvar promise = playSound.play();\n\t\t\tif (promise !== undefined) {\n\t\t\t\tpromise.then(function () {\n\n\t\t\t\t\t// on end event\n\t\t\t\t\tplaySound.onended = function () {\n\n\t\t\t\t\t\t// internal event stuff\n\t\t\t\t\t\t(Number(opts.loop || false) ? _loop : _end).call(this);\n\n\t\t\t\t\t\t// and custom event, if defined\n\t\t\t\t\t\tif (opts.onEnd) opts.onEnd();\n\t\t\t\t\t};\n\t\t\t\t}).catch(function (err) {\n\t\t\t\t\tconsole.warn(err);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t//\n\t\t\treturn playSound;\n\t\t}\n\n\t\t// sound is disabled, just return base audio node\n\t\treturn this.instances[0];\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tSound.prototype.stop = function stop() {\n\t\tfor (var i = 0, n = this.instances.length; i < n; i++) {\n\t\t\tvar instance = this.instances[i];\n\t\t\tif (!instance.paused) {\n\t\t\t\t_end.call(instance);\n\t\t\t}\n\t\t}\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tSound.readyAll = function readyAll() {\n\t\tfor (var i = 0, n = Sound.array.length; i < n; i++) {\n\t\t\tif (!Sound.array[i].ready) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tSound.get = function get(name) {\n\t\tif ((typeof name === \"undefined\" ? \"undefined\" : _typeof(name)) === \"object\") return name;\n\t\tfor (var i = 0, n = Sound.array.length; i < n; i++) {\n\t\t\tif (Sound.array[i].name === name) {\n\t\t\t\treturn Sound.array[i];\n\t\t\t}\n\t\t}\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tSound.enable = function enable(x) {\n\t\tSound.isEnabled = x;\n\t};\n\n\t/** */\n\n\n\tSound.create = function create(name, src) {\n\t\treturn new Sound(name, src);\n\t};\n\n\t/** */\n\n\n\tSound.play = function play(sound) {\n\t\tvar opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n\t\tsound = Sound.get(sound);\n\t\treturn Sound.prototype.play.call(sound, opts);\n\t};\n\n\t/** */\n\n\n\tSound.stop = function stop(sound) {\n\t\tsound = Sound.get(sound);\n\t\tSound.prototype.stop.call(sound);\n\t};\n\n\treturn Sound;\n}();\n\nexports.default = Sound;\n\n\nSound.isEnabled = true;\nSound.names = [];\nSound.array = [];\n\n//\nfunction _loop() {\n\tthis.currentTime = 0;\n\tthis.play();\n}\n\n//\nfunction _end() {\n\tthis.pause();\n\tthis.currentTime = 0;\n}\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _room = __webpack_require__(5);\n\nvar _room2 = _interopRequireDefault(_room);\n\nvar _draw = __webpack_require__(0);\n\nvar _draw2 = _interopRequireDefault(_draw);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } } /**\r\n                                                                                                                                                           * @module camera\r\n                                                                                                                                                           */\n\n//\n\n\n/**\r\n *\r\n */\nvar Camera = function () {\n\n\t/**\r\n  *\r\n  */\n\tfunction Camera() {\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\t\t_classCallCheck(this, Camera);\n\n\t\tthis.x = 0, this.y = 0, this.angle = 0, this.width = _room2.default.current.width, this.height = _room2.default.current.height, this.follow = null, this.gridLocked = false, this.left = 0, this.right = 0, this.top = 0, this.bottom = 0;\n\t\t_extends(this, opts);\n\t\tCamera.array.push(this);\n\t}\n\n\t/**\r\n  *\r\n  */\n\n\n\tCamera.prototype.update = function update() {\n\n\t\tif (this.follow) {\n\n\t\t\t// if single instance, put into array\n\t\t\tif (!Array.isArray(this.follow)) this.follow = [this.follow];\n\n\t\t\t//\n\t\t\tvar x = 0,\n\t\t\t    y = 0,\n\t\t\t    count = 0,\n\t\t\t    weight = 1;\n\t\t\tthis.follow.forEach(function (inst) {\n\n\t\t\t\tif (Array.isArray(inst)) {\n\t\t\t\t\tweight = inst[1] || 1;\n\t\t\t\t\tinst = inst[0];\n\t\t\t\t} else {\n\t\t\t\t\tweight = 1;\n\t\t\t\t}\n\n\t\t\t\tx += inst.x * weight;\n\t\t\t\ty += inst.y * weight;\n\t\t\t\tcount += weight;\n\t\t\t});\n\n\t\t\tthis.x = x / count;\n\t\t\tthis.y = y / count;\n\t\t}\n\n\t\t// update bounds\n\t\tthis.left = this.x - this.width * 0.5;\n\t\tthis.right = this.x + this.width * 0.5;\n\t\tthis.top = this.y - this.height * 0.5;\n\t\tthis.bottom = this.y + this.height * 0.5;\n\n\t\t// apply camera\n\t\t_draw2.default.transform.translate(-this.left, -this.top);\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tCamera.create = function create() {\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\t\treturn new Camera(opts);\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tCamera.update = function update() {\n\t\tCamera.array.forEach(function (cam) {\n\t\t\tcam.update();\n\t\t});\n\t};\n\n\treturn Camera;\n}();\n\nexports.default = Camera;\n\n\nCamera.array = [];\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _canvas = __webpack_require__(3);\n\nvar _canvas2 = _interopRequireDefault(_canvas);\n\nvar _room = __webpack_require__(5);\n\nvar _room2 = _interopRequireDefault(_room);\n\nvar _input = __webpack_require__(7);\n\nvar _input2 = _interopRequireDefault(_input);\n\nvar _instance = __webpack_require__(2);\n\nvar _instance2 = _interopRequireDefault(_instance);\n\nvar _global = __webpack_require__(16);\n\nvar _global2 = _interopRequireDefault(_global);\n\nvar _draw = __webpack_require__(0);\n\nvar _draw2 = _interopRequireDefault(_draw);\n\nvar _camera = __webpack_require__(10);\n\nvar _camera2 = _interopRequireDefault(_camera);\n\nvar _transition = __webpack_require__(6);\n\nvar _transition2 = _interopRequireDefault(_transition);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\r\n * @module main\r\n */\n\nvar lastTick = performance.now(),\n    tickLength = 1000 / 60,\n    dt = 0,\n    last = 0;\n\n//\nvar main = {\n\n\t/**\r\n  *\r\n  */\n\tget dt() {\n\t\treturn dt;\n\t},\n\n\t/**\r\n  *\r\n  */\n\tstart: function start() {\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\n\t\t// Basic site-locking\n\t\tif (opts.host !== undefined && opts.host !== \"\") {\n\t\t\tvar loc = window.parent ? window.parent.location : window.location;\n\t\t\tvar host = loc.hostname;\n\t\t\tvar arr = opts.host.split(\" \").join(\"\").split(\",\");\n\t\t\tif (!opts.host.includes(host)) return;\n\t\t}\n\n\t\t//\n\t\tvar canv = _canvas2.default.create({\n\t\t\twidth: _room2.default.current.width,\n\t\t\theight: _room2.default.current.height,\n\t\t\tcrisp2D: true,\n\t\t\tapplication: true\n\t\t});\n\n\t\t// selectively enable input methods\n\t\tif (opts.enableMouse) _input2.default.initMouse();\n\t\tif (opts.enableKeyboard) _input2.default.initKeyboard();\n\t\tif (opts.enableTouch) _input2.default.initTouch();\n\t\tif (opts.hideCursor) canv.style.cursor = \"none\";\n\n\t\t//\n\t\t_room2.default.enter(_room2.default.current);\n\t\ttick(performance.now());\n\t},\n\n\t/**\r\n  *\r\n  */\n\tsetGameSpeed: function setGameSpeed(speed) {\n\t\ttickLength = 1000 / speed;\n\t}\n\n\t/**\r\n  *\r\n  */\n};function tick(timestamp) {\n\n\t// exit game with Esc key\n\tif (window._GB_stop && _input2.default.triggerEvents.includes(\"EscapePressed\")) window._GB_stop();\n\n\t// request the next frame\n\twindow.requestAnimationFrame(tick);\n\tvar nextTick = lastTick + tickLength;\n\tvar numTicks = 0;\n\t_global2.default.fps = 1000 / (timestamp - last);\n\tlast = timestamp;\n\n\t//\n\tif (timestamp > nextTick) {\n\t\tvar timeSinceTick = timestamp - lastTick;\n\t\tnumTicks = Math.floor(timeSinceTick / tickLength);\n\t}\n\n\t//\n\t_input2.default.getTriggerEvents();\n\tqueueUpdates(numTicks);\n\tgameDraw();\n\n\t//\n\tif (numTicks) {\n\t\t_input2.default.update();\n\t}\n}\n\n/**\r\n *\r\n */\nfunction queueUpdates(numTicks) {\n\tfor (var i = 0; i < numTicks; i++) {\n\t\tlastTick = lastTick + tickLength;\n\t\tdt = 1;\n\t\tgameUpdate(1);\n\t}\n}\n\n/**\r\n * @param {number} dt Delta Time.\r\n */\nfunction gameUpdate(dt) {\n\t_instance2.default.stepAll(dt);\n\t_instance2.default.clearDestroyed();\n\t_transition2.default.updateAll();\n}\n\n/**\r\n *\r\n */\nfunction gameDraw() {\n\t_draw2.default.reset();\n\t_canvas2.default.clear(_canvas2.default.main, \"#000000\");\n\t_room2.default.draw(_room2.default.current);\n\t_camera2.default.update();\n\t_instance2.default.drawAll();\n\t_transition2.default.drawAll();\n}\n\n/**\r\n *\r\n */\nfunction handleResizeEvent() {\n\t_instance2.default.executeEventAll(\"resize\");\n}\n\n// attach event listerners\nwindow.addEventListener(\"resize\", handleResizeEvent);\n\n//\nexports.default = main;\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar color = {\n\n\t/**\r\n  * @param {string} hex A hex string.\r\n  */\n\thexToRgb: function hexToRgb(hex) {\n\t\tvar result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n\t\treturn result ? {\n\t\t\tr: parseInt(result[1], 16),\n\t\t\tg: parseInt(result[2], 16),\n\t\t\tb: parseInt(result[3], 16)\n\t\t} : null;\n\t},\n\n\t/**\r\n  * @param {number} c The component.\r\n  */\n\tcomponentToHex: function componentToHex(c) {\n\t\tvar hex = c.toString(16);\n\t\treturn hex.length == 1 ? \"0\" + hex : hex;\n\t},\n\n\t/**\r\n  * @param {number} r The red component.\r\n  * @param {number} g The green component.\r\n  * @param {number} b The blue component.\r\n  */\n\trgbToHex: function rgbToHex(r, g, b) {\n\t\tvar c = color.componentToHex;\n\t\treturn \"#\" + c(r) + c(g) + c(b);\n\t}\n\n\t//\n};exports.default = color;\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n/**\r\n * @module keyvalues\r\n */\n\nvar values = [\"ArrowUp\", \"ArrowDown\", \"ArrowLeft\", \"ArrowRight\", \"Enter\", \"Space\", \"Backspace\", \"Escape\", \"ShiftLeft\", \"ShiftRight\", \"ControlLeft\", \"ControlRight\", \"AltLeft\", \"AltRight\", \"KeyA\", \"KeyB\", \"KeyC\", \"KeyD\", \"KeyE\", \"KeyF\", \"KeyG\", \"KeyH\", \"KeyI\", \"KeyJ\", \"KeyK\", \"KeyL\", \"KeyM\", \"KeyN\", \"KeyO\", \"KeyP\", \"KeyQ\", \"KeyR\", \"KeyS\", \"KeyT\", \"KeyU\", \"KeyV\", \"KeyW\", \"KeyZ\", \"KeyY\", \"KeyZ\"];\n\nexports.default = values;\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; /**\r\n                                                                                                                                                                                                                                                                   * @module event\r\n                                                                                                                                                                                                                                                                   */\n\nvar _keyvalues = __webpack_require__(13);\n\nvar _keyvalues2 = _interopRequireDefault(_keyvalues);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//\nvar events = {\n\n\tcreate: \"create\",\n\troomEnter: \"roomEnter\",\n\troomLeave: \"roomLeave\",\n\tstep: \"step\",\n\tdraw: \"draw\",\n\tcollision: \"collision_\",\n\tresize: \"resize\",\n\tkeyboard: _extends({}, translate(_keyvalues2.default), {\n\t\tpressed: translate(_keyvalues2.default, \"Pressed\"),\n\t\treleased: translate(_keyvalues2.default, \"Released\")\n\t})\n\n\t/**\r\n  * @param {array} array\r\n  * @param {string} [postfix=\"\"]\r\n  */\n};function translate(array) {\n\tvar postfix = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"\";\n\n\tvar obj = {};\n\tarray.forEach(function (name) {\n\t\tobj[name] = name + postfix;\n\t});\n\treturn obj;\n}\n\n//\nexports.default = events;\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\nexports.default = Pool;\n/**\r\n * @module Pool\r\n */\n\n/**\r\n * The Pool object contains an array (the pool) called stack to which we can give objects. The Pool also maintains it's own length property, as the true length of the stack array does not change, so as to avoid garbage collection.\r\n * @param {Object} newConstructor The constructor function for this pool. During get, if no items are in the pool and no default value is provided, a new object is created from this constructor and returned.\r\n */\nfunction Pool(newConstructor) {\n\tthis.stack = [];\n\tthis.length = 0;\n\tthis.newConstructor = newConstructor;\n}\n\n/**\r\n * @param {Object} [def] The default object (or even value) to return if no items are found in the pool. If this is not defined, and no items are found in the pool, then a new object is created as per the Pool's newConstructor property.\r\n */\nPool.prototype.get = function (def) {\n\n\t// return object from pool\n\tif (this.length) {\n\t\tdef = this.stack[--this.length];\n\t\tthis.stack[this.length] = undefined;\n\t}\n\n\t// return found/default object or create a new one\n\treturn def || new this.newConstructor();\n};\n\n/**\r\n * @param {Object} i Objec to release, adding it to the pool.\r\n */\nPool.prototype.release = function (i) {\n\tthis.stack[this.length++] = i;\n};\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar global = {\n\tfps: 0\n};\n\nexports.default = global;\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _pool = __webpack_require__(15);\n\nvar _pool2 = _interopRequireDefault(_pool);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } } /**\r\n                                                                                                                                                           * @module dataGrid\r\n                                                                                                                                                           */\n\n//\n\n\n/**\r\n *\r\n */\nvar Grid = function () {\n\n\t/**\r\n  *\r\n  */\n\tfunction Grid(width, height) {\n\t\tvar opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n\t\t_classCallCheck(this, Grid);\n\n\t\tvar size = width * height;\n\t\tvar value = opts.value || 0;\n\t\tvar myGrid = Grid.pool.get(this);\n\t\tvar array = myGrid === this ? this.data = [] : myGrid.data;\n\n\t\t// fill grid with default value\n\t\tfor (var n = 0; n < size; n++) {\n\t\t\tarray[n] = value;\n\t\t} //\n\t\tmyGrid.size = size;\n\t\tmyGrid.width = width;\n\t\tmyGrid.height = height;\n\t\treturn myGrid;\n\t}\n\n\t/**\r\n  *\r\n  */\n\n\n\tGrid.prototype.get = function get(x, y) {\n\t\treturn this.data[x + y * this.width];\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tGrid.prototype.set = function set(x, y, value) {\n\t\tthis.data[x + y * this.width] = value;\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tGrid.prototype.create = function create() {\n\t\treturn newGrid.apply(undefined, arguments);\n\t};\n\n\t/**\r\n  *\r\n  */\n\n\n\tGrid.prototype.destroy = function destroy() {\n\t\tGrid.pool.release(this);\n\t};\n\n\t/** */\n\n\n\tGrid.get = function get() {\n\t\tvar _Grid$prototype$get;\n\n\t\treturn (_Grid$prototype$get = Grid.prototype.get).call.apply(_Grid$prototype$get, arguments);\n\t};\n\n\t/** */\n\n\n\tGrid.set = function set() {\n\t\tvar _Grid$prototype$set;\n\n\t\treturn (_Grid$prototype$set = Grid.prototype.set).call.apply(_Grid$prototype$set, arguments);\n\t};\n\n\treturn Grid;\n}();\n\n//\n\n\nexports.default = Grid;\nGrid.pool = new _pool2.default(Grid);\n\n/***/ }),\n/* 18 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\n//\nvar tween = {\n\n\t/**\r\n  *\r\n  */\n\tblend: function blend(n1, n2, perc) {\n\t\tvar diff = n2 - n1;\n\t\treturn n1 + diff * perc;\n\t},\n\n\n\t/**\r\n  *\r\n  */\n\tcubicBezier: function cubicBezier(x2, y2, x3, y3, i) {\n\n\t\tvar x1 = 0,\n\t\t    y1 = 0,\n\t\t    x4 = 1,\n\t\t    y4 = 1;\n\n\t\t// The Green Lines\n\t\tvar xa = tween.blend(x1, x2, i),\n\t\t    ya = tween.blend(y1, y2, i),\n\t\t    xb = tween.blend(x2, x3, i),\n\t\t    yb = tween.blend(y2, y3, i),\n\t\t    xc = tween.blend(x3, x4, i),\n\t\t    yc = tween.blend(y3, y4, i),\n\n\n\t\t// The Blue Line\n\t\txm = tween.blend(xa, xb, i),\n\t\t    ym = tween.blend(ya, yb, i),\n\t\t    xn = tween.blend(xb, xc, i),\n\t\t    yn = tween.blend(yb, yc, i),\n\n\n\t\t// The Black Dot\n\t\tx = tween.blend(xm, xn, i),\n\t\t    y = tween.blend(ym, yn, i);\n\n\t\t//\n\t\treturn y;\n\t}\n};\n\n//\nexports.default = tween;\n\n/***/ }),\n/* 19 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _draw = __webpack_require__(0);\n\nvar _draw2 = _interopRequireDefault(_draw);\n\nvar _sprite = __webpack_require__(1);\n\nvar _sprite2 = _interopRequireDefault(_sprite);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar noop = function noop() {};\n\n/** */\n\nvar Primitive = function () {\n\n\t/**\r\n  * @param {object} opts Options object.\r\n  * @param {array} opts.points Array of Point objects.\r\n  * @param {*} opts.texture Sprite object or name of sprite resource.\r\n  * @param {*} opts.color Color of the primitive.\r\n  * @param {string} opts.format Format of the points array.\r\n  * @param {function} opts.modifier Point modifier function.\r\n  * @param {number} opts.x X position to draw the primitive.\r\n  * @param {number} opts.y Y position to draw the primitive.\r\n  */\n\tfunction Primitive() {\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\t\t_classCallCheck(this, Primitive);\n\n\t\tthis.points = opts.points || [];\n\t\tthis.texture = opts.texture || null;\n\t\tthis.color = opts.color || \"#000000\";\n\t\tthis.format = opts.format || \"quads\";\n\t\tthis.modifier = opts.modifier || noop;\n\t\tthis.x = opts.x || 0;\n\t\tthis.y = opts.y || 0;\n\t}\n\n\t/** Method for drawing instantiated Primitive. */\n\n\n\tPrimitive.prototype.draw = function draw() {\n\t\tPrimitive.draw(this);\n\t};\n\n\t/**\r\n  * Alternate way to create a new Primitive instance.\r\n  * @param {object} opts See constructor.opts parameter.\r\n  */\n\n\n\tPrimitive.create = function create() {\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\t\treturn new Primitive(opts);\n\t};\n\n\t/**\r\n  * @param {object} opts See constructor.opts parameter.\r\n  */\n\n\n\tPrimitive.draw = function draw() {\n\t\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\t\tif (opts.texture) drawTextured(opts);else drawBasic(opts);\n\t};\n\n\treturn Primitive;\n}();\n\n/**\r\n *\r\n */\n\n\nexports.default = Primitive;\nfunction drawTextured() {\n\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\n\tvar texture = opts.texture;\n\tvar spr = _sprite2.default.get(texture);\n\tif (spr === null) {\n\t\tconsole.warn(\"No such texture: \" + texture);\n\t\treturn;\n\t}\n\n\tvar ctx = _draw2.default.context;\n\tvar frame = spr.images[0];\n\tvar img = frame.img;\n\tvar w = spr.width;\n\tvar h = spr.height;\n\tvar tris = orderTriangleList(opts);\n\n\t//\n\tvar t = void 0;\n\tvar pts = applyModifier(opts.points, opts.modifier);\n\tvar len = tris.length;\n\tfor (t = 0; t < len; t++) {\n\n\t\tvar pp = tris[t];\n\t\tvar x0 = pts[pp[0]].x,\n\t\t    x1 = pts[pp[1]].x,\n\t\t    x2 = pts[pp[2]].x;\n\t\tvar y0 = pts[pp[0]].y,\n\t\t    y1 = pts[pp[1]].y,\n\t\t    y2 = pts[pp[2]].y;\n\t\tvar u0 = pts[pp[0]].u * w,\n\t\t    u1 = pts[pp[1]].u * w,\n\t\t    u2 = pts[pp[2]].u * w;\n\t\tvar v0 = pts[pp[0]].v * h,\n\t\t    v1 = pts[pp[1]].v * h,\n\t\t    v2 = pts[pp[2]].v * h;\n\n\t\t// Set clipping area so that only pixels inside the triangle will\n\t\t// be affected by the image drawing operation\n\t\tctx.save();\n\t\tctx.beginPath();\n\t\tctx.moveTo(x0, y0);\n\t\tctx.lineTo(x1, y1);\n\t\tctx.lineTo(x2, y2);\n\t\tctx.closePath();\n\t\tctx.clip();\n\n\t\t// Compute matrix transform\n\t\tvar delta = u0 * v1 + v0 * u2 + u1 * v2 - v1 * u2 - v0 * u1 - u0 * v2;\n\t\tvar delta_a = x0 * v1 + v0 * x2 + x1 * v2 - v1 * x2 - v0 * x1 - x0 * v2;\n\t\tvar delta_b = u0 * x1 + x0 * u2 + u1 * x2 - x1 * u2 - x0 * u1 - u0 * x2;\n\t\tvar delta_c = u0 * v1 * x2 + v0 * x1 * u2 + x0 * u1 * v2 - x0 * v1 * u2 - v0 * u1 * x2 - u0 * x1 * v2;\n\t\tvar delta_d = y0 * v1 + v0 * y2 + y1 * v2 - v1 * y2 - v0 * y1 - y0 * v2;\n\t\tvar delta_e = u0 * y1 + y0 * u2 + u1 * y2 - y1 * u2 - y0 * u1 - u0 * y2;\n\t\tvar delta_f = u0 * v1 * y2 + v0 * y1 * u2 + y0 * u1 * v2 - y0 * v1 * u2 - v0 * u1 * y2 - u0 * y1 * v2;\n\n\t\t// Draw the transformed image\n\t\tctx.transform(delta_a / delta, delta_d / delta, delta_b / delta, delta_e / delta, delta_c / delta, delta_f / delta);\n\t\tctx.drawImage(img, 0, 0);\n\t\tctx.restore();\n\t}\n}\n\n/**\r\n *\r\n */\nfunction drawBasic() {\n\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\tvar points = applyModifier(opts.points, opts.modifier);\n\tvar length = points.length;\n\tif (length > 0) {\n\t\tvar tris = orderQuadList(opts);\n\t\tvar i = void 0,\n\t\t    ctx = _draw2.default.context;\n\t\tctx.fillStyle = opts.color || _draw2.default.color;\n\t\tfor (i = 0; i < tris.length; i++) {\n\t\t\tvar tri = tris[i];\n\t\t\tvar n = void 0,\n\t\t\t    p = points[tri[0]];\n\t\t\tctx.beginPath();\n\t\t\tctx.moveTo(p.x, p.y);\n\t\t\tfor (n = 1; n < tri.length; n++) {\n\t\t\t\tp = points[tri[n]];\n\t\t\t\tctx.lineTo(p.x, p.y);\n\t\t\t}\n\t\t\tctx.closePath();\n\t\t\tctx.fill();\n\t\t}\n\t}\n}\n\n/**\r\n *\r\n */\nfunction applyModifier(points, modifier) {\n\tvar newPoints = [];\n\tpoints.forEach(function (p) {\n\t\tvar newP = _extends({}, p, modifier.call(p));\n\t\tnewPoints.push(newP);\n\t});\n\treturn newPoints;\n}\n\n/**\r\n * @param {object} opts\r\n */\nfunction orderTriangleList() {\n\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\tvar tris = [];\n\tif (opts.format === \"quads\") {\n\t\tvar length = Math.floor(opts.points.length / 4);\n\t\tvar n = void 0,\n\t\t    o = 0;\n\t\tfor (n = 0; n < length; n++) {\n\t\t\ttris.push([o + 0, o + 1, o + 2], [o + 2, o + 3, o + 0]);\n\t\t\to += 4;\n\t\t}\n\t}\n\treturn tris;\n}\n\n/**\r\n * @param {object} opts\r\n */\nfunction orderQuadList() {\n\tvar opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\tvar tris = [];\n\tvar length = Math.floor(opts.points.length / 4);\n\tvar n = void 0,\n\t    o = 0;\n\tfor (n = 0; n < length; n++, o += 4) {\n\t\ttris.push([o + 0, o + 1, o + 2, o + 3]);\n\t}\n\treturn tris;\n}\n\n/***/ }),\n/* 20 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\nexports.Transition = exports.tween = exports.math = exports.draw = exports.instance = exports.action = exports.event = exports.object = exports.sound = exports.sprite = exports.input = exports.room = exports.Camera = exports.canvas = exports.main = undefined;\n\nvar _main = __webpack_require__(11);\n\nvar _main2 = _interopRequireDefault(_main);\n\nvar _canvas = __webpack_require__(3);\n\nvar _canvas2 = _interopRequireDefault(_canvas);\n\nvar _camera = __webpack_require__(10);\n\nvar _camera2 = _interopRequireDefault(_camera);\n\nvar _room = __webpack_require__(5);\n\nvar _room2 = _interopRequireDefault(_room);\n\nvar _input = __webpack_require__(7);\n\nvar _input2 = _interopRequireDefault(_input);\n\nvar _sprite = __webpack_require__(1);\n\nvar _sprite2 = _interopRequireDefault(_sprite);\n\nvar _sound = __webpack_require__(9);\n\nvar _sound2 = _interopRequireDefault(_sound);\n\nvar _object = __webpack_require__(8);\n\nvar _object2 = _interopRequireDefault(_object);\n\nvar _event = __webpack_require__(14);\n\nvar _event2 = _interopRequireDefault(_event);\n\nvar _action = __webpack_require__(23);\n\nvar action = _interopRequireWildcard(_action);\n\nvar _instance = __webpack_require__(2);\n\nvar _instance2 = _interopRequireDefault(_instance);\n\nvar _draw = __webpack_require__(0);\n\nvar _draw2 = _interopRequireDefault(_draw);\n\nvar _math = __webpack_require__(4);\n\nvar _math2 = _interopRequireDefault(_math);\n\nvar _tween = __webpack_require__(18);\n\nvar _tween2 = _interopRequireDefault(_tween);\n\nvar _transition = __webpack_require__(6);\n\nvar _transition2 = _interopRequireDefault(_transition);\n\nvar _primitive = __webpack_require__(19);\n\nvar _primitive2 = _interopRequireDefault(_primitive);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\r\n * @module core\r\n */\n\nexports.main = _main2.default;\nexports.canvas = _canvas2.default;\nexports.Camera = _camera2.default;\nexports.room = _room2.default;\nexports.input = _input2.default;\nexports.sprite = _sprite2.default;\nexports.sound = _sound2.default;\nexports.object = _object2.default;\nexports.event = _event2.default;\nexports.action = action;\nexports.instance = _instance2.default;\nexports.draw = _draw2.default;\nexports.math = _math2.default;\nexports.tween = _tween2.default;\nexports.Transition = _transition2.default;\n\n/***/ }),\n/* 21 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; /**\r\n                                                                                                                                                                                                                                                                   *\r\n                                                                                                                                                                                                                                                                   */\n\n//\n\n\nvar _math = __webpack_require__(4);\n\nvar _math2 = _interopRequireDefault(_math);\n\nvar _instance = __webpack_require__(2);\n\nvar _instance2 = _interopRequireDefault(_instance);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//\nvar basic = JSON.stringify({\n\tsprite: null,\n\tindex: 0,\n\timageSpeed: 1,\n\tanimationBehavior: \"loop\",\n\tvisible: true,\n\tsolid: false,\n\texists: true,\n\tscaleX: 1,\n\tscaleY: 1,\n\trotation: 0,\n\tterminal: 100,\n\tgravity: 0,\n\tgravityDirection: 0,\n\tspeedX: 0,\n\tspeedY: 0,\n\tboxTop: 0,\n\tboxBottom: 0,\n\tboxLeft: 0,\n\tboxRight: 0,\n\tbehaviours: [],\n\tlisteners: [],\n\tevents: {},\n\tboxCollision: {\n\t\tx: 0,\n\t\ty: 0,\n\t\twidth: 0,\n\t\theight: 0,\n\t\ttop: 0,\n\t\tbottom: 0,\n\t\tleft: 0,\n\t\tright: 0\n\t},\n\t_depth: 0\n});\n\n//\nvar objectVarsModule = {\n\n\t/**\r\n  *\r\n  */\n\tset: function set(proto) {\n\n\t\t_extends(proto, JSON.parse(basic));\n\n\t\tObject.defineProperty(proto, \"depth\", {\n\t\t\tset: function set(x) {\n\t\t\t\tthis._depth = x;\n\t\t\t\t_instance2.default.instanceArray.sort(function (a, b) {\n\t\t\t\t\treturn a._depth - b._depth;\n\t\t\t\t});\n\t\t\t},\n\t\t\tget: function get() {\n\t\t\t\treturn this._depth;\n\t\t\t}\n\t\t});\n\n\t\tObject.defineProperty(proto, \"speed\", {\n\t\t\tset: function set(x) {\n\t\t\t\tvar y = this.direction * _math2.default.DEGTORAD;\n\t\t\t\tthis.speedX = Math.cos(y) * x;\n\t\t\t\tthis.speedY = Math.sin(y) * x;\n\t\t\t},\n\t\t\tget: function get(x) {\n\t\t\t\treturn _math2.default.pointDistance(0, 0, this.speedX, this.speedY);\n\t\t\t}\n\t\t});\n\n\t\tObject.defineProperty(proto, \"direction\", {\n\t\t\tset: function set(x) {\n\t\t\t\tvar y = this.speed;\n\t\t\t\tthis.speedX = Math.cos(x * _math2.default.DEGTORAD) * y;\n\t\t\t\tthis.speedY = Math.sin(x * _math2.default.DEGTORAD) * y;\n\t\t\t},\n\t\t\tget: function get(x) {\n\t\t\t\treturn _math2.default.pointDirection(0, 0, this.speedX, this.speedY);\n\t\t\t}\n\t\t});\n\t}\n\n\t//\n};exports.default = objectVarsModule;\n\n/***/ }),\n/* 22 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _global = __webpack_require__(16);\n\nvar _global2 = _interopRequireDefault(_global);\n\nvar _object = __webpack_require__(8);\n\nvar _object2 = _interopRequireDefault(_object);\n\nvar _sprite = __webpack_require__(1);\n\nvar _sprite2 = _interopRequireDefault(_sprite);\n\nvar _sound = __webpack_require__(9);\n\nvar _sound2 = _interopRequireDefault(_sound);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } } /**\r\n                                                                                                                                                           * @module Compiler\r\n                                                                                                                                                           */\n\n//\n\n\n//\nvar Compiler = function () {\n\tfunction Compiler() {\n\t\t_classCallCheck(this, Compiler);\n\t}\n\n\t/**\r\n  * @param {string} exp\r\n  */\n\tCompiler.actionExpression = function actionExpression(exp) {\n\n\t\tif (!isNaN(Number(exp))) return Number(exp);\n\n\t\tif (Compiler.isBoolean(exp)) {\n\t\t\treturn exp === true || exp === \"true\";\n\t\t}\n\n\t\tif (Compiler.isFunction(exp) || Compiler.isOperator(exp) || Compiler.isResource(exp) || Compiler.isCss(exp)) return exp;\n\n\t\tif (Compiler.isString(exp)) {\n\t\t\treturn exp.slice(1, -1);\n\t\t}\n\n\t\tif (typeof exp === \"string\") {\n\n\t\t\tvar n = void 0,\n\t\t\t    string = \"\",\n\t\t\t    sIndex = -1,\n\t\t\t    newArr = [];\n\n\t\t\tfor (n = 0; n < exp.length; n++) {\n\n\t\t\t\tvar c = exp.charAt(n);\n\t\t\t\tswitch (c) {\n\n\t\t\t\t\tcase \"'\":\n\t\t\t\t\t\tif (sIndex === -1) {\n\t\t\t\t\t\t\tsIndex = n + 1;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tnewArr.push(\"'\" + exp.slice(sIndex, n) + \"'\");\n\t\t\t\t\t\t\tsIndex = -1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif (sIndex === -1 && c !== \" \") {\n\t\t\t\t\t\t\tif (c === \"+\" || c === \"-\" || c === \"=\") {\n\t\t\t\t\t\t\t\tif (string !== \"\") {\n\t\t\t\t\t\t\t\t\tnewArr.push(string);\n\t\t\t\t\t\t\t\t\tstring = \"\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tnewArr.push(c);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tstring += c;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (string !== \"\") {\n\t\t\t\tnewArr.push(string);\n\t\t\t\tstring = \"\";\n\t\t\t}\n\n\t\t\tvar y = \"\";\n\n\t\t\tnewArr.forEach(function (word) {\n\t\t\t\tvar num = parseInt(word);\n\t\t\t\tif (isNaN(num)) {\n\t\t\t\t\tvar _c = word.charAt(0);\n\t\t\t\t\tif (_c === \"'\") {\n\t\t\t\t\t\ty += word;\n\t\t\t\t\t} else if (_c === \"+\" || _c === \"-\") {\n\t\t\t\t\t\ty += word;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (word === \"fps\") y += _global2.default.fps;else {\n\t\t\t\t\t\t\tif (!Compiler.isResource(word) && Compiler.isSingleWord(word)) {\n\t\t\t\t\t\t\t\ty += \"this.\" + word;\n\t\t\t\t\t\t\t\t//this[word] = this[word] || word;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ty += word;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\ty += word;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn eval(y);\n\t\t}\n\n\t\treturn exp;\n\t};\n\n\t/** */\n\n\n\tCompiler.isResource = function isResource(x) {\n\t\treturn _object2.default.names.includes(x) || _sprite2.default.names.includes(x) || _sound2.default.names.includes(x);\n\t};\n\n\t/** */\n\n\n\tCompiler.isString = function isString(x) {\n\t\treturn x.charAt(0) === \"\\\"\";\n\t};\n\n\t/** */\n\n\n\tCompiler.isSingleWord = function isSingleWord(x) {\n\t\treturn !x.includes(\".\");\n\t};\n\n\t/** */\n\n\n\tCompiler.isFunction = function isFunction(x) {\n\t\treturn typeof x === \"function\";\n\t};\n\n\t/** */\n\n\n\tCompiler.isBoolean = function isBoolean(x) {\n\t\treturn x === \"true\" || x === \"false\" || x === true || x === false;\n\t};\n\n\t/** */\n\n\n\tCompiler.isOperator = function isOperator(x) {\n\t\treturn x === \"<\" || x === \">\" || x === \"<=\" || x === \">=\" || x === \"==\";\n\t};\n\n\t/** */\n\n\n\tCompiler.isCss = function isCss(x) {\n\t\treturn x.charAt(0) === \"#\";\n\t};\n\n\treturn Compiler;\n}();\n\nexports.default = Compiler;\n\n/***/ }),\n/* 23 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\nexports.GAME = exports.confirm = exports.alert = exports.message = exports.code = exports.func = exports.confine = exports.wrap = exports.actionConfine = exports.actionWrap = exports.moveReverseY = exports.moveReverseX = exports.moveSpeedY = exports.moveSpeedX = exports.moveDirect = exports.moveFree = exports.jumpRandom = exports.jump = exports.setGravity = exports.actionTest = exports.test = exports.get = exports.set = exports.exitEvent = exports.blockEnd = exports.blockBegin = exports.drawSprite = exports.instanceDrawSelf = exports.drawSelf = exports.drawText = exports.drawSetFontSize = exports.drawSetFont = exports.drawSetColor = exports.soundPlay = exports.instanceChangeSprite = exports.changeSprite = exports.instanceSetDirection = exports.instanceSetRotation = exports.instanceDestroy = exports.instanceCreateMoving = exports.instanceCreate = undefined;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; /**\r\n                                                                                                                                                                                                                                                                   * @module actions\r\n                                                                                                                                                                                                                                                                   */\n\nvar _room = __webpack_require__(5);\n\nvar _room2 = _interopRequireDefault(_room);\n\nvar _sound = __webpack_require__(9);\n\nvar _sound2 = _interopRequireDefault(_sound);\n\nvar _draw = __webpack_require__(0);\n\nvar _draw2 = _interopRequireDefault(_draw);\n\nvar _instance = __webpack_require__(2);\n\nvar _instance2 = _interopRequireDefault(_instance);\n\nvar _input = __webpack_require__(7);\n\nvar _input2 = _interopRequireDefault(_input);\n\nvar _math = __webpack_require__(4);\n\nvar _math2 = _interopRequireDefault(_math);\n\nvar _sprite = __webpack_require__(1);\n\nvar _sprite2 = _interopRequireDefault(_sprite);\n\nvar _canvas = __webpack_require__(3);\n\nvar _canvas2 = _interopRequireDefault(_canvas);\n\nvar _color = __webpack_require__(12);\n\nvar _color2 = _interopRequireDefault(_color);\n\nvar _main = __webpack_require__(11);\n\nvar _main2 = _interopRequireDefault(_main);\n\nvar _camera = __webpack_require__(10);\n\nvar _camera2 = _interopRequireDefault(_camera);\n\nvar _app = __webpack_require__(24);\n\nvar _app2 = _interopRequireDefault(_app);\n\nvar _data = __webpack_require__(25);\n\nvar _data2 = _interopRequireDefault(_data);\n\nvar _tilemap = __webpack_require__(26);\n\nvar _tilemap2 = _interopRequireDefault(_tilemap);\n\nvar _tween = __webpack_require__(18);\n\nvar _tween2 = _interopRequireDefault(_tween);\n\nvar _transition = __webpack_require__(6);\n\nvar _transition2 = _interopRequireDefault(_transition);\n\nvar _primitive = __webpack_require__(19);\n\nvar _primitive2 = _interopRequireDefault(_primitive);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\r\n * @param {string} varName\r\n * @param {value} value\r\n */\nfunction actionSet(varName, value, relative) {\n\trelative ? this[varName] += value : this[varName] = value;\n}\n\n/**\r\n * @param {string} varName\r\n * @param {string} op Operation.\r\n * @param {value} value Value to check against.\r\n */\nfunction actionTest(varName, op, value) {\n\tswitch (op) {\n\t\tcase \"==\":\n\t\t\treturn this[varName] == value;\n\t\tcase \"<\":\n\t\t\treturn this[varName] < value;\n\t\tcase \">\":\n\t\t\treturn this[varName] > value;\n\t\tcase \"<=\":\n\t\t\treturn this[varName] <= value;\n\t\tcase \">=\":\n\t\t\treturn this[varName] >= value;\n\t\tdefault:\n\t\t\treturn false;\n\t}\n}\n\n/**\r\n * Sets the instance's gravity to the given value.\r\n * @param {number} value The gravity strength.\r\n */\nfunction actionSetGravity(value) {\n\tthis.gravity = value;\n}\n\n/**\r\n * Instantly sets the instance's x and y values to a random position within\r\n * the current room.\r\n * @param {number} x\r\n * @param {number} y\r\n * @param {boolean} relative\r\n */\nfunction actionJump(x, y, relative) {\n\n\tif (relative) {\n\t\tthis.x += Number(x);\n\t\tthis.y += Number(y);\n\t} else {\n\t\tthis.x = Number(x);\n\t\tthis.y = Number(y);\n\t}\n}\n\n/**\r\n * Instantly sets the instance's x and y values to a random position within\r\n * the current room.\r\n */\nfunction actionJumpRandom() {\n\tvar x1 = 0,\n\t    y1 = 0,\n\t    x2 = 640,\n\t    y2 = 480;\n\tthis.x = Math.floor(Math.random() * (x2 - x1 + 1)) + x1;\n\tthis.y = Math.floor(Math.random() * (y2 - y1 + 1)) + y1;\n}\n\n/**\r\n *\r\n */\nfunction moveFree(speed, direction) {\n\tthis.speed = speed;\n\tthis.direction = direction;\n}\n\n/**\r\n * Instantly sets the instance's x and y values to a random position within\r\n * the current room.\r\n * @param {number} x\r\n * @param {number} y\r\n */\nfunction moveDirect(x, y) {\n\tthis.x += x * _main2.default.dt;\n\tthis.y += y * _main2.default.dt;\n}\n\n/**\r\n *\r\n */\nfunction moveSpeedX(speed) {\n\tthis.speedX = Number(speed);\n}\nfunction moveSpeedY(speed) {\n\tthis.speedY = Number(speed);\n}\nfunction moveReverseX() {\n\tthis.speedX = -this.speedX;\n}\nfunction moveReverseY() {\n\tthis.speedY = -this.speedY;\n}\n\n/**\r\n * Wraps the instance back into the room when it leaves.\r\n */\nfunction actionWrap() {\n\n\tvar width = this.boxRight - this.boxLeft,\n\t    height = this.boxBottom - this.boxTop,\n\t    thisRoom = _room2.default.current,\n\t    roomW = thisRoom.width,\n\t    roomH = thisRoom.height;\n\n\tif (this.boxRight < 0) this.x += roomW + width;\n\tif (this.boxBottom < 0) this.y += roomH + height;\n\tif (this.boxLeft > roomW) this.x -= roomW + width;\n\tif (this.boxTop > roomH) this.y -= roomH + height;\n}\n\n/**\r\n * Wraps the instance back into the room when it leaves.\r\n */\nfunction actionConfine() {\n\n\tvar width = this.boxRight - this.boxLeft,\n\t    height = this.boxBottom - this.boxTop,\n\t    thisRoom = _room2.default.current,\n\t    roomW = thisRoom.width,\n\t    roomH = thisRoom.height;\n\n\tif (this.boxLeft < 0) this.x = 0;\n\tif (this.boxTop < 0) this.y = 0;\n\tif (this.boxRight > roomW) this.x = roomW - width;\n\tif (this.boxBottom > roomH) this.y = roomH - height;\n}\n\n/**\r\n * Executes the given function with variable arguments on the instance.\r\n * @param {function} func\r\n * @param {...*} args\r\n */\nfunction actionFunc(func) {\n\tfor (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n\t\targs[_key - 1] = arguments[_key];\n\t}\n\n\tfunc.apply(this, args);\n}\n\n/**\r\n * Executes the given function with variable arguments on the instance.\r\n * @param {string} code\r\n */\nfunction runCode(code) {\n\n\tif (typeof code === \"string\") {\n\t\ttry {\n\t\t\teval(code);\n\t\t} catch (err) {\n\t\t\tconsole.error(err.message);\n\t\t}\n\t} else {\n\t\tconsole.error(\"runCode( code ); code must be a string!\");\n\t}\n}\n\n/**\r\n * Shows the value of the given variable of the instance, in the console.\r\n * @param {...*} args\r\n */\nfunction actionGet() {\n\tfor (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n\t\targs[_key2] = arguments[_key2];\n\t}\n\n\tconsole.log(this[args].toFixed(2));\n}\n\n// Fucntions for use in code.\nvar GAME = {\n\tmain: {\n\t\tsetGameSpeed: _main2.default.setGameSpeed\n\t},\n\tinstance: {\n\t\tcreate: _instance2.default.create,\n\t\tcreateMoving: _instance2.default.createMoving,\n\t\tdestroy: _instance2.default.destroy,\n\t\tfind: _instance2.default.find,\n\t\tfindRandom: _instance2.default.findRandom,\n\t\tcount: _instance2.default.count,\n\t\tmouseOn: _instance2.default.mouseOn\n\t},\n\tdraw: _extends(_draw2.default, {\n\t\tself: _instance2.default.drawSelf,\n\t\tdebug: _instance2.default.drawDebug\n\t}),\n\tcanvas: {\n\t\tgetMain: _canvas2.default.getMain,\n\t\tcreate: _canvas2.default.create\n\t},\n\tcolor: _color2.default,\n\tsprite: {\n\t\tcreate: _sprite2.default.create,\n\t\taddFrame: _sprite2.default.addFrame,\n\t\ttint: _sprite2.default.tint,\n\t\tget: _sprite2.default.get,\n\t\tcache: _sprite2.default.cache\n\t},\n\tsound: {\n\t\tplay: _sound2.default.play,\n\t\tstop: _sound2.default.stop,\n\t\tget: _sound2.default.get\n\t},\n\troom: _room2.default,\n\tinput: {\n\t\tkeyboard: _input2.default.keyboard,\n\t\tmouse: _input2.default.mouse,\n\t\ttouch: _input2.default.touch\n\t},\n\tmath: _math2.default,\n\tCamera: _camera2.default,\n\tapp: _app2.default,\n\tdata: _data2.default,\n\tTilemap: _tilemap2.default,\n\ttween: _tween2.default,\n\tTransition: _transition2.default,\n\tPrimitive: _primitive2.default\n\n\t//\n};var blockBegin = \"blockBegin\",\n    blockEnd = \"blockEnd\",\n    exitEvent = \"exitEvent\",\n    instanceCreate = _instance2.default.create,\n    instanceCreateMoving = _instance2.default.createMoving,\n    instanceDestroy = _instance2.default.destroy,\n    changeSprite = _instance2.default.changeSprite,\n    instanceSetRotation = _instance2.default.setRotation,\n    instanceSetDirection = _instance2.default.setDirection,\n    message = console.log,\n    alert = function alert(m) {\n\twindow.alert(m);\n},\n    confirm = function confirm(m) {\n\treturn window.confirm(m);\n},\n    drawSetColor = _draw2.default.setColor,\n    drawSetFont = _draw2.default.setFont,\n    drawSetFontSize = _draw2.default.setFontSize,\n    drawText = _draw2.default.text,\n    drawSelf = _instance2.default.drawSelf,\n    drawSprite = _draw2.default.sprite,\n    soundPlay = function soundPlay(snd, loop) {\n\t_sound2.default.play(snd, { loop: loop });\n};\n\n//\nexports.instanceCreate = instanceCreate;\nexports.instanceCreateMoving = instanceCreateMoving;\nexports.instanceDestroy = instanceDestroy;\nexports.instanceSetRotation = instanceSetRotation;\nexports.instanceSetDirection = instanceSetDirection;\nexports.changeSprite = changeSprite;\nexports.instanceChangeSprite = changeSprite;\nexports.soundPlay = soundPlay;\nexports.drawSetColor = drawSetColor;\nexports.drawSetFont = drawSetFont;\nexports.drawSetFontSize = drawSetFontSize;\nexports.drawText = drawText;\nexports.drawSelf = drawSelf;\nexports.instanceDrawSelf = drawSelf;\nexports.drawSprite = drawSprite;\nexports.blockBegin = blockBegin;\nexports.blockEnd = blockEnd;\nexports.exitEvent = exitEvent;\nexports.set = actionSet;\nexports.get = actionGet;\nexports.test = actionTest;\nexports.actionTest = actionTest;\nexports.setGravity = actionSetGravity;\nexports.jump = actionJump;\nexports.jumpRandom = actionJumpRandom;\nexports.moveFree = moveFree;\nexports.moveDirect = moveDirect;\nexports.moveSpeedX = moveSpeedX;\nexports.moveSpeedY = moveSpeedY;\nexports.moveReverseX = moveReverseX;\nexports.moveReverseY = moveReverseY;\nexports.actionWrap = actionWrap;\nexports.actionConfine = actionConfine;\nexports.wrap = actionWrap;\nexports.confine = actionConfine;\nexports.func = actionFunc;\nexports.code = runCode;\nexports.message = message;\nexports.alert = alert;\nexports.confirm = confirm;\nexports.GAME = GAME;\n\n/***/ }),\n/* 24 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _canvas = __webpack_require__(3);\n\nvar _canvas2 = _interopRequireDefault(_canvas);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//\nvar app = {\n\n\t/**\r\n  * @param {string} cursor Same as the CSS cursor property.\r\n  * See {@link https://developer.mozilla.org/en-US/docs/Web/CSS/cursor}\r\n  */\n\tsetCursor: function setCursor(cursor) {\n\t\t_canvas2.default.main.style.cursor = cursor;\n\t}\n\n\t//\n}; /**\r\n    * @module app\r\n    */\n\n//\nexports.default = app;\n\n/***/ }),\n/* 25 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _dataGrid = __webpack_require__(17);\n\nvar _dataGrid2 = _interopRequireDefault(_dataGrid);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//\nexports.default = {\n  Grid: _dataGrid2.default\n}; /**\r\n    * @module data\r\n    */\n\n/***/ }),\n/* 26 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _generator = __webpack_require__(27);\n\nvar _generator2 = _interopRequireDefault(_generator);\n\nvar _dataGrid = __webpack_require__(17);\n\nvar _dataGrid2 = _interopRequireDefault(_dataGrid);\n\nvar _draw = __webpack_require__(0);\n\nvar _draw2 = _interopRequireDefault(_draw);\n\nvar _sprite = __webpack_require__(1);\n\nvar _sprite2 = _interopRequireDefault(_sprite);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\r\n *\r\n */\n/**\r\n * @module Tilemap\r\n */\n\n//\nfunction Tilemap() {\n\tvar options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\n\t//\n\tthis.textureAtlas = options.atlas || null;\n\tthis.tileWidth = options.tileWidth || 16;\n\tthis.tileHeight = options.tileHeight || 16;\n\tthis.tileSpacing = options.tileSpacing || 0;\n\tthis.tileOverlay = options.tileOverlay || 0;\n\tthis.tilesWide = options.tilesWide || 16;\n\tthis.mapWidth = options.mapWidth || 16;\n\tthis.mapHeight = options.mapHeight || 16;\n\tthis.layers = {};\n}\n\n/**\r\n *\r\n */\nTilemap.prototype.set = function (layer, x, y, index) {\n\n\tif (!this.layers[layer]) {\n\t\tthis.layers[layer] = new _dataGrid2.default(this.mapWidth, this.mapHeight);\n\t}\n\n\tthis.layers[layer].set(x, y, index);\n};\n\n//\nTilemap.prototype.draw = function (options) {\n\n\t// cache\n\tvar atlas = _sprite2.default.get(this.textureAtlas).images[0].img;\n\tvar gap = this.tileSpacing + this.tileOverlay;\n\n\t//\n\tvar startX = void 0,\n\t    startY = void 0,\n\t    endX = void 0,\n\t    endY = void 0,\n\t    order = void 0;\n\tif (options) {\n\t\torder = options.order;\n\t\tstartX = Math.floor(Math.max(0, options.left / this.tileWidth));\n\t\tstartY = Math.floor(Math.max(0, options.top / this.tileHeight));\n\t\tendX = Math.ceil(Math.min(this.mapWidth, options.right / this.tileWidth));\n\t\tendY = Math.ceil(Math.min(this.mapHeight, options.bottom / this.tileHeight));\n\t} else {\n\t\torder = Object.keys(this.layers);\n\t\tstartX = 0;\n\t\tstartY = 0;\n\t\tendX = this.mapWidth;\n\t\tendY = this.mapHeight;\n\t}\n\n\tvar name = void 0,\n\t    x = void 0,\n\t    y = void 0,\n\t    n = void 0;\n\tfor (n = 0; n < order.length; n++) {\n\t\tfor (x = startX; x < endX; x++) {\n\t\t\tfor (y = startY; y < endY; y++) {\n\n\t\t\t\tvar tile = this.layers[order[n]].get(x, y);\n\t\t\t\tif (tile > 0) {\n\n\t\t\t\t\tvar iX = (tile - 1) % this.tilesWide;\n\t\t\t\t\tvar iY = Math.floor((tile - 1) / this.tilesWide);\n\t\t\t\t\tiX = iX * (this.tileWidth + gap * 2) + gap;\n\t\t\t\t\tiY = iY * (this.tileHeight + gap * 2) + gap;\n\n\t\t\t\t\t_draw2.default.context.drawImage(atlas, iX - this.tileOverlay, iY - this.tileOverlay, this.tileWidth + this.tileOverlay * 2, // source width\n\t\t\t\t\tthis.tileHeight + this.tileOverlay * 2, // source height\n\t\t\t\t\tx * this.tileWidth - this.tileOverlay, // target x\n\t\t\t\t\ty * this.tileHeight - this.tileOverlay, // target y\n\t\t\t\t\tthis.tileWidth + this.tileOverlay * 2, // target width\n\t\t\t\t\tthis.tileHeight + this.tileOverlay * 2 // target height\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n};\n\n//\nTilemap.create = _generator2.default.functionFromConstructor(Tilemap);\n\n//\nexports.default = Tilemap;\n\n/***/ }),\n/* 27 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n/**\r\n * @module generator\r\n */\n\n//\nexports.default = {\n\n\t/**\r\n  * @param {function} constructor Constructor function.\r\n  */\n\tfunctionFromConstructor: function functionFromConstructor(constructor) {\n\t\treturn function () {\n\t\t\tfor (var _len = arguments.length, a = Array(_len), _key = 0; _key < _len; _key++) {\n\t\t\t\ta[_key] = arguments[_key];\n\t\t\t}\n\n\t\t\treturn new (Function.prototype.bind.apply(constructor, [null].concat(a)))();\n\t\t};\n\t},\n\n\t/**\r\n  * @param {function} method\r\n  */\n\tfunctionFromMethod: function functionFromMethod(method) {\n\t\treturn function () {\n\t\t\treturn method.call.apply(method, arguments);\n\t\t};\n\t}\n\n};\n\n/***/ })\n/******/ ]);\n});\n\n\n// WEBPACK FOOTER //\n// GameBeans.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 20);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap fe1d84373535c8aa3df1","/**\r\n * @module draw\r\n */\r\n\r\nimport math from \"./math.js\";\r\nimport sprite from \"./sprite.js\";\r\n\r\n//\r\nlet draw = {\r\n\t\r\n\t//\r\n\tcolor: \"#FFFFFF\",\r\n\tfont: \"Arial\",\r\n\tfontSize: 30,\r\n\ttextAlign: \"start\",\r\n\ttextBaseline: \"alphabetic\",\r\n\ttarget: null,\r\n\tcontext: null,\r\n\tdefaultTransform: [1, 0, 0, 1, 0, 0],\r\n\ttargetStack: [],\r\n\timageSmoothing: false,\r\n\toffsetX: 0,\r\n\toffsetY: 0,\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tsetTarget: function( target ) {\r\n\t\tdraw.targetStack.push( draw.target );\r\n\t\tdraw.target = target;\r\n\t\tdraw.context = target.getContext( \"2d\" );\r\n\t},\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tresetTarget: function() {\r\n\t\tlet target = draw.targetStack.pop();\r\n\t\tdraw.target = target;\r\n\t\tdraw.context = target.getContext( \"2d\" );\r\n\t},\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tgetTarget: function() {\r\n\t\treturn draw.target;\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tsave: function() {\r\n\t\tdraw.context.save();\r\n\t},\r\n\t \r\n\t/**\r\n\t *\r\n\t */\r\n\trestore: function() {\r\n\t\tdraw.context.restore();\r\n\t},\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\treset: function() {\r\n\t\tdraw.context.imageSmoothingEnabled = draw.imageSmoothing;\r\n\t\tdraw.context.setTransform(...draw.defaultTransform);\r\n\t\tdraw.context.globalAlpha = 1;\r\n\t},\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tsetImageSmoothing: function( enable ) {\r\n\t\tdraw.imageSmoothing = enable;\r\n\t},\r\n\r\n\t//\r\n\ttransform: {\r\n\t\t\r\n\t\tscale: function( x, y ) {\r\n\t\t\tdraw.context.scale( x, y );\r\n\t\t},\r\n\t\t\r\n\t\trotate: function( rot ) {\r\n\t\t\tdraw.context.rotate( rot * math.DEGTORAD );\r\n\t\t},\r\n\t\t\r\n\t\ttranslate: function( x, y ) {\r\n\t\t\tdraw.offsetX = x;\r\n\t\t\tdraw.offsetY = y;\r\n\t\t\tdraw.context.translate( x, y );\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * @param {object} opt\r\n\t\t */\r\n\t\tsetDefault: function( opt = {} ) {\r\n\t\t\t\r\n\t\t\tlet trans = draw.defaultTransform;\r\n\t\t\tif ( opt.scaleX ) trans[0] = opt.scaleX;\r\n\t\t\tif ( opt.skewX ) trans[1] = opt.skewX;\r\n\t\t\tif ( opt.skewY ) trans[2] = opt.skewY;\r\n\t\t\tif ( opt.scaleY ) trans[3] = opt.scaleY;\r\n\t\t\tif ( opt.moveX ) trans[4] = opt.moveX;\r\n\t\t\tif ( opt.moveY ) trans[5] = opt.moveY;\r\n\t\t\r\n\t\t}\r\n\t\t\r\n\t},\r\n\r\n\t/**\r\n\t * @param {color} c Can be a number, a hex-value or an object containing R, G, B and optionally A properties or H, S, L and optionally A properties.\r\n\t */\r\n\tsetColor: function( c ) {\r\n\t\t\r\n\t\t// quick exit if c is already a CSS color value\r\n\t\tif ( typeof c === \"string\" ) {\r\n\t\t\tdraw.color = c;\r\n\t\t}\r\n\t\t\r\n\t\t// c is an object\r\n\t\telse {\r\n\t\t\t\r\n\t\t\t// RGB / RGBA\r\n\t\t\tif ( \"r\" in c && \"g\" in c && \"b\" in c ) {\r\n\t\t\t\tdraw.color = ( \"a\" in c )\r\n\t\t\t\t\t? \"rgba(\"+c.r+\",\"+c.g+\",\"+c.b+\",\"+c.a+\")\"\r\n\t\t\t\t\t: \"rgb(\"+c.r+\",\"+c.g+\",\"+c.b+\")\";\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// HSL / HSLA\r\n\t\t\telse if ( \"h\" in c && \"s\" in c && \"l\" in c ) {\r\n\t\t\t\tdraw.color = ( \"a\" in c )\r\n\t\t\t\t\t? \"hsla(\"+c.h+\",\"+c.s+\"%,\"+c.l+\"%,\"+c.a+\")\"\r\n\t\t\t\t\t: \"hsl(\"+c.h+\",\"+c.s+\"%,\"+c.l+\"%)\";\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t},\r\n\r\n\t/**\r\n\t * Draws the sprite at the given x, y position.\r\n\t * @param {sprite} sprite\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t */\r\n\tsprite: function( spr, index, x, y, scaleX, scaleY, rotation ) {\r\n\r\n\t\tspr = sprite.get( spr );\r\n\t\t\r\n\t\t//\r\n\t\tlet ctx = draw.context;\r\n\t\tctx.save();\r\n\t\t\r\n\t\t//\r\n\t\tctx.translate( x, y );\r\n\t\tctx.rotate( rotation * math.DEGTORAD );\r\n\t\tctx.scale( scaleX, scaleY );\r\n\t\t\r\n\t\t//\r\n\t\tindex = Math.floor( index ) % spr.images.length;\r\n\t\t\r\n\t\t//\r\n\t\tlet frame = spr.images[index];\r\n\t\tlet img = frame.img;\r\n\t\tctx.drawImage(\r\n\t\t\timg, frame.clip.x, frame.clip.y,\r\n\t\t\tframe.clip.w, frame.clip.h,\r\n\t\t\t-spr.originX, -spr.originY,\r\n\t\t\tspr.width, spr.height\r\n\t\t);\r\n\t\t\r\n\t\t//\r\n\t\tctx.restore();\r\n\r\n\t},\r\n\r\n\t/**\r\n\t * Draws the sprite at the given x, y position.\r\n\t * @param {sprite} sprite\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @param {number} w\r\n\t * @param {number} h\r\n\t */\r\n\tspriteTiled: function(spr, index, x, y, w, h) {\r\n\r\n\t\tspr = sprite.get(spr);\r\n\t\t\r\n\t\tlet dx, dy, rx, ry;\r\n\t\tfor ( rx=0, dx=x; rx<w; rx++, dx+=spr.width )\r\n\t\tfor ( ry=0, dy=y; ry<h; ry++, dy+=spr.height )\r\n\t\t\tdrawSprite( spr, index, dx, dy, 1, 1, 0 );\r\n\r\n\t},\r\n\r\n\t/**\r\n\t * Draws a canvas at the given position.\r\n\t * @param {canvas} canvas The canvas to draw.\r\n\t * @param {number} x The X position to draw at.\r\n\t * @param {number} y The Y position to draw at.\r\n\t */\r\n\tcanvas: function(canvas, x, y) {\r\n\t\tdraw.context.drawImage(canvas, x, y);\r\n\t},\r\n\t\r\n\t/**\r\n\t * @param {string} font\r\n\t * @param {number} size\r\n\t * @param {string} align Horizontal alignment.\r\n\t * @param {string} baseline Vertical alignment.\r\n\t */\r\n\tsetFont: function( font, size, align, baseline ) {\r\n\t\t\r\n\t\tdraw.font = font;\r\n\t\tdraw.fontSize = size;\r\n\t\tdraw.textAlign = align;\r\n\t\tdraw.textBaseline = baseline;\r\n\t\t\r\n\t\tlet ctx = draw.context;\r\n\t\tctx.font = draw.fontSize + \"px \" + draw.font;\r\n\t\tctx.textAlign = draw.textAlign;\r\n\t\tctx.textBaseline = draw.textBaseline;\r\n\t\t\r\n\t},\r\n\r\n\t/**\r\n\t * @param {string} text\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t */\r\n\ttext: function(text, x, y, opts = {}) {\r\n\t\t\r\n\t\tx = Number(x);\r\n\t\ty = Number(y);\r\n\t\t\r\n\t\tlet drawMethod = \"fillText\";\r\n\t\tlet ctx = draw.context;\r\n\t\t\r\n\t\t//\r\n\t\tif (opts.stroke) {\r\n\t\t\tctx.strokeStyle = opts.strokeColor || draw.color;\r\n\t\t\tctx.lineWidth = opts.lineWidth || 2;\r\n\t\t\tdrawMethod = \"strokeText\";\r\n\t\t} else {\r\n\t\t\tctx.fillStyle = draw.color;\r\n\t\t}\r\n\t\t\r\n\t\t//\r\n\t\tlet lineLength;\r\n\t\tlet drawX = x;\r\n\t\tlet startN = 0;\r\n\t\tlet endN = text.toString().length;\r\n\t\tif (opts.pattern) {\r\n\t\t\tstartN = opts.pattern.start;\r\n\t\t\tendN = opts.pattern.end;\r\n\t\t}\r\n\t\t\r\n\t\t//\r\n\t\tlet lineHeight = ctx.measureText(\"M\").width * 1.2;\r\n\t\tlet lines = text.toString().split( \"#\" );\r\n\t\tfor (var i=0; i<lines.length; i++) {\r\n\t\t\t\r\n\t\t\tif ( opts.maxWidth ) {\r\n\t\t\t\tvar words = lines[i].split(' ');\r\n\t\t\t\tvar line = '';\r\n\t\t\t\t\r\n\t\t\t\tfor(var n = 0; n < words.length; n++) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar testLine = line + words[n] + ' ';\r\n\t\t\t\t\tvar metrics = ctx.measureText(testLine);\r\n\t\t\t\t\tvar testWidth = metrics.width;\r\n\t\t\t\t\tif (testWidth > opts.maxWidth && n > 0) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlet a = line.slice(0, startN);\r\n\t\t\t\t\t\tlet b = line.slice(startN, endN);\r\n\t\t\t\t\t\tdrawX += ctx.measureText(a).width;\r\n\t\t\t\t\t\tif ( 0 < endN )\r\n\t\t\t\t\t\t\tctx[drawMethod]( b, drawX, y );\r\n\t\t\t\t\t\tlineLength = testLine.length;\r\n\t\t\t\t\t\tstartN -= lineLength;\r\n\t\t\t\t\t\tendN -= lineLength;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tline = words[n] + ' ';\r\n\t\t\t\t\t\ty += lineHeight;\r\n\t\t\t\t\t\tdrawX = x;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tline = testLine;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tlet a = line.slice(0, startN);\r\n\t\t\t\tlet b = line.slice(startN, endN);\r\n\t\t\t\tdrawX += ctx.measureText(a).width;\r\n\t\t\t\tif ( 0 < endN )\r\n\t\t\t\t\tctx[drawMethod]( b, drawX, y );\r\n\t\t\t\tlineLength = line.length;\r\n\t\t\t\t\r\n\t\t\t} else {\r\n\t\t\t\r\n\t\t\t\tlet a = lines[i].slice(0, startN);\r\n\t\t\t\tlet b = lines[i].slice(startN, endN);\r\n\t\t\t\tdrawX += ctx.measureText(a).width;\r\n\t\t\t\tctx[drawMethod]( b, drawX, y );\r\n\t\t\t\tlineLength = lines[i].length;\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tdrawX = x;\r\n\t\t\ty += lineHeight;\r\n\t\t\tstartN -= lineLength;\r\n\t\t\tendN -= lineLength;\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t},\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tprimitive: {\r\n\t\r\n\t\ttextureMap: function( texture, pts ) {\r\n\t\t\t\r\n\t\t\tlet ctx = draw.context;\r\n\t\t\tlet spr = sprite.get( texture );\r\n\t\t\tlet frame = spr.images[0];\r\n\t\t\tlet img = frame.img;\r\n\t\t\tlet w = spr.width;\r\n\t\t\tlet h = spr.height;\r\n\t\t\t\r\n\t\t\tvar tris = [[0, 1, 2], [2, 3, 0]]; // Split in two triangles\r\n\t\t\tfor (var t=0; t<2; t++) {\r\n\t\t\t\tvar pp = tris[t];\r\n\t\t\t\tvar x0 = pts[pp[0]].x, x1 = pts[pp[1]].x, x2 = pts[pp[2]].x;\r\n\t\t\t\tvar y0 = pts[pp[0]].y, y1 = pts[pp[1]].y, y2 = pts[pp[2]].y;\r\n\t\t\t\tvar u0 = pts[pp[0]].u*w, u1 = pts[pp[1]].u*w, u2 = pts[pp[2]].u*w;\r\n\t\t\t\tvar v0 = pts[pp[0]].v*h, v1 = pts[pp[1]].v*h, v2 = pts[pp[2]].v*h;\r\n\r\n\t\t\t\t// Set clipping area so that only pixels inside the triangle will\r\n\t\t\t\t// be affected by the image drawing operation\r\n\t\t\t\tctx.save();\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tctx.moveTo(x0, y0);\r\n\t\t\t\tctx.lineTo(x1, y1);\r\n\t\t\t\tctx.lineTo(x2, y2);\r\n\t\t\t\tctx.closePath();\r\n\t\t\t\tctx.clip();\r\n\r\n\t\t\t\t// Compute matrix transform\r\n\t\t\t\tvar delta = u0*v1 + v0*u2 + u1*v2 - v1*u2 - v0*u1 - u0*v2;\r\n\t\t\t\tvar delta_a = x0*v1 + v0*x2 + x1*v2 - v1*x2 - v0*x1 - x0*v2;\r\n\t\t\t\tvar delta_b = u0*x1 + x0*u2 + u1*x2 - x1*u2 - x0*u1 - u0*x2;\r\n\t\t\t\tvar delta_c = u0*v1*x2 + v0*x1*u2 + x0*u1*v2 - x0*v1*u2\r\n\t\t\t\t\t\t\t  - v0*u1*x2 - u0*x1*v2;\r\n\t\t\t\tvar delta_d = y0*v1 + v0*y2 + y1*v2 - v1*y2 - v0*y1 - y0*v2;\r\n\t\t\t\tvar delta_e = u0*y1 + y0*u2 + u1*y2 - y1*u2 - y0*u1 - u0*y2;\r\n\t\t\t\tvar delta_f = u0*v1*y2 + v0*y1*u2 + y0*u1*v2 - y0*v1*u2\r\n\t\t\t\t\t\t\t  - v0*u1*y2 - u0*y1*v2;\r\n\r\n\t\t\t\t// Draw the transformed image\r\n\t\t\t\tctx.transform(delta_a/delta, delta_d/delta,\r\n\t\t\t\t\t\t\t  delta_b/delta, delta_e/delta,\r\n\t\t\t\t\t\t\t  delta_c/delta, delta_f/delta);\r\n\t\t\t\tctx.drawImage( img, 0, 0 );\r\n\t\t\t\tctx.restore();\r\n\t\t\t}\r\n\t\t}\r\n\t\r\n\t},\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tshape: {\r\n\t\t\r\n\t\t/**\r\n\t\t * @param {number} x1\r\n\t\t * @param {number} y1\r\n\t\t * @param {number} x2\r\n\t\t * @param {number} y2\r\n\t\t * @param {object} options\r\n\t\t */\r\n\t\tline: function( x1, y1, x2, y2, options = {} ) {\r\n\t\t\r\n\t\t\tlet ctx = draw.context;\r\n\t\t\tctx.strokeStyle = options.color || draw.color;\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.moveTo( x1, y1 );\r\n\t\t\tctx.lineTo( x2, y2 );\r\n\t\t\tctx.stroke();\r\n\t\t\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * @param {number} x1\r\n\t\t * @param {number} y1\r\n\t\t * @param {number} x2\r\n\t\t * @param {number} y2\r\n\t\t * @param {object} options\r\n\t\t */\r\n\t\tellipse: function(x, y, xr, yr, opts = {}) {\r\n\t\t\r\n\t\t\t//\r\n\t\t\tlet ctx = draw.context;\r\n\t\t\tctx.save();\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.translate(x-xr, y-yr);\r\n\t\t\tctx.scale(xr, yr);\r\n\t\t\tctx.arc(1, 1, 1, 0, 2 * Math.PI, false);\r\n\t\t\tctx.restore();\r\n\t\t\t\r\n\t\t\t//\r\n\t\t\tlet style;\r\n\t\t\tif (opts.healthbar) {\r\n\t\t\t\tlet amount = opts.healthbar.amount || 1;\r\n\t\t\t\tlet color = opts.healthbar.color || \"#0F0\";\r\n\t\t\t\tlet background = opts.healthbar.background || \"#F00\";\r\n\t\t\t\tstyle = ctx.createLinearGradient( x-xr, 0, x+xr, 0 );\r\n\t\t\t\tstyle.addColorStop( 0, color );\r\n\t\t\t\tstyle.addColorStop( amount, color );\r\n\t\t\t\tstyle.addColorStop( amount, background );\r\n\t\t\t\tstyle.addColorStop( 1, background );\r\n\t\t\t} else {\r\n\t\t\t\tstyle = opts.color || draw.color;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t//\r\n\t\t\tif (!opts.fill && !opts.stroke)\r\n\t\t\t\topts.fill = true;\r\n\t\t\t\r\n\t\t\t//\r\n\t\t\tif (opts.fill) {\r\n\t\t\t\tctx.fillStyle = style;\r\n\t\t\t\tctx.fill();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (opts.stroke) {\r\n\t\t\t\tctx.strokeStyle = style\r\n\t\t\t\tctx.lineWidth = opts.lineWidth || 1;\r\n\t\t\t\tctx.stroke();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * @param {number} x\r\n\t\t * @param {number} y\r\n\t\t * @param {number} w\r\n\t\t * @param {number} h\r\n\t\t * @param {object} options\r\n\t\t */\r\n\t\trectangle: function( x, y, w, h, options = {} ) {\r\n\t\t\r\n\t\t\t//\r\n\t\t\tlet ctx = draw.context;\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.rect( x, y, w, h );\r\n\t\t\t\r\n\t\t\t//\r\n\t\t\tlet style;\r\n\t\t\tif ( options.healthbar ) {\r\n\t\t\t\tlet amount = options.healthbar.amount || 1;\r\n\t\t\t\tlet color = options.healthbar.color || \"#0F0\";\r\n\t\t\t\tlet background = options.healthbar.background || \"#F00\";\r\n\t\t\t\tstyle = ctx.createLinearGradient( x, 0, x+w, 0 );\r\n\t\t\t\tstyle.addColorStop( 0, color );\r\n\t\t\t\tstyle.addColorStop( amount, color );\r\n\t\t\t\tstyle.addColorStop( amount, background );\r\n\t\t\t\tstyle.addColorStop( 1, background );\r\n\t\t\t} else {\r\n\t\t\t\tstyle = options.color || draw.color;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t//\r\n\t\t\tif (!opts.fill && !opts.stroke)\r\n\t\t\t\topts.fill = true;\r\n\t\t\t\r\n\t\t\t//\r\n\t\t\tif (options.fill) {\r\n\t\t\t\tctx.fillStyle = style;\r\n\t\t\t\tctx.fill();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (opts.stroke) {\r\n\t\t\t\tctx.strokeStyle = style;\r\n\t\t\t\tctx.lineWidth = options.lineWidth || 1;\r\n\t\t\t\tctx.stroke();\r\n\t\t\t}\r\n\t\t\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n}\r\n\r\n//\r\nexport default draw;\r\n\n\n\n// WEBPACK FOOTER //\n// ./js/draw.js","/**\r\n * @module sprite\r\n */\r\n\r\n//\r\nimport color from \"./color.js\";\r\n\r\n//\r\nlet aSprites = [],\r\n\taLength = 0;\r\n\r\n/**\r\n *\r\n */\r\nlet sprite = {\r\n\t\r\n\t//\r\n\tnames: [],\r\n\tarray: aSprites,\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tcreate: function( options = {} ) {\r\n\r\n\t\t//\r\n\t\tlet atlas, atlasIndex;\r\n\t\tif ( options.atlas ) {\r\n\t\t\tatlasIndex = options.atlasIndex || 0;\r\n\t\t\tatlas = options.atlas.images[atlasIndex];\r\n\t\t}\r\n\t\t\r\n\t\t//\r\n\t\tlet newSprite = {\r\n\t\t\tassetType: \"sprite\",\r\n\t\t\tname: options.name || newSpriteName(),\r\n\t\t\toriginX: options.originX || 0,\r\n\t\t\toriginY: options.originY || 0,\r\n\t\t\twidth: 0,\r\n\t\t\theight: 0,\r\n\t\t\timages: []\r\n\t\t}\r\n\t\t\r\n\t\t//\r\n\t\tif ( options.frames ) {\r\n\t\t\toptions.frames.forEach( function( frame ) {\r\n\t\t\t\tsprite.addFrame( newSprite, {\r\n\t\t\t\t\tsource: frame.src\r\n\t\t\t\t});\r\n\t\t\t} );\r\n\t\t}\r\n\t\t\r\n\t\t//\r\n\t\tsprite.names[aLength] = newSprite.name;\r\n\t\taSprites[aLength++] = newSprite;\r\n\t\treturn newSprite;\r\n\r\n\t},\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\taddFrame: function( spr, options = {} ) {\r\n\t\t\r\n\t\tspr = sprite.get( spr );\r\n\t\t\r\n\t\t//\r\n\t\tlet atlas;\r\n\t\tif ( options.atlas ) {\r\n\t\t\tatlas = sprite.get( options.atlas ).images[0].img;\r\n\t\t}\r\n\t\t\r\n\t\tlet image = {\r\n\t\t\timg: atlas || new Image(),\r\n\t\t\tclip: null,\r\n\t\t\tready: false\r\n\t\t}\r\n\t\t\r\n\t\t//\r\n\t\tif ( options.source ) {\r\n\t\t\t\r\n\t\t\timage.img.onload = function() {\r\n\t\t\t\t\r\n\t\t\t\t//\r\n\t\t\t\timage.clip = {\r\n\t\t\t\t\tx: 0,\r\n\t\t\t\t\ty: 0,\r\n\t\t\t\t\tw: image.img.width,\r\n\t\t\t\t\th: image.img.height\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t//\r\n\t\t\t\tif ( spr.width * spr.height === 0 ) {\r\n\t\t\t\t\tspr.width = image.clip.w;\r\n\t\t\t\t\tspr.height = image.clip.h;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t//\r\n\t\t\t\timage.ready = true;\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\timage.img.src = options.source || \"\";\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\t//\r\n\t\tif ( atlas && options.clip ) {\r\n\t\t\t\r\n\t\t\t//\r\n\t\t\timage.clip = options.clip;\r\n\t\t\tconsole.log( image.clip );\r\n\t\t\t\r\n\t\t\t//\r\n\t\t\tif ( spr.width * spr.height === 0 ) {\r\n\t\t\t\tspr.width = image.clip.w;\r\n\t\t\t\tspr.height = image.clip.h;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t//\r\n\t\t\timage.ready = true;\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\t//\r\n\t\tspr.images.push( image );\r\n\t\t\r\n\t},\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tcache: function( spr, options = {} ) {\r\n\t\t\r\n\t\tspr = sprite.get( spr );\r\n\t\tspr.images.forEach( function( frame ) {\r\n\t\t\tlet canvas = document.createElement( \"CANVAS\" );\r\n\t\t\tcanvas.width = options.width || frame.img.width;\r\n\t\t\tcanvas.height = options.height || frame.img.height;\r\n\t\t\tlet ctx = canvas.getContext( \"2d\" );\r\n\t\t\tctx.drawImage( frame.img, 0, 0, canvas.width+1, canvas.height+1 );\r\n\t\t\t\r\n\t\t\tframe.clip.x = 0;\r\n\t\t\tframe.clip.y = 0;\r\n\t\t\tframe.clip.w = canvas.width;\r\n\t\t\tframe.clip.h = canvas.height;\r\n\t\t\tframe.img = canvas;\r\n\t\t} );\r\n\t\t\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tsetOrigin: function( spr, x, y ) {\r\n\t\t\r\n\t\tspr = sprite.get( spr );\r\n\t\tspr.originX = Number( x );\r\n\t\tspr.originY = Number( y );\r\n\t\t\r\n\t},\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\treadyAll: function() {\r\n\t\t\r\n\t\tfor ( var n=0; n<aLength; n++ ) {\r\n\t\t\tlet spr = aSprites[n];\r\n\t\t\tfor ( var i=0; i<spr.images.length; i++ ) {\r\n\t\t\t\tlet image = spr.images[i];\r\n\t\t\t\tif ( !image.ready ) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn true;\r\n\t\t\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\ttint: function( spr, col ) {\r\n\t\t\r\n\t\tif ( typeof spr !== \"object\" )\r\n\t\t\tspr = sprite.get( spr );\r\n\t\t\r\n\t\t//\r\n\t\tspr.images.forEach( function( image ) {\r\n\t\t\t\r\n\t\t\t// create canvas, draw image\r\n\t\t\tlet canvas = document.createElement( \"CANVAS\" );\r\n\t\t\tlet ctx = canvas.getContext( \"2d\" );\r\n\t\t\tcanvas.width = spr.width;\r\n\t\t\tcanvas.height = spr.height;\r\n\t\t\tctx.drawImage( image.img, 0, 0 );\r\n\t\t\t\r\n\t\t\t// get data, do thing, put data back\r\n\t\t\tlet imageData = ctx.getImageData( 0, 0, canvas.width, canvas.height );\r\n\t\t\tpixelDataTint( imageData.data, (typeof col === \"object\") ? col : color.hexToRgb( col ) );\r\n\t\t\tctx.putImageData( imageData, 0, 0 );\r\n\t\t\t\r\n\t\t\t//\r\n\t\t\timage.img.src = canvas.toDataURL( \"image/png\" );\r\n\t\t\t\r\n\t\t} );\r\n\t\t\r\n\t},\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tget: function( name ) {\r\n\t\t\r\n\t\tif ( typeof name === \"object\" )\r\n\t\t\treturn name;\r\n\t\t\r\n\t\tfor ( var n = 0; n < aLength; n++ )\r\n\t\t\tif ( aSprites[n].name === name )\r\n\t\t\t\treturn aSprites[n];\r\n\t\t\t\r\n\t\treturn null;\r\n\t\t\r\n\t}\r\n\t\r\n}\r\n\r\n/**\r\n *\r\n */\r\nfunction newSpriteName() {\r\n\treturn \"Sprite_\" + aLength;\r\n}\r\n\r\n/**\r\n *\r\n */\r\nfunction pixelDataTint( data, rgb ) {\r\n\t\r\n\t// cache as much as possible, there could be a lot of pixels\r\n\tlet l = data.length,\r\n\t\tr = rgb.r / 255,\r\n\t\tg = rgb.g / 255,\r\n\t\tb = rgb.b / 255;\r\n\t\r\n\t//\r\n\tfor (var i = 0; i < l; i += 4) {\r\n\t\tdata[i]     = r * data[i]     >> 0;\r\n\t\tdata[i + 1] = g * data[i + 1] >> 0;\r\n\t\tdata[i + 2] = b * data[i + 2] >> 0;\r\n\t}\r\n\t\r\n}\r\n\r\n//\r\nexport default sprite;\r\n\n\n\n// WEBPACK FOOTER //\n// ./js/sprite.js","/**\r\n * @module instances\r\n */\r\n\r\nimport math from \"./math.js\";\r\nimport input from \"./input.js\";\r\nimport object from \"./object.js\";\r\nimport sprite from \"./sprite.js\";\r\nimport draw from \"./draw.js\";\r\nimport compile from \"./compile.js\";\r\n\r\n//\r\nwindow.global = {};\r\nlet aInstances = [];\r\nlet otherStack = [];\r\n\r\n//\r\nlet instance = {\r\n\t\r\n\t//\r\n\tinstanceArray: aInstances,\r\n\tinstanceHardLimit: 1000,\r\n\t\r\n\t/**\r\n\t * @param {object} obj\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t */\r\n\tcreate: function(obj, x, y) {\r\n\t\t\r\n\t\t//\r\n\t\tlet o = object.get(obj);\r\n\t\tif ( o === null ) {\r\n\t\t\twindow.addConsoleText(\"#F00\", \"No such object as \" + obj);\r\n\t\t\twindow._GB_stop();\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\t\r\n\t\tlet inst = o.pool.get();\r\n\t\tinst.object = o;\r\n\t\tinst.objectName = o.objectName;\r\n\t\tinst.assetType = \"instance\";\r\n\t\tinst.x = Number( x );\r\n\t\tinst.y = Number( y );\r\n\t\tinst.boxCollision = Object.assign( {}, inst.boxCollision );\r\n\t\t\r\n\t\t//\r\n\t\tlet spr = sprite.get( inst.sprite );\r\n\t\tif ( spr ) {\r\n\t\t\tinst.boxCollision.x = spr.originX;\r\n\t\t\tinst.boxCollision.y = spr.originY;\r\n\t\t\tinst.boxCollision.width = spr.width;\r\n\t\t\tinst.boxCollision.height = spr.height;\r\n\t\t}\r\n\t\t\r\n\t\t//\r\n\t\tinstance.addToArray( inst );\r\n\t\tinstance.updateBoundingBox( inst );\r\n\t\tinstance.updateCollisionBox( inst );\r\n\t\tinstance.executeEvent( inst, \"create\" );\r\n\t\t\r\n\t\t//\r\n\t\treturn inst;\r\n\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\taddToArray: function(inst) {\r\n\t\t\r\n\t\tfor ( var i=0; i<aInstances.length; i++ ) {\r\n\t\t\tif ( inst.depth <= aInstances[i].depth ) {\r\n\t\t\t\taInstances.splice( i, 0, inst );\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\taInstances.push(inst);\r\n\r\n\t},\r\n\r\n\t/**\r\n\t * @param {object} obj\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @param {number} speed\r\n\t * @param {number} direction\r\n\t */\r\n\tcreateMoving: function( obj, x, y, speed, direction ) {\r\n\r\n\t\tif ( aInstances.length >= instance.instanceHardLimit ) {\r\n\t\t\tconsole.warn( \"instance number hard limit reached:\", instance.instanceHardLimit );\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet newInst = instance.create(obj, x, y);\r\n\t\tnewInst.speed = speed;\r\n\t\tnewInst.direction = direction;\r\n\t\treturn newInst;\r\n\t\t\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tfind: function( objectName, instNumber ) {\r\n\t\t\r\n\t\tlet n, c=0;\r\n\t\tfor ( n=0; n<aInstances.length; n++ ) {\r\n\t\t\tlet inst = instance.instanceArray[n];\r\n\t\t\tif ( inst.objectName === objectName ) {\r\n\t\t\t\tif ( c++ === instNumber )\r\n\t\t\t\t\treturn inst;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t\t\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tfindRandom: function( name ) {\r\n\t\t\r\n\t\tlet n, c = 0, instNumber = math.randomInt( 0, count( name ) - 1 );\r\n\t\tfor ( n=0; n<instance.instanceArray.length; n++ ) {\r\n\t\t\tlet inst = instance.instanceArray[n];\r\n\t\t\tif ( inst.objectName === name ) {\r\n\t\t\t\tif ( c++ === instNumber )\r\n\t\t\t\t\treturn inst;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t\t\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tcount: function( objectName ) {\r\n\t\t\r\n\t\tlet n, c=0;\r\n\t\tinstance.instanceArray.forEach( function( inst ) {\r\n\t\t\tc += (inst.objectName === objectName);\r\n\t\t} );\r\n\t\treturn c;\r\n\t\t\r\n\t},\r\n\r\n\t/**\r\n\t * @param {number} rotation\r\n\t * @param {boolean} relative\r\n\t */\r\n\tsetRotation: function(rotation, relative) {\r\n\t\tthis.rotation = (relative) ? this.rotation + rotation : rotation;\r\n\t},\r\n\r\n\t/**\r\n\t * @param {number} rotation\r\n\t * @param {boolean} relative\r\n\t */\r\n\tsetDirection: function(direction, relative) {\r\n\t\tthis.direction = (relative) ? this.direction + direction : direction;\r\n\t},\r\n\r\n\t/**\r\n\t * @param {object} inst\r\n\t */\r\n\tmouseOn: function(inst) {\r\n\t\t\r\n\t\treturn !(inst.boxTop > input.mouse.y/2 - draw.offsetY\r\n\t\t|| inst.boxBottom < input.mouse.y/2 - draw.offsetY\r\n\t\t|| inst.boxLeft > input.mouse.x/2 - draw.offsetX\r\n\t\t|| inst.boxRight < input.mouse.x/2 - draw.offsetX);\r\n\t\t\r\n\t},\r\n\r\n\t/**\r\n\t * @param {instance} inst\r\n\t */\r\n\tstep: function( inst, dt ) {\r\n\t\t\r\n\t\t// step events\r\n\t\tinstance.executeEvent( inst, \"step\" );\r\n\t\tinstance.updateAnimation( inst, dt );\r\n\t\tinstance.updatePosition( inst, dt );\r\n\t\tinstance.updateBoundingBox( inst );\r\n\t\tinstance.updateCollisionBox( inst );\r\n\t\t\r\n\t\t// collision events\r\n\t\tinstance.instanceExecuteListeners( inst );\r\n\t\t\r\n\t\t// input events\r\n\t\tinput.triggerEvents.forEach( function( event ) {\r\n\t\t\tinstance.executeEvent( inst, event );\r\n\t\t} );\r\n\t\t\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tupdateAnimation: function( inst, dt ) {\r\n\t\t\r\n\t\tinst.index += inst.imageSpeed;\r\n\t\tlet spr = sprite.get( inst.sprite );\r\n\t\tif ( spr ) {\r\n\t\t\tlet length = spr.images.length;\r\n\t\t\tif ( inst.index >= length ) {\r\n\t\t\t\t\r\n\t\t\t\tlet behavior = inst.animationBehavior;\r\n\t\t\t\tlet type = typeof behavior;\r\n\t\t\t\t\r\n\t\t\t\t//\r\n\t\t\t\tif ( type === \"string\" ) {\r\n\t\t\t\t\r\n\t\t\t\t\t//\r\n\t\t\t\t\tif ( behavior === \"loop\" ) {\r\n\t\t\t\t\t\tinst.index -= length;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t//\r\n\t\t\t\t\telse if ( behavior === \"stop\" ) {\r\n\t\t\t\t\t\tinst.index = length - 1;\r\n\t\t\t\t\t\tinst.imageSpeed = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t//\r\n\t\t\t\telse if ( type === \"function\" ) {\r\n\t\t\t\t\tbehavior.call( inst );\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tupdatePosition: function( inst, dt ) {\r\n\t\t\r\n\t\t// if the instance is already falling at terminal velocity then we no longer apply gravity\r\n\t\tlet gravVector = {\r\n\t\t\tx: math.lengthDirX( inst.terminal, inst.gravityDirection ),\r\n\t\t\ty: math.lengthDirY( inst.terminal, inst.gravityDirection )\r\n\t\t};\r\n\t\t\r\n\t\tif ( gravVector.x > 0 && inst.speedX <= gravVector.x\r\n\t\t||   gravVector.x < 0 && inst.speedX >= gravVector.x ) {\r\n\t\t\tinst.speedX += math.lengthDirX( inst.gravity, inst.gravityDirection );\r\n\t\t}\r\n\t\t\r\n\t\tif ( gravVector.y > 0 && inst.speedY <= gravVector.y\r\n\t\t||   gravVector.y < 0 && inst.speedY >= gravVector.y ) {\r\n\t\t\tinst.speedY += math.lengthDirY( inst.gravity, inst.gravityDirection );\r\n\t\t}\r\n\r\n\t\t// move instance\r\n\t\tinst.x += inst.speedX * dt;\r\n\t\tinst.y += inst.speedY * dt;\r\n\t\t\r\n\t},\r\n\r\n\t/**\r\n\t * @param {object} inst\r\n\t */\r\n\tupdateBoundingBox: function( inst ) {\r\n\r\n\t\tlet spr = sprite.get( inst.sprite );\r\n\t\tif ( spr !== null ) {\r\n\t\t\tinst.boxTop    = inst.y - spr.originY * inst.scaleY;\r\n\t\t\tinst.boxLeft   = inst.x - spr.originX * inst.scaleX;\r\n\t\t\tinst.boxBottom = inst.boxTop + spr.height * inst.scaleY;\r\n\t\t\tinst.boxRight  = inst.boxLeft + spr.width * inst.scaleX;\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t/**\r\n\t * @param {object} inst\r\n\t */\r\n\tupdateCollisionBox: function( inst ) {\r\n\t\t\r\n\t\tlet box = inst.boxCollision;\r\n\t\tbox.top    = inst.y - box.y * inst.scaleY;\r\n\t\tbox.left   = inst.x - box.x * inst.scaleX;\r\n\t\tbox.bottom = box.top + box.height * inst.scaleY;\r\n\t\tbox.right  = box.left + box.width * inst.scaleX;\r\n\t\t\t\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tdestroy: function( inst, ev = true ) {\r\n\t\t\r\n\t\tinst.exists = false;\r\n\t\t\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tdraw: function(inst) {\r\n\t\t(inst.events[\"draw\"] !== undefined)\r\n\t\t\t? instance.executeEvent(inst, \"draw\")\r\n\t\t\t: instance.drawSelf(inst);\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tdrawSelf: function(inst) {\r\n\t\tif (inst.sprite !== null)\r\n\t\t\tdraw.sprite(\r\n\t\t\t\tinst.sprite,\r\n\t\t\t\tinst.index,\r\n\t\t\t\tinst.x, inst.y,\r\n\t\t\t\tinst.scaleX, inst.scaleY,\r\n\t\t\t\tinst.rotation\r\n\t\t\t);\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tdrawDebug: function(inst) {\r\n\t\tlet box = inst.boxCollision;\r\n\t\tdraw.shape.rectangle(\r\n\t\t\tbox.left,\r\n\t\t\tbox.top,\r\n\t\t\tbox.right - box.left,\r\n\t\t\tbox.bottom - box.top, {\r\n\t\t\t\tcolor: \"#FF000055\"\r\n\t\t\t}\r\n\t\t);\r\n\t},\r\n\r\n\t/**\r\n\t * @param {object} sprite\r\n\t */\r\n\tchangeSprite: function(sprite) {\r\n\t\tthis.sprite = sprite;\r\n\t},\r\n\r\n\t/**\r\n\t * @param {object} inst\r\n\t */\r\n\tinstanceExecuteListeners: function( inst ) {\r\n\r\n\t\tinst.listeners.forEach( listener => {\r\n\t\t\tswitch ( listener.type ) {\r\n\t\t\t\t\r\n\t\t\t\tcase ( \"collision\" ):\r\n\t\t\t\t\tinstance.instanceCollisionInstance( inst, listener.target );\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t\t\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tinstanceCollisionInstance: function( inst, target ) {\r\n\t\t\r\n\t\tlet arr = object.getAllInstances( target );\r\n\t\tlet box1 = inst.boxCollision;\r\n\t\tarr.forEach( function( targ ) {\r\n\t\t\t\r\n\t\t\t// same instance\r\n\t\t\tif ( inst === targ )\r\n\t\t\t\treturn;\r\n\t\t\t\r\n\t\t\t// no collision\r\n\t\t\tlet box2 = targ.boxCollision;\r\n\t\t\tif ( box1.left > box2.right\r\n\t\t\t||   box1.right < box2.left\r\n\t\t\t||   box1.top > box2.bottom\r\n\t\t\t||   box1.bottom < box2.top ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t\t// execute collision event\r\n\t\t\tinstance.executeEvent( inst, \"collision_\" + target, targ );\r\n\t\t\t\r\n\t\t} );\r\n\t\t\r\n\t},\r\n\r\n\t/**\r\n\t * @param {instance} inst\r\n\t * @param {event} event\r\n\t * @param {instance} otherInst The other instance, in collisions for example.\r\n\t */\r\n\texecuteEvent: function( inst, event, otherInst ) {\r\n\t\t\r\n\t\t// set the current \"other\" instance\r\n\t\totherStack.push( window.other );\r\n\t\twindow.other = otherInst;\r\n\t\t\r\n\t\t//\r\n\t\ttry {\r\n\t\t\t\r\n\t\t\tif ( inst.exists ) {\r\n\t\t\t\tlet actions = inst.events[event];\r\n\t\t\t\tif ( actions ) {\r\n\t\t\t\t\tinstance.executeActions( inst, actions, otherInst );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t\tcatch ( err ) {\r\n\t\t\tconsole.error( err );\r\n\t\t\twindow.addConsoleText( \"#F00\",\r\n\t\t\t\t\"Failed to execute event [\" + event + \"]\"\r\n\t\t\t\t+ \" of object [\" + inst.objectName + \"]\"\r\n\t\t\t\t+ \" with error: \" + err );\r\n\t\t}\r\n\t\t\r\n\t\t// restore previous \"other\" instance\r\n\t\twindow.other = otherStack.pop();\r\n\t\t\r\n\t},\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\texecuteEventAll: function(event, otherInst) {\r\n\t\tfor (var n = 0; n < aInstances.length; n++)\r\n\t\t\tinstance.executeEvent(aInstances[n], event, otherInst);\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\texecuteActions: function(inst, actions, otherInst) {\r\n\t\t\r\n\t\tlet condition = true,\r\n\t\t\tsteps = [],\r\n\t\t\tscope = 0,\r\n\t\t\ta, action;\r\n\t\t\r\n\t\tfor ( a=0; a<actions.length; a++ ) {\r\n\t\t\t\r\n\t\t\taction = actions[a];\r\n\t\t\tswitch ( action.flow ) {\r\n\t\t\t\t\r\n\t\t\t\t// regular action\r\n\t\t\t\tcase ( \"\" ):\r\n\t\t\t\t\t\r\n\t\t\t\t\tif ( condition ) {\r\n\t\t\t\t\t\tlet func = action.action,\r\n\t\t\t\t\t\t\targs = action.args,\r\n\t\t\t\t\t\t\tn, newArgs = [];\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t//console.log(args);\r\n\t\t\t\t\t\tfor ( n = 0; n < args.length; n++ ) {\r\n\t\t\t\t\t\t\tswitch ( args[n] ) {\r\n\t\t\t\t\t\t\t\tcase ( \"self\" ): newArgs[n] = inst; break;\r\n\t\t\t\t\t\t\t\tcase ( \"other\" ): newArgs[n] = otherInst; break;\r\n\t\t\t\t\t\t\t\tdefault: newArgs[n] = compile.actionExpression.call(inst, args[n]); break\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\tcondition = func.apply(inst, newArgs);\r\n\t\t\t\t\t\t( condition === undefined )\r\n\t\t\t\t\t\t\t? condition = true\r\n\t\t\t\t\t\t\t: steps[scope] = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\t\t// control actions\r\n\t\t\t\tcase ( \"blockBegin\" ): scope++; break;\r\n\t\t\t\tcase ( \"blockEnd\" ): scope--; break;\r\n\t\t\t\tcase ( \"exitEvent\" ): if ( condition ) return false; break;\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// exit from a single statement after an expression not contained in a block\r\n\t\t\tif ( steps[scope]++ === 1 )\r\n\t\t\t\tcondition = true;\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t},\r\n\r\n\t/**\r\n\t * @param {number} dt Delta time.\r\n\t */\r\n\tstepAll: function( dt ) {\r\n\t\t\r\n\t\taInstances.forEach( function( i ) {\r\n\t\t\tinstance.step( i, dt );\r\n\t\t} );\r\n\t\t\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tdrawAll: function() {\r\n\t\t\r\n\t\taInstances.forEach( function( inst ) {\r\n\t\t\t( inst.visible ) && instance.draw( inst );\r\n\t\t});\r\n\t\t\r\n\t},\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tclearDestroyed: function() {\r\n\t\t\r\n\t\tfor ( var n=aInstances.length-1; n>=0; n-- ) {\r\n\t\t\tlet i = aInstances[n];\r\n\t\t\tif( !i.exists ) {\r\n\t\t\t\ti.exists = true;\r\n\t\t\t\ti.speedX = 0;\r\n\t\t\t\ti.speedY = 0;\r\n\t\t\t\ti.object.pool.release( i );\r\n\t\t\t\taInstances.splice( n, 1 );\r\n\t\t\t}\r\n\t\t}\r\n\t\r\n\t}\r\n\r\n}\r\n\r\n\r\nexport default instance;\r\n\n\n\n// WEBPACK FOOTER //\n// ./js/instance.js","/**\r\n * @module canvas\r\n */\r\n\r\n//\r\nimport draw from \"./draw.js\";\r\n\t\r\n//\r\nlet canvas = {\r\n\t\r\n\t//\r\n\tarray: [],\r\n\tmain: null,\r\n\tdom: null,\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tcreate: function( options = {} ) {\r\n\t\t\r\n\t\t//\r\n\t\tlet c = document.createElement( \"CANVAS\" );\r\n\t\tcanvas.array.push( c );\r\n\t\t\r\n\t\t//\r\n\t\tc.width = options.width || 300;\r\n\t\tc.height = options.height || 150;\r\n\t\tc.scale = options.scale || 1;\r\n\t\tc.application = options.application || false;\r\n\t\t\r\n\t\t//\r\n\t\tif ( options.crisp2D ) {\r\n\t\t\tlet ctx = c.getContext( \"2d\" );\r\n\t\t\tctx.imageSmoothingEnabled = false;\r\n\t\t\t//ctx.scale( c.scale, c.scale );\r\n\t\t}\r\n\t\t\r\n\t\t//\r\n\t\tif ( c.application ) {\r\n\t\t\tdraw.setTarget( c );\r\n\t\t\tcanvas.setMain( c );\r\n\t\t}\r\n\t\t\r\n\t\t//\r\n\t\tc.oncontextmenu = function( e ){\r\n\t\t\te.preventDefault()\r\n\t\t}\r\n\t\t\r\n\t\t//\r\n\t\treturn c;\r\n\t\t\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tsetMain: function( c ) {\r\n\t\r\n\t\tcanvas.main = c;\r\n\t\tif ( canvas.dom === null ) {\r\n\t\t\tcanvas.dom = c;\r\n\t\t\tvar el = document.getElementById(\"gbgamebox\") || document.body;\r\n\t\t\tel.appendChild( c );\r\n\t\t}\r\n\t\r\n\t},\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tgetMain: function() {\r\n\t\treturn canvas.main;\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tclear: function( c, color ) {\r\n\t\tvar ctx = c.getContext( \"2d\" );\r\n\t\tctx.fillStyle = color || \"#000000\";\r\n\t\tctx.fillRect( 0, 0, c.width / c.scale, c.height / c.scale );\r\n\t}\r\n\t\r\n}\r\n\r\n//\r\nexport default canvas;\r\n\n\n\n// WEBPACK FOOTER //\n// ./js/canvas.js","/**\r\n * @module math\r\n */\r\n\r\nlet math = {\r\n \r\n\t// constances\r\n\tPI: Math.PI,\r\n\tRADTODEG: 180 / Math.PI,\r\n\tDEGTORAD: Math.PI / 180,\r\n\t\t\r\n\t// copied functions\r\n\tcos: Math.cos,\r\n\tsin: Math.sin,\r\n\tsign: Math.sign,\r\n\t\t\r\n\t/**\r\n\t *\r\n\t */\r\n\trandomInt: function( min, max ) {\r\n\t\tmin = Math.ceil( min );\r\n\t\tmax = Math.floor( max );\r\n\t\treturn Math.floor( Math.random() * ( max - min + 1 ) ) + min;\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tchoose: function( ...value ) {\r\n\t\treturn value[Math.floor( Math.random() * value.length )];\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tlengthDirX: function( l, d ) {\r\n\t\treturn Math.cos( d * math.DEGTORAD ) * l;\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tlengthDirY: function( l, d ) {\r\n\t\treturn Math.sin( d * math.DEGTORAD ) * l;\r\n\t},\r\n\t \r\n\t/**\r\n\t * @param {number} x1\r\n\t * @param {number} y1\r\n\t * @param {number} x2\r\n\t * @param {number} y2\r\n\t */\r\n\tpointDistance: function( x1, y1, x2, y2 ) {\r\n\t\tlet a = x1 - x2,\r\n\t\t\tb = y1 - y2;\r\n\t\treturn Math.sqrt( a * a + b * b );\r\n\t},\r\n\r\n\t/**\r\n\t * @param {number} x1\r\n\t * @param {number} y1\r\n\t * @param {number} x2\r\n\t * @param {number} y2\r\n\t */\r\n\tpointDirection: function( x1, y1, x2, y2 ) {\r\n\t\treturn ( ( Math.atan2( y2 - y1, x2 - x1 ) * math.RADTODEG ) + 360 ) % 360;\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tangleDifference: function( angle1, angle2 ) {\r\n\t\t\r\n\t\tlet diff = ( angle2 - angle1 ) % 360;\r\n\t\t\r\n\t\tif ( diff <= -180 ) {\r\n\t\t\tdiff += 360;\r\n\t\t} else if ( diff > 180 ) {\r\n\t\t\tdiff -= 360;\r\n\t\t}\r\n\t\t\r\n\t\treturn diff;\r\n\t\t\r\n\t}\r\n\t\r\n}\r\n\r\n//\r\nexport default math;\n\n\n// WEBPACK FOOTER //\n// ./js/math.js","/**\r\n * @module room\r\n */\r\n\r\n//\r\nimport Transition from \"./transition.js\";\r\nimport instance from \"./instance.js\";\r\nimport sprite from \"./sprite.js\";\r\nimport draw from \"./draw.js\";\r\n \r\n//\r\nlet room = {\r\n\t\r\n\tarray: [],\r\n\tcurrent: null,\r\n\t\r\n\t/**\r\n\t * @param {string} name\r\n\t * @param {int} width\r\n\t * @param {int} height\r\n\t */\r\n\tcreate: function(name, width, height) {\r\n\t\t\r\n\t\tlet newRoom = {\r\n\t\t\tname: name,\r\n\t\t\tassetType: \"room\",\r\n\t\t\twidth: Number(width),\r\n\t\t\theight: Number(height),\r\n\t\t\tbackground: null,\r\n\t\t\tbackgroundMethod: \"no-repeat\",\r\n\t\t\tinstances: []\r\n\t\t};\r\n\t\t\r\n\t\tif (room.current === null)\r\n\t\t\troom.current = newRoom;\r\n\t\t\r\n\t\troom.array.push(newRoom);\r\n\t\treturn newRoom;\r\n\t\t\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tsetBackground: function(rm, spr) {\r\n\t\trm = room.get(rm);\r\n\t\trm.background = spr;\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\taddInstance: function(rm, inst, x, y) {\r\n\t\trm = room.get(rm);\r\n\t\trm.instances.push({ name: inst, x: x, y: y });\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tenter: function(rm, opts = {}) {\r\n\t\t\r\n\t\tif (opts.transition) {\r\n\t\t\tnew Transition({\r\n\t\t\t\tprefab: opts.transition,\r\n\t\t\t\tcallback: room.enter.bind(null, rm)\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\t// leave room event\r\n\t\tinstance.executeEventAll(\"roomleave\");\r\n\t\t\r\n\t\t// clear current instances\r\n\t\tinstance.instanceArray.forEach(function(i) {\r\n\t\t\tinstance.destroy(i, false);\r\n\t\t});\r\n\r\n\t\t// goto new room and create new instances\r\n\t\trm = room.get(rm);\r\n\t\troom.current = rm;\r\n\t\trm.instances.forEach(function(inst) {\r\n\t\t\tinstance.create(inst.name, inst.x, inst.y);\r\n\t\t});\r\n\t\t\r\n\t\t// enter room event\r\n\t\tinstance.executeEventAll(\"roomenter\");\r\n\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tdraw: function(rm) {\r\n\r\n\t\t// draw background\r\n\t\trm = room.get(rm);\r\n\t\tlet spr = sprite.get(rm.background);\r\n\t\tif ( spr !== null ) {\r\n\t\t\t\r\n\t\t\tvar canvas = draw.getTarget();\r\n\t\t\tvar ctx = canvas.getContext( \"2d\" );\r\n\t\t\tlet image = spr.images[0].img;\r\n\t\t\tif ( rm.backgroundMethod === \"stretch\" ) {\r\n\t\t\t\tctx.drawImage( image, 0, 0, canvas.width, canvas.height );\r\n\t\t\t} else {\r\n\t\t\t\tlet ptrn = ctx.createPattern( image, rm.backgroundMethod );\r\n\t\t\t\tctx.fillStyle = ptrn;\r\n\t\t\t\tctx.fillRect( 0, 0, canvas.width, canvas.height );\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\r\n\t},\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tget: function(name) {\r\n\t\t\r\n\t\tif ( typeof name === \"object\" )\r\n\t\t\treturn name;\r\n\t\t\r\n\t\tfor ( var n = 0; n < room.array.length; n++ )\r\n\t\t\tif ( room.array[n][\"name\"] === name )\r\n\t\t\t\treturn room.array[n];\r\n\t\t\t\r\n\t\treturn null;\r\n\t\t\t\r\n\t}\r\n\t\r\n}\r\n\r\n//\r\nexport default room;\n\n\n// WEBPACK FOOTER //\n// ./js/room.js","\r\nimport draw from \"./draw.js\";\r\n\r\nconst noop = () => {};\r\n\r\nexport default class Transition {\r\n\t\r\n\t/**\r\n\t* @param {object} opts Options.\r\n\t* @param {string} opts.type\r\n\t* @param {string} opts.time Time in steps the tranistion will last per stage (in/out).\r\n\t* @param {string} opts.color Color of the transition.\r\n\t* @param {string} opts.callback Function to execute mid-transition.\r\n\t*/\r\n\tconstructor(opts = {}) {\r\n\t\tthis.type = opts.type || \"fade\";\r\n\t\tthis.time = opts.time || 60;\r\n\t\tthis.color = opts.color || \"#000000\";\r\n\t\tthis.callback = opts.callback || noop;\r\n\t\tif (opts.prefab) Object.assign(this, opts.prefab);\r\n\t\tthis.direction = 1;\r\n\t\tthis.alpha = 0;\r\n\t\tthis.delta = 1/this.time;\r\n\t\tTransition.allInstances.push(this);\r\n\t\t\r\n\t\t// Check transition type exists and log warning otherwise\r\n\t\tif (!Transition.prefabs.hasOwnProperty(this.type)) {\r\n\t\t\twindow.addConsoleText(\"#F00\", \"Unknown transition type: \" + this.type);\r\n\t\t\tthis.type = \"fade\";\r\n\t\t}\r\n\t}\r\n\t\r\n\t/** */\r\n\tupdate() {\r\n\t\tif (Transition.prefabs.hasOwnProperty(this.type))\r\n\t\t\tTransition.prefabs[this.type].update.call(this);\r\n\t}\r\n\t\r\n\t/** */\r\n\tdraw() {\r\n\t\tif (Transition.prefabs.hasOwnProperty(this.type))\r\n\t\t\tTransition.prefabs[this.type].draw.call(this);\r\n\t}\r\n\t\r\n\t/** */\r\n\tdestroy() {\r\n\t\tlet x = Transition.allInstances.indexOf(this);\r\n\t\tTransition.allInstances.splice(x, 1);\r\n\t}\r\n\t\r\n\t/** */\r\n\tstatic create(opts) {\r\n\t\treturn new Transition(opts);\r\n\t}\r\n\t\r\n\t/** */\r\n\tstatic updateAll() {\r\n\t\tTransition.allInstances.forEach((t) => {\r\n\t\t\tt.update();\r\n\t\t});\r\n\t}\r\n\t\r\n\t/** */\r\n\tstatic drawAll() {\r\n\t\tTransition.allInstances.forEach((t) => {\r\n\t\t\tt.draw();\r\n\t\t});\r\n\t}\r\n\t\r\n}\r\n\r\n//\r\nTransition.allInstances = [];\r\n\r\n/**\r\n * @namespace\r\n */\r\nTransition.prefabs = {\r\n\r\n\t\"fade\": {\r\n\t\tupdate: function() {\r\n\t\t\tthis.alpha += this.direction ? this.delta : -this.delta;\r\n\t\t\tif (this.alpha >= 1) {\r\n\t\t\t\tthis.callback();\r\n\t\t\t\tthis.direction = 0;\r\n\t\t\t} else if (this.alpha <= 0) {\r\n\t\t\t\tthis.destroy();\r\n\t\t\t\tconsole.log(\"destroy\");\r\n\t\t\t}\r\n\t\t},\r\n\t\tdraw: function() {\r\n\t\t\tvar canvas = draw.getTarget();\r\n\t\t\tvar ctx = canvas.getContext(\"2d\");\r\n\t\t\tctx.globalAlpha = this.alpha;\r\n\t\t\tctx.fillStyle = this.color;\r\n\t\t\tctx.fillRect(0, 0, 9999999, 9999999);\r\n\t\t}\r\n\t}\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./js/transition.js","/**\r\n * @module input\r\n */\r\n \r\nimport canvas from \"./canvas\";\r\nimport keyValues from \"./keyvalues.js\";\r\n\r\nlet element = document;\r\n\r\n// mouse object\r\nlet __mouse = {\r\n\tpressed: [false, false, false],\r\n\tdown: [false, false, false],\r\n\treleased: [false, false, false],\r\n\twheelUp: false,\r\n\twheelDown: false,\r\n\tx: 0,\r\n\ty: 0\r\n}\r\n\r\n// keboard object\r\nlet __keyboard = {\r\n\tpressed: {},\r\n\tdown: {},\r\n\treleased: {}\r\n}\r\n\r\n// touch object\r\nlet __touch = {\r\n\tstart: [],\r\n\theld: [],\r\n\tmove: [],\r\n\tend: [],\r\n\tcancel: [],\r\n\tx: [],\r\n\ty: []\r\n}\r\n\r\n//\r\nlet __triggerEvents = [];\r\n\r\n//\r\nlet input = {\r\n\t\r\n\ttriggerEvents: __triggerEvents,\r\n\tmouse: __mouse,\r\n\tkeyboard: __keyboard,\r\n\ttouch: __touch,\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tinit: function() {\r\n\t\r\n\t\t// init all input methods\r\n\t\tinput.initMouse();\r\n\t\tinput.initKeyboard();\r\n\t\tinput.initTouch();\r\n\t\t\r\n\t\t// disable context menu\r\n\t\telement.oncontextmenu = function( e ) {\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\t\r\n\t},\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tinitMouse: function() {\r\n\t\t\r\n\t\t//\r\n\t\tlet handleMouseDown = function( e ) {\r\n\t\t\te.preventDefault();\r\n\t\t\t( !__mouse.pressed[e.button] ) && window.focus();\r\n\t\t\t__mouse.pressed[e.button] = true;\r\n\t\t\t__mouse.down[e.button] = true;\r\n\t\t}\r\n\t\t\r\n\t\t//\r\n\t\tlet handleMouseUp = function( e ) {\r\n\t\t\te.preventDefault();\r\n\t\t\t__mouse.pressed[e.button] = false;\r\n\t\t\t__mouse.released[e.button] = true;\r\n\t\t\t__mouse.down[e.button] = false;\r\n\t\t}\r\n\t\t\r\n\t\t//\r\n\t\tlet handleMouseMove = function(e) {\r\n\t\t\tlet canv = canvas.main;\r\n\t\t\tlet rect = canv.getBoundingClientRect();\r\n\t\t\t__mouse.x = e.clientX - rect.left;\r\n\t\t\t__mouse.y = e.clientY - rect.top;\r\n\t\t}\r\n\t\t\r\n\t\t//\r\n\t\tlet handleMouseWheel = function( e ) {\r\n\t\t\te.preventDefault();\r\n\t\t\tlet delta = Math.max( -1, Math.min( 1, e.wheelDelta ) );\r\n\t\t\t__mouse.wheelUp = delta > 0;\r\n\t\t\t__mouse.wheelDown = delta < 0;\r\n\t\t}\r\n\t\t\r\n\t\t//\r\n\t\telement.onmousedown = handleMouseDown;\r\n\t\telement.onmouseup = handleMouseUp;\r\n\t\telement.onmousemove = handleMouseMove;\r\n\t\telement.onmousewheel = handleMouseWheel;\r\n\t\t\r\n\t},\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tinitKeyboard: function() {\r\n\t\t\r\n\t\t//\r\n\t\tkeyValues.forEach( function( key ) {\r\n\t\t\t__keyboard.pressed[key] = false;\r\n\t\t\t__keyboard.down[key] = false;\r\n\t\t\t__keyboard.released[key] = false;\r\n\t\t} );\r\n\t\t\r\n\t\t//\r\n\t\tlet handleKeyDown = function( e ) {\r\n\t\t\te.preventDefault();\r\n\t\t\tif ( !__keyboard.down[e.code] ) {\r\n\t\t\t\t__keyboard.pressed[e.code] = true;\r\n\t\t\t\t__keyboard.down[e.code] = true;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t//\r\n\t\tlet handleKeyUp = function( e ) {\r\n\t\t\te.preventDefault();\r\n\t\t\t__keyboard.released[e.code] = true;\r\n\t\t\t__keyboard.down[e.code] = false;\r\n\t\t}\r\n\t\t\r\n\t\t//\r\n\t\telement.onkeydown = handleKeyDown;\r\n\t\telement.onkeyup = handleKeyUp;\r\n\t\t\r\n\t},\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tinitTouch: function() {\r\n\t\t\r\n\t\t//\r\n\t\tlet handleTouchStart = function( e ) {\r\n\t\t\te.preventDefault();\r\n\t\t\t( !__touch.start[0] ) && window.focus();\r\n\t\t\t__touch.start[0] = true;\r\n\t\t\t__touch.held[0] = true;\r\n\t\t}\r\n\t\t\r\n\t\t//\r\n\t\tlet handleTouchEnd = function( e ) {\r\n\t\t\te.preventDefault();\r\n\t\t\t__touch.start[0] = false;\r\n\t\t\t__touch.end[0] = true;\r\n\t\t\t__touch.held[0] = false;\r\n\t\t}\r\n\t\t\r\n\t\t//\r\n\t\tlet handleTouchMove = function( e ) {\r\n\t\t\te.preventDefault();\r\n\t\t\tlet touches = e.changedTouches;\r\n\t\t\t__touch.x[0] = touches[0].pageX;\r\n\t\t\t__touch.y[0] = touches[0].pageY;\r\n\t\t}\r\n\t\t\r\n\t\t//\r\n\t\telement.ontouchstart = handleTouchStart;\r\n\t\telement.ontouchend = handleTouchEnd;\r\n\t\telement.ontouchcancel = handleTouchEnd;\r\n\t\telement.ontouchmove = handleTouchMove;\r\n\t\t\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tgetTriggerEvents: function() {    \r\n\r\n\t\t__triggerEvents.length = 0;\r\n\t\tObject.keys( __keyboard.down ).forEach( key => {\r\n\t\t\t\r\n\t\t\tif ( keyValues.includes( key ) ) {\r\n\t\t\t\r\n\t\t\t\tif ( __keyboard.down[key] )\r\n\t\t\t\t\t__triggerEvents.push( key );\r\n\t\t\t\t\r\n\t\t\t\tif ( __keyboard.pressed[key] )\r\n\t\t\t\t\t__triggerEvents.push( key + \"Pressed\" );\r\n\t\t\t\t\r\n\t\t\t\tif ( __keyboard.released[key] )\r\n\t\t\t\t\t__triggerEvents.push( key + \"Released\" );\r\n\t\t\t\t\r\n\t\t\t} else {\r\n\t\t\t\r\n\t\t\t\tconsole.warn( \"input key not supported: \", key );\r\n\t\t\t\tdelete __keyboard.down[key];\r\n\t\t\t\r\n\t\t\t}\r\n\t\t\t\r\n\t\t} );\r\n\t\t\r\n\t\t// map mouse ids to names\r\n\t\tlet mouseMap = [\"Left\", \"Middle\", \"Right\"];\r\n\t\t\r\n\t\t// mouse events\r\n\t\tfor( var n=0; n<3; n++ ) {\r\n\t\t\t\r\n\t\t\tif ( __mouse.down[n] )\r\n\t\t\t\t__triggerEvents.push( mouseMap[n] + \"Down\" );\r\n\t\t\t\r\n\t\t\tif ( __mouse.pressed[n] )\r\n\t\t\t\t__triggerEvents.push( mouseMap[n] + \"Pressed\" );\r\n\t\t\t\r\n\t\t\tif ( __mouse.released[n] )\r\n\t\t\t\t__triggerEvents.push( mouseMap[n] + \"Released\" );\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\tif ( __mouse.wheelUp ) __triggerEvents.push( \"WheelUp\" );\r\n\t\tif ( __mouse.wheelDown ) __triggerEvents.push( \"WheelDown\" );\r\n\t\t\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tupdate: function() {\r\n\t\t\r\n\t\tObject.keys( __keyboard.down ).forEach( key => {\r\n\t\t\t__keyboard.pressed[key] = false;\r\n\t\t\t__keyboard.released[key] = false;\r\n\t\t} );\r\n\r\n\t\tObject.keys( __mouse.down ).forEach( button => {\r\n\t\t\t__mouse.pressed[button] = false;\r\n\t\t\t__mouse.released[button] = false;\r\n\t\t} );\r\n\t\t\r\n\t\tObject.keys( __touch.held ).forEach( button => {\r\n\t\t\t__touch.start[button] = false;\r\n\t\t\t__touch.end[button] = false;\r\n\t\t\t__touch.held[button] = false;\r\n\t\t} );\r\n\t\t\r\n\t\t__mouse.wheelUp = false;\r\n\t\t__mouse.wheelDown = false;\r\n\t\t\r\n\t}\r\n\t\r\n}\r\n\r\n//\r\nexport default input;\r\n\n\n\n// WEBPACK FOOTER //\n// ./js/input.js","/**\r\n * @module objects\r\n */\r\n\r\nimport event from \"./event.js\";\r\nimport instance from \"./instance.js\";\r\nimport objectVars from \"./objectVars.js\";\r\nimport Pool from \"./utils/pool.js\";\r\n\r\n/**\r\n *\r\n */\r\nexport default class object {\r\n\r\n\t/**\r\n\t * @param {string} name\r\n\t * @param {number} sprite\r\n\t */\r\n\tconstructor(name, sprite) {\r\n\t\tlet obj = function(){};\r\n\t\tobjectVars.set(obj.prototype);\r\n\t\tobj.assetType = \"object\";\r\n\t\tobj.objectName = name || \"object_\" + obj.id;\r\n\t\tobj.prototype.sprite = sprite || null;\r\n\t\tobj.pool = new Pool(obj);\r\n\t\tobject.names.push(obj.objectName);\r\n\t\tobject.array.push(obj);\r\n\t\treturn obj;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tstatic create(...args) {\r\n\t\treturn new object(...args);\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t\t*/\r\n\tstatic set(obj, property, value) {\r\n\t\tobj = object.get(obj);\r\n\t\tobj.prototype[property] = value;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Add an action with variable parameters to an event of an object.\r\n\t * @param object Can be an object constructor or integer ID.\r\n\t * @param event\r\n\t * @param action\r\n\t * @param {...*} args\r\n\t */\r\n\tstatic eventAddAction(obj, event, action, ...args) {\r\n\t\t\r\n\t\tobj = object.get(obj);\r\n\t\t\r\n\t\tif ( typeof event === \"object\" ) {\r\n\t\t\tobject.keys(event).forEach((key) => {\r\n\t\t\t\tevent[key].forEach((params) => {\r\n\t\t\t\t\tobject.eventAddAction(obj, key, ...params);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tif (action !== undefined) {\r\n\t\t\t\r\n\t\t\t// if flow action, get flow tag\r\n\t\t\tlet flow = \"\";\r\n\t\t\tif (typeof action === \"string\")\r\n\t\t\t\tflow = action;\r\n\t\t\t\r\n\t\t\t// create a new event if not yet defined\r\n\t\t\tif ( obj.prototype.events[event] === undefined ) {\r\n\t\t\t\t\r\n\t\t\t\tobj.prototype.events[event] = [];\r\n\t\t\t\t\r\n\t\t\t\tif ( event.includes( \"collision_\" ) ) {\r\n\t\t\t\t\tlet index = event.indexOf(\"_\") + 1;\r\n\t\t\t\t\tlet name = event.slice(index, 200);\r\n\t\t\t\t\tobject.addCollisionListener(obj, name);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// add action data to event\r\n\t\t\tobj.prototype.events[event].push({\r\n\t\t\t\tflow: flow,\r\n\t\t\t\taction: action,\r\n\t\t\t\targs: args\r\n\t\t\t});\r\n\t\t\t\r\n\t\t} else {\r\n\t\t\tconsole.warn(\"tried to add an undefined action to an event!\");\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tstatic addCollisionListener(obj, target) {\r\n\t\tobj.prototype.listeners.push({\r\n\t\t\ttype: \"collision\",\r\n\t\t\ttarget: target\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tstatic getAllInstances(obj) {\r\n\t\tlet arr = [];\r\n\t\tinstance.instanceArray.forEach(instance => {\r\n\t\t\tlet name = instance.constructor.objectName;\r\n\t\t\tif (name === obj)\r\n\t\t\t\tarr.push(instance);\r\n\t\t});\r\n\t\treturn arr;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number}\r\n\t */\r\n\tstatic get(value) {\r\n\t\t\r\n\t\tif (typeof value === \"object\" || typeof value === \"function\")\r\n\t\t\treturn value;\r\n\t\t\r\n\t\tfor (var n = 0; n < object.array.length; n++)\r\n\t\t\tif (object.array[n].objectName === value)\r\n\t\t\t\treturn object.array[n];\r\n\t\t\t\r\n\t\tconsole.warn(\"FAIL: \", typeof value, value);\r\n\t\treturn null;\r\n\t\t\r\n\t}\r\n\r\n}\r\n\r\nobject.names = [];\r\nobject.array = [];\r\n\n\n\n// WEBPACK FOOTER //\n// ./js/object.js","/**\r\n * @module sound\r\n */\r\n \r\n/**\r\n *\r\n */\r\nexport default class Sound {\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tconstructor(name, source) {\r\n\t\tthis.name = name;\r\n\t\tthis.assetType = \"sound\";\r\n\t\tthis.instances = [new Audio(source)];\r\n\t\tthis.ready = false;\r\n\t\tSound.names.push(name);\r\n\t\tSound.array.push(this);\r\n\t\tlet test = this.instances[0];\r\n\t\ttest.oncanplaythrough = () => {\r\n\t\t\tthis.ready = true;\r\n\t\t\ttest.oncanplaythrough = null;\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {object} opts object.\r\n\t */\r\n\tplay(opts = {}) {\r\n\t\tif (Sound.isEnabled) {\r\n\t\t\t\r\n\t\t\t// find an existing sound instance to play\r\n\t\t\tlet playSound;\r\n\t\t\tfor (var i=0, n=this.instances.length; i<n; i++) {\r\n\t\t\t\tlet instance = this.instances[i];\r\n\t\t\t\tif (instance.paused) {\r\n\t\t\t\t\tplaySound = instance;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// create new instance of sound\r\n\t\t\tif (!playSound) {\r\n\t\t\t\tplaySound = this.instances[0].cloneNode();\r\n\t\t\t\tthis.instances.push(playSound);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t//\r\n\t\t\tplaySound.onError = function(err) {\r\n\t\t\t\tconsole.error(soundName, err);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// play the sound\r\n\t\t\tlet promise = playSound.play();\r\n\t\t\tif ( promise !== undefined ) {\r\n\t\t\t\tpromise.then( function() {\r\n\t\t\t\t\t\r\n\t\t\t\t\t// on end event\r\n\t\t\t\t\tplaySound.onended = function() {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// internal event stuff\r\n\t\t\t\t\t\t( ( Number( opts.loop || false ) )\r\n\t\t\t\t\t\t\t? _loop : _end ).call( this );\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// and custom event, if defined\r\n\t\t\t\t\t\tif (opts.onEnd) opts.onEnd();\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t}).catch((err) => {\r\n\t\t\t\t\tconsole.warn(err);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t//\r\n\t\t\treturn playSound;\r\n\t\t}\r\n\t\t\r\n\t\t// sound is disabled, just return base audio node\r\n\t\treturn this.instances[0];\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tstop() {\r\n\t\tfor (var i=0, n=this.instances.length; i<n; i++) {\r\n\t\t\tlet instance = this.instances[i];\r\n\t\t\tif (!instance.paused) {\r\n\t\t\t\t_end.call(instance);\r\n\t\t\t}\r\n\t\t}\r\n\t\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tstatic readyAll() {\r\n\t\tfor (var i=0, n=Sound.array.length; i<n; i++) {\r\n\t\t\tif (!Sound.array[i].ready) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tstatic get(name) {\r\n\t\tif (typeof name === \"object\") return name;\r\n\t\tfor ( var i=0, n=Sound.array.length; i<n; i++ ) {\r\n\t\t\tif (Sound.array[i].name === name) {\r\n\t\t\t\treturn Sound.array[i];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tstatic enable(x) {\r\n\t\tSound.isEnabled = x;\r\n\t}\r\n\t\r\n\t/** */\r\n\tstatic create(name, src) {\r\n\t\treturn new Sound(name, src);\r\n\t}\r\n\t\r\n\t/** */\r\n\tstatic play(sound, opts = {}) {\r\n\t\tsound = Sound.get(sound);\r\n\t\treturn Sound.prototype.play.call(sound, opts);\r\n\t}\r\n\t\r\n\t/** */\r\n\tstatic stop(sound) {\r\n\t\tsound = Sound.get(sound);\r\n\t\tSound.prototype.stop.call(sound);\r\n\t}\r\n\r\n}\r\n\r\nSound.isEnabled = true;\r\nSound.names = [];\r\nSound.array = [];\r\n\r\n//\r\nfunction _loop() {\r\n\tthis.currentTime = 0;\r\n\tthis.play();\r\n}\r\n\r\n//\r\nfunction _end() {\r\n\tthis.pause();\r\n\tthis.currentTime = 0;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./js/sound.js","/**\r\n * @module camera\r\n */\r\n\r\n//\r\nimport room from \"./room.js\";\r\nimport draw from \"./draw.js\";\r\n\r\n/**\r\n *\r\n */\r\nexport default class Camera {\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconstructor(opts = {}) {\r\n\t\tthis.x = 0,\r\n\t\tthis.y = 0,\r\n\t\tthis.angle = 0,\r\n\t\tthis.width = room.current.width,\r\n\t\tthis.height = room.current.height,\r\n\t\tthis.follow = null,\r\n\t\tthis.gridLocked = false,\r\n\t\tthis.left = 0,\r\n\t\tthis.right = 0,\r\n\t\tthis.top = 0,\r\n\t\tthis.bottom = 0\r\n\t\tObject.assign(this, opts);\r\n\t\tCamera.array.push(this);\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tupdate() {\r\n\t\t\r\n\t\tif (this.follow) {\r\n\t\t\t\r\n\t\t\t// if single instance, put into array\r\n\t\t\tif (!Array.isArray(this.follow))\r\n\t\t\t\tthis.follow = [this.follow];\r\n\t\t\t\r\n\t\t\t//\r\n\t\t\tlet x = 0, y = 0, count = 0, weight = 1;\r\n\t\t\tthis.follow.forEach((inst) => {\r\n\t\t\t\t\r\n\t\t\t\tif (Array.isArray(inst)) {\r\n\t\t\t\t\tweight = inst[1] || 1;\r\n\t\t\t\t\tinst = inst[0];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tweight = 1;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tx += inst.x * weight;\r\n\t\t\t\ty += inst.y * weight;\r\n\t\t\t\tcount += weight;\r\n\t\t\t\t\r\n\t\t\t} );\r\n\t\t\t\r\n\t\t\tthis.x = x / count;\r\n\t\t\tthis.y = y / count;\r\n\t\t}\r\n\t\t\r\n\t\t// update bounds\r\n\t\tthis.left = this.x - this.width * 0.5;\r\n\t\tthis.right = this.x + this.width * 0.5;\r\n\t\tthis.top = this.y - this.height * 0.5;\r\n\t\tthis.bottom = this.y + this.height * 0.5;\r\n\t\t\r\n\t\t// apply camera\r\n\t\tdraw.transform.translate(-this.left, -this.top);\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tstatic create(opts = {}) {\r\n\t\treturn new Camera(opts);\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tstatic update() {\r\n\t\tCamera.array.forEach((cam) => {\r\n\t\t\tcam.update();\r\n\t\t});\r\n\t}\r\n\t\r\n}\r\n\r\nCamera.array = [];\n\n\n// WEBPACK FOOTER //\n// ./js/camera.js","/**\r\n * @module main\r\n */\r\n\r\nimport canvas from \"./canvas.js\";\r\nimport room from \"./room.js\";\r\nimport input from \"./input.js\";\r\nimport instance from \"./instance.js\";\r\nimport global from \"./global.js\";\r\nimport draw from \"./draw.js\";\r\nimport camera from \"./camera.js\";\r\nimport Transition from \"./transition.js\";\r\n\r\nlet lastTick = performance.now(),\r\n\ttickLength = 1000 / 60,\r\n\tdt = 0,\r\n\tlast = 0;\r\n\t\r\n//\r\nlet main = {\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tget dt() {\r\n\t\treturn dt;\r\n\t},\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tstart: function(opts = {}) {\r\n\t\t\r\n\t\t// Basic site-locking\r\n\t\tif (opts.host !== undefined && opts.host !== \"\") {\r\n\t\t\tlet loc = (window.parent) ? window.parent.location : window.location;\r\n\t\t\tlet host = loc.hostname;\r\n\t\t\tlet arr = opts.host.split(\" \").join(\"\").split(\",\");\r\n\t\t\tif ( !opts.host.includes( host ) )\r\n\t\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\t//\r\n\t\tlet canv = canvas.create({\r\n\t\t\twidth: room.current.width,\r\n\t\t\theight: room.current.height,\r\n\t\t\tcrisp2D: true,\r\n\t\t\tapplication: true\r\n\t\t});\r\n\t\t\r\n\t\t// selectively enable input methods\r\n\t\tif (opts.enableMouse) input.initMouse();\r\n\t\tif (opts.enableKeyboard) input.initKeyboard();\r\n\t\tif (opts.enableTouch) input.initTouch();\r\n\t\tif (opts.hideCursor) canv.style.cursor = \"none\";\r\n\t\t\r\n\t\t//\r\n\t\troom.enter(room.current);\r\n\t\ttick(performance.now());\r\n\t\t\r\n\t},\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tsetGameSpeed: function( speed ) {\r\n\t\ttickLength = 1000 / speed;\r\n\t}\r\n\t\r\n}\r\n\r\n/**\r\n *\r\n */\r\nfunction tick( timestamp ) {\r\n\t\r\n\t// exit game with Esc key\r\n\tif ( window._GB_stop && input.triggerEvents.includes(\"EscapePressed\") )\r\n\t\twindow._GB_stop();\r\n\t\r\n\t// request the next frame\r\n\twindow.requestAnimationFrame( tick );\r\n\tlet nextTick = lastTick + tickLength;\r\n\tlet numTicks = 0;\r\n\tglobal.fps = 1000 / (timestamp - last);\r\n\tlast = timestamp;\r\n\r\n\t//\r\n\tif ( timestamp > nextTick ) {\r\n\t\tlet timeSinceTick = timestamp - lastTick;\r\n\t\tnumTicks = Math.floor( timeSinceTick / tickLength );\r\n\t}\r\n\t\r\n\t//\r\n\tinput.getTriggerEvents();\r\n\tqueueUpdates( numTicks );\r\n\tgameDraw();\r\n\t\r\n\t//\r\n\tif ( numTicks ) {\r\n\t\tinput.update();\r\n\t}\r\n\t\r\n}\r\n\r\n/**\r\n *\r\n */\r\nfunction queueUpdates(numTicks) {\r\n\tfor(var i = 0; i < numTicks; i++) {\r\n\t\tlastTick = lastTick + tickLength;\r\n\t\tdt = 1;\r\n\t\tgameUpdate(1);\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {number} dt Delta Time.\r\n */\r\nfunction gameUpdate(dt) {\r\n\tinstance.stepAll(dt);\r\n\tinstance.clearDestroyed();\r\n\tTransition.updateAll();\r\n}\r\n\r\n/**\r\n *\r\n */\r\nfunction gameDraw() {\r\n\tdraw.reset();\r\n\tcanvas.clear(canvas.main, \"#000000\");\r\n\troom.draw(room.current);\r\n\tcamera.update();\r\n\tinstance.drawAll();\r\n\tTransition.drawAll();\r\n}\r\n\r\n/**\r\n *\r\n */\r\nfunction handleResizeEvent() {\r\n\tinstance.executeEventAll( \"resize\" );\r\n}\r\n\r\n// attach event listerners\r\nwindow.addEventListener( \"resize\", handleResizeEvent );\r\n\r\n//\r\nexport default main;\r\n\n\n\n// WEBPACK FOOTER //\n// ./js/main.js","\r\nlet color = {\r\n\r\n\t/**\r\n\t * @param {string} hex A hex string.\r\n\t */\r\n\thexToRgb: function(hex) {\r\n\t\tvar result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n\t\treturn result ? {\r\n\t\t\tr: parseInt(result[1], 16),\r\n\t\t\tg: parseInt(result[2], 16),\r\n\t\t\tb: parseInt(result[3], 16)\r\n\t\t} : null;\r\n\t},\r\n\t\r\n\t/**\r\n\t * @param {number} c The component.\r\n\t */\r\n\tcomponentToHex: function(c) {\r\n\t\tvar hex = c.toString(16);\r\n\t\treturn hex.length == 1 ? \"0\" + hex : hex;\r\n\t},\r\n\r\n\t/**\r\n\t * @param {number} r The red component.\r\n\t * @param {number} g The green component.\r\n\t * @param {number} b The blue component.\r\n\t */\r\n\trgbToHex: function(r, g, b) {\r\n\t\tlet c = color.componentToHex;\r\n\t\treturn \"#\" + c(r) + c(g) + c(b);\r\n\t}\r\n\t\r\n}\r\n\r\n//\r\nexport default color;\n\n\n// WEBPACK FOOTER //\n// ./js/color.js","/**\r\n * @module keyvalues\r\n */\r\n \r\nlet values = [\r\n\t\"ArrowUp\",\r\n\t\"ArrowDown\",\r\n\t\"ArrowLeft\",\r\n\t\"ArrowRight\",\r\n\t\"Enter\",\r\n\t\"Space\",\r\n\t\"Backspace\",\r\n\t\"Escape\",\r\n\t\"ShiftLeft\",\r\n\t\"ShiftRight\",\r\n\t\"ControlLeft\",\r\n\t\"ControlRight\",\r\n\t\"AltLeft\",\r\n\t\"AltRight\",\r\n\t\"KeyA\",\r\n\t\"KeyB\",\r\n\t\"KeyC\",\r\n\t\"KeyD\",\r\n\t\"KeyE\",\r\n\t\"KeyF\",\r\n\t\"KeyG\",\r\n\t\"KeyH\",\r\n\t\"KeyI\",\r\n\t\"KeyJ\",\r\n\t\"KeyK\",\r\n\t\"KeyL\",\r\n\t\"KeyM\",\r\n\t\"KeyN\",\r\n\t\"KeyO\",\r\n\t\"KeyP\",\r\n\t\"KeyQ\",\r\n\t\"KeyR\",\r\n\t\"KeyS\",\r\n\t\"KeyT\",\r\n\t\"KeyU\",\r\n\t\"KeyV\",\r\n\t\"KeyW\",\r\n\t\"KeyZ\",\r\n\t\"KeyY\",\r\n\t\"KeyZ\",\r\n];\r\n\r\nexport default values;\r\n\n\n\n// WEBPACK FOOTER //\n// ./js/keyvalues.js","/**\r\n * @module event\r\n */\r\n \r\nimport keyValues from \"./keyvalues.js\";\r\n\r\n//\r\nlet events = {\r\n\t\r\n\tcreate: \"create\",\r\n\troomEnter: \"roomEnter\",\r\n\troomLeave: \"roomLeave\",\r\n\tstep: \"step\",\r\n\tdraw: \"draw\",\r\n\tcollision: \"collision_\",\r\n\tresize: \"resize\",\r\n\tkeyboard: {\r\n\t\t...translate( keyValues ),\r\n\t\tpressed: translate( keyValues, \"Pressed\" ),\r\n\t\treleased: translate( keyValues, \"Released\" )\r\n\t}\r\n\t\r\n}\r\n\t\r\n/**\r\n * @param {array} array\r\n * @param {string} [postfix=\"\"]\r\n */\r\nfunction translate( array, postfix = \"\" ) {\r\n\tlet obj = {};\r\n\tarray.forEach( function( name ) {\r\n\t\tobj[name] = name + postfix;\r\n\t} );\r\n\treturn obj;\r\n}\r\n\r\n//\r\nexport default events;\n\n\n// WEBPACK FOOTER //\n// ./js/event.js","/**\r\n * @module Pool\r\n */\r\n\r\n/**\r\n * The Pool object contains an array (the pool) called stack to which we can give objects. The Pool also maintains it's own length property, as the true length of the stack array does not change, so as to avoid garbage collection.\r\n * @param {Object} newConstructor The constructor function for this pool. During get, if no items are in the pool and no default value is provided, a new object is created from this constructor and returned.\r\n */\r\nexport default function Pool( newConstructor ) {\r\n\tthis.stack = [];\r\n\tthis.length = 0;\r\n\tthis.newConstructor = newConstructor;\r\n}\r\n\r\n/**\r\n * @param {Object} [def] The default object (or even value) to return if no items are found in the pool. If this is not defined, and no items are found in the pool, then a new object is created as per the Pool's newConstructor property.\r\n */\r\nPool.prototype.get = function( def ) {\r\n\t\r\n\t// return object from pool\r\n\tif ( this.length ) {\r\n\t\tdef = this.stack[--this.length];\r\n\t\tthis.stack[this.length] = undefined;\r\n\t}\r\n\t\r\n\t// return found/default object or create a new one\r\n\treturn def || new this.newConstructor();\r\n\t\r\n}\r\n\r\n/**\r\n * @param {Object} i Objec to release, adding it to the pool.\r\n */\r\nPool.prototype.release = function( i ) {\r\n\tthis.stack[this.length++] = i;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./js/utils/pool.js","\r\nlet global = {\r\n\tfps: 0\r\n}\r\n\r\nexport default global;\n\n\n// WEBPACK FOOTER //\n// ./js/global.js","/**\r\n * @module dataGrid\r\n */\r\n\r\n//\r\nimport Pool from \"../utils/pool.js\";\r\n\r\n/**\r\n *\r\n */\r\nexport default class Grid {\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tconstructor(width, height, opts = {}) {\r\n\t\tlet size = width * height;\r\n\t\tlet value = opts.value || 0;\r\n\t\tlet myGrid = Grid.pool.get(this);\r\n\t\tlet array = (myGrid === this) ? this.data = [] : myGrid.data;\r\n\t\t\r\n\t\t// fill grid with default value\r\n\t\tfor (var n=0; n<size; n++)\r\n\t\t\tarray[n] = value;\r\n\r\n\t\t//\r\n\t\tmyGrid.size = size;\r\n\t\tmyGrid.width = width;\r\n\t\tmyGrid.height = height;\r\n\t\treturn myGrid;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tget(x, y) {\r\n\t\treturn this.data[x + y * this.width];\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tset(x, y, value) {\r\n\t\tthis.data[x + y * this.width] = value;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tcreate(...args) {\r\n\t\treturn newGrid(...args);\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tdestroy() {\r\n\t\tGrid.pool.release(this);\r\n\t}\r\n\t\r\n\t/** */\r\n\tstatic get(...args) {\r\n\t\treturn Grid.prototype.get.call(...args);\r\n\t}\r\n\t\r\n\t/** */\r\n\tstatic set(...args) {\r\n\t\treturn Grid.prototype.set.call(...args);\r\n\t}\r\n\r\n}\r\n\r\n//\r\nGrid.pool = new Pool(Grid);\n\n\n// WEBPACK FOOTER //\n// ./js/data/dataGrid.js","\r\n//\r\nlet tween = {\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tblend( n1 , n2 , perc ) {\r\n\t\tlet diff = n2 - n1;\r\n\t\treturn n1 + ( diff * perc );\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tcubicBezier( x2, y2, x3, y3, i ) {\r\n\t\t\r\n\t\tlet x1 = 0,\r\n\t\t\ty1 = 0,\r\n\t\t\tx4 = 1,\r\n\t\t\ty4 = 1;\r\n\t\t\r\n\t\t // The Green Lines\r\n\t\tlet xa = tween.blend( x1 , x2 , i ),\r\n\t\t\tya = tween.blend( y1 , y2 , i ),\r\n\t\t\txb = tween.blend( x2 , x3 , i ),\r\n\t\t\tyb = tween.blend( y2 , y3 , i ),\r\n\t\t\txc = tween.blend( x3 , x4 , i ),\r\n\t\t\tyc = tween.blend( y3 , y4 , i ),\r\n\r\n\t\t\t// The Blue Line\r\n\t\t\txm = tween.blend( xa , xb , i ),\r\n\t\t\tym = tween.blend( ya , yb , i ),\r\n\t\t\txn = tween.blend( xb , xc , i ),\r\n\t\t\tyn = tween.blend( yb , yc , i ),\r\n\r\n\t\t\t// The Black Dot\r\n\t\t\tx = tween.blend( xm , xn , i ),\r\n\t\t\ty = tween.blend( ym , yn , i );\r\n\t\t\r\n\t\t//\r\n\t\treturn y;\r\n\t\t\r\n\t}\r\n\t\r\n}\r\n\r\n//\r\nexport default tween;\n\n\n// WEBPACK FOOTER //\n// ./js/tween.js","import draw from \"./../draw.js\";\r\nimport sprite from \"./../sprite.js\";\r\n\r\nconst noop = () => {};\r\n\r\n/** */\r\nexport default class Primitive {\r\n\r\n\t/**\r\n\t * @param {object} opts Options object.\r\n\t * @param {array} opts.points Array of Point objects.\r\n\t * @param {*} opts.texture Sprite object or name of sprite resource.\r\n\t * @param {*} opts.color Color of the primitive.\r\n\t * @param {string} opts.format Format of the points array.\r\n\t * @param {function} opts.modifier Point modifier function.\r\n\t * @param {number} opts.x X position to draw the primitive.\r\n\t * @param {number} opts.y Y position to draw the primitive.\r\n\t */\r\n\tconstructor(opts = {}) {\r\n\t\tthis.points = opts.points || [];\r\n\t\tthis.texture = opts.texture || null;\r\n\t\tthis.color = opts.color || \"#000000\";\r\n\t\tthis.format = opts.format || \"quads\";\r\n\t\tthis.modifier = opts.modifier || noop;\r\n\t\tthis.x = opts.x || 0;\r\n\t\tthis.y = opts.y || 0;\r\n\t}\r\n\t\r\n\t/** Method for drawing instantiated Primitive. */\r\n\tdraw() {\r\n\t\tPrimitive.draw(this);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Alternate way to create a new Primitive instance.\r\n\t * @param {object} opts See constructor.opts parameter.\r\n\t */\r\n\tstatic create(opts = {}) {\r\n\t\treturn new Primitive(opts);\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {object} opts See constructor.opts parameter.\r\n\t */\r\n\tstatic draw(opts = {}) {\r\n\t\tif (opts.texture) drawTextured(opts);\r\n\t\telse drawBasic(opts);\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n *\r\n */\r\nfunction drawTextured(opts = {}) {\r\n\t\r\n\tlet texture = opts.texture;\r\n\tlet spr = sprite.get(texture);\r\n\tif (spr === null) {\r\n\t\tconsole.warn(\"No such texture: \" + texture);\r\n\t\treturn;\r\n\t}\r\n\t\r\n\tlet ctx = draw.context;\r\n\tlet frame = spr.images[0];\r\n\tlet img = frame.img;\r\n\tlet w = spr.width;\r\n\tlet h = spr.height;\r\n\tlet tris = orderTriangleList(opts);\r\n\t\r\n\t//\r\n\tlet t;\r\n\tlet pts = applyModifier(opts.points, opts.modifier);\r\n\tlet len = tris.length;\r\n\tfor (t=0; t<len; t++) {\r\n\t\t\r\n\t\tvar pp = tris[t];\r\n\t\tvar x0 = pts[pp[0]].x, x1 = pts[pp[1]].x, x2 = pts[pp[2]].x;\r\n\t\tvar y0 = pts[pp[0]].y, y1 = pts[pp[1]].y, y2 = pts[pp[2]].y;\r\n\t\tvar u0 = pts[pp[0]].u*w, u1 = pts[pp[1]].u*w, u2 = pts[pp[2]].u*w;\r\n\t\tvar v0 = pts[pp[0]].v*h, v1 = pts[pp[1]].v*h, v2 = pts[pp[2]].v*h;\r\n\t\t\r\n\t\t// Set clipping area so that only pixels inside the triangle will\r\n\t\t// be affected by the image drawing operation\r\n\t\tctx.save();\r\n\t\tctx.beginPath();\r\n\t\tctx.moveTo(x0, y0);\r\n\t\tctx.lineTo(x1, y1);\r\n\t\tctx.lineTo(x2, y2);\r\n\t\tctx.closePath();\r\n\t\tctx.clip();\r\n\r\n\t\t// Compute matrix transform\r\n\t\tvar delta = u0*v1 + v0*u2 + u1*v2 - v1*u2 - v0*u1 - u0*v2;\r\n\t\tvar delta_a = x0*v1 + v0*x2 + x1*v2 - v1*x2 - v0*x1 - x0*v2;\r\n\t\tvar delta_b = u0*x1 + x0*u2 + u1*x2 - x1*u2 - x0*u1 - u0*x2;\r\n\t\tvar delta_c = u0*v1*x2 + v0*x1*u2 + x0*u1*v2 - x0*v1*u2\r\n\t\t\t\t\t  - v0*u1*x2 - u0*x1*v2;\r\n\t\tvar delta_d = y0*v1 + v0*y2 + y1*v2 - v1*y2 - v0*y1 - y0*v2;\r\n\t\tvar delta_e = u0*y1 + y0*u2 + u1*y2 - y1*u2 - y0*u1 - u0*y2;\r\n\t\tvar delta_f = u0*v1*y2 + v0*y1*u2 + y0*u1*v2 - y0*v1*u2\r\n\t\t\t\t\t  - v0*u1*y2 - u0*y1*v2;\r\n\r\n\t\t// Draw the transformed image\r\n\t\tctx.transform(delta_a/delta, delta_d/delta,\r\n\t\t\t\t\t  delta_b/delta, delta_e/delta,\r\n\t\t\t\t\t  delta_c/delta, delta_f/delta);\r\n\t\tctx.drawImage(img, 0, 0);\r\n\t\tctx.restore();\r\n\t}\r\n}\r\n\r\n/**\r\n *\r\n */\r\nfunction drawBasic(opts = {}) {\r\n\tlet points = applyModifier(opts.points, opts.modifier);\r\n\tlet length = points.length;\r\n\tif (length > 0) {\r\n\t\tlet tris = orderQuadList(opts);\r\n\t\tlet i, ctx = draw.context;\r\n\t\tctx.fillStyle = opts.color || draw.color;\r\n\t\tfor (i=0; i<tris.length; i++) {\r\n\t\t\tlet tri = tris[i];\r\n\t\t\tlet n, p = points[tri[0]];\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.moveTo(p.x, p.y);\r\n\t\t\tfor (n=1; n<tri.length; n++) {\r\n\t\t\t\tp = points[tri[n]];\r\n\t\t\t\tctx.lineTo(p.x, p.y);\r\n\t\t\t}\r\n\t\t\tctx.closePath();\r\n\t\t\tctx.fill();\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n *\r\n */\r\nfunction applyModifier(points, modifier) {\r\n\tlet newPoints = [];\r\n\tpoints.forEach(function(p) {\r\n\t\tlet newP = Object.assign({}, p, modifier.call(p));\r\n\t\tnewPoints.push(newP);\r\n\t});\r\n\treturn newPoints;\r\n}\r\n\r\n/**\r\n * @param {object} opts\r\n */\r\nfunction orderTriangleList(opts = {}) {\r\n\tlet tris = [];\r\n\tif (opts.format === \"quads\") {\r\n\t\tlet length = Math.floor(opts.points.length / 4);\r\n\t\tlet n, o = 0;\r\n\t\tfor (n=0; n<length; n++) {\r\n\t\t\ttris.push([o+0, o+1, o+2], [o+2, o+3, o+0]);\r\n\t\t\to += 4;\r\n\t\t}\r\n\t}\r\n\treturn tris;\r\n}\r\n\r\n/**\r\n * @param {object} opts\r\n */\r\nfunction orderQuadList(opts = {}) {\r\n\tlet tris = [];\r\n\tlet length = Math.floor(opts.points.length / 4);\r\n\tlet n, o = 0;\r\n\tfor (n=0; n<length; n++, o+=4) {\r\n\t\ttris.push([o+0, o+1, o+2, o+3]);\r\n\t}\r\n\treturn tris;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./js/drawing/primitive.js","/**\r\n * @module core\r\n */\r\n\r\nimport main from \"./main.js\";\r\nimport canvas from \"./canvas.js\";\r\nimport Camera from \"./camera.js\";\r\nimport room from \"./room.js\";\r\nimport input from \"./input.js\";\r\nimport sprite from \"./sprite.js\";\r\nimport sound from \"./sound.js\";\r\nimport object from \"./object.js\";\r\nimport event from \"./event.js\";\r\nimport * as action from \"./action.js\";\r\nimport instance from \"./instance.js\";\r\nimport draw from \"./draw.js\";\r\nimport math from \"./math.js\";\r\nimport tween from \"./tween.js\";\r\nimport Transition from \"./transition.js\";\r\nimport Primitive from \"./drawing/primitive.js\";\r\n\r\nexport {\r\n\tmain,\r\n\tcanvas,\r\n\tCamera,\r\n\troom,\r\n\tinput,\r\n\tsprite,\r\n\tsound,\r\n\tobject,\r\n\tevent,\r\n\taction,\r\n\tinstance,\r\n\tdraw,\r\n\tmath,\r\n\ttween,\r\n\tTransition\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./js/core.js","/**\r\n *\r\n */\r\n \r\n//\r\nimport math from \"./math.js\";\r\nimport instance from \"./instance.js\";\r\n \r\n//\r\nlet basic = JSON.stringify({\r\n\tsprite: null,\r\n\tindex: 0,\r\n\timageSpeed: 1,\r\n\tanimationBehavior: \"loop\",\r\n\tvisible: true,\r\n\tsolid: false,\r\n\texists: true,\r\n\tscaleX: 1,\r\n\tscaleY: 1,\r\n\trotation: 0,\r\n\tterminal: 100,\r\n\tgravity: 0,\r\n\tgravityDirection: 0,\r\n\tspeedX: 0,\r\n\tspeedY: 0,\r\n\tboxTop: 0,\r\n\tboxBottom: 0,\r\n\tboxLeft: 0,\r\n\tboxRight: 0,\r\n\tbehaviours: [],\r\n\tlisteners: [],\r\n\tevents: {},\r\n\tboxCollision: {\r\n\t\tx: 0,\r\n\t\ty: 0,\r\n\t\twidth: 0,\r\n\t\theight: 0,\r\n\t\ttop: 0,\r\n\t\tbottom: 0,\r\n\t\tleft: 0,\r\n\t\tright: 0 \r\n\t},\r\n\t_depth: 0\r\n});\r\n \r\n//\r\nlet objectVarsModule = {\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tset: function( proto ) {\r\n\t\t\r\n\t\tObject.assign( proto, JSON.parse( basic ) );\r\n\t\t\r\n\t\tObject.defineProperty( proto, \"depth\", {\r\n\t\t\tset: function( x ) {\r\n\t\t\t\tthis._depth = x;\r\n\t\t\t\tinstance.instanceArray.sort( function( a, b ) {\r\n\t\t\t\t\treturn a._depth - b._depth;\r\n\t\t\t\t} );\r\n\t\t\t},\r\n\t\t\tget: function() {\r\n\t\t\t\treturn this._depth;\r\n\t\t\t}\r\n\t\t} );\r\n\t\t\r\n\t\tObject.defineProperty( proto, \"speed\", {\r\n\t\t\tset: function( x ) {\r\n\t\t\t\tlet y = this.direction * math.DEGTORAD;\r\n\t\t\t\tthis.speedX = Math.cos( y ) * x;\r\n\t\t\t\tthis.speedY = Math.sin( y ) * x;\r\n\t\t\t},\r\n\t\t\tget: function( x ) {\r\n\t\t\t\treturn math.pointDistance( 0, 0, this.speedX, this.speedY );\r\n\t\t\t}\r\n\t\t} );\r\n\t\t\r\n\t\tObject.defineProperty( proto, \"direction\", {\r\n\t\t\tset: function( x ) {\r\n\t\t\t\tlet y = this.speed;\r\n\t\t\t\tthis.speedX = Math.cos( x * math.DEGTORAD ) * y;\r\n\t\t\t\tthis.speedY = Math.sin( x * math.DEGTORAD ) * y;\r\n\t\t\t},\r\n\t\t\tget: function( x ) {\r\n\t\t\t\treturn math.pointDirection( 0, 0, this.speedX, this.speedY );\r\n\t\t\t}\r\n\t\t} );\r\n\t\t\t\r\n\t}\r\n\t\r\n}\r\n\r\n//\r\nexport default objectVarsModule;\n\n\n// WEBPACK FOOTER //\n// ./js/objectVars.js","/**\r\n * @module Compiler\r\n */\r\n\r\n//\r\nimport global from \"./global.js\";\r\nimport object from \"./object.js\";\r\nimport sprite from \"./sprite.js\";\r\nimport sound from \"./sound.js\";\r\n \r\n//\r\nexport default class Compiler {\r\n\t\r\n\t/**\r\n\t * @param {string} exp\r\n\t */\r\n\tstatic actionExpression(exp) {\r\n\t\t\r\n\t\tif (!isNaN(Number(exp)))\r\n\t\t\treturn Number(exp);\r\n\t\t\r\n\t\tif (Compiler.isBoolean(exp)) {\r\n\t\t\treturn exp === true || exp === \"true\";\r\n\t\t}\r\n\t\t\r\n\t\tif (Compiler.isFunction(exp)\r\n\t\t||  Compiler.isOperator(exp)\r\n\t\t||  Compiler.isResource(exp)\r\n\t\t||  Compiler.isCss(exp))\r\n\t\t\treturn exp;\r\n\t\t\t\r\n\t\tif (Compiler.isString(exp)) {\r\n\t\t\treturn exp.slice(1, -1);\r\n\t\t}\r\n\t\t\r\n\t\tif (typeof exp === \"string\") {\r\n\t\t\r\n\t\t\tlet n,\r\n\t\t\t\tstring = \"\",\r\n\t\t\t\tsIndex = -1,\r\n\t\t\t\tnewArr = [];\r\n\t\t\t\t\r\n\t\t\tfor (n = 0; n < exp.length; n++) {\r\n\t\t\t\t\r\n\t\t\t\tlet c = exp.charAt( n );\r\n\t\t\t\tswitch ( c ) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tcase ( \"'\" ):\r\n\t\t\t\t\t\tif ( sIndex === -1 ) {\r\n\t\t\t\t\t\t\tsIndex = n + 1\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tnewArr.push( \"'\" + exp.slice( sIndex, n ) + \"'\" );\r\n\t\t\t\t\t\t\tsIndex = -1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tif ( sIndex === -1 && c !== \" \" ) {\r\n\t\t\t\t\t\t\tif ( c === \"+\" || c === \"-\" || c === \"=\" ) {\r\n\t\t\t\t\t\t\t\tif ( string !== \"\" ) {\r\n\t\t\t\t\t\t\t\t\tnewArr.push( string );\r\n\t\t\t\t\t\t\t\t\tstring = \"\";\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tnewArr.push( c );\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tstring += c;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (string !== \"\") {\r\n\t\t\t\tnewArr.push(string);\r\n\t\t\t\tstring = \"\";\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tlet y = \"\";\r\n\t\t\t\r\n\t\t\tnewArr.forEach((word) => {\r\n\t\t\t\tlet num = parseInt(word);\r\n\t\t\t\tif (isNaN(num)) {\r\n\t\t\t\t\tlet c = word.charAt(0);\r\n\t\t\t\t\tif (c === \"'\") {\r\n\t\t\t\t\t\ty += word;\r\n\t\t\t\t\t} else if (c === \"+\" || c === \"-\") {\r\n\t\t\t\t\t\ty += word;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif ( word === \"fps\" )\r\n\t\t\t\t\t\t\ty += global.fps;\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tif (!Compiler.isResource(word)\r\n\t\t\t\t\t\t\t&&  Compiler.isSingleWord(word)) {\r\n\t\t\t\t\t\t\t\ty += \"this.\" + word;\r\n\t\t\t\t\t\t\t\t//this[word] = this[word] || word;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ty += word;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\ty += word;\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\t\t\t\r\n\t\t\treturn eval(y);\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\treturn exp;\r\n\r\n\t}\r\n\t\r\n\t/** */\r\n\tstatic isResource(x) {\r\n\t\treturn object.names.includes(x)\r\n\t\t\t|| sprite.names.includes(x)\r\n\t\t\t|| sound.names.includes(x);\r\n\t}\r\n\t\r\n\t/** */\r\n\tstatic isString(x) {\r\n\t\treturn x.charAt(0) === \"\\\"\";\r\n\t}\r\n\t\r\n\t/** */\r\n\tstatic isSingleWord(x) {\r\n\t\treturn !x.includes(\".\");\r\n\t}\r\n\t\r\n\t/** */\r\n\tstatic isFunction(x) {\r\n\t\treturn typeof x === \"function\";\r\n\t}\r\n\t\r\n\t/** */\r\n\tstatic isBoolean(x) {\r\n\t\treturn x === \"true\"\r\n\t\t\t|| x === \"false\"\r\n\t\t\t|| x === true\r\n\t\t\t|| x === false;\r\n\t}\r\n\t\r\n\t/** */\r\n\tstatic isOperator(x) {\r\n\t\treturn x === \"<\"\r\n\t\t\t|| x === \">\"\r\n\t\t\t|| x === \"<=\"\r\n\t\t\t|| x === \">=\"\r\n\t\t\t|| x === \"==\";\r\n\t}\r\n\t\r\n\t/** */\r\n\tstatic isCss(x) {\r\n\t\treturn x.charAt(0) === \"#\";\r\n\t}\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./js/compile.js","/**\r\n * @module actions\r\n */\r\n\r\nimport room from \"./room.js\";\r\nimport sound from \"./sound.js\";\r\nimport draw from \"./draw.js\";\r\nimport instance from \"./instance.js\";\r\nimport input from \"./input.js\";\r\nimport math from \"./math.js\";\r\nimport sprite from \"./sprite.js\";\r\nimport canvas from \"./canvas.js\";\r\nimport color from \"./color.js\";\r\nimport main from \"./main.js\";\r\nimport Camera from \"./camera.js\";\r\nimport app from \"./app.js\";\r\nimport data from \"./data.js\";\r\nimport Tilemap from \"./tilemap.js\";\r\nimport tween from \"./tween.js\";\r\nimport Transition from \"./transition.js\";\r\nimport Primitive from \"./drawing/primitive.js\";\r\n \r\n/**\r\n * @param {string} varName\r\n * @param {value} value\r\n */\r\nfunction actionSet(varName, value, relative) {\r\n\t(relative)\r\n\t\t? this[varName] += value\r\n\t\t: this[varName] = value;\r\n}\r\n\r\n/**\r\n * @param {string} varName\r\n * @param {string} op Operation.\r\n * @param {value} value Value to check against.\r\n */\r\nfunction actionTest( varName, op, value ) {\r\n\tswitch ( op ) {\r\n\t\tcase( \"==\" ): return this[varName] == value;\r\n\t\tcase( \"<\" ):  return this[varName] <  value;\r\n\t\tcase( \">\" ):  return this[varName] >  value;\r\n\t\tcase( \"<=\" ): return this[varName] <= value;\r\n\t\tcase( \">=\" ): return this[varName] >= value;\r\n\t\tdefault: return false;\r\n\t}\r\n}\r\n\r\n/**\r\n * Sets the instance's gravity to the given value.\r\n * @param {number} value The gravity strength.\r\n */\r\nfunction actionSetGravity( value ) {\r\n\tthis.gravity = value;\r\n}\r\n\r\n/**\r\n * Instantly sets the instance's x and y values to a random position within\r\n * the current room.\r\n * @param {number} x\r\n * @param {number} y\r\n * @param {boolean} relative\r\n */\r\nfunction actionJump( x, y, relative ) {\r\n\t\r\n\tif ( relative ) {\r\n\t\tthis.x += Number( x );\r\n\t\tthis.y += Number( y );\r\n\t} else {\r\n\t\tthis.x = Number( x );\r\n\t\tthis.y = Number( y );\r\n\t}\r\n}\r\n\r\n/**\r\n * Instantly sets the instance's x and y values to a random position within\r\n * the current room.\r\n */\r\nfunction actionJumpRandom() {\r\n\tlet x1 = 0, y1 = 0, x2 = 640, y2 = 480;\r\n\tthis.x = Math.floor( Math.random() * ( x2 - x1 + 1 ) ) + x1;\r\n\tthis.y = Math.floor( Math.random() * ( y2 - y1 + 1 ) ) + y1;\r\n}\r\n\r\n/**\r\n *\r\n */\r\nfunction moveFree( speed, direction ) {\r\n\tthis.speed = speed;\r\n\tthis.direction = direction;\r\n}\r\n\r\n/**\r\n * Instantly sets the instance's x and y values to a random position within\r\n * the current room.\r\n * @param {number} x\r\n * @param {number} y\r\n */\r\nfunction moveDirect( x, y ) {\r\n\tthis.x += x * main.dt;\r\n\tthis.y += y * main.dt;\r\n}\r\n\r\n/**\r\n *\r\n */\r\nfunction moveSpeedX( speed ) { this.speedX = Number( speed ); }\r\nfunction moveSpeedY( speed ) { this.speedY = Number( speed ); }\r\nfunction moveReverseX() { this.speedX = -this.speedX; }\r\nfunction moveReverseY() { this.speedY = -this.speedY; }\r\n\r\n/**\r\n * Wraps the instance back into the room when it leaves.\r\n */\r\nfunction actionWrap() {\r\n\t\r\n\tlet width = this.boxRight - this.boxLeft,\r\n\t\theight = this.boxBottom - this.boxTop,\r\n\t\tthisRoom = room.current,\r\n\t\troomW = thisRoom.width,\r\n\t\troomH = thisRoom.height;\r\n\t\t\r\n\tif ( this.boxRight  < 0 )     this.x += roomW + width;\r\n\tif ( this.boxBottom < 0 )     this.y += roomH + height;\r\n\tif ( this.boxLeft   > roomW ) this.x -= roomW + width;\r\n\tif ( this.boxTop    > roomH ) this.y -= roomH + height;\r\n\t\r\n}\r\n\r\n/**\r\n * Wraps the instance back into the room when it leaves.\r\n */\r\nfunction actionConfine() {\r\n\t\r\n\tlet width = this.boxRight - this.boxLeft,\r\n\t\theight = this.boxBottom - this.boxTop,\r\n\t\tthisRoom = room.current,\r\n\t\troomW = thisRoom.width,\r\n\t\troomH = thisRoom.height;\r\n\t\t\r\n\tif ( this.boxLeft   < 0 )     this.x = 0;\r\n\tif ( this.boxTop    < 0 )     this.y = 0;\r\n\tif ( this.boxRight  > roomW ) this.x = roomW - width;\r\n\tif ( this.boxBottom > roomH ) this.y = roomH - height;\r\n\t\r\n}\r\n\r\n/**\r\n * Executes the given function with variable arguments on the instance.\r\n * @param {function} func\r\n * @param {...*} args\r\n */\r\nfunction actionFunc( func, ...args ) {\r\n\tfunc.apply( this, args );\r\n}\r\n\r\n/**\r\n * Executes the given function with variable arguments on the instance.\r\n * @param {string} code\r\n */\r\nfunction runCode( code ) {\r\n\t\r\n\tif ( typeof code === \"string\" ) {\r\n\t\ttry {\r\n\t\t\teval( code );\r\n\t\t}\r\n\t\tcatch( err ) {\r\n\t\t\tconsole.error( err.message );\r\n\t\t}\r\n\t}\r\n\t\r\n\telse {\r\n\t\tconsole.error( \"runCode( code ); code must be a string!\" );\r\n\t}\r\n\t\r\n}\r\n\r\n/**\r\n * Shows the value of the given variable of the instance, in the console.\r\n * @param {...*} args\r\n */\r\nfunction actionGet( ...args ) {\r\n\tconsole.log( this[args].toFixed( 2 ) );\r\n}\r\n\r\n// Fucntions for use in code.\r\nlet GAME = {\r\n\tmain: {\r\n\t\tsetGameSpeed: main.setGameSpeed\r\n\t},\r\n\tinstance: {\r\n\t\tcreate: instance.create,\r\n\t\tcreateMoving: instance.createMoving,\r\n\t\tdestroy: instance.destroy,\r\n\t\tfind: instance.find,\r\n\t\tfindRandom: instance.findRandom,\r\n\t\tcount: instance.count,\r\n\t\tmouseOn: instance.mouseOn\r\n\t},\r\n\tdraw: Object.assign( draw, {\r\n\t\tself: instance.drawSelf,\r\n\t\tdebug: instance.drawDebug\r\n\t} ),\r\n\tcanvas: {\r\n\t\tgetMain: canvas.getMain,\r\n\t\tcreate: canvas.create\r\n\t},\r\n\tcolor: color,\r\n\tsprite: {\r\n\t\tcreate: sprite.create,\r\n\t\taddFrame: sprite.addFrame,\r\n\t\ttint: sprite.tint,\r\n\t\tget: sprite.get,\r\n\t\tcache: sprite.cache\r\n\t},\r\n\tsound: {\r\n\t\tplay: sound.play,\r\n\t\tstop: sound.stop,\r\n\t\tget: sound.get\r\n\t},\r\n\troom: room,\r\n\tinput: {\r\n\t\tkeyboard: input.keyboard,\r\n\t\tmouse: input.mouse,\r\n\t\ttouch: input.touch\r\n\t},\r\n\tmath: math,\r\n\tCamera: Camera,\r\n\tapp: app,\r\n\tdata: data,\r\n\tTilemap: Tilemap,\r\n\ttween: tween,\r\n\tTransition: Transition,\r\n\tPrimitive: Primitive\r\n}\r\n\r\n//\r\nlet blockBegin            = \"blockBegin\",\r\n\tblockEnd        \t  = \"blockEnd\",\r\n\texitEvent        \t  = \"exitEvent\",\r\n\tinstanceCreate    \t  = instance.create,\r\n\tinstanceCreateMoving  = instance.createMoving,\r\n\tinstanceDestroy       = instance.destroy,\r\n\tchangeSprite  \t\t  = instance.changeSprite,\r\n\tinstanceSetRotation   = instance.setRotation,\r\n\tinstanceSetDirection  = instance.setDirection,\r\n\tmessage               = console.log,\r\n\talert                 = function( m ) { window.alert( m ) },\r\n\tconfirm               = function( m ) { return window.confirm( m ) },\r\n\tdrawSetColor          = draw.setColor,\r\n\tdrawSetFont           = draw.setFont,\r\n\tdrawSetFontSize       = draw.setFontSize,\r\n\tdrawText              = draw.text,\r\n\tdrawSelf              = instance.drawSelf,\r\n\tdrawSprite            = draw.sprite,\r\n\tsoundPlay = function( snd, loop ) { sound.play( snd, { loop: loop } ) };\r\n\r\n//\r\nexport {\r\n\tinstanceCreate,\r\n\tinstanceCreateMoving,\r\n\tinstanceDestroy,\r\n\tinstanceSetRotation,\r\n\tinstanceSetDirection,\r\n\tchangeSprite,\r\n\tchangeSprite as instanceChangeSprite,\r\n\tsoundPlay,\r\n\tdrawSetColor,\r\n\tdrawSetFont,\r\n\tdrawSetFontSize,\r\n\tdrawText,\r\n\tdrawSelf,\r\n\tdrawSelf as instanceDrawSelf,\r\n\tdrawSprite,\r\n\tblockBegin,\r\n\tblockEnd,\r\n\texitEvent,\r\n\tactionSet        as set,\r\n\tactionGet        as get,\r\n\tactionTest       as test,\r\n\tactionTest,\r\n\tactionSetGravity as setGravity,\r\n\tactionJump       as jump,\r\n\tactionJumpRandom as jumpRandom,\r\n\tmoveFree,\r\n\tmoveDirect,\r\n\tmoveSpeedX,\r\n\tmoveSpeedY,\r\n\tmoveReverseX,\r\n\tmoveReverseY,\r\n\tactionWrap,\r\n\tactionConfine,\r\n\tactionWrap       as wrap,\r\n\tactionConfine    as confine,\r\n\tactionFunc       as func,\t// DEPRECATE?\r\n\trunCode          as code,\r\n\tmessage,\r\n\talert,\r\n\tconfirm,\r\n\tGAME\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./js/action.js","/**\r\n * @module app\r\n */\r\n \r\n//\r\nimport canvas from \"./canvas.js\";\r\n \r\n//\r\nlet app = {\r\n\t\r\n\t/**\r\n\t * @param {string} cursor Same as the CSS cursor property.\r\n\t * See {@link https://developer.mozilla.org/en-US/docs/Web/CSS/cursor}\r\n\t */\r\n\tsetCursor: function(cursor) {\r\n\t\tcanvas.main.style.cursor = cursor;\r\n\t}\r\n\t\r\n}\r\n\r\n//\r\nexport default app;\r\n\n\n\n// WEBPACK FOOTER //\n// ./js/app.js","/**\r\n * @module data\r\n */\r\n\r\nimport Grid from \"./data/dataGrid.js\";\r\n\r\n//\r\nexport default {\r\n\tGrid: Grid\r\n}\n\n\n// WEBPACK FOOTER //\n// ./js/data.js","/**\r\n * @module Tilemap\r\n */\r\n\r\n//\r\nimport generator from \"./generator.js\";\r\nimport Grid from \"./data/dataGrid.js\";\r\nimport draw from \"./draw.js\";\r\nimport sprite from \"./sprite.js\";\r\n\r\n/**\r\n *\r\n */\r\nfunction Tilemap( options = {} ) {\r\n\t\r\n\t//\r\n\tthis.textureAtlas = options.atlas || null;\r\n\tthis.tileWidth = options.tileWidth || 16;\r\n\tthis.tileHeight = options.tileHeight || 16;\r\n\tthis.tileSpacing = options.tileSpacing || 0;\r\n\tthis.tileOverlay = options.tileOverlay || 0;\r\n\tthis.tilesWide = options.tilesWide || 16;\r\n\tthis.mapWidth = options.mapWidth || 16;\r\n\tthis.mapHeight = options.mapHeight || 16;\r\n\tthis.layers = {};\r\n\t\r\n}\r\n\r\n/**\r\n *\r\n */\r\nTilemap.prototype.set = function( layer, x, y, index ) {\r\n\r\n\tif ( !this.layers[layer] ) {\r\n\t\tthis.layers[layer] = new Grid( this.mapWidth, this.mapHeight );\r\n\t}\r\n\t\r\n\tthis.layers[layer].set( x, y, index );\r\n\r\n}\r\n\r\n//\r\nTilemap.prototype.draw = function( options ) {\r\n\r\n\t// cache\r\n\tlet atlas = sprite.get( this.textureAtlas ).images[0].img;\r\n\tlet gap = this.tileSpacing + this.tileOverlay;\r\n\t\r\n\t//\r\n\tlet startX, startY, endX, endY, order;\r\n\tif ( options ) {\r\n\t\torder = options.order;\r\n\t\tstartX = Math.floor(Math.max( 0, options.left / this.tileWidth ));\r\n\t\tstartY = Math.floor(Math.max( 0, options.top / this.tileHeight ));\r\n\t\tendX = Math.ceil(Math.min( this.mapWidth, options.right / this.tileWidth ));\r\n\t\tendY = Math.ceil(Math.min( this.mapHeight, options.bottom / this.tileHeight ));\r\n\t} else {\r\n\t\torder = Object.keys( this.layers );\r\n\t\tstartX = 0;\r\n\t\tstartY = 0;\r\n\t\tendX = this.mapWidth;\r\n\t\tendY = this.mapHeight;\r\n\t}\r\n\t\r\n\tlet name, x, y, n;\r\n\tfor ( n=0; n<order.length; n++ ) {\r\n\t\tfor ( x=startX; x<endX; x++ ) {\r\n\t\t\tfor ( y=startY; y<endY; y++ ) {\r\n\t\t\t\t\r\n\t\t\t\tvar tile = this.layers[order[n]].get( x, y );\r\n\t\t\t\tif ( tile > 0 ) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet iX = ( tile - 1 ) % this.tilesWide;\r\n\t\t\t\t\tlet iY = Math.floor( ( tile - 1 ) / this.tilesWide );\r\n\t\t\t\t\tiX = iX * (this.tileWidth + gap*2) + gap;\r\n\t\t\t\t\tiY = iY * (this.tileHeight + gap*2) + gap;\r\n\t\t\t\t\t\r\n\t\t\t\t\tdraw.context.drawImage(\r\n\t\t\t\t\t\tatlas,\r\n\t\t\t\t\t\tiX - this.tileOverlay, iY - this.tileOverlay,\r\n\t\t\t\t\t\tthis.tileWidth + this.tileOverlay * 2, // source width\r\n\t\t\t\t\t\tthis.tileHeight + this.tileOverlay * 2, // source height\r\n\t\t\t\t\t\tx * this.tileWidth - this.tileOverlay, // target x\r\n\t\t\t\t\t\ty * this.tileHeight - this.tileOverlay, // target y\r\n\t\t\t\t\t\tthis.tileWidth + this.tileOverlay * 2, // target width\r\n\t\t\t\t\t\tthis.tileHeight + this.tileOverlay * 2 // target height\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\n//\r\nTilemap.create = generator.functionFromConstructor( Tilemap );\r\n\r\n//\r\nexport default Tilemap;\n\n\n// WEBPACK FOOTER //\n// ./js/tilemap.js","/**\r\n * @module generator\r\n */\r\n\r\n//\r\nexport default {\r\n\t\r\n\t/**\r\n\t * @param {function} constructor Constructor function.\r\n\t */\r\n\tfunctionFromConstructor: (constructor) => {\r\n\t\treturn function(...a) { return new constructor(...a); }\r\n\t},\r\n\r\n\t/**\r\n\t * @param {function} method\r\n\t */\r\n\tfunctionFromMethod: (method) => {\r\n\t\treturn function(...a) { return method.call(...a); }\r\n\t}\r\n\t\r\n}\n\n\n// WEBPACK FOOTER //\n// ./js/generator.js"],"sourceRoot":""}